"use strict";var Gue=Object.create;var rE=Object.defineProperty;var Kue=Object.getOwnPropertyDescriptor;var Que=Object.getOwnPropertyNames;var Jue=Object.getPrototypeOf,Zue=Object.prototype.hasOwnProperty;var Yn=(e,t)=>{for(var r in t)rE(e,r,{get:t[r],enumerable:!0})},UB=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Que(t))!Zue.call(e,o)&&o!==r&&rE(e,o,{get:()=>t[o],enumerable:!(n=Kue(t,o))||n.enumerable});return e};var gg=(e,t,r)=>(r=e!=null?Gue(Jue(e)):{},UB(t||!e||!e.__esModule?rE(r,"default",{value:e,enumerable:!0}):r,e)),Yue=e=>UB(rE({},"__esModule",{value:!0}),e);var $Ue={};Yn($Ue,{activate:()=>jUe});module.exports=Yue($Ue);var nE=e=>typeof e=="function",u=function(e,t){if(typeof e=="function")return function(){return e(arguments)?t.apply(this,arguments):r=>t(r,...arguments)};switch(e){case 0:case 1:throw new RangeError(`Invalid arity ${e}`);case 2:return function(r,n){return arguments.length>=2?t(r,n):function(o){return t(o,r)}};case 3:return function(r,n,o){return arguments.length>=3?t(r,n,o):function(s){return t(s,r,n)}};case 4:return function(r,n,o,s){return arguments.length>=4?t(r,n,o,s):function(i){return t(i,r,n,o)}};case 5:return function(r,n,o,s,i){return arguments.length>=5?t(r,n,o,s,i):function(a){return t(a,r,n,o,s)}};default:return function(){if(arguments.length>=e)return t.apply(this,arguments);let r=arguments;return function(n){return t(n,...r)}}}};var R=e=>e;var ah=e=>()=>e,zr=ah(!0),ls=ah(!1),w1=ah(null),ch=ah(void 0),Ar=ch;function p(e,t,r,n,o,s,i,a,c){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return r(t(e));case 4:return n(r(t(e)));case 5:return o(n(r(t(e))));case 6:return s(o(n(r(t(e)))));case 7:return i(s(o(n(r(t(e))))));case 8:return a(i(s(o(n(r(t(e)))))));case 9:return c(a(i(s(o(n(r(t(e))))))));default:{let l=arguments[0];for(let f=1;f<arguments.length;f++)l=arguments[f](l);return l}}}var ar=e=>(t,r)=>t===r||e(t,r),Xue=(e,t)=>e===t,epe=()=>Xue;var tpe=epe();var O1=u(2,(e,t)=>ar((r,n)=>e(t(r),t(n)))),qB=O1(tpe,e=>e.getTime());var WB=e=>ar((t,r)=>{if(t.length!==r.length)return!1;for(let n=0;n<t.length;n++)if(!e(t[n],r[n]))return!1;return!0});var uh=e=>u(3,(t,r,n)=>e(t,o=>({...o,[r]:n(o)}))),ph=e=>u(2,(t,r)=>e(t,n=>({[r]:n}))),oE=(e,t)=>u(3,(r,n,o)=>t(r,s=>e(o(s),i=>({...s,[n]:i}))));var HB="effect/GlobalValue",bg,ne=(e,t)=>(bg||(globalThis[HB]??=new Map,bg=globalThis[HB]),bg.has(e)||bg.set(e,t()),bg.get(e));var BB=e=>!!e,zB=e=>e instanceof Set,jB=e=>e instanceof Map,cr=e=>typeof e=="string",go=e=>typeof e=="number",Oi=e=>typeof e=="boolean",Bu=e=>typeof e=="bigint",Oa=e=>typeof e=="symbol";var _i=nE,$B=e=>e===void 0,VB=e=>e!==void 0;var sE=e=>e!==null,GB=e=>!1;var lh=e=>typeof e=="object"&&e!==null,jr=e=>lh(e)||_i(e),F=u(2,(e,t)=>jr(e)&&t in e),_a=u(2,(e,t)=>F(e,"_tag")&&e._tag===t),Ul=e=>e==null,KB=e=>e!=null;var QB=e=>e instanceof Uint8Array,iE=e=>e instanceof Date,Lo=e=>typeof e=="string"||F(e,Symbol.iterator),yg=e=>lh(e)&&!Array.isArray(e);var k1=e=>F(e,"then")&&_i(e.then);var ql=e=>`BUG: ${e} - please report an issue at https://github.com/Effect-TS/effect/issues`;var T1=Symbol.for("effect/Gen/GenKind"),ZB=e=>jr(e)&&T1 in e,I1=class{value;constructor(t){this.value=t}get _F(){return R}get _R(){return t=>t}get _O(){return t=>t}get _E(){return t=>t}[T1]=T1;[Symbol.iterator](){return new Wl(this)}},Wl=class e{self;called=!1;constructor(t){this.self=t}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new e(this.self)}};var YB=()=>function(){let e=arguments[0];for(let t=1;t<arguments.length;t++)e=arguments[t](e);return new I1(e)},npe=335903614,ope=4150755663,spe=1481765933,ipe=1284865837,ape=9007199254740992,cpe=134217728,aE=class{_state;constructor(t,r,n,o){return Ul(r)&&Ul(t)?(r=Math.random()*4294967295>>>0,t=0):Ul(r)&&(r=t,t=0),Ul(o)&&Ul(n)?(o=this._state?this._state[3]:ope,n=this._state?this._state[2]:npe):Ul(o)&&(o=n,n=0),this._state=new Int32Array([0,0,n>>>0,((o||0)|1)>>>0]),this._next(),JB(this._state,this._state[0],this._state[1],t>>>0,r>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(t){this._state[0]=t[0],this._state[1]=t[1],this._state[2]=t[2],this._state[3]=t[3]|1}integer(t){return Math.round(this.number()*Number.MAX_SAFE_INTEGER)%t}number(){let t=(this._next()&67108863)*1,r=(this._next()&134217727)*1;return(t*cpe+r)/ape}_next(){let t=this._state[0]>>>0,r=this._state[1]>>>0;upe(this._state,t,r,spe,ipe),JB(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let n=t>>>18,o=(r>>>18|t<<14)>>>0;n=(n^t)>>>0,o=(o^r)>>>0;let s=(o>>>27|n<<5)>>>0,i=t>>>27,a=(-i>>>0&31)>>>0;return(s>>>i|s<<a)>>>0}};function upe(e,t,r,n,o){let s=(r>>>16)*(o&65535)>>>0,i=(r&65535)*(o>>>16)>>>0,a=(r&65535)*(o&65535)>>>0,c=(r>>>16)*(o>>>16)+((i>>>16)+(s>>>16))>>>0;i=i<<16>>>0,a=a+i>>>0,a>>>0<i>>>0&&(c=c+1>>>0),s=s<<16>>>0,a=a+s>>>0,a>>>0<s>>>0&&(c=c+1>>>0),c=c+Math.imul(r,n)>>>0,c=c+Math.imul(t,o)>>>0,e[0]=c,e[1]=a}function JB(e,t,r,n,o){let s=t+n>>>0,i=r+o>>>0;i>>>0<r>>>0&&(s=s+1|0),e[0]=s,e[1]=i}var R1=Symbol.for("effect/Utils/YieldWrap"),qs=class{#e;constructor(t){this.#e=t}[R1](){return this.#e}};function Sg(e){if(typeof e=="object"&&e!==null&&R1 in e)return e[R1]();throw new Error(ql("yieldWrapGet"))}var Uo=ne("effect/Utils/isStructuralRegion",()=>({enabled:!1,tester:void 0}));var XB={effect_internal_function:e=>e()},ppe={effect_internal_function:e=>{try{return e()}finally{}}},lpe=XB.effect_internal_function(()=>new Error().stack)?.includes("effect_internal_function")===!0,rt=lpe?XB.effect_internal_function:ppe.effect_internal_function,fpe=function*(){}.constructor,ez=e=>jr(e)&&e.constructor===fpe;var M1=ne(Symbol.for("effect/Hash/randomHashCache"),()=>new WeakMap),H=Symbol.for("effect/Hash"),M=e=>{if(Uo.enabled===!0)return 0;switch(typeof e){case"number":return ac(e);case"bigint":return Ke(e.toString(10));case"boolean":return Ke(String(e));case"symbol":return Ke(String(e));case"string":return Ke(e);case"undefined":return Ke("undefined");case"function":case"object":return e===null?Ke("null"):e instanceof Date?M(e.toISOString()):e instanceof URL?M(e.href):dpe(e)?e[H]():zu(e);default:throw new Error(`BUG: unhandled typeof ${typeof e} - please report an issue at https://github.com/Effect-TS/effect/issues`)}},zu=e=>(M1.has(e)||M1.set(e,ac(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER))),M1.get(e)),G=e=>t=>t*53^e,cE=e=>e&3221225471|e>>>1&1073741824,dpe=e=>F(e,H),ac=e=>{if(e!==e||e===1/0)return 0;let t=e|0;for(t!==e&&(t^=e*4294967295);e>4294967295;)t^=e/=4294967295;return cE(t)},Ke=e=>{let t=5381,r=e.length;for(;r;)t=t*33^e.charCodeAt(--r);return cE(t)},hpe=(e,t)=>{let r=12289;for(let n=0;n<t.length;n++)r^=p(Ke(t[n]),G(M(e[t[n]])));return cE(r)},uE=e=>hpe(e,Object.keys(e)),qo=e=>{let t=6151;for(let r=0;r<e.length;r++)t=p(t,G(M(e[r])));return cE(t)},se=function(){if(arguments.length===1){let r=arguments[0];return function(n){return Object.defineProperty(r,H,{value(){return n},enumerable:!1}),n}}let e=arguments[0],t=arguments[1];return Object.defineProperty(e,H,{value(){return t},enumerable:!1}),t};var W=Symbol.for("effect/Equal");function N(){return arguments.length===1?e=>pE(e,arguments[0]):pE(arguments[0],arguments[1])}function pE(e,t){if(e===t)return!0;let r=typeof e;if(r!==typeof t)return!1;if(r==="object"||r==="function"){if(e!==null&&t!==null){if(ju(e)&&ju(t))return M(e)===M(t)&&e[W](t)?!0:Uo.enabled&&Uo.tester?Uo.tester(e,t):!1;if(e instanceof Date&&t instanceof Date)return e.toISOString()===t.toISOString();if(e instanceof URL&&t instanceof URL)return e.href===t.href}if(Uo.enabled){if(Array.isArray(e)&&Array.isArray(t))return e.length===t.length&&e.every((n,o)=>pE(n,t[o]));if(Object.getPrototypeOf(e)===Object.prototype&&Object.getPrototypeOf(e)===Object.prototype){let n=Object.keys(e),o=Object.keys(t);if(n.length===o.length){for(let s of n)if(!(s in t&&pE(e[s],t[s])))return Uo.tester?Uo.tester(e,t):!1;return!0}}return Uo.tester?Uo.tester(e,t):!1}}return Uo.enabled&&Uo.tester?Uo.tester(e,t):!1}var ju=e=>F(e,W),Eg=()=>N;var he=Symbol.for("nodejs.util.inspect.custom"),ve=e=>{try{if(F(e,"toJSON")&&_i(e.toJSON)&&e.toJSON.length===0)return e.toJSON();if(Array.isArray(e))return e.map(ve)}catch{return{}}return fh(e)},v1="[Circular]";function bo(e){try{return e.toISOString()}catch{return"Invalid Date"}}function mpe(e){try{let t=e.toString();return typeof t=="string"?t:String(t)}catch{return"[toString threw]"}}function $u(e){return cr(e)?JSON.stringify(e):String(e)}function Wo(e,t){let r=t?.space??0,n=new WeakSet,o=r?go(r)?" ".repeat(r):r:"",s=l=>o.repeat(l),i=(l,f)=>{let d=l?.constructor;return d&&d!==Object.prototype.constructor&&d.name?`${d.name}(${f})`:f},a=l=>{try{return Reflect.ownKeys(l)}catch{return["[ownKeys threw]"]}};function c(l,f=0){if(Array.isArray(l)){if(n.has(l))return v1;if(n.add(l),!o||l.length<=1)return`[${l.map(h=>c(h,f)).join(",")}]`;let d=l.map(h=>c(h,f+1)).join(`,
`+s(f+1));return`[
${s(f+1)}${d}
${s(f)}]`}if(iE(l))return bo(l);if(!t?.ignoreToString&&F(l,"toString")&&_i(l.toString)&&l.toString!==Object.prototype.toString&&l.toString!==Array.prototype.toString){let d=mpe(l);return l instanceof Error&&l.cause?`${d} (cause: ${c(l.cause,f)})`:d}if(cr(l))return JSON.stringify(l);if(go(l)||l==null||Oi(l)||Oa(l))return String(l);if(Bu(l))return String(l)+"n";if(l instanceof Set||l instanceof Map)return n.has(l)?v1:(n.add(l),`${l.constructor.name}(${c(Array.from(l),f)})`);if(jr(l)){if(n.has(l))return v1;n.add(l);let d=a(l);if(!o||d.length<=1){let m=`{${d.map(y=>`${$u(y)}:${c(l[y],f)}`).join(",")}}`;return i(l,m)}let h=`{
${d.map(m=>`${s(f+1)}${$u(m)}: ${c(l[m],f+1)}`).join(`,
`)}
${s(f)}}`;return i(l,h)}return String(l)}return c(e,0)}var De=e=>JSON.stringify(e,null,2),cqe={toJSON(){return ve(this)},[he](){return this.toJSON()},toString(){return De(this.toJSON())}},tz=class{[he](){return this.toJSON()}toString(){return De(this.toJSON())}},cc=(e,t=2)=>{if(typeof e=="string")return e;try{return typeof e=="object"?Cg(e,t):String(e)}catch{return String(e)}},Cg=(e,t)=>{let r=[],n=JSON.stringify(e,(o,s)=>typeof s=="object"&&s!==null?r.includes(s)?void 0:r.push(s)&&(Hl.fiberRefs!==void 0&&rz(s)?s[P1](Hl.fiberRefs):s):s,t);return r=void 0,n},P1=Symbol.for("effect/Inspectable/Redactable"),rz=e=>typeof e=="object"&&e!==null&&P1 in e,Hl=ne("effect/Inspectable/redactableState",()=>({fiberRefs:void 0})),nz=(e,t)=>{let r=Hl.fiberRefs;Hl.fiberRefs=e;try{return t()}finally{Hl.fiberRefs=r}},fh=e=>rz(e)&&Hl.fiberRefs!==void 0?e[P1](Hl.fiberRefs):e;var v=(e,t)=>{switch(t.length){case 0:return e;case 1:return t[0](e);case 2:return t[1](t[0](e));case 3:return t[2](t[1](t[0](e)));case 4:return t[3](t[2](t[1](t[0](e))));case 5:return t[4](t[3](t[2](t[1](t[0](e)))));case 6:return t[5](t[4](t[3](t[2](t[1](t[0](e))))));case 7:return t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))));case 8:return t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e))))))));case 9:return t[8](t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))))));default:{let r=e;for(let n=0,o=t.length;n<o;n++)r=t[n](r);return r}}};var Bl="Async",uc="Commit",mt="Failure",dh="OnFailure",hh="OnSuccess",mh="OnSuccessAndFailure",xt="Success",lE="Sync";var pc="UpdateRuntimeFlags",xh="While",zl="Iterator",fE="WithRuntime",gh="Yield",wg="RevertFlags";var gpe="3.19.3",_g=()=>gpe;var sz=Symbol.for("effect/Effect"),kg=Symbol.for("effect/Stream"),iz=Symbol.for("effect/Sink"),az=Symbol.for("effect/Channel"),Ta={_R:e=>e,_E:e=>e,_A:e=>e,_V:_g()},bpe={_A:e=>e,_In:e=>e,_L:e=>e,_E:e=>e,_R:e=>e},ype={_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutElem:e=>e,_OutDone:e=>e},lc={[sz]:Ta,[kg]:Ta,[iz]:bpe,[az]:ype,[W](e){return this===e},[H](){return se(this,zu(this))},[Symbol.iterator](){return new Wl(new qs(this))},pipe(){return v(this,arguments)}},bh={[H](){return se(this,uE(this))},[W](e){let t=Object.keys(this),r=Object.keys(e);if(t.length!==r.length)return!1;for(let n of t)if(!(n in e&&N(this[n],e[n])))return!1;return!0}},ki={...lc,_op:uc},F1={...ki,...bh},cz=(function(){function e(){}return e.prototype=ki,e})();var uz=Symbol.for("effect/Option"),pz={...lc,[uz]:{_A:e=>e},[he](){return this.toJSON()},toString(){return De(this.toJSON())}},Spe=Object.assign(Object.create(pz),{_tag:"Some",_op:"Some",[W](e){return dE(e)&&D1(e)&&N(this.value,e.value)},[H](){return se(this,G(M(this._tag))(M(this.value)))},toJSON(){return{_id:"Option",_tag:this._tag,value:ve(this.value)}}}),Epe=M("None"),Cpe=Object.assign(Object.create(pz),{_tag:"None",_op:"None",[W](e){return dE(e)&&Vu(e)},[H](){return Epe},toJSON(){return{_id:"Option",_tag:this._tag}}}),dE=e=>F(e,uz),Vu=e=>e._tag==="None",D1=e=>e._tag==="Some",Ti=Object.create(Cpe),Rn=e=>{let t=Object.create(Spe);return t.value=e,t};var L1=Symbol.for("effect/Either"),lz={...lc,[L1]:{_R:e=>e},[he](){return this.toJSON()},toString(){return De(this.toJSON())}},wpe=Object.assign(Object.create(lz),{_tag:"Right",_op:"Right",[W](e){return hE(e)&&mE(e)&&N(this.right,e.right)},[H](){return G(M(this._tag))(M(this.right))},toJSON(){return{_id:"Either",_tag:this._tag,right:ve(this.right)}}}),Ope=Object.assign(Object.create(lz),{_tag:"Left",_op:"Left",[W](e){return hE(e)&&yh(e)&&N(this.left,e.left)},[H](){return G(M(this._tag))(M(this.left))},toJSON(){return{_id:"Either",_tag:this._tag,left:ve(this.left)}}}),hE=e=>F(e,L1),yh=e=>e._tag==="Left",mE=e=>e._tag==="Right",Ig=e=>{let t=Object.create(Ope);return t.left=e,t},Rg=e=>{let t=Object.create(wpe);return t.right=e,t},U1=e=>mE(e)?Ti:Rn(e.left),q1=e=>yh(e)?Ti:Rn(e.right),fz=u(2,(e,t)=>Vu(e)?Ig(t()):Rg(e.value));var Z=Rg;var $=Ig;var W1=fz,Sh=e=>{if(_i(e))try{return Z(e())}catch(t){return $(t)}else try{return Z(e.try())}catch(t){return $(e.catch(t))}};var xE=hE,kt=yh,Ho=mE;var hz=({left:e,right:t})=>ar((r,n)=>kt(r)?kt(n)&&e(r.left,n.left):Ho(n)&&t(r.right,n.right)),mz=u(2,(e,{onLeft:t,onRight:r})=>kt(e)?$(t(e.left)):Z(r(e.right))),Ws=u(2,(e,t)=>kt(e)?$(t(e.left)):Z(e.right)),Eh=u(2,(e,t)=>Ho(e)?Z(t(e.right)):$(e.left)),Xe=u(2,(e,{onLeft:t,onRight:r})=>kt(e)?t(e.left):r(e.right));var gE=Xe({onLeft:R,onRight:R});var H1=u(2,(e,t)=>{if(Ho(e))return e.right;throw t(e.left)}),B1=H1(()=>new Error("getOrThrow called on a Left"));var z1=e=>e.length>0;var ie={};Yn(ie,{Do:()=>Zpe,TypeId:()=>kpe,all:()=>yz,andThen:()=>Npe,ap:()=>Hpe,as:()=>xz,asVoid:()=>Ppe,bind:()=>Jpe,bindTo:()=>Kpe,composeK:()=>qpe,contains:()=>Q1,containsWith:()=>Cz,exists:()=>J1,filter:()=>Qu,filterMap:()=>Ez,firstSomeOf:()=>Mpe,flatMap:()=>kr,flatMapNullable:()=>V1,flatten:()=>Dpe,fromIterable:()=>Ipe,fromNullable:()=>br,gen:()=>Xpe,getEquivalence:()=>K1,getLeft:()=>Rpe,getOrElse:()=>_e,getOrNull:()=>SE,getOrThrow:()=>vg,getOrThrowWith:()=>EE,getOrUndefined:()=>yr,getOrder:()=>jpe,getRight:()=>j1,isNone:()=>ge,isOption:()=>yE,isSome:()=>X,let:()=>Qpe,lift2:()=>$pe,liftNullable:()=>vpe,liftPredicate:()=>Vpe,liftThrowable:()=>Vl,map:()=>ct,match:()=>j,mergeWith:()=>Ju,none:()=>g,orElse:()=>yo,orElseEither:()=>Ape,orElseSome:()=>$1,partitionMap:()=>zpe,product:()=>bz,productMany:()=>Wpe,reduceCompact:()=>Bpe,some:()=>x,tap:()=>gz,toArray:()=>Sz,toRefinement:()=>Tpe,void:()=>Fpe,zipLeft:()=>Upe,zipRight:()=>Lpe,zipWith:()=>G1});var fc=e=>(t,r)=>t===r?0:e(t,r);var bE=fc((e,t)=>e<t?-1:1);var Ch=fc((e,t)=>e<t?-1:1);var wh=u(2,(e,t)=>fc((r,n)=>e(t(r),t(n))));var jl=e=>u(2,(t,r)=>e(t,r)===-1),$l=e=>u(2,(t,r)=>e(t,r)===1),Oh=e=>u(2,(t,r)=>e(t,r)!==1),_h=e=>u(2,(t,r)=>e(t,r)!==-1),Ag=e=>u(2,(t,r)=>t===r||e(t,r)<1?t:r),Mg=e=>u(2,(t,r)=>t===r||e(t,r)>-1?t:r),Gu=e=>u(2,(t,r)=>Ag(e)(r.maximum,Mg(e)(r.minimum,t))),kh=e=>u(2,(t,r)=>!jl(e)(t,r.minimum)&&!$l(e)(t,r.maximum));var kpe=Symbol.for("effect/Option"),g=()=>Ti,x=Rn,yE=dE,ge=Vu,X=D1,j=u(2,(e,{onNone:t,onSome:r})=>ge(e)?t():r(e.value)),Tpe=e=>t=>X(e(t)),Ipe=e=>{for(let t of e)return x(t);return g()},j1=q1,Rpe=U1,_e=u(2,(e,t)=>ge(e)?t():e.value),yo=u(2,(e,t)=>ge(e)?t():e),$1=u(2,(e,t)=>ge(e)?x(t()):e),Ape=u(2,(e,t)=>ge(e)?ct(t(),Rg):ct(e,Ig)),Mpe=e=>{let t=g();for(t of e)if(X(t))return t;return t},br=e=>e==null?g():x(e),vpe=e=>(...t)=>br(e(...t)),SE=_e(w1),yr=_e(ch),Vl=e=>(...t)=>{try{return x(e(...t))}catch{return g()}},EE=u(2,(e,t)=>{if(X(e))return e.value;throw t()}),vg=EE(()=>new Error("getOrThrow called on a None")),ct=u(2,(e,t)=>ge(e)?g():x(t(e.value))),xz=u(2,(e,t)=>ct(e,()=>t)),Ppe=xz(void 0),Fpe=x(void 0);var kr=u(2,(e,t)=>ge(e)?g():t(e.value)),Npe=u(2,(e,t)=>kr(e,r=>{let n=nE(t)?t(r):t;return yE(n)?n:x(n)})),V1=u(2,(e,t)=>ge(e)?g():br(t(e.value))),Dpe=kr(R),Lpe=u(2,(e,t)=>kr(e,()=>t)),Upe=u(2,(e,t)=>gz(e,()=>t)),qpe=u(2,(e,t)=>r=>kr(e(r),t)),gz=u(2,(e,t)=>kr(e,r=>ct(t(r),()=>r))),bz=(e,t)=>X(e)&&X(t)?x([e.value,t.value]):g(),Wpe=(e,t)=>{if(ge(e))return g();let r=[e.value];for(let n of t){if(ge(n))return g();r.push(n.value)}return x(r)},yz=e=>{if(Symbol.iterator in e){let r=[];for(let n of e){if(ge(n))return g();r.push(n.value)}return x(r)}let t={};for(let r of Object.keys(e)){let n=e[r];if(ge(n))return g();t[r]=n.value}return x(t)},G1=u(3,(e,t,r)=>ct(bz(e,t),([n,o])=>r(n,o))),Hpe=u(2,(e,t)=>G1(e,t,(r,n)=>r(n))),Bpe=u(3,(e,t,r)=>{let n=t;for(let o of e)X(o)&&(n=r(n,o.value));return n}),Sz=e=>ge(e)?[]:[e.value],zpe=u(2,(e,t)=>{if(ge(e))return[g(),g()];let r=t(e.value);return yh(r)?[x(r.left),g()]:[g(),x(r.right)]}),Ez=kr,Qu=u(2,(e,t)=>Ez(e,r=>t(r)?Rn(r):Ti)),K1=e=>ar((t,r)=>ge(t)?ge(r):ge(r)?!1:e(t.value,r.value)),jpe=e=>fc((t,r)=>X(t)?X(r)?e(t.value,r.value):1:-1),$pe=e=>u(2,(t,r)=>G1(t,r,e)),Vpe=u(2,(e,t)=>t(e)?x(e):g()),Cz=e=>u(2,(t,r)=>ge(t)?!1:e(t.value,r)),Gpe=Eg(),Q1=Cz(Gpe),J1=u(2,(e,t)=>ge(e)?!1:t(e.value)),Kpe=ph(ct),Qpe=uh(ct);var Jpe=oE(ct,kr),Zpe=x({}),Ype=YB(),Xpe=(...e)=>{let r=(e.length===1?e[0]:e[1].bind(e[0]))(Ype),n=r.next();for(;!n.done;){let o=ZB(n.value)?n.value.value:Sg(n.value);if(ge(o))return o;n=r.next(o.value)}return x(n.value)},Ju=e=>(t,r)=>ge(t)?r:ge(r)?t:x(e(t.value,r.value));var CE=(...e)=>e;var wz=u(2,(e,t)=>{let r=0;for(let n of e){let o=t(n,r);if(Oi(o)){if(o)return x(n)}else if(X(o))return o;r++}return g()});var Gl=e=>new Array(e),wE=u(2,(e,t)=>{let r=Math.max(1,Math.floor(e)),n=new Array(r);for(let o=0;o<r;o++)n[o]=t(o);return n});var Ee=e=>Array.isArray(e)?e:Array.from(e),Kl=e=>Array.isArray(e)?e:[e];var Y1=u(2,(e,{onEmpty:t,onNonEmpty:r})=>ut(e)?r(e):t()),_z=u(2,(e,{onEmpty:t,onNonEmpty:r})=>ut(e)?r(Lr(e),Ri(e)):t());var Th=u(2,(e,t)=>[t,...e]);var kz=u(2,(e,t)=>[...e,t]),X1=u(2,(e,t)=>Ee(e).concat(Ee(t)));var eR=Array.isArray,ele=e=>e.length===0,Tz=ele,Ii=z1,ut=z1;var Iz=(e,t)=>e<0||e>=t.length,tle=(e,t)=>Math.floor(Math.min(Math.max(0,e),t.length)),rle=u(2,(e,t)=>{let r=Math.floor(t);return Iz(r,e)?g():x(e[r])}),tR=u(2,(e,t)=>{let r=Math.floor(t);if(Iz(r,e))throw new Error(`Index ${r} out of bounds`);return e[r]});var Ia=rle(0),Lr=tR(0),OE=e=>ut(e)?x(rR(e)):g(),rR=e=>e[e.length-1];var Ri=e=>e.slice(1);var nle=(e,t)=>{let r=0;for(let n of e){if(!t(n,r))break;r++}return r},Rz=u(2,(e,t)=>iR(e,nle(e,t))),Az=u(2,(e,t)=>{let r=Ee(e);return r.slice(tle(t,r),r.length)});var _E=wz;var nR=e=>Array.from(e).reverse(),dc=u(2,(e,t)=>{let r=Array.from(e);return r.sort(t),r});var oR=u(2,(e,t)=>sR(e,t,CE)),sR=u(3,(e,t,r)=>{let n=Ee(e),o=Ee(t);if(ut(n)&&ut(o)){let s=[r(Lr(n),Lr(o))],i=Math.min(n.length,o.length);for(let a=1;a<i;a++)s[a]=r(n[a],o[a]);return s}return[]});var Mz=e=>u(2,(t,r)=>{for(let n of t)if(e(r,n))return!0;return!1}),vz=Eg();var iR=u(2,(e,t)=>{let r=Array.from(e),n=Math.floor(t);return ut(r)?n>=1?ole(r,n):[[],r]:[r,[]]}),ole=u(2,(e,t)=>{let r=Math.max(1,Math.floor(t));return r>=e.length?[Ih(e),[]]:[Th(e.slice(1,r),Lr(e)),e.slice(r)]});var Ih=e=>e.slice();var sle=u(3,(e,t,r)=>{let n=Ee(e),o=Ee(t);return ut(n)?ut(o)?Lz(r)(X1(n,o)):n:o}),fs=u(2,(e,t)=>sle(e,t,vz)),aR=e=>{let t=Mz(e);return u(2,(r,n)=>Ee(r).filter(o=>t(n,o)))},cR=aR(vz);var ds=()=>[],Vr=e=>[e],Ai=u(2,(e,t)=>e.map(t)),Ql=u(2,(e,t)=>{if(Tz(e))return[];let r=[];for(let n=0;n<e.length;n++){let o=t(e[n],n);for(let s=0;s<o.length;s++)r.push(o[s])}return r}),Rh=Ql(R),hc=u(2,(e,t)=>{let r=Ee(e),n=[];for(let o=0;o<r.length;o++){let s=t(r[o],o);X(s)&&n.push(s.value)}return n}),Pz=u(2,(e,t)=>{let r=0,n=[];for(let o of e){let s=t(o,r);if(X(s))n.push(s.value);else break;r++}return n}),uR=u(2,(e,t)=>{let r=[],n=[],o=Ee(e);for(let s=0;s<o.length;s++){let i=t(o[s],s);kt(i)?r.push(i.left):n.push(i.right)}return[r,n]}),Fz=hc(R);var Nz=u(2,(e,t)=>{let r=Ee(e),n=[];for(let o=0;o<r.length;o++)t(r[o],o)&&n.push(r[o]);return n});var mc=u(3,(e,t,r)=>Ee(e).reduce((n,o,s)=>r(n,o,s),t)),Pg=u(3,(e,t,r)=>Ee(e).reduceRight((n,o,s)=>r(n,o,s),t));var Dz=u(2,(e,t)=>e.every(t));var pR=(e,t)=>{let r=[],n=e,o;for(;X(o=t(n));){let[s,i]=o.value;r.push(s),n=i}return r};var An=WB;var Lz=u(2,(e,t)=>{let r=Ee(e);if(ut(r)){let n=[Lr(r)],o=Ri(r);for(let s of o)n.every(i=>!t(s,i))&&n.push(s);return n}return[]}),lR=e=>Lz(e,Eg());var xc=u(2,(e,t)=>Ee(e).join(t)),Uz=u(3,(e,t,r)=>{let n=0,o=t,s=[];for(let i of e){let a=r(o,i,n);o=a[0],s.push(a[1]),n++}return[o,s]});var Hs=class e extends Error{constructor(t=!1){super(),this.interruptExecution=t,this.footprint=e.SharedFootPrint}static isFailure(t){return t!=null&&t.footprint===e.SharedFootPrint}};Hs.SharedFootPrint=Symbol.for("fast-check/PreconditionFailure");var Fg=class{[Symbol.iterator](){return this}next(t){return{value:t,done:!0}}};Fg.nil=new Fg;function qz(){return Fg.nil}function*Wz(e,t){for(let r of e)yield t(r)}function*Hz(e,t){for(let r of e)yield*t(r)}function*Bz(e,t){for(let r of e)t(r)&&(yield r)}function*zz(e,t){for(let r=0;r<t;++r){let n=e.next();if(n.done)break;yield n.value}}function*jz(e,t){let r=e.next();for(;!r.done&&t(r.value);)yield r.value,r=e.next()}function*$z(e,t){for(let r=e.next();!r.done;r=e.next())yield r.value;for(let r of t)for(let n=r.next();!n.done;n=r.next())yield n.value}var ile=Symbol.iterator,ot=class e{static nil(){return new e(qz())}static of(...t){return new e(t[ile]())}constructor(t){this.g=t}next(){return this.g.next()}[Symbol.iterator](){return this.g}map(t){return new e(Wz(this.g,t))}flatMap(t){return new e(Hz(this.g,t))}dropWhile(t){let r=!1;function*n(o){(r||!t(o))&&(r=!0,yield o)}return this.flatMap(n)}drop(t){if(t<=0)return this;let r=0;function n(){return r++<t}return this.dropWhile(n)}takeWhile(t){return new e(jz(this.g,t))}take(t){return new e(zz(this.g,t))}filter(t){return new e(Bz(this.g,t))}every(t){for(let r of this.g)if(!t(r))return!1;return!0}has(t){for(let r of this.g)if(t(r))return[!0,r];return[!1,null]}join(...t){return new e($z(this.g,t))}getNthOrLast(t){let r=t,n=null;for(let o of this.g){if(r--===0)return o;n=o}return n}};function Zu(e){return new ot(e)}var Sr=Symbol.for("fast-check/cloneMethod");function gc(e){return e!==null&&(typeof e=="object"||typeof e=="function")&&Sr in e&&typeof e[Sr]=="function"}function Jl(e){return gc(e)?e[Sr]():e}var ale=Object.defineProperty,Pe=class{constructor(t,r,n=void 0){this.value_=t,this.context=r,this.hasToBeCloned=n!==void 0||gc(t),this.readOnce=!1,this.hasToBeCloned?ale(this,"value",{get:n!==void 0?n:this.getValue}):this.value=t}getValue(){return this.hasToBeCloned?this.readOnce?this.value_[Sr]():(this.readOnce=!0,this.value_):this.value_}};var Vz=Object.assign,Tt=class{filter(t){return new hR(this,t)}map(t,r){return new dR(this,t,r)}chain(t){return new fR(this,t)}noShrink(){return new mR(this)}noBias(){return new xR(this)}},fR=class extends Tt{constructor(t,r){super(),this.arb=t,this.chainer=r}generate(t,r){let n=t.clone(),o=this.arb.generate(t,r);return this.valueChainer(o,t,n,r)}canShrinkWithoutContext(t){return!1}shrink(t,r){return this.isSafeContext(r)?(r.stoppedForOriginal?ot.nil():this.arb.shrink(r.originalValue,r.originalContext).map(n=>this.valueChainer(n,r.clonedMrng.clone(),r.clonedMrng,r.originalBias))).join(r.chainedArbitrary.shrink(t,r.chainedContext).map(n=>{let o=Vz(Vz({},r),{chainedContext:n.context,stoppedForOriginal:!0});return new Pe(n.value_,o)})):ot.nil()}valueChainer(t,r,n,o){let s=this.chainer(t.value_),i=s.generate(r,o),a={originalBias:o,originalValue:t.value_,originalContext:t.context,stoppedForOriginal:!1,chainedArbitrary:s,chainedContext:i.context,clonedMrng:n};return new Pe(i.value_,a)}isSafeContext(t){return t!=null&&typeof t=="object"&&"originalBias"in t&&"originalValue"in t&&"originalContext"in t&&"stoppedForOriginal"in t&&"chainedArbitrary"in t&&"chainedContext"in t&&"clonedMrng"in t}},dR=class extends Tt{constructor(t,r,n){super(),this.arb=t,this.mapper=r,this.unmapper=n,this.bindValueMapper=o=>this.valueMapper(o)}generate(t,r){let n=this.arb.generate(t,r);return this.valueMapper(n)}canShrinkWithoutContext(t){if(this.unmapper!==void 0)try{let r=this.unmapper(t);return this.arb.canShrinkWithoutContext(r)}catch{return!1}return!1}shrink(t,r){if(this.isSafeContext(r))return this.arb.shrink(r.originalValue,r.originalContext).map(this.bindValueMapper);if(this.unmapper!==void 0){let n=this.unmapper(t);return this.arb.shrink(n,void 0).map(this.bindValueMapper)}return ot.nil()}mapperWithCloneIfNeeded(t){let r=t.value,n=this.mapper(r);return t.hasToBeCloned&&(typeof n=="object"&&n!==null||typeof n=="function")&&Object.isExtensible(n)&&!gc(n)&&Object.defineProperty(n,Sr,{get:()=>()=>this.mapperWithCloneIfNeeded(t)[0]}),[n,r]}valueMapper(t){let[r,n]=this.mapperWithCloneIfNeeded(t),o={originalValue:n,originalContext:t.context};return new Pe(r,o)}isSafeContext(t){return t!=null&&typeof t=="object"&&"originalValue"in t&&"originalContext"in t}},hR=class extends Tt{constructor(t,r){super(),this.arb=t,this.refinement=r,this.bindRefinementOnValue=n=>this.refinementOnValue(n)}generate(t,r){for(;;){let n=this.arb.generate(t,r);if(this.refinementOnValue(n))return n}}canShrinkWithoutContext(t){return this.arb.canShrinkWithoutContext(t)&&this.refinement(t)}shrink(t,r){return this.arb.shrink(t,r).filter(this.bindRefinementOnValue)}refinementOnValue(t){return this.refinement(t.value)}},mR=class extends Tt{constructor(t){super(),this.arb=t}generate(t,r){return this.arb.generate(t,r)}canShrinkWithoutContext(t){return this.arb.canShrinkWithoutContext(t)}shrink(t,r){return ot.nil()}noShrink(){return this}},xR=class extends Tt{constructor(t){super(),this.arb=t}generate(t,r){return this.arb.generate(t,void 0)}canShrinkWithoutContext(t){return this.arb.canShrinkWithoutContext(t)}shrink(t,r){return this.arb.shrink(t,r)}noBias(){return this}};var Gz=Function.prototype.apply,gR=Symbol("apply");function cle(e){try{return e.apply}catch{return}}function ule(e,t,r){let n=e;n[gR]=Gz;let o=n[gR](t,r);return delete n[gR],o}function So(e,t,r){return cle(e)===Gz?e.apply(t,r):ule(e,t,r)}var a3=typeof Array<"u"?Array:void 0;var Mr=typeof Error<"u"?Error:void 0;var Mi=typeof String<"u"?String:void 0;var c3=typeof encodeURIComponent<"u"?encodeURIComponent:void 0;var kE=Symbol;var Wqe=Array.prototype.forEach,Kz=Array.prototype.indexOf,Qz=Array.prototype.join,Jz=Array.prototype.map,Zz=Array.prototype.filter,Yz=Array.prototype.push,Hqe=Array.prototype.pop,Bqe=Array.prototype.splice,Xz=Array.prototype.slice,zqe=Array.prototype.sort,jqe=Array.prototype.every;function ple(e){try{return e.indexOf}catch{return}}function lle(e){try{return e.join}catch{return}}function fle(e){try{return e.map}catch{return}}function dle(e){try{return e.filter}catch{return}}function hle(e){try{return e.push}catch{return}}function mle(e){try{return e.slice}catch{return}}function Yu(e,...t){return ple(e)===Kz?e.indexOf(...t):So(Kz,e,t)}function yn(e,...t){return lle(e)===Qz?e.join(...t):So(Qz,e,t)}function Er(e,t){return fle(e)===Jz?e.map(t):So(Jz,e,[t])}function u3(e,t){return dle(e)===Zz?e.filter(t):So(Zz,e,[t])}function St(e,...t){return hle(e)===Yz?e.push(...t):So(Yz,e,t)}function Xn(e,...t){return mle(e)===Xz?e.slice(...t):So(Xz,e,t)}var e3=Date.prototype.getTime,t3=Date.prototype.toISOString;function xle(e){try{return e.getTime}catch{return}}function gle(e){try{return e.toISOString}catch{return}}function TE(e){return xle(e)===e3?e.getTime():So(e3,e,[])}function p3(e){return gle(e)===t3?e.toISOString():So(t3,e,[])}var $qe=Set.prototype.add,Vqe=Set.prototype.has;var Gqe=WeakMap.prototype.set,Kqe=WeakMap.prototype.get;var r3=Map.prototype.set,n3=Map.prototype.get;function ble(e){try{return e.set}catch{return}}function yle(e){try{return e.get}catch{return}}function Ah(e,t,r){return ble(e)===r3?e.set(t,r):So(r3,e,[t,r])}function Zl(e,t){return yle(e)===n3?e.get(t):So(n3,e,[t])}var o3=String.prototype.split,Qqe=String.prototype.startsWith,Jqe=String.prototype.endsWith,Zqe=String.prototype.substring,Yqe=String.prototype.toLowerCase,Xqe=String.prototype.toUpperCase,eWe=String.prototype.padStart,s3=String.prototype.charCodeAt,tWe=String.prototype.normalize,rWe=String.prototype.replace;function Sle(e){try{return e.split}catch{return}}function Ele(e){try{return e.charCodeAt}catch{return}}function vi(e,...t){return Sle(e)===o3?e.split(...t):So(o3,e,t)}function Yl(e,t){return Ele(e)===s3?e.charCodeAt(t):So(s3,e,[t])}var i3=Number.prototype.toString;function Cle(e){try{return e.toString}catch{return}}function IE(e,...t){return Cle(e)===i3?e.toString(...t):So(i3,e,t)}var wle=Object.prototype.toString;function bR(e){return So(wle,e,[])}var yR=class{constructor(t){this.producer=t}[Symbol.iterator](){return this.it===void 0&&(this.it=this.producer()),this.it}next(){return this.it===void 0&&(this.it=this.producer()),this.it.next()}};function Xu(e){return new yR(e)}var Ole=Math.log;function RE(e){return 2+~~(Ole(e+1)*.4342944819032518)}var _le={};function bc(){return _le}var Xl=Symbol("UndefinedContextPlaceholder");function ef(e){return e.context!==void 0?e:e.hasToBeCloned?new Pe(e.value_,Xl,()=>e.value):new Pe(e.value_,Xl)}var AE=class e{constructor(t,r){this.arb=t,this.predicate=r;let{asyncBeforeEach:n,asyncAfterEach:o,beforeEach:s,afterEach:i}=bc()||{};if(n!==void 0&&s!==void 0)throw Mr(`Global "asyncBeforeEach" and "beforeEach" parameters can't be set at the same time when running async properties`);if(o!==void 0&&i!==void 0)throw Mr(`Global "asyncAfterEach" and "afterEach" parameters can't be set at the same time when running async properties`);this.beforeEachHook=n||s||e.dummyHook,this.afterEachHook=o||i||e.dummyHook}isAsync(){return!0}generate(t,r){let n=this.arb.generate(t,r!=null?RE(r):void 0);return ef(n)}shrink(t){if(t.context===void 0&&!this.arb.canShrinkWithoutContext(t.value_))return ot.nil();let r=t.context!==Xl?t.context:void 0;return this.arb.shrink(t.value_,r).map(ef)}async runBeforeEach(){await this.beforeEachHook()}async runAfterEach(){await this.afterEachHook()}async run(t,r){r||await this.beforeEachHook();try{let n=await this.predicate(t);return n==null||n===!0?null:{error:new Mr("Property failed by returning false"),errorMessage:"Error: Property failed by returning false"}}catch(n){return Hs.isFailure(n)?n:n instanceof Mr&&n.stack?{error:n,errorMessage:n.stack}:{error:n,errorMessage:Mi(n)}}finally{r||await this.afterEachHook()}}beforeEach(t){let r=this.beforeEachHook;return this.beforeEachHook=()=>t(r),this}afterEach(t){let r=this.afterEachHook;return this.afterEachHook=()=>t(r),this}};AE.dummyHook=()=>{};var Ng=class e{constructor(t,r){this.arb=t,this.predicate=r;let{beforeEach:n=e.dummyHook,afterEach:o=e.dummyHook,asyncBeforeEach:s,asyncAfterEach:i}=bc()||{};if(s!==void 0)throw Mr(`"asyncBeforeEach" can't be set when running synchronous properties`);if(i!==void 0)throw Mr(`"asyncAfterEach" can't be set when running synchronous properties`);this.beforeEachHook=n,this.afterEachHook=o}isAsync(){return!1}generate(t,r){let n=this.arb.generate(t,r!=null?RE(r):void 0);return ef(n)}shrink(t){if(t.context===void 0&&!this.arb.canShrinkWithoutContext(t.value_))return ot.nil();let r=t.context!==Xl?t.context:void 0;return this.arb.shrink(t.value_,r).map(ef)}runBeforeEach(){this.beforeEachHook()}runAfterEach(){this.afterEachHook()}run(t,r){r||this.beforeEachHook();try{let n=this.predicate(t);return n==null||n===!0?null:{error:new Mr("Property failed by returning false"),errorMessage:"Error: Property failed by returning false"}}catch(n){return Hs.isFailure(n)?n:n instanceof Mr&&n.stack?{error:n,errorMessage:n.stack}:{error:n,errorMessage:Mi(n)}}finally{r||this.afterEachHook()}}beforeEach(t){let r=this.beforeEachHook;return this.beforeEachHook=()=>t(r),this}afterEach(t){let r=this.afterEachHook;return this.afterEachHook=()=>t(r),this}};Ng.dummyHook=()=>{};var TR={};Yn(TR,{__commitHash:()=>Vle,__type:()=>jle,__version:()=>$le,congruential32:()=>d3,generateN:()=>l3,mersenne:()=>m3,skipN:()=>ER,uniformArrayIntDistribution:()=>C3,uniformBigIntDistribution:()=>w3,uniformIntDistribution:()=>_3,unsafeGenerateN:()=>SR,unsafeSkipN:()=>Dg,unsafeUniformArrayIntDistribution:()=>tf,unsafeUniformBigIntDistribution:()=>rf,unsafeUniformIntDistribution:()=>yc,xoroshiro128plus:()=>y3,xorshift128plus:()=>g3});function SR(e,t){for(var r=[],n=0;n!=t;++n)r.push(e.unsafeNext());return r}function l3(e,t){var r=e.clone(),n=SR(r,t);return[n,r]}function Dg(e,t){for(var r=0;r!=t;++r)e.unsafeNext()}function ER(e,t){var r=e.clone();return Dg(r,t),r}var Rle=214013,Ale=2531011,Mle=4294967295,vle=(1<<31)-1,CR=function(e){return e*Rle+Ale&Mle},wR=function(e){return(e&vle)>>16},f3=(function(){function e(t){this.seed=t}return e.prototype.clone=function(){return new e(this.seed)},e.prototype.next=function(){var t=new e(this.seed),r=t.unsafeNext();return[r,t]},e.prototype.unsafeNext=function(){var t=CR(this.seed),r=wR(t),n=CR(t),o=wR(n);this.seed=CR(n);var s=wR(this.seed),i=s+(o+(r<<15)<<15);return i|0},e.prototype.getState=function(){return[this.seed]},e})();function Ple(e){var t=e.length===1;if(!t)throw new Error("The state must have been produced by a congruential32 RandomGenerator");return new f3(e[0])}var d3=Object.assign(function(e){return new f3(e)},{fromState:Ple});var Fle=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,s=[],i;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(a){i={error:a}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(i)throw i.error}}return s},Nle=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,s;n<o;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))},h3=(function(){function e(t,r){this.states=t,this.index=r}return e.twist=function(t){for(var r=t.slice(),n=0;n!==e.N-e.M;++n){var o=(r[n]&e.MASK_UPPER)+(r[n+1]&e.MASK_LOWER);r[n]=r[n+e.M]^o>>>1^-(o&1)&e.A}for(var n=e.N-e.M;n!==e.N-1;++n){var s=(r[n]&e.MASK_UPPER)+(r[n+1]&e.MASK_LOWER);r[n]=r[n+e.M-e.N]^s>>>1^-(s&1)&e.A}var i=(r[e.N-1]&e.MASK_UPPER)+(r[0]&e.MASK_LOWER);return r[e.N-1]=r[e.M-1]^i>>>1^-(i&1)&e.A,r},e.seeded=function(t){var r=Array(e.N);r[0]=t;for(var n=1;n!==e.N;++n){var o=r[n-1]^r[n-1]>>>30;r[n]=Math.imul(e.F,o)+n|0}return r},e.from=function(t){return new e(e.twist(e.seeded(t)),0)},e.prototype.clone=function(){return new e(this.states,this.index)},e.prototype.next=function(){var t=new e(this.states,this.index),r=t.unsafeNext();return[r,t]},e.prototype.unsafeNext=function(){var t=this.states[this.index];return t^=this.states[this.index]>>>e.U,t^=t<<e.S&e.B,t^=t<<e.T&e.C,t^=t>>>e.L,++this.index>=e.N&&(this.states=e.twist(this.states),this.index=0),t},e.prototype.getState=function(){return Nle([this.index],Fle(this.states),!1)},e.fromState=function(t){var r=t.length===e.N+1&&t[0]>=0&&t[0]<e.N;if(!r)throw new Error("The state must have been produced by a mersenne RandomGenerator");return new e(t.slice(1),t[0])},e.N=624,e.M=397,e.R=31,e.A=2567483615,e.F=1812433253,e.U=11,e.S=7,e.B=2636928640,e.T=15,e.C=4022730752,e.L=18,e.MASK_LOWER=Math.pow(2,e.R)-1,e.MASK_UPPER=Math.pow(2,e.R),e})();function Dle(e){return h3.fromState(e)}var m3=Object.assign(function(e){return h3.from(e)},{fromState:Dle});var x3=(function(){function e(t,r,n,o){this.s01=t,this.s00=r,this.s11=n,this.s10=o}return e.prototype.clone=function(){return new e(this.s01,this.s00,this.s11,this.s10)},e.prototype.next=function(){var t=new e(this.s01,this.s00,this.s11,this.s10),r=t.unsafeNext();return[r,t]},e.prototype.unsafeNext=function(){var t=this.s00^this.s00<<23,r=this.s01^(this.s01<<23|this.s00>>>9),n=t^this.s10^(t>>>18|r<<14)^(this.s10>>>5|this.s11<<27),o=r^this.s11^r>>>18^this.s11>>>5,s=this.s00+this.s10|0;return this.s01=this.s11,this.s00=this.s10,this.s11=o,this.s10=n,s},e.prototype.jump=function(){var t=new e(this.s01,this.s00,this.s11,this.s10);return t.unsafeJump(),t},e.prototype.unsafeJump=function(){for(var t=0,r=0,n=0,o=0,s=[1667051007,2321340297,1548169110,304075285],i=0;i!==4;++i)for(var a=1;a;a<<=1)s[i]&a&&(t^=this.s01,r^=this.s00,n^=this.s11,o^=this.s10),this.unsafeNext();this.s01=t,this.s00=r,this.s11=n,this.s10=o},e.prototype.getState=function(){return[this.s01,this.s00,this.s11,this.s10]},e})();function Lle(e){var t=e.length===4;if(!t)throw new Error("The state must have been produced by a xorshift128plus RandomGenerator");return new x3(e[0],e[1],e[2],e[3])}var g3=Object.assign(function(e){return new x3(-1,~e,e|0,0)},{fromState:Lle});var b3=(function(){function e(t,r,n,o){this.s01=t,this.s00=r,this.s11=n,this.s10=o}return e.prototype.clone=function(){return new e(this.s01,this.s00,this.s11,this.s10)},e.prototype.next=function(){var t=new e(this.s01,this.s00,this.s11,this.s10),r=t.unsafeNext();return[r,t]},e.prototype.unsafeNext=function(){var t=this.s00+this.s10|0,r=this.s10^this.s00,n=this.s11^this.s01,o=this.s00,s=this.s01;return this.s00=o<<24^s>>>8^r^r<<16,this.s01=s<<24^o>>>8^n^(n<<16|r>>>16),this.s10=n<<5^r>>>27,this.s11=r<<5^n>>>27,t},e.prototype.jump=function(){var t=new e(this.s01,this.s00,this.s11,this.s10);return t.unsafeJump(),t},e.prototype.unsafeJump=function(){for(var t=0,r=0,n=0,o=0,s=[3639956645,3750757012,1261568508,386426335],i=0;i!==4;++i)for(var a=1;a;a<<=1)s[i]&a&&(t^=this.s01,r^=this.s00,n^=this.s11,o^=this.s10),this.unsafeNext();this.s01=t,this.s00=r,this.s11=n,this.s10=o},e.prototype.getState=function(){return[this.s01,this.s00,this.s11,this.s10]},e})();function Ule(e){var t=e.length===4;if(!t)throw new Error("The state must have been produced by a xoroshiro128plus RandomGenerator");return new b3(e[0],e[1],e[2],e[3])}var y3=Object.assign(function(e){return new b3(-1,~e,e|0,0)},{fromState:Ule});function OR(e,t){if(e.sign!==t.sign)return ME(e,{sign:-t.sign,data:t.data});for(var r=[],n=0,o=e.data,s=t.data,i=o.length-1,a=s.length-1;i>=0||a>=0;--i,--a){var c=i>=0?o[i]:0,l=a>=0?s[a]:0,f=c+l+n;r.push(f>>>0),n=~~(f/4294967296)}return n!==0&&r.push(n),{sign:e.sign,data:r.reverse()}}function S3(e){e.sign=1;for(var t=e.data,r=t.length-1;r>=0;--r)if(t[r]===4294967295)t[r]=0;else return t[r]+=1,e;return t.unshift(1),e}function qle(e,t){for(var r=Math.max(e.length,t.length),n=0;n<r;++n){var o=n+e.length-r,s=n+t.length-r,i=o>=0?e[o]:0,a=s>=0?t[s]:0;if(i<a)return!0;if(i>a)return!1}return!1}function ME(e,t){if(e.sign!==t.sign)return OR(e,{sign:-t.sign,data:t.data});var r=e.data,n=t.data;if(qle(r,n)){var o=ME(t,e);return o.sign=-o.sign,o}for(var s=[],i=0,a=r.length-1,c=n.length-1;a>=0||c>=0;--a,--c){var l=a>=0?r[a]:0,f=c>=0?n[c]:0,d=l-f-i;s.push(d>>>0),i=d<0?1:0}return{sign:e.sign,data:s.reverse()}}function _R(e){for(var t=e.data,r=0;r!==t.length&&t[r]===0;++r);return r===t.length?(e.sign=1,e.data=[0],e):(t.splice(0,r),e)}function vE(e,t){if(t<0){var r=-t;e.sign=-1,e.data[0]=~~(r/4294967296),e.data[1]=r>>>0}else e.sign=1,e.data[0]=~~(t/4294967296),e.data[1]=t>>>0;return e}function E3(e,t,r){var n=t.data[1],o=t.data[0],s=t.sign,i=r.data[1],a=r.data[0],c=r.sign;if(e.sign=1,s===1&&c===-1){var l=n+i,f=o+a+(l>4294967295?1:0);return e.data[0]=f>>>0,e.data[1]=l>>>0,e}var d=n,h=o,m=i,y=a;s===-1&&(d=i,h=a,m=n,y=o);var T=0,C=d-m;return C<0&&(T=1,C=C>>>0),e.data[0]=h-y-T,e.data[1]=C,e}function PE(e,t){for(var r=e>2?~~(4294967296/e)*e:4294967296,n=t.unsafeNext()+2147483648;n>=r;)n=t.unsafeNext()+2147483648;return n%e}function FE(e,t,r){for(var n=t.length;;){for(var o=0;o!==n;++o){var s=o===0?t[0]+1:4294967296,i=PE(s,r);e[o]=i}for(var o=0;o!==n;++o){var a=e[o],c=t[o];if(a<c)return e;if(a>c)break}}}function tf(e,t,r){var n=_R(S3(ME(t,e))),o=n.data.slice(0),s=FE(o,n.data,r);return _R(OR({sign:1,data:s},e))}function C3(e,t,r){if(r!=null){var n=r.clone();return[tf(e,t,n),n]}return function(o){var s=o.clone();return[tf(e,t,s),s]}}var Lg=typeof BigInt<"u"?BigInt:void 0;function rf(e,t,r){for(var n=t-e+Lg(1),o=Lg(-2147483648),s=Lg(4294967296),i=s,a=1;i<n;)i*=s,++a;for(var c=i-i%n;;){for(var l=Lg(0),f=0;f!==a;++f){var d=r.unsafeNext();l=s*l+(Lg(d)-o)}if(l<c){var h=l%n;return h+e}}}function w3(e,t,r){if(r!=null){var n=r.clone();return[rf(e,t,n),n]}return function(o){var s=o.clone();return[rf(e,t,s),s]}}var Wle=Number.MAX_SAFE_INTEGER,Hle={sign:1,data:[0,0]},Ble={sign:1,data:[0,0]},O3={sign:1,data:[0,0]},kR=[0,0];function zle(e,t,r,n){var o=r<=Wle?vE(O3,r):E3(O3,vE(Hle,t),vE(Ble,e));return o.data[1]===4294967295?(o.data[0]+=1,o.data[1]=0):o.data[1]+=1,FE(kR,o.data,n),kR[0]*4294967296+kR[1]+e}function yc(e,t,r){var n=t-e;if(n<=4294967295){var o=PE(n+1,r);return o+e}return zle(e,t,n,r)}function _3(e,t,r){if(r!=null){var n=r.clone();return[yc(e,t,n),n]}return function(o){var s=o.clone();return[yc(e,t,s),s]}}var jle="module",$le="6.1.0",Vle="a413dd2b721516be2ef29adffb515c5ae67bfbad";var Mh=TR;var eo;(function(e){e[e.None=0]="None",e[e.Verbose=1]="Verbose",e[e.VeryVerbose=2]="VeryVerbose"})(eo||(eo={}));var Gle=Date.now,Kle=Math.min,Qle=Math.random,Eo=class e{constructor(t){let r=t||{};this.seed=e.readSeed(r),this.randomType=e.readRandomType(r),this.numRuns=e.readNumRuns(r),this.verbose=e.readVerbose(r),this.maxSkipsPerRun=e.readOrDefault(r,"maxSkipsPerRun",100),this.timeout=e.safeTimeout(e.readOrDefault(r,"timeout",null)),this.skipAllAfterTimeLimit=e.safeTimeout(e.readOrDefault(r,"skipAllAfterTimeLimit",null)),this.interruptAfterTimeLimit=e.safeTimeout(e.readOrDefault(r,"interruptAfterTimeLimit",null)),this.markInterruptAsFailure=e.readBoolean(r,"markInterruptAsFailure"),this.skipEqualValues=e.readBoolean(r,"skipEqualValues"),this.ignoreEqualValues=e.readBoolean(r,"ignoreEqualValues"),this.logger=e.readOrDefault(r,"logger",n=>{console.log(n)}),this.path=e.readOrDefault(r,"path",""),this.unbiased=e.readBoolean(r,"unbiased"),this.examples=e.readOrDefault(r,"examples",[]),this.endOnFailure=e.readBoolean(r,"endOnFailure"),this.reporter=e.readOrDefault(r,"reporter",null),this.asyncReporter=e.readOrDefault(r,"asyncReporter",null),this.errorWithCause=e.readBoolean(r,"errorWithCause")}toParameters(){let t=n=>n!==null?n:void 0;return{seed:this.seed,randomType:this.randomType,numRuns:this.numRuns,maxSkipsPerRun:this.maxSkipsPerRun,timeout:t(this.timeout),skipAllAfterTimeLimit:t(this.skipAllAfterTimeLimit),interruptAfterTimeLimit:t(this.interruptAfterTimeLimit),markInterruptAsFailure:this.markInterruptAsFailure,skipEqualValues:this.skipEqualValues,ignoreEqualValues:this.ignoreEqualValues,path:this.path,logger:this.logger,unbiased:this.unbiased,verbose:this.verbose,examples:this.examples,endOnFailure:this.endOnFailure,reporter:t(this.reporter),asyncReporter:t(this.asyncReporter),errorWithCause:this.errorWithCause}}static read(t){return new e(t)}};Eo.createQualifiedRandomGenerator=e=>t=>{let r=e(t);return r.unsafeJump===void 0&&(r.unsafeJump=()=>Dg(r,42)),r};Eo.readSeed=e=>{if(e.seed==null)return Gle()^Qle()*4294967296;let t=e.seed|0;if(e.seed===t)return t;let r=e.seed-t;return t^r*4294967296};Eo.readRandomType=e=>{if(e.randomType==null)return Mh.xorshift128plus;if(typeof e.randomType=="string")switch(e.randomType){case"mersenne":return Eo.createQualifiedRandomGenerator(Mh.mersenne);case"congruential":case"congruential32":return Eo.createQualifiedRandomGenerator(Mh.congruential32);case"xorshift128plus":return Mh.xorshift128plus;case"xoroshiro128plus":return Mh.xoroshiro128plus;default:throw new Error(`Invalid random specified: '${e.randomType}'`)}let t=e.randomType(0);if("min"in t&&t.min!==-2147483648)throw new Error(`Invalid random number generator: min must equal -0x80000000, got ${String(t.min)}`);if("max"in t&&t.max!==2147483647)throw new Error(`Invalid random number generator: max must equal 0x7fffffff, got ${String(t.max)}`);return"unsafeJump"in t?e.randomType:Eo.createQualifiedRandomGenerator(e.randomType)};Eo.readNumRuns=e=>e.numRuns!=null?e.numRuns:e.num_runs!=null?e.num_runs:100;Eo.readVerbose=e=>e.verbose==null?eo.None:typeof e.verbose=="boolean"?e.verbose===!0?eo.Verbose:eo.None:e.verbose<=eo.None?eo.None:e.verbose>=eo.VeryVerbose?eo.VeryVerbose:e.verbose|0;Eo.readBoolean=(e,t)=>e[t]===!0;Eo.readOrDefault=(e,t,r)=>{let n=e[t];return n??r};Eo.safeTimeout=e=>e===null?null:Kle(e,2147483647);var k3=Array.from,T3=typeof Buffer<"u"?Buffer.isBuffer:void 0,vh=JSON.stringify,I3=Number.isNaN,Jle=Object.keys,Zle=Object.getOwnPropertySymbols,Yle=Object.getOwnPropertyDescriptor,R3=Object.getPrototypeOf,A3=Number.NEGATIVE_INFINITY,Xle=Number.POSITIVE_INFINITY,ep=Symbol.for("fast-check/toStringMethod");function IR(e){return e!==null&&(typeof e=="object"||typeof e=="function")&&ep in e&&typeof e[ep]=="function"}var Ph=Symbol.for("fast-check/asyncToStringMethod");function RR(e){return e!==null&&(typeof e=="object"||typeof e=="function")&&Ph in e&&typeof e[Ph]=="function"}var efe=/^Symbol\((.*)\)$/;function tfe(e){if(e.description!==void 0)return e.description;let t=efe.exec(Mi(e));return t&&t[1].length?t[1]:null}function M3(e){switch(e){case 0:return 1/e===A3?"-0":"0";case A3:return"Number.NEGATIVE_INFINITY";case Xle:return"Number.POSITIVE_INFINITY";default:return e===e?Mi(e):"Number.NaN"}}function rfe(e){let t=-1;for(let r in e){let n=Number(r);if(n!==t+1)return!0;t=n}return t+1!==e.length}function Bs(e,t,r){let n=[...t,e];if(typeof e=="object"&&Yu(t,e)!==-1)return"[cyclic]";if(RR(e)){let o=r(e);if(o.state==="fulfilled")return o.value}if(IR(e))try{return e[ep]()}catch{}switch(bR(e)){case"[object Array]":{let o=e;if(o.length>=50&&rfe(o)){let i=[];for(let a in o)I3(Number(a))||St(i,`${a}:${Bs(o[a],n,r)}`);return i.length!==0?`Object.assign(Array(${o.length}),{${yn(i,",")}})`:`Array(${o.length})`}let s=yn(Er(o,i=>Bs(i,n,r)),",");return o.length===0||o.length-1 in o?`[${s}]`:`[${s},]`}case"[object BigInt]":return`${e}n`;case"[object Boolean]":{let o=e==!0?"true":"false";return typeof e=="boolean"?o:`new Boolean(${o})`}case"[object Date]":{let o=e;return I3(TE(o))?"new Date(NaN)":`new Date(${vh(p3(o))})`}case"[object Map]":return`new Map(${Bs(Array.from(e),n,r)})`;case"[object Null]":return"null";case"[object Number]":return typeof e=="number"?M3(e):`new Number(${M3(Number(e))})`;case"[object Object]":{try{let a=e.toString;if(typeof a=="function"&&a!==Object.prototype.toString)return e.toString()}catch{return"[object Object]"}let o=a=>`${a==="__proto__"?'["__proto__"]':typeof a=="symbol"?`[${Bs(a,n,r)}]`:vh(a)}:${Bs(e[a],n,r)}`,s=[...Er(Jle(e),o),...Er(u3(Zle(e),a=>{let c=Yle(e,a);return c&&c.enumerable}),o)],i="{"+yn(s,",")+"}";return R3(e)===null?i==="{}"?"Object.create(null)":`Object.assign(Object.create(null),${i})`:i}case"[object Set]":return`new Set(${Bs(Array.from(e),n,r)})`;case"[object String]":return typeof e=="string"?vh(e):`new String(${vh(e)})`;case"[object Symbol]":{let o=e;if(kE.keyFor(o)!==void 0)return`Symbol.for(${vh(kE.keyFor(o))})`;let s=tfe(o);if(s===null)return"Symbol()";let i=s.startsWith("Symbol.")&&kE[s.substring(7)];return o===i?s:`Symbol(${vh(s)})`}case"[object Promise]":{let o=r(e);switch(o.state){case"fulfilled":return`Promise.resolve(${Bs(o.value,n,r)})`;case"rejected":return`Promise.reject(${Bs(o.value,n,r)})`;case"pending":return"new Promise(() => {/*pending*/})";case"unknown":default:return"new Promise(() => {/*unknown*/})"}}case"[object Error]":if(e instanceof Error)return`new Error(${Bs(e.message,n,r)})`;break;case"[object Undefined]":return"undefined";case"[object Int8Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Int16Array]":case"[object Uint16Array]":case"[object Int32Array]":case"[object Uint32Array]":case"[object Float32Array]":case"[object Float64Array]":case"[object BigInt64Array]":case"[object BigUint64Array]":{if(typeof T3=="function"&&T3(e))return`Buffer.from(${Bs(k3(e.values()),n,r)})`;let o=R3(e),s=o&&o.constructor&&o.constructor.name;if(typeof s=="string"){let a=e.values();return`${s}.from(${Bs(k3(a),n,r)})`}break}}try{return e.toString()}catch{return bR(e)}}function hs(e){return Bs(e,[],()=>({state:"unknown",value:void 0}))}var YHe=Date.now;var Sc;(function(e){e[e.Success=0]="Success",e[e.Skipped=-1]="Skipped",e[e.Failure=1]="Failure"})(Sc||(Sc={}));var DE=class e{constructor(t,r){this.verbosity=t,this.interruptedAsFailure=r,this.isSuccess=()=>this.pathToFailure==null,this.firstFailure=()=>this.pathToFailure?+vi(this.pathToFailure,":")[0]:-1,this.numShrinks=()=>this.pathToFailure?vi(this.pathToFailure,":").length-1:0,this.rootExecutionTrees=[],this.currentLevelExecutionTrees=this.rootExecutionTrees,this.failure=null,this.numSkips=0,this.numSuccesses=0,this.interrupted=!1}appendExecutionTree(t,r){let n={status:t,value:r,children:[]};return this.currentLevelExecutionTrees.push(n),n}fail(t,r,n){if(this.verbosity>=eo.Verbose){let o=this.appendExecutionTree(Sc.Failure,t);this.currentLevelExecutionTrees=o.children}this.pathToFailure==null?this.pathToFailure=`${r}`:this.pathToFailure+=`:${r}`,this.value=t,this.failure=n}skip(t){this.verbosity>=eo.VeryVerbose&&this.appendExecutionTree(Sc.Skipped,t),this.pathToFailure==null&&++this.numSkips}success(t){this.verbosity>=eo.VeryVerbose&&this.appendExecutionTree(Sc.Success,t),this.pathToFailure==null&&++this.numSuccesses}interrupt(){this.interrupted=!0}extractFailures(){if(this.isSuccess())return[];let t=[],r=this.rootExecutionTrees;for(;r.length>0&&r[r.length-1].status===Sc.Failure;){let n=r[r.length-1];t.push(n.value),r=n.children}return t}toRunDetails(t,r,n,o){if(!this.isSuccess())return{failed:!0,interrupted:this.interrupted,numRuns:this.firstFailure()+1-this.numSkips,numSkips:this.numSkips,numShrinks:this.numShrinks(),seed:t,counterexample:this.value,counterexamplePath:e.mergePaths(r,this.pathToFailure),error:this.failure.errorMessage,errorInstance:this.failure.error,failures:this.extractFailures(),executionSummary:this.rootExecutionTrees,verbose:this.verbosity,runConfiguration:o.toParameters()};let s=this.interruptedAsFailure||this.numSuccesses===0;return{failed:this.numSkips>n||this.interrupted&&s,interrupted:this.interrupted,numRuns:this.numSuccesses,numSkips:this.numSkips,numShrinks:0,seed:t,counterexample:null,counterexamplePath:null,error:null,errorInstance:null,failures:[],executionSummary:this.rootExecutionTrees,verbose:this.verbosity,runConfiguration:o.toParameters()}}};DE.mergePaths=(e,t)=>{if(e.length===0)return t;let r=e.split(":"),n=t.split(":"),o=+r[r.length-1]+ +n[0];return[...r.slice(0,r.length-1),`${o}`,...n.slice(1)].join(":")};var tp=class e{constructor(t){this.internalRng=t.clone()}clone(){return new e(this.internalRng)}next(t){return yc(0,(1<<t)-1,this.internalRng)}nextBoolean(){return yc(0,1,this.internalRng)==1}nextInt(t,r){return yc(t??e.MIN_INT,r??e.MAX_INT,this.internalRng)}nextBigInt(t,r){return rf(t,r,this.internalRng)}nextArrayInt(t,r){return tf(t,r,this.internalRng)}nextDouble(){let t=this.next(26),r=this.next(27);return(t*e.DBL_FACTOR+r)*e.DBL_DIVISOR}getState(){if("getState"in this.internalRng&&typeof this.internalRng.getState=="function")return this.internalRng.getState()}};tp.MIN_INT=-2147483648;tp.MAX_INT=2147483647;tp.DBL_FACTOR=Math.pow(2,27);tp.DBL_DIVISOR=Math.pow(2,-53);var afe=Math.floor,v3=Math.log;function P3(e){return afe(v3(e)/v3(2))}function AR(e,t,r){if(e===t)return[{min:e,max:t}];if(e<0&&t>0){let i=r(-e),a=r(t);return[{min:-i,max:a},{min:t-a,max:t},{min:e,max:e+i}]}let n=r(t-e),o={min:e,max:e+n},s={min:t-n,max:t};return e<0?[s,o]:[o,s]}var cfe=Math.ceil,ufe=Math.floor;function F3(e){return ufe(e/2)}function N3(e){return cfe(e/2)}function MR(e,t,r){let n=e-t;function*o(){let i=r?void 0:t,a=r?n:F3(n);for(let c=a;c>0;c=F3(c)){let l=c===n?t:e-c;yield new Pe(l,i),i=l}}function*s(){let i=r?void 0:t,a=r?n:N3(n);for(let c=a;c<0;c=N3(c)){let l=c===n?t:e-c;yield new Pe(l,i),i=l}}return n>0?Zu(o()):Zu(s())}var D3=Math.sign,pfe=Number.isInteger,lfe=Object.is,rp=class e extends Tt{constructor(t,r){super(),this.min=t,this.max=r}generate(t,r){let n=this.computeGenerateRange(t,r);return new Pe(t.nextInt(n.min,n.max),void 0)}canShrinkWithoutContext(t){return typeof t=="number"&&pfe(t)&&!lfe(t,-0)&&this.min<=t&&t<=this.max}shrink(t,r){if(!e.isValidContext(t,r)){let n=this.defaultTarget();return MR(t,n,!0)}return this.isLastChanceTry(t,r)?ot.of(new Pe(r,void 0)):MR(t,r,!1)}defaultTarget(){return this.min<=0&&this.max>=0?0:this.min<0?this.max:this.min}computeGenerateRange(t,r){if(r===void 0||t.nextInt(1,r)!==1)return{min:this.min,max:this.max};let n=AR(this.min,this.max,P3);if(n.length===1)return n[0];let o=t.nextInt(-2*(n.length-1),n.length-2);return o<0?n[0]:n[o+1]}isLastChanceTry(t,r){return t>0?t===r+1&&t>this.min:t<0?t===r-1&&t<this.max:!1}static isValidContext(t,r){if(r===void 0)return!1;if(typeof r!="number")throw new Error("Invalid context type passed to IntegerArbitrary (#1)");if(r!==0&&D3(t)!==D3(r))throw new Error("Invalid context value passed to IntegerArbitrary (#2)");return!0}};var L3=Number.isInteger;function ffe(e){let t=e.min!==void 0?e.min:-2147483648,r=e.max!==void 0?e.max:2147483647;return{min:t,max:r}}function vr(e={}){let t=ffe(e);if(t.min>t.max)throw new Error("fc.integer maximum value should be equal or greater than the minimum one");if(!L3(t.min))throw new Error("fc.integer minimum value should be an integer");if(!L3(t.max))throw new Error("fc.integer maximum value should be an integer");return new rp(t.min,t.max)}var U3=new Map;function LE(e){if(e===void 0)return{depth:0};if(typeof e!="string")return e;let t=Zl(U3,e);if(t!==void 0)return t;let r={depth:0};return Ah(U3,e,r),r}var UE=class{constructor(t,r,n){this.arb=t,this.mrng=r,this.biasFactor=n}attemptExact(){}next(){return this.arb.generate(this.mrng,this.biasFactor)}};var dfe=Math.min,hfe=Math.max,qE=class{constructor(t,r,n,o){this.arb=t,this.mrng=r,this.slices=n,this.biasFactor=o,this.activeSliceIndex=0,this.nextIndexInSlice=0,this.lastIndexInSlice=-1}attemptExact(t){if(t!==0&&this.mrng.nextInt(1,this.biasFactor)===1){let r=[];for(let n=0;n!==this.slices.length;++n)this.slices[n].length===t&&St(r,n);if(r.length===0)return;this.activeSliceIndex=r[this.mrng.nextInt(0,r.length-1)],this.nextIndexInSlice=0,this.lastIndexInSlice=t-1}}next(){if(this.nextIndexInSlice<=this.lastIndexInSlice)return new Pe(this.slices[this.activeSliceIndex][this.nextIndexInSlice++],void 0);if(this.mrng.nextInt(1,this.biasFactor)!==1)return this.arb.generate(this.mrng,this.biasFactor);this.activeSliceIndex=this.mrng.nextInt(0,this.slices.length-1);let t=this.slices[this.activeSliceIndex];if(this.mrng.nextInt(1,this.biasFactor)!==1)return this.nextIndexInSlice=1,this.lastIndexInSlice=t.length-1,new Pe(t[0],void 0);let r=this.mrng.nextInt(0,t.length-1),n=this.mrng.nextInt(0,t.length-1);return this.nextIndexInSlice=dfe(r,n),this.lastIndexInSlice=hfe(r,n),new Pe(t[this.nextIndexInSlice++],void 0)}};function vR(e,t,r,n){return n===void 0||r.length===0||t.nextInt(1,n)!==1?new UE(e,t,n):new qE(e,t,r,n)}var mfe=Math.floor,q3=Math.log,W3=Math.max,xfe=Array.isArray;function PR(e,t){return e===t?e:e+mfe(q3(t-e)/q3(2))}var Ug=class e extends Tt{constructor(t,r,n,o,s,i,a){super(),this.arb=t,this.minLength=r,this.maxGeneratedLength=n,this.maxLength=o,this.setBuilder=i,this.customSlices=a,this.lengthArb=vr({min:r,max:n}),this.depthContext=LE(s)}preFilter(t){if(this.setBuilder===void 0)return t;let r=this.setBuilder();for(let n=0;n!==t.length;++n)r.tryAdd(t[n]);return r.getData()}static makeItCloneable(t,r){return t[Sr]=()=>{let n=[];for(let o=0;o!==r.length;++o)St(n,r[o].value);return this.makeItCloneable(n,r),n},t}generateNItemsNoDuplicates(t,r,n,o){let s=0,i=t(),a=vR(this.arb,n,this.customSlices,o);for(;i.size()<r&&s<this.maxGeneratedLength;){let c=a.next();i.tryAdd(c)?s=0:s+=1}return i.getData()}safeGenerateNItemsNoDuplicates(t,r,n,o){let s=W3(0,r-PR(this.minLength,this.maxGeneratedLength));this.depthContext.depth+=s;try{return this.generateNItemsNoDuplicates(t,r,n,o)}finally{this.depthContext.depth-=s}}generateNItems(t,r,n){let o=[],s=vR(this.arb,r,this.customSlices,n);s.attemptExact(t);for(let i=0;i!==t;++i){let a=s.next();St(o,a)}return o}safeGenerateNItems(t,r,n){let o=W3(0,t-PR(this.minLength,this.maxGeneratedLength));this.depthContext.depth+=o;try{return this.generateNItems(t,r,n)}finally{this.depthContext.depth-=o}}wrapper(t,r,n,o){let s=r?this.preFilter(t):t,i=!1,a=[],c=[];for(let f=0;f!==s.length;++f){let d=s[f];i=i||d.hasToBeCloned,St(a,d.value),St(c,d.context)}i&&e.makeItCloneable(a,s);let l={shrunkOnce:r,lengthContext:t.length===s.length&&n!==void 0?n:void 0,itemsContexts:c,startIndex:o};return new Pe(a,l)}generate(t,r){let n=this.applyBias(t,r),o=n.size,s=this.setBuilder!==void 0?this.safeGenerateNItemsNoDuplicates(this.setBuilder,o,t,n.biasFactorItems):this.safeGenerateNItems(o,t,n.biasFactorItems);return this.wrapper(s,!1,void 0,0)}applyBias(t,r){if(r===void 0)return{size:this.lengthArb.generate(t,void 0).value};if(this.minLength===this.maxGeneratedLength)return{size:this.lengthArb.generate(t,void 0).value,biasFactorItems:r};if(t.nextInt(1,r)!==1)return{size:this.lengthArb.generate(t,void 0).value};if(t.nextInt(1,r)!==1||this.minLength===this.maxGeneratedLength)return{size:this.lengthArb.generate(t,void 0).value,biasFactorItems:r};let n=PR(this.minLength,this.maxGeneratedLength);return{size:vr({min:this.minLength,max:n}).generate(t,void 0).value,biasFactorItems:r}}canShrinkWithoutContext(t){if(!xfe(t)||this.minLength>t.length||t.length>this.maxLength)return!1;for(let n=0;n!==t.length;++n)if(!(n in t)||!this.arb.canShrinkWithoutContext(t[n]))return!1;return this.preFilter(Er(t,n=>new Pe(n,void 0))).length===t.length}shrinkItemByItem(t,r,n){let o=[];for(let s=r.startIndex;s<n;++s)St(o,Xu(()=>this.arb.shrink(t[s],r.itemsContexts[s]).map(i=>{let a=Er(Xn(t,0,s),(l,f)=>new Pe(Jl(l),r.itemsContexts[f])),c=Er(Xn(t,s+1),(l,f)=>new Pe(Jl(l),r.itemsContexts[f+s+1]));return[[...a,i,...c],void 0,s]})));return ot.nil().join(...o)}shrinkImpl(t,r){if(t.length===0)return ot.nil();let n=r!==void 0?r:{shrunkOnce:!1,lengthContext:void 0,itemsContexts:[],startIndex:0};return this.lengthArb.shrink(t.length,n.lengthContext).drop(n.shrunkOnce&&n.lengthContext===void 0&&t.length>this.minLength+1?1:0).map(o=>{let s=t.length-o.value;return[Er(Xn(t,s),(i,a)=>new Pe(Jl(i),n.itemsContexts[a+s])),o.context,0]}).join(Xu(()=>t.length>this.minLength?this.shrinkItemByItem(t,n,1):this.shrinkItemByItem(t,n,t.length))).join(t.length>this.minLength?Xu(()=>{let o={shrunkOnce:!1,lengthContext:void 0,itemsContexts:Xn(n.itemsContexts,1),startIndex:0};return this.shrinkImpl(Xn(t,1),o).filter(s=>this.minLength<=s[0].length+1).map(s=>[[new Pe(Jl(t[0]),n.itemsContexts[0]),...s[0]],void 0,0])}):ot.nil())}shrink(t,r){return this.shrinkImpl(t,r).map(n=>this.wrapper(n[0],!0,n[1],n[2]))}};var gfe=Math.floor,bfe=Math.min,np=2147483647,Fh=["xsmall","small","medium","large","xlarge"],yfe=["-4","-3","-2","-1","=","+1","+2","+3","+4"],Sfe="small";function Efe(e,t){switch(t){case"xsmall":return gfe(1.1*e)+1;case"small":return 2*e+10;case"medium":return 11*e+100;case"large":return 101*e+1e3;case"xlarge":return 1001*e+1e4;default:throw new Error(`Unable to compute lengths based on received size: ${t}`)}}function FR(e,t){let r=Yu(yfe,e);if(r===-1)return e;let n=Yu(Fh,t);if(n===-1)throw new Error(`Unable to offset size based on the unknown defaulted one: ${t}`);let o=n+r-4;return o<0?Fh[0]:o>=Fh.length?Fh[Fh.length-1]:Fh[o]}function qg(e,t,r,n){let{baseSize:o=Sfe,defaultSizeToMaxWhenMaxSpecified:s}=bc()||{},i=e!==void 0?e:n&&s?"max":o;if(i==="max")return r;let a=FR(i,o);return bfe(Efe(t,a),r)}function Ur(e,t={}){let r=t.size,n=t.minLength||0,o=t.maxLength,s=t.depthIdentifier,i=o!==void 0?o:np,c=qg(r,n,i,o!==void 0),l=t.experimentalCustomSlices||[];return new Ug(e,n,c,i,s,void 0,l)}var H3=String.fromCodePoint;function B3(e){if(typeof e!="string")throw new Error("Cannot unmap non-string");if(e.length===0||e.length>2)throw new Error("Cannot unmap string with more or less than one character");let t=Yl(e,0);if(e.length===1)return t;let r=Yl(e,1);if(t<55296||t>56319||r<56320||r>57343)throw new Error("Cannot unmap invalid surrogate pairs");return e.codePointAt(0)}function Ec(e,t,r,n){return vr({min:e,max:t}).map(o=>H3(r(o)),o=>n(B3(o)))}function Wg(e){return e<95?e+32:e<=126?e-95:e}function Hg(e){return e>=32&&e<=126?e-32:e>=0&&e<=31?e+95:e}function z3(e){return e}function LR(){return Ec(32,126,z3,z3)}var UR=2048;function Ofe(e){return e<55296?Wg(e):e+UR}function _fe(e){return e<55296?Hg(e):e<=57343?-1:e-UR}function HE(){return Ec(0,1114111-UR,Ofe,_fe)}var j3=class e{constructor(){this.receivedLogs=[]}log(t){this.receivedLogs.push(t)}size(){return this.receivedLogs.length}toString(){return JSON.stringify({logs:this.receivedLogs})}[Sr](){return new e}};var x6e=Number.NaN,g6e=Number.isNaN;var k6e=Number.isNaN;var W6e=Number.isNaN;var Sje=Number.POSITIVE_INFINITY,Eje=Number.MAX_SAFE_INTEGER,Cje=Number.isInteger;var Aje=Number.isInteger;var jje=String.fromCharCode;function Rfe(e){let t=c3(e);return e!==t?t:`%${IE(Yl(e,0),16)}`}function Afe(e){if(typeof e!="string")throw new Error("Unsupported");return decodeURIComponent(e)}var $je=HE().map(Rfe,Afe);var d4e=String.fromCodePoint;var U4e=Symbol("adapted-value");var y5e=Number.NEGATIVE_INFINITY,S5e=Number.POSITIVE_INFINITY,E5e=Number.EPSILON;var Z3=new Float64Array(1),C5e=new Uint32Array(Z3.buffer,Z3.byteOffset);var O5e=Number.isInteger;var _5e=Number.NEGATIVE_INFINITY,k5e=Number.POSITIVE_INFINITY;var R5e=Number.NEGATIVE_INFINITY,A5e=Number.POSITIVE_INFINITY,M5e=Number.MAX_VALUE;var z5e=Number.isInteger,j5e=Number.isNaN,$5e=Number.NEGATIVE_INFINITY,V5e=Number.POSITIVE_INFINITY,G5e=Number.MAX_VALUE,K5e=Number.NaN;var J5e=Number.NEGATIVE_INFINITY,Z5e=Number.POSITIVE_INFINITY,Y5e=2**-126*2**-23,X3=2**127*(1+(2**23-1)/2**23),X5e=2**-23;var Y3=new Float32Array(1),e$e=new Uint32Array(Y3.buffer,Y3.byteOffset);var o$e=Number.NEGATIVE_INFINITY,s$e=Number.POSITIVE_INFINITY;var m$e=Number.isInteger,x$e=Number.isNaN;var g$e=Number.NEGATIVE_INFINITY,b$e=Number.POSITIVE_INFINITY,y$e=Number.NaN;function e6(e){return e.replace(/([$`\\])/g,"\\$1").replace(/\r/g,"\\r")}var Q$e=Number.MIN_SAFE_INTEGER,J$e=Number.MAX_SAFE_INTEGER;var X$e=Number.MAX_SAFE_INTEGER;var r8e=Number.parseInt;var z9e=a3.isArray;var A7e=Symbol("no-key");var _de={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F",16:"G",17:"H",18:"J",19:"K",20:"M",21:"N",22:"P",23:"Q",24:"R",25:"S",26:"T",27:"V",28:"W",29:"X",30:"Y",31:"Z"};function kde(e){return e<10?Mi(e):_de[e]}function c6(e,t){let r="";for(;e.length+r.length<t;)r+="0";return r+e}function u6(e){let t="";for(let r=e;r!==0;){let n=r>>5,o=r-(n<<5);t=kde(o)+t,r=n}return t}function Tde(e,t){let r=~~(e/1073741824),n=e&1073741823;return c6(u6(r),t-6)+c6(u6(n),6)}function BR(e){return function(r){return Tde(r,e)}}var HKe=BR(10),BKe=BR(8);var zR=class e{constructor(t,r){this.commands=t,this.metadataForReplay=r}[Symbol.iterator](){return this.commands[Symbol.iterator]()}[Sr](){return new e(this.commands.map(t=>t.clone()),this.metadataForReplay)}toString(){let t=this.commands.filter(n=>n.hasRan).map(n=>n.toString()).join(","),r=this.metadataForReplay();return r.length!==0?`${t} /*${r}*/`:t}};var GE=e=>e(),KE=class e{constructor(t,r){this.act=t,this.taskSelector=r,this.lastTaskId=0,this.sourceTaskSelector=r.clone(),this.scheduledTasks=[],this.triggeredTasks=[],this.scheduledWatchers=[]}static buildLog(t){return`[task\${${t.taskId}}] ${t.label.length!==0?`${t.schedulingType}::${t.label}`:t.schedulingType} ${t.status}${t.outputValue!==void 0?` with value ${e6(t.outputValue)}`:""}`}log(t,r,n,o,s,i){this.triggeredTasks.push({status:s,schedulingType:t,taskId:r,label:n,metadata:o,outputValue:i!==void 0?hs(i):void 0})}scheduleInternal(t,r,n,o,s,i){let a=null,c=++this.lastTaskId,l=new Promise((f,d)=>{a=()=>{(i?n.then(()=>i()):n).then(h=>(this.log(t,c,r,o,"resolved",h),f(h)),h=>(this.log(t,c,r,o,"rejected",h),d(h)))}});return this.scheduledTasks.push({original:n,scheduled:l,trigger:a,schedulingType:t,taskId:c,label:r,metadata:o,customAct:s}),this.scheduledWatchers.length!==0&&this.scheduledWatchers[0](),l}schedule(t,r,n,o){return this.scheduleInternal("promise",r||"",t,n,o||GE)}scheduleFunction(t,r){return(...n)=>this.scheduleInternal("function",`${t.name}(${n.map(hs).join(",")})`,t(...n),void 0,r||GE)}scheduleSequence(t,r){let n={done:!1,faulty:!1},o={then:a=>a()},s=()=>{},i=new Promise(a=>s=a);return t.reduce((a,c)=>{let[l,f,d]=typeof c=="function"?[c,c.name,void 0]:[c.builder,c.label,c.metadata];return a.then(()=>{let h=this.scheduleInternal("sequence",f,o,d,r||GE,()=>l());return h.catch(()=>{n.faulty=!0,s()}),h})},o).then(()=>{n.done=!0,s()},()=>{}),Object.assign(n,{task:Promise.resolve(i).then(()=>({done:n.done,faulty:n.faulty}))})}count(){return this.scheduledTasks.length}internalWaitOne(){if(this.scheduledTasks.length===0)throw new Error("No task scheduled");let t=this.taskSelector.nextTaskIndex(this.scheduledTasks),[r]=this.scheduledTasks.splice(t,1);return r.customAct(async()=>{r.trigger();try{await r.scheduled}catch{}})}async waitOne(t){let r=t||GE;await this.act(()=>r(async()=>await this.internalWaitOne()))}async waitAll(t){for(;this.scheduledTasks.length>0;)await this.waitOne(t)}async waitFor(t,r){let n=!1,o=null,s=async()=>{for(;!n&&this.scheduledTasks.length>0;)await this.waitOne(r);o=null},i=()=>{o===null&&(o=Promise.resolve().then(s))},a=()=>{let l=this.scheduledWatchers.indexOf(i);l!==-1&&this.scheduledWatchers.splice(l,1),l===0&&this.scheduledWatchers.length!==0&&this.scheduledWatchers[0]()},c=t.then(l=>(n=!0,o===null?(a(),l):o.then(()=>(a(),l))),l=>{if(n=!0,o===null)throw a(),l;return o.then(()=>{throw a(),l})});return this.scheduledTasks.length>0&&this.scheduledWatchers.length===0&&i(),this.scheduledWatchers.push(i),c}report(){return[...this.triggeredTasks,...this.scheduledTasks.map(t=>({status:"pending",schedulingType:t.schedulingType,taskId:t.taskId,label:t.label,metadata:t.metadata}))]}toString(){return"schedulerFor()`\n"+this.report().map(e.buildLog).map(t=>`-> ${t}`).join(`
`)+"`"}[Sr](){return new e(this.act,this.sourceTaskSelector)}};var jR;(function(e){e[e.Full=0]="Full",e[e.Character=1]="Character"})(jR||(jR={}));var fZe=String.fromCodePoint;var TZe=String.fromCodePoint,IZe=[..."abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_"],RZe=[..."0123456789"],AZe=[...` 	\r
\v\f`],Wde=[...`\r
`],Hde=[...""],MZe=[...Wde,...Hde],vZe=LR();var $R=(e,t)=>{switch(t._tag){case"StringKeyword":case"TemplateLiteral":return Object.keys(e);case"SymbolKeyword":return Object.getOwnPropertySymbols(e);case"Refinement":return $R(e,t.from)}},Dh=e=>{let t=!1,r;return()=>(t||(r=e(),t=!0),r)},QE=e=>Array.isArray(e),f6=e=>!Array.isArray(e),l6=e=>`[${$u(e)}]`,JE=e=>QE(e)?e.map(l6).join(""):l6(e);var Pi=(e,t,r,n)=>{let o=e;return r&&ut(r)&&(o+=`
at path: ${JE(r)}`),t!==void 0&&(o+=`
details: ${t}`),n&&(o+=`
schema (${n._tag}): ${n}`),o},YE=e=>Pi("Invalid Argument",e),VR=(e,t,r)=>Pi("Unsupported schema",e,t,r);var d6=(e,t)=>VR("Cannot build an Equivalence",t,e);var GR=(e,t,r)=>Pi("Unsupported schema or overlapping types",`cannot extend ${e} with ${t}`,r),h6=e=>Pi("Unsupported template literal span",void 0,void 0,e),Cc=e=>VR(void 0,void 0,e),m6=e=>Pi("Unsupported key schema",void 0,void 0,e),x6=e=>Pi("Unsupported literal",`literal value: ${Wo(e)}`),KR=e=>Pi("Duplicate index signature",`${e} index signature`),g6=Pi("Unsupported index signature parameter","An index signature parameter type must be `string`, `symbol`, a template literal type or a refinement of the previous types"),b6=Pi("Invalid element","A required element cannot follow an optional element. ts(1257)"),QR=e=>Pi("Duplicate property signature transformation",`Duplicate key ${Wo(e)}`),y6=e=>VR(void 0,void 0,e),XE=e=>Pi("Duplicate property signature",`Duplicate key ${Wo(e)}`);var E6=Symbol.for("effect/SchemaId/DateFromSelf"),C6=Symbol.for("effect/SchemaId/GreaterThan"),w6=Symbol.for("effect/SchemaId/GreaterThanOrEqualTo"),O6=Symbol.for("effect/SchemaId/LessThan"),_6=Symbol.for("effect/SchemaId/LessThanOrEqualTo"),k6=Symbol.for("effect/SchemaId/Int"),T6=Symbol.for("effect/SchemaId/NonNaN"),I6=Symbol.for("effect/SchemaId/Finite"),R6=Symbol.for("effect/SchemaId/JsonNumber"),A6=Symbol.for("effect/SchemaId/Between"),M6=Symbol.for("effect/SchemaId/GreaterThanBigint"),v6=Symbol.for("effect/SchemaId/GreaterThanOrEqualToBigint"),P6=Symbol.for("effect/SchemaId/LessThanBigint"),F6=Symbol.for("effect/SchemaId/LessThanOrEqualToBigint"),N6=Symbol.for("effect/SchemaId/BetweenBigint"),D6=Symbol.for("effect/SchemaId/MinLength"),L6=Symbol.for("effect/SchemaId/MaxLength"),U6=Symbol.for("effect/SchemaId/Length"),q6=Symbol.for("effect/SchemaId/MinItems"),W6=Symbol.for("effect/SchemaId/MaxItems"),H6=Symbol.for("effect/SchemaId/ItemsCount");var Fi=bE;var B6=Gu(Fi);var z6=u(2,(e,t)=>{let r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,o=r>n?r:n,s=parseInt(e.toFixed(o).replace(".","")),i=parseInt(t.toFixed(o).replace(".",""));return s%i/Math.pow(10,o)}),j6=e=>{let t=Math.ceil(Math.log(e)/Math.log(2));return Math.max(Math.pow(2,t),2)},$6=e=>{if(e==="NaN")return Rn(NaN);if(e==="Infinity")return Rn(1/0);if(e==="-Infinity")return Rn(-1/0);if(e.trim()==="")return Ti;let t=Number(e);return Number.isNaN(t)?Ti:Rn(t)};var Uh=e=>e.replace(/[/\\^$*+?.()|[\]{}]/g,"\\$&");var lA=Symbol.for("effect/annotation/Brand"),G6=Symbol.for("effect/annotation/SchemaId"),fA=Symbol.for("effect/annotation/Message"),rC=Symbol.for("effect/annotation/MissingMessage"),Gg=Symbol.for("effect/annotation/Identifier"),Bo=Symbol.for("effect/annotation/Title"),cp=Symbol.for("effect/annotation/AutoTitle"),Ic=Symbol.for("effect/annotation/Description"),dA=Symbol.for("effect/annotation/Examples"),hA=Symbol.for("effect/annotation/Default"),mA=Symbol.for("effect/annotation/JSONSchema"),xA=Symbol.for("effect/annotation/Arbitrary"),gA=Symbol.for("effect/annotation/Pretty"),nC=Symbol.for("effect/annotation/Equivalence"),K6=Symbol.for("effect/annotation/Documentation"),bA=Symbol.for("effect/annotation/Concurrency"),yA=Symbol.for("effect/annotation/Batching"),SA=Symbol.for("effect/annotation/ParseIssueTitle"),EA=Symbol.for("effect/annotation/ParseOptions"),CA=Symbol.for("effect/annotation/DecodingFallback"),Kg=Symbol.for("effect/annotation/Surrogate"),Qg=Symbol.for("effect/annotation/StableFilter"),Mn=u(2,(e,t)=>Object.prototype.hasOwnProperty.call(e.annotations,t)?x(e.annotations[t]):g()),wA=Mn(lA);var Q6=Mn(fA),J6=Mn(rC),OA=Mn(Bo),_A=Mn(cp),Jg=Mn(Gg),kA=Mn(Ic);var Z6=Mn(bA),Y6=Mn(yA),X6=Mn(SA),ej=Mn(EA),tj=Mn(CA),up=Mn(Kg),zde=Mn(Qg),TA=e=>J1(zde(e),t=>t===!0),oC=Symbol.for("effect/annotation/JSONIdentifier"),jde=Mn(oC),$de=e=>yo(jde(e),()=>Jg(e)),rj=Symbol.for("effect/schema/ParseJson"),uf=class{typeParameters;decodeUnknown;encodeUnknown;annotations;_tag="Declaration";constructor(t,r,n,o={}){this.typeParameters=t,this.decodeUnknown=r,this.encodeUnknown=n,this.annotations=o}toString(){return _e($s(this),()=>"<declaration schema>")}toJSON(){return{_tag:this._tag,typeParameters:this.typeParameters.map(t=>t.toJSON()),annotations:ur(this.annotations)}}},ms=e=>t=>t._tag===e;var Li=class{literal;annotations;_tag="Literal";constructor(t,r={}){this.literal=t,this.annotations=r}toString(){return _e($s(this),()=>Wo(this.literal))}toJSON(){return{_tag:this._tag,literal:Bu(this.literal)?String(this.literal):this.literal,annotations:ur(this.annotations)}}},Ma=ms("Literal"),nj=new Li(null);var pf=class{symbol;annotations;_tag="UniqueSymbol";constructor(t,r={}){this.symbol=t,this.annotations=r}toString(){return _e($s(this),()=>Wo(this.symbol))}toJSON(){return{_tag:this._tag,symbol:String(this.symbol),annotations:ur(this.annotations)}}},Vde=ms("UniqueSymbol"),YR=class{annotations;_tag="UndefinedKeyword";constructor(t={}){this.annotations=t}toString(){return Ui(this)}toJSON(){return{_tag:this._tag,annotations:ur(this.annotations)}}},lf=new YR({[Bo]:"undefined"});var XR=class{annotations;_tag="VoidKeyword";constructor(t={}){this.annotations=t}toString(){return Ui(this)}toJSON(){return{_tag:this._tag,annotations:ur(this.annotations)}}},oj=new XR({[Bo]:"void"});var eA=class{annotations;_tag="NeverKeyword";constructor(t={}){this.annotations=t}toString(){return Ui(this)}toJSON(){return{_tag:this._tag,annotations:ur(this.annotations)}}},Zg=new eA({[Bo]:"never"}),Gde=ms("NeverKeyword"),tA=class{annotations;_tag="UnknownKeyword";constructor(t={}){this.annotations=t}toString(){return Ui(this)}toJSON(){return{_tag:this._tag,annotations:ur(this.annotations)}}},IA=new tA({[Bo]:"unknown"});var rA=class{annotations;_tag="AnyKeyword";constructor(t={}){this.annotations=t}toString(){return Ui(this)}toJSON(){return{_tag:this._tag,annotations:ur(this.annotations)}}},RA=new rA({[Bo]:"any"});var nA=class{annotations;_tag="StringKeyword";constructor(t={}){this.annotations=t}toString(){return Ui(this)}toJSON(){return{_tag:this._tag,annotations:ur(this.annotations)}}},sC=new nA({[Bo]:"string",[Ic]:"a string"}),Yg=ms("StringKeyword"),oA=class{annotations;_tag="NumberKeyword";constructor(t={}){this.annotations=t}toString(){return Ui(this)}toJSON(){return{_tag:this._tag,annotations:ur(this.annotations)}}},iC=new oA({[Bo]:"number",[Ic]:"a number"}),AA=ms("NumberKeyword"),sA=class{annotations;_tag="BooleanKeyword";constructor(t={}){this.annotations=t}toString(){return Ui(this)}toJSON(){return{_tag:this._tag,annotations:ur(this.annotations)}}},aC=new sA({[Bo]:"boolean",[Ic]:"a boolean"}),MA=ms("BooleanKeyword"),iA=class{annotations;_tag="BigIntKeyword";constructor(t={}){this.annotations=t}toString(){return Ui(this)}toJSON(){return{_tag:this._tag,annotations:ur(this.annotations)}}},sj=new iA({[Bo]:"bigint",[Ic]:"a bigint"});var aA=class{annotations;_tag="SymbolKeyword";constructor(t={}){this.annotations=t}toString(){return Ui(this)}toJSON(){return{_tag:this._tag,annotations:ur(this.annotations)}}},ij=new aA({[Bo]:"symbol",[Ic]:"a symbol"}),cC=ms("SymbolKeyword"),cA=class{annotations;_tag="ObjectKeyword";constructor(t={}){this.annotations=t}toString(){return Ui(this)}toJSON(){return{_tag:this._tag,annotations:ur(this.annotations)}}},aj=new cA({[Bo]:"object",[Ic]:"an object in the TypeScript meaning, i.e. the `object` type"});var tC=class{enums;annotations;_tag="Enums";constructor(t,r={}){this.enums=t,this.annotations=r}toString(){return _e($s(this),()=>`<enum ${this.enums.length} value(s): ${this.enums.map(([t,r])=>JSON.stringify(r)).join(" | ")}>`)}toJSON(){return{_tag:this._tag,enums:this.enums,annotations:ur(this.annotations)}}},Kde=ms("Enums"),cj=e=>{switch(e._tag){case"Literal":case"NumberKeyword":case"StringKeyword":case"TemplateLiteral":return!0;case"Union":return e.types.every(cj)}return!1},uj=e=>{switch(e._tag){case"Literal":return JSON.stringify(String(e.literal));case"StringKeyword":return"string";case"NumberKeyword":return"number";case"TemplateLiteral":return String(e);case"Union":return e.types.map(uj).join(" | ")}},Qde=e=>{switch(e._tag){case"Literal":return String(e.literal);case"StringKeyword":return"${string}";case"NumberKeyword":return"${number}";case"TemplateLiteral":return"${"+String(e)+"}";case"Union":return"${"+e.types.map(uj).join(" | ")+"}"}},ip=class{literal;type;constructor(t,r){if(this.literal=r,cj(t))this.type=t;else throw new Error(h6(t))}toString(){return Qde(this.type)+this.literal}toJSON(){return{type:this.type.toJSON(),literal:this.literal}}},$g=class{head;spans;annotations;_tag="TemplateLiteral";constructor(t,r,n={}){this.head=t,this.spans=r,this.annotations=n}toString(){return _e($s(this),()=>Jde(this))}toJSON(){return{_tag:this._tag,head:this.head,spans:this.spans.map(t=>t.toJSON()),annotations:ur(this.annotations)}}},Jde=e=>"`"+e.head+e.spans.map(String).join("")+"`",pj=ms("TemplateLiteral"),ap=class{type;annotations;constructor(t,r={}){this.type=t,this.annotations=r}toJSON(){return{type:this.type.toJSON(),annotations:ur(this.annotations)}}toString(){return String(this.type)}},wo=class extends ap{isOptional;constructor(t,r,n={}){super(t,n),this.isOptional=r}toJSON(){return{type:this.type.toJSON(),isOptional:this.isOptional,annotations:ur(this.annotations)}}toString(){return String(this.type)+(this.isOptional?"?":"")}},uC=e=>e.map(t=>t.type),wc=class{elements;rest;isReadonly;annotations;_tag="TupleType";constructor(t,r,n,o={}){this.elements=t,this.rest=r,this.isReadonly=n,this.annotations=o;let s=!1,i=!1;for(let a of t)if(a.isOptional)s=!0;else if(s){i=!0;break}if(i||s&&r.length>1)throw new Error(b6)}toString(){return _e($s(this),()=>Zde(this))}toJSON(){return{_tag:this._tag,elements:this.elements.map(t=>t.toJSON()),rest:this.rest.map(t=>t.toJSON()),isReadonly:this.isReadonly,annotations:ur(this.annotations)}}},Zde=e=>{let t=e.elements.map(String).join(", ");return _z(e.rest,{onEmpty:()=>`readonly [${t}]`,onNonEmpty:(r,n)=>{let o=String(r),s=o.includes(" | ")?`(${o})`:o;if(n.length>0){let i=n.map(String).join(", ");return e.elements.length>0?`readonly [${t}, ...${s}[], ${i}]`:`readonly [...${s}[], ${i}]`}else return e.elements.length>0?`readonly [${t}, ...${s}[]]`:`ReadonlyArray<${o}>`}})};var It=class extends wo{name;isReadonly;constructor(t,r,n,o,s){super(r,n,s),this.name=t,this.isReadonly=o}toString(){return(this.isReadonly?"readonly ":"")+String(this.name)+(this.isOptional?"?":"")+": "+this.type}toJSON(){return{name:String(this.name),type:this.type.toJSON(),isOptional:this.isOptional,isReadonly:this.isReadonly,annotations:ur(this.annotations)}}},lj=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return!0;case"Refinement":return lj(e.from)}return!1},Oc=class{type;isReadonly;parameter;constructor(t,r,n){if(this.type=r,this.isReadonly=n,lj(t))this.parameter=t;else throw new Error(g6)}toString(){return(this.isReadonly?"readonly ":"")+`[x: ${this.parameter}]: ${this.type}`}toJSON(){return{parameter:this.parameter.toJSON(),type:this.type.toJSON(),isReadonly:this.isReadonly}}},rn=class{annotations;_tag="TypeLiteral";propertySignatures;indexSignatures;constructor(t,r,n={}){this.annotations=n;let o={};for(let i=0;i<t.length;i++){let a=t[i].name;if(Object.prototype.hasOwnProperty.call(o,a))throw new Error(XE(a));o[a]=null}let s={string:!1,symbol:!1};for(let i=0;i<r.length;i++){let a=Tc(r[i].parameter);if(Yg(a)){if(s.string)throw new Error(KR("string"));s.string=!0}else if(cC(a)){if(s.symbol)throw new Error(KR("symbol"));s.symbol=!0}}this.propertySignatures=t,this.indexSignatures=r}toString(){return _e($s(this),()=>Yde(this))}toJSON(){return{_tag:this._tag,propertySignatures:this.propertySignatures.map(t=>t.toJSON()),indexSignatures:this.indexSignatures.map(t=>t.toJSON()),annotations:ur(this.annotations)}}},V6=e=>e.map(String).join("; "),Yde=e=>{if(e.propertySignatures.length>0){let t=e.propertySignatures.map(String).join("; ");return e.indexSignatures.length>0?`{ ${t}; ${V6(e.indexSignatures)} }`:`{ ${t} }`}else return e.indexSignatures.length>0?`{ ${V6(e.indexSignatures)} }`:"{}"},vA=ms("TypeLiteral"),Xde=dc(wh(Fi,e=>{switch(e._tag){case"AnyKeyword":return 0;case"UnknownKeyword":return 1;case"ObjectKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3}return 4})),ehe={string:"StringKeyword",number:"NumberKeyword",boolean:"BooleanKeyword",bigint:"BigIntKeyword"},fj=e=>Ql(e,t=>Xg(t)?fj(t.types):[t]),the=e=>{let t=Xde(e),r=[],n={},o=[];for(let s of t)switch(s._tag){case"NeverKeyword":break;case"AnyKeyword":return[RA];case"UnknownKeyword":return[IA];case"ObjectKeyword":case"UndefinedKeyword":case"VoidKeyword":case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":{n[s._tag]||(n[s._tag]=s,r.push(s));break}case"Literal":{let i=typeof s.literal;switch(i){case"string":case"number":case"bigint":case"boolean":{let a=ehe[i];!n[a]&&!o.includes(s.literal)&&(o.push(s.literal),r.push(s));break}case"object":{o.includes(s.literal)||(o.push(s.literal),r.push(s));break}}break}case"UniqueSymbol":{!n.SymbolKeyword&&!o.includes(s.symbol)&&(o.push(s.symbol),r.push(s));break}case"TupleType":{n.ObjectKeyword||r.push(s);break}case"TypeLiteral":{s.propertySignatures.length===0&&s.indexSignatures.length===0?n["{}"]||(n["{}"]=s,r.push(s)):n.ObjectKeyword||r.push(s);break}default:r.push(s)}return r},Qt=class e{types;annotations;static make=(t,r)=>pC(t)?new e(t,r):t.length===1?t[0]:Zg;static unify=(t,r)=>e.make(the(fj(t)),r);_tag="Union";constructor(t,r={}){this.types=t,this.annotations=r}toString(){return _e($s(this),()=>this.types.map(String).join(" | "))}toJSON(){return{_tag:this._tag,types:this.types.map(t=>t.toJSON()),annotations:ur(this.annotations)}}},dj=(e,t)=>e.map(t),pC=e=>e.length>1,Xg=ms("Union"),ZR=ne(Symbol.for("effect/Schema/AST/toJSONMemoMap"),()=>new WeakMap),js=class{f;annotations;_tag="Suspend";constructor(t,r={}){this.f=t,this.annotations=r,this.f=Dh(t)}toString(){return $s(this).pipe(yo(()=>kr(Vl(this.f)(),t=>$s(t))),_e(()=>"<suspended schema>"))}toJSON(){let t=this.f(),r=ZR.get(t);return r||(ZR.set(t,{_tag:this._tag}),r={_tag:this._tag,ast:t.toJSON(),annotations:ur(this.annotations)},ZR.set(t,r),r)}};var _c=class{from;filter;annotations;_tag="Refinement";constructor(t,r,n={}){this.from=t,this.filter=r,this.annotations=n}toString(){return Jg(this).pipe(_e(()=>j(wj(this),{onNone:()=>`{ ${this.from} | filter }`,onSome:t=>pp(this.from)?String(this.from)+" & "+t:t})))}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),annotations:ur(this.annotations)}}},pp=ms("Refinement"),lC={},Sn=class{from;to;transformation;annotations;_tag="Transformation";constructor(t,r,n,o={}){this.from=t,this.to=r,this.transformation=n,this.annotations=o}toString(){return _e($s(this),()=>`(${String(this.from)} <-> ${String(this.to)})`)}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),to:this.to.toJSON(),annotations:ur(this.annotations)}}},hj=ms("Transformation"),Vg=class{decode;encode;_tag="FinalTransformation";constructor(t,r){this.decode=t,this.encode=r}},rhe=e=>t=>t._tag===e;var uA=class{_tag="ComposeTransformation"},fC=new uA;var Hh=class{from;to;decode;encode;constructor(t,r,n,o){this.from=t,this.to=r,this.decode=n,this.encode=o}},mj=e=>e.decode===R&&e.encode===R,kc=class{propertySignatureTransformations;_tag="TypeLiteralTransformation";constructor(t){this.propertySignatureTransformations=t;let r={},n={};for(let o of t){let s=o.from;if(r[s])throw new Error(QR(s));r[s]=!0;let i=o.to;if(n[i])throw new Error(QR(i));n[i]=!0}}},eb=rhe("TypeLiteralTransformation"),tb=(e,t)=>{let r=Object.getOwnPropertyDescriptors(e),n={...e.annotations};delete n[Gg];let o={...n,...t},s=up(e);return X(s)&&(o[Kg]=tb(s.value,t)),r.annotations.value=o,Object.create(Object.getPrototypeOf(e),r)},xj=e=>Qt.unify(qh(e)),nhe="[\\s\\S]*?",ohe="[+-]?\\d*\\.?\\d+(?:[Ee][+-]?\\d+)?",gj=(e,t)=>{switch(e._tag){case"Literal":return Uh(String(e.literal));case"StringKeyword":return nhe;case"NumberKeyword":return ohe;case"TemplateLiteral":return PA(e,t,!1);case"Union":return e.types.map(r=>gj(r,t)).join("|")}},she=(e,t,r,n)=>{if(Xg(e)){if(r&&!n)return`(?:${t})`}else if(!r||!n)return t;return`(${t})`},PA=(e,t,r)=>{let n="";if(e.head!==""){let o=Uh(e.head);n+=t&&r?`(${o})`:o}for(let o of e.spans){let s=gj(o.type,t);if(n+=she(o.type,s,t,r),o.literal!==""){let i=Uh(o.literal);n+=t&&r?`(${i})`:i}}return n},FA=e=>new RegExp(`^${PA(e,!1,!0)}$`),bj=e=>new RegExp(`^${PA(e,!0,!0)}$`);var eC=e=>{let t=up(e);if(X(t))return eC(t.value);switch(e._tag){case"TypeLiteral":return e.indexSignatures.slice();case"Suspend":return eC(e.f());case"Refinement":return eC(e.from)}return[]},Bg=e=>{switch(e._tag){case"TupleType":{let t=!1,r=[];for(let n of e.elements)n.isOptional&&(t=!0),r.push(n.type);return t&&r.push(lf),r=r.concat(uC(e.rest)),Qt.make(r)}case"Refinement":return Bg(e.from);case"Union":return Qt.make(e.types.map(Bg));case"Suspend":return Bg(e.f())}throw new Error(Cc(e))},yj=(e,t)=>{let r=_E(e.propertySignatures,n=>n.name===t);if(X(r))return r.value;if(cr(t)){let n;for(let o of e.indexSignatures){let s=Tc(o.parameter);switch(s._tag){case"TemplateLiteral":{if(FA(s).test(t))return new It(t,o.type,!1,!0);break}case"StringKeyword":n===void 0&&(n=new It(t,o.type,!1,!0))}}if(n)return n}else if(Oa(t))for(let n of e.indexSignatures){let o=Tc(n.parameter);if(cC(o))return new It(t,n.type,!1,!0)}},af=(e,t)=>{let r=up(e);if(X(r))return af(r.value,t);switch(e._tag){case"TypeLiteral":{let n=yj(e,t);if(n)return n;break}case"Union":return new It(t,Qt.make(e.types.map(n=>af(n,t).type)),!1,!0);case"Suspend":return af(e.f(),t);case"Refinement":return af(e.from,t)}throw new Error(Cc(e))},of=e=>{let t=up(e);if(X(t))return of(t.value);switch(e._tag){case"TypeLiteral":return e.propertySignatures.map(r=>r.name);case"Union":return e.types.slice(1).reduce((r,n)=>cR(r,of(n)),of(e.types[0]));case"Suspend":return of(e.f());case"Refinement":return of(e.from);case"Transformation":return of(e.to)}return[]},NA=(e,t)=>{let r=[],n=[],o=s=>{switch(s._tag){case"NeverKeyword":break;case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":case"Refinement":n.push(new Oc(s,t,!0));break;case"Literal":if(cr(s.literal)||go(s.literal))r.push(new It(s.literal,t,!1,!0));else throw new Error(x6(s.literal));break;case"Enums":{for(let[i,a]of s.enums)r.push(new It(a,t,!1,!0));break}case"UniqueSymbol":r.push(new It(s.symbol,t,!1,!0));break;case"Union":s.types.forEach(o);break;default:throw new Error(m6(s))}};return o(e),{propertySignatures:r,indexSignatures:n}},Di=(e,t)=>{let r=up(e);if(X(r))return Di(r.value,t);switch(e._tag){case"TypeLiteral":{let n=[],o={};for(let s of e.propertySignatures)o[s.name]=null,t.includes(s.name)&&n.push(s);for(let s of t)if(!(s in o)){let i=yj(e,s);i&&n.push(i)}return new rn(n,[])}case"Union":return new rn(t.map(n=>af(e,n)),[]);case"Suspend":return Di(e.f(),t);case"Refinement":return Di(e.from,t);case"Transformation":switch(e.transformation._tag){case"ComposeTransformation":return new Sn(Di(e.from,t),Di(e.to,t),fC);case"TypeLiteralTransformation":{let n=[],o=[];for(let s of t){let i=e.transformation.propertySignatureTransformations.find(a=>a.to===s);i?(n.push(i),o.push(i.from)):o.push(s)}return ut(n)?new Sn(Di(e.from,o),Di(e.to,t),new kc(n)):Di(e.from,o)}}}throw new Error(Cc(e))},Sj=(e,t)=>{let r=eC(e);return r.length>0?(r.some(n=>Yg(Tc(n.parameter)))&&(r=r.filter(n=>!pj(Tc(n.parameter)))),new rn([],r)):Di(e,of(e).filter(n=>!t.includes(n)))},zg=e=>Qt.make([e,lf]),cf=(e,t)=>{let r=t?.exact===!0;switch(e._tag){case"TupleType":return new wc(e.elements.map(n=>new wo(r?n.type:zg(n.type),!0)),Y1(e.rest,{onEmpty:()=>e.rest,onNonEmpty:n=>[new ap(Qt.make([...uC(n),lf]))]}),e.isReadonly);case"TypeLiteral":return new rn(e.propertySignatures.map(n=>new It(n.name,r?n.type:zg(n.type),!0,n.isReadonly,n.annotations)),e.indexSignatures.map(n=>new Oc(n.parameter,zg(n.type),n.isReadonly)));case"Union":return Qt.make(e.types.map(n=>cf(n,t)));case"Suspend":return new js(()=>cf(e.f(),t));case"Declaration":case"Refinement":throw new Error(Cc(e));case"Transformation":{if(eb(e.transformation)&&e.transformation.propertySignatureTransformations.every(mj))return new Sn(cf(e.from,t),cf(e.to,t),e.transformation);throw new Error(Cc(e))}}return e},Wh=e=>{switch(e._tag){case"TupleType":return new wc(e.elements.map(t=>new wo(t.type,!1)),e.rest,e.isReadonly);case"TypeLiteral":return new rn(e.propertySignatures.map(t=>new It(t.name,t.type,!1,t.isReadonly,t.annotations)),e.indexSignatures);case"Union":return Qt.make(e.types.map(t=>Wh(t)));case"Suspend":return new js(()=>Wh(e.f()));case"Declaration":case"Refinement":throw new Error(Cc(e));case"Transformation":{if(eb(e.transformation)&&e.transformation.propertySignatureTransformations.every(mj))return new Sn(Wh(e.from),Wh(e.to),e.transformation);throw new Error(Cc(e))}}return e},sf=e=>{switch(e._tag){case"TupleType":return e.isReadonly===!1?e:new wc(e.elements,e.rest,!1,e.annotations);case"TypeLiteral":{let t=Co(e.propertySignatures,n=>n.isReadonly===!1?n:new It(n.name,n.type,n.isOptional,!1,n.annotations)),r=Co(e.indexSignatures,n=>n.isReadonly===!1?n:new Oc(n.parameter,n.type,!1));return t===e.propertySignatures&&r===e.indexSignatures?e:new rn(t,r,e.annotations)}case"Union":{let t=Co(e.types,sf);return t===e.types?e:Qt.make(t,e.annotations)}case"Suspend":return new js(()=>sf(e.f()),e.annotations);case"Refinement":{let t=sf(e.from);return t===e.from?e:new _c(t,e.filter,e.annotations)}case"Transformation":{let t=sf(e.from),r=sf(e.to);return t===e.from&&r===e.to?e:new Sn(t,r,e.transformation,e.annotations)}}return e};var DA=e=>t=>{let r;for(let n of e)Object.prototype.hasOwnProperty.call(t.annotations,n)&&(r===void 0&&(r={}),r[n]=t.annotations[n]);return r},Ej=e=>t=>{let r={...t.annotations};for(let n of e)delete r[n];return r},ihe=DA([dA,hA,mA,xA,gA,nC]),gt=e=>{switch(e._tag){case"Declaration":{let t=Co(e.typeParameters,gt);return t===e.typeParameters?e:new uf(t,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{let t=Co(e.elements,o=>{let s=gt(o.type);return s===o.type?o:new wo(s,o.isOptional)}),r=uC(e.rest),n=Co(r,gt);return t===e.elements&&n===r?e:new wc(t,n.map(o=>new ap(o)),e.isReadonly,e.annotations)}case"TypeLiteral":{let t=Co(e.propertySignatures,n=>{let o=gt(n.type);return o===n.type?n:new It(n.name,o,n.isOptional,n.isReadonly)}),r=Co(e.indexSignatures,n=>{let o=gt(n.type);return o===n.type?n:new Oc(n.parameter,o,n.isReadonly)});return t===e.propertySignatures&&r===e.indexSignatures?e:new rn(t,r,e.annotations)}case"Union":{let t=Co(e.types,gt);return t===e.types?e:Qt.make(t,e.annotations)}case"Suspend":return new js(()=>gt(e.f()),e.annotations);case"Refinement":{let t=gt(e.from);return t===e.from?e:new _c(t,e.filter,e.annotations)}case"Transformation":{let t=ihe(e);return gt(t!==void 0?tb(e.to,t):e.to)}}return e};function Co(e,t){let r=!1,n=Gl(e.length);for(let o=0;o<e.length;o++){let s=e[o],i=t(s);i!==s&&(r=!0),n[o]=i}return r?n:e}var pA=e=>{switch(e._tag){case"Transformation":return e.from;case"Refinement":return pA(e.from);case"Suspend":return pA(e.f())}},Ni=(e,t)=>{switch(e._tag){case"Declaration":{let r=Co(e.typeParameters,n=>Ni(n,t));return r===e.typeParameters?e:new uf(r,e.decodeUnknown,e.encodeUnknown)}case"TupleType":{let r=Co(e.elements,s=>{let i=Ni(s.type,t);return i===s.type?s:new wo(i,s.isOptional)}),n=uC(e.rest),o=Co(n,s=>Ni(s,t));return r===e.elements&&o===n?e:new wc(r,o.map(s=>new ap(s)),e.isReadonly)}case"TypeLiteral":{let r=Co(e.propertySignatures,o=>{let s=Ni(o.type,t);return s===o.type?o:new It(o.name,s,o.isOptional,o.isReadonly)}),n=Co(e.indexSignatures,o=>{let s=Ni(o.type,t);return s===o.type?o:new Oc(o.parameter,s,o.isReadonly)});return r===e.propertySignatures&&n===e.indexSignatures?e:new rn(r,n)}case"Union":{let r=Co(e.types,n=>Ni(n,t));return r===e.types?e:Qt.make(r)}case"Suspend":{let r,n=$de(e);if(X(n)){let o=t?"Bound":"";r={[oC]:`${n.value}Encoded${o}`}}return new js(()=>Ni(e.f(),t),r)}case"Refinement":{let r=Ni(e.from,t);return t?r===e.from?e:pA(e.from)===void 0&&TA(e)?new _c(r,e.filter,e.annotations):r:r}case"Transformation":return Ni(e.from,t)}return e},rb=e=>Ni(e,!1),Cj=e=>Ni(e,!0),ur=e=>{let t={};for(let r of Object.getOwnPropertySymbols(e))t[String(r)]=e[r];return t},Tc=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return e;case"Refinement":return Tc(e.from)}},LA=(e,t)=>{switch(e._tag){case"Literal":return Ma(t)&&t.literal===e.literal;case"UniqueSymbol":return Vde(t)&&t.symbol===e.symbol;case"UndefinedKeyword":case"VoidKeyword":case"NeverKeyword":case"UnknownKeyword":case"AnyKeyword":case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":case"ObjectKeyword":return t._tag===e._tag;case"TemplateLiteral":return pj(t)&&t.head===e.head&&ahe(t.spans,e.spans);case"Enums":return Kde(t)&&che(t.enums,e.enums);case"Union":return Xg(t)&&uhe(e.types,t.types);case"Refinement":case"TupleType":case"TypeLiteral":case"Suspend":case"Transformation":case"Declaration":return e===t}},ahe=An((e,t)=>e.literal===t.literal&&LA(e.type,t.type)),che=An((e,t)=>t[0]===e[0]&&t[1]===e[1]),uhe=An(LA),phe=aR(LA),qh=e=>{switch(e._tag){case"Declaration":{let t=up(e);if(X(t))return qh(t.value);break}case"TypeLiteral":return e.propertySignatures.map(t=>Oa(t.name)?new pf(t.name):new Li(t.name)).concat(e.indexSignatures.map(t=>Tc(t.parameter)));case"Suspend":return qh(e.f());case"Union":return e.types.slice(1).reduce((t,r)=>phe(t,qh(r)),qh(e.types[0]));case"Transformation":return qh(e.to)}throw new Error(Cc(e))},UA=(e,t)=>new Sn(e,t,fC),jg=(e,t)=>{switch(e._tag){case"TypeLiteral":{let r=[];for(let n of Reflect.ownKeys(t)){let o=t[n];o!==void 0&&r.push(new Hh(n,o,R,R))}return r.length===0?e:new Sn(e,new rn(e.propertySignatures.map(n=>{let o=t[n.name];return new It(o===void 0?n.name:o,gt(n.type),n.isOptional,n.isReadonly,n.annotations)}),e.indexSignatures),new kc(r))}case"Union":return Qt.make(e.types.map(r=>jg(r,t)));case"Suspend":return new js(()=>jg(e.f(),t));case"Transformation":return UA(e,jg(gt(e),t))}throw new Error(y6(e))},Ui=e=>_e($s(e),()=>e._tag);function lhe(e){return j(wA(e),{onNone:()=>"",onSome:t=>t.map(r=>` & Brand<${Wo(r)}>`).join("")})}var wj=e=>OA(e).pipe(yo(()=>kA(e)),yo(()=>_A(e)),ct(t=>t+lhe(e))),$s=e=>yo(Jg(e),()=>wj(e)),Oj=(e,t,r)=>{switch(e._tag){case"UndefinedKeyword":return Zg;case"Union":{let n=[],o=!1;for(let s of e.types){let i=t(s);i?(o=!0,Gde(i)||n.push(i)):n.push(s)}if(o)return Qt.make(n);break}case"Suspend":return t(e.f());case"Transformation":return r(e)}};var _j=/^[+-]?\d+$/,WA=Symbol.for("effect/BigDecimal"),fhe={[WA]:WA,[H](){let e=ff(this);return p(M(e.value),G(ac(e.scale)),se(this))},[W](e){return BA(e)&&hhe(this,e)},toString(){return`BigDecimal(${Wi(this)})`},toJSON(){return{_id:"BigDecimal",value:String(this.value),scale:this.scale}},[he](){return this.toJSON()},pipe(){return v(this,arguments)}},BA=e=>F(e,WA),lp=(e,t)=>{let r=Object.create(fhe);return r.value=e,r.scale=t,r},Tj=(e,t)=>{if(e!==qi&&e%HA===qi)throw new RangeError("Value must be normalized");let r=lp(e,t);return r.normalized=r,r},qi=BigInt(0);var HA=BigInt(10),Ij=Tj(qi,0),ff=e=>{if(e.normalized===void 0)if(e.value===qi)e.normalized=Ij;else{let t=`${e.value}`,r=0;for(let s=t.length-1;s>=0&&t[s]==="0";s--)r++;r===0&&(e.normalized=e);let n=BigInt(t.substring(0,t.length-r)),o=e.scale-r;e.normalized=Tj(n,o)}return e.normalized},dC=u(2,(e,t)=>t>e.scale?lp(e.value*HA**BigInt(t-e.scale),t):t<e.scale?lp(e.value/HA**BigInt(e.scale-t),t):e);var Bh=fc((e,t)=>{let r=bE(kj(e),kj(t));return r!==0?r:e.scale>t.scale?Ch(e.value,dC(t,e.scale).value):e.scale<t.scale?Ch(dC(e,t.scale).value,t.value):Ch(e.value,t.value)}),Rj=jl(Bh),Aj=Oh(Bh),Mj=$l(Bh),vj=_h(Bh),Pj=kh(Bh),Fj=Gu(Bh);var kj=e=>e.value===qi?0:e.value<qi?-1:1,dhe=e=>e.value<qi?lp(-e.value,e.scale):e;var zA=ar((e,t)=>e.scale>t.scale?dC(t,e.scale).value===e.value:e.scale<t.scale?dC(e,t.scale).value===t.value:e.value===t.value),hhe=u(2,(e,t)=>zA(e,t));var Nj=e=>EE(mhe(e),()=>new RangeError(`Number must be finite, got ${e}`));var mhe=e=>{if(!Number.isFinite(e))return g();let t=`${e}`;if(t.includes("e"))return jA(t);let[r,n=""]=t.split(".");return x(lp(BigInt(`${r}${n}`),n.length))},jA=e=>{if(e==="")return x(Ij);let t,r,n=e.search(/[eE]/);if(n!==-1){let c=e.slice(n+1);if(t=e.slice(0,n),r=Number(c),t===""||!Number.isSafeInteger(r)||!_j.test(c))return g()}else t=e,r=0;let o,s,i=t.search(/\./);if(i!==-1){let c=t.slice(0,i),l=t.slice(i+1);o=`${c}${l}`,s=l.length}else o=t,s=0;if(!_j.test(o))return g();let a=s-r;return Number.isSafeInteger(a)?x(lp(BigInt(o),a)):g()};var Wi=e=>{let t=ff(e);if(Math.abs(t.scale)>=16)return xhe(t);let r=t.value<qi,n=r?`${t.value}`.substring(1):`${t.value}`,o,s;if(t.scale>=n.length)o="0",s="0".repeat(t.scale-n.length)+n;else{let a=n.length-t.scale;if(a>n.length){let c=a-n.length;o=`${n}${"0".repeat(c)}`,s=""}else s=n.slice(a),o=n.slice(0,a)}let i=s===""?o:`${o}.${s}`;return r?`-${i}`:i},xhe=e=>{if(ghe(e))return"0e+0";let t=ff(e),r=`${dhe(t).value}`,n=r.slice(0,1),o=r.slice(1),s=`${$A(t)?"-":""}${n}`;o!==""&&(s+=`.${o}`);let i=o.length-t.scale;return`${s}e${i>=0?"+":""}${i}`},Dj=e=>Number(Wi(e));var ghe=e=>e.value===qi,$A=e=>e.value<qi,Lj=e=>e.value>qi;var bhe=Ch;var qj=Gu(bhe);var Wj=e=>e>BigInt(Number.MAX_SAFE_INTEGER)||e<BigInt(Number.MIN_SAFE_INTEGER)?g():x(Number(e)),Hj=e=>{try{return e.trim()===""?g():x(BigInt(e))}catch{return g()}},Bj=e=>{if(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER)return g();try{return x(BigInt(e))}catch{return g()}};var nb=e=>!e;var Jt={};Yn(Jt,{GenericTag:()=>nn,Reference:()=>Hi,ReferenceTypeId:()=>khe,Tag:()=>vhe,TagTypeId:()=>_he,add:()=>qe,empty:()=>En,get:()=>jt,getOption:()=>xs,getOrElse:()=>Rhe,isContext:()=>ob,isReference:()=>Ihe,isTag:()=>$h,make:()=>Oo,merge:()=>_o,mergeAll:()=>YA,omit:()=>Mhe,pick:()=>Ahe,unsafeGet:()=>vn,unsafeMake:()=>The});var hC=Symbol.for("effect/Context/Tag"),zh=Symbol.for("effect/Context/Reference"),yhe="effect/STM",She=Symbol.for(yhe),jh={...lc,_op:"Tag",[She]:Ta,[hC]:{_Service:e=>e,_Identifier:e=>e},toString(){return De(this.toJSON())},toJSON(){return{_id:"Tag",key:this.key,stack:this.stack}},[he](){return this.toJSON()},of(e){return e},context(e){return JA(this,e)}},Ehe={...jh,[zh]:zh},jj=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=2;let r=new Error;Error.stackTraceLimit=t;let n=Object.create(jh);return Object.defineProperty(n,"stack",{get(){return r.stack}}),n.key=e,n},$j=e=>()=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=2;let r=new Error;Error.stackTraceLimit=t;function n(){}return Object.setPrototypeOf(n,jh),n.key=e,Object.defineProperty(n,"stack",{get(){return r.stack}}),n},Vj=()=>(e,t)=>{let r=Error.stackTraceLimit;Error.stackTraceLimit=2;let n=new Error;Error.stackTraceLimit=r;function o(){}return Object.setPrototypeOf(o,Ehe),o.key=e,o.defaultValue=t.defaultValue,Object.defineProperty(o,"stack",{get(){return n.stack}}),o},KA=Symbol.for("effect/Context"),Che={[KA]:{_Services:e=>e},[W](e){if(QA(e)&&this.unsafeMap.size===e.unsafeMap.size){for(let t of this.unsafeMap.keys())if(!e.unsafeMap.has(t)||!N(this.unsafeMap.get(t),e.unsafeMap.get(t)))return!1;return!0}return!1},[H](){return se(this,ac(this.unsafeMap.size))},pipe(){return v(this,arguments)},toString(){return De(this.toJSON())},toJSON(){return{_id:"Context",services:Array.from(this.unsafeMap).map(ve)}},[he](){return this.toJSON()}},Vs=e=>{let t=Object.create(Che);return t.unsafeMap=e,t},whe=e=>{let t=new Error(`Service not found${e.key?`: ${String(e.key)}`:""}`);if(e.stack){let r=e.stack.split(`
`);if(r.length>2){let n=r[2].match(/at (.*)/);n&&(t.message=t.message+` (defined at ${n[1]})`)}}if(t.stack){let r=t.stack.split(`
`);r.splice(1,3),t.stack=r.join(`
`)}return t},QA=e=>F(e,KA),Gj=e=>F(e,hC),mC=e=>F(e,zh),Ohe=Vs(new Map),Kj=()=>Ohe,JA=(e,t)=>Vs(new Map([[e.key,t]])),Qj=u(3,(e,t,r)=>{let n=new Map(e.unsafeMap);return n.set(t.key,r),Vs(n)}),GA=ne("effect/Context/defaultValueCache",()=>new Map),xC=e=>{if(GA.has(e.key))return GA.get(e.key);let t=e.defaultValue();return GA.set(e.key,t),t},Jj=(e,t)=>e.unsafeMap.has(t.key)?e.unsafeMap.get(t.key):xC(t),ZA=u(2,(e,t)=>{if(!e.unsafeMap.has(t.key)){if(zh in t)return xC(t);throw whe(t)}return e.unsafeMap.get(t.key)}),Zj=ZA,Yj=u(3,(e,t,r)=>e.unsafeMap.has(t.key)?e.unsafeMap.get(t.key):mC(t)?xC(t):r()),Xj=u(2,(e,t)=>e.unsafeMap.has(t.key)?Rn(e.unsafeMap.get(t.key)):mC(t)?Rn(xC(t)):Ti),e4=u(2,(e,t)=>{let r=new Map(e.unsafeMap);for(let[n,o]of t.unsafeMap)r.set(n,o);return Vs(r)}),t4=(...e)=>{let t=new Map;for(let r=0;r<e.length;r++)e[r].unsafeMap.forEach((n,o)=>{t.set(o,n)});return Vs(t)},r4=(...e)=>t=>{let r=new Set(e.map(o=>o.key)),n=new Map;for(let[o,s]of t.unsafeMap.entries())r.has(o)&&n.set(o,s);return Vs(n)},n4=(...e)=>t=>{let r=new Map(t.unsafeMap);for(let n of e)r.delete(n.key);return Vs(r)};var _he=hC,khe=zh,nn=jj;var The=Vs,ob=QA,$h=Gj,Ihe=mC,En=Kj,Oo=JA,qe=Qj,jt=Zj,Rhe=Yj,vn=ZA,xs=Xj,_o=e4,YA=t4,Ahe=r4,Mhe=n4,vhe=$j,Hi=Vj;var s4=Symbol.for("effect/Chunk");function Phe(e,t,r,n,o){for(let s=t;s<Math.min(e.length,t+o);s++)r[n+s-t]=e[s];return r}var i4=[],gC=e=>ar((t,r)=>t.length===r.length&&Zt(t).every((n,o)=>e(n,dt(r,o)))),Fhe=gC(N),Nhe={[s4]:{_A:e=>e},toString(){return De(this.toJSON())},toJSON(){return{_id:"Chunk",values:Zt(this).map(ve)}},[he](){return this.toJSON()},[W](e){return df(e)&&Fhe(this,e)},[H](){return se(this,qo(Zt(this)))},[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return i4[Symbol.iterator]();default:return Zt(this)[Symbol.iterator]()}},pipe(){return v(this,arguments)}},Pr=e=>{let t=Object.create(Nhe);switch(t.backing=e,e._tag){case"IEmpty":{t.length=0,t.depth=0,t.left=t,t.right=t;break}case"IConcat":{t.length=e.left.length+e.right.length,t.depth=1+Math.max(e.left.depth,e.right.depth),t.left=e.left,t.right=e.right;break}case"IArray":{t.length=e.array.length,t.depth=0,t.left=Gs,t.right=Gs;break}case"ISingleton":{t.length=1,t.depth=0,t.left=Gs,t.right=Gs;break}case"ISlice":{t.length=e.length,t.depth=e.chunk.depth+1,t.left=Gs,t.right=Gs;break}}return t},df=e=>F(e,s4),Gs=Pr({_tag:"IEmpty"}),ee=()=>Gs,fp=(...e)=>sb(e),V=e=>Pr({_tag:"ISingleton",a:e}),pt=e=>df(e)?e:Le(Ee(e)),XA=(e,t,r)=>{switch(e.backing._tag){case"IArray":{Phe(e.backing.array,0,t,r,e.length);break}case"IConcat":{XA(e.left,t,r),XA(e.right,t,r+e.left.length);break}case"ISingleton":{t[r]=e.backing.a;break}case"ISlice":{let n=0,o=r;for(;n<e.length;)t[o]=dt(e,n),n+=1,o+=1;break}}};var Dhe=e=>{switch(e.backing._tag){case"IEmpty":return i4;case"IArray":return e.backing.array;default:{let t=new Array(e.length);return XA(e,t,0),e.backing={_tag:"IArray",array:t},e.left=Gs,e.right=Gs,e.depth=0,t}}},Zt=Dhe,Lhe=e=>{switch(e.backing._tag){case"IEmpty":case"ISingleton":return e;case"IArray":return Pr({_tag:"IArray",array:nR(e.backing.array)});case"IConcat":return Pr({_tag:"IConcat",left:gs(e.backing.right),right:gs(e.backing.left)});case"ISlice":return Le(nR(Zt(e)))}},gs=Lhe,a4=u(2,(e,t)=>t<0||t>=e.length?g():x(dt(e,t))),Le=e=>e.length===0?ee():e.length===1?V(e[0]):Pr({_tag:"IArray",array:e}),sb=e=>Le(e),dt=u(2,(e,t)=>{switch(e.backing._tag){case"IEmpty":throw new Error("Index out of bounds");case"ISingleton":{if(t!==0)throw new Error("Index out of bounds");return e.backing.a}case"IArray":{if(t>=e.length||t<0)throw new Error("Index out of bounds");return e.backing.array[t]}case"IConcat":return t<e.left.length?dt(e.left,t):dt(e.right,t-e.left.length);case"ISlice":return dt(e.backing.chunk,t+e.backing.offset)}}),Pn=u(2,(e,t)=>We(e,V(t))),Et=u(2,(e,t)=>We(V(t),e)),bs=u(2,(e,t)=>{if(t<=0)return Gs;if(t>=e.length)return e;switch(e.backing._tag){case"ISlice":return Pr({_tag:"ISlice",chunk:e.backing.chunk,length:t,offset:e.backing.offset});case"IConcat":return t>e.left.length?Pr({_tag:"IConcat",left:e.left,right:bs(e.right,t-e.left.length)}):bs(e.left,t);default:return Pr({_tag:"ISlice",chunk:e,offset:0,length:t})}}),$t=u(2,(e,t)=>{if(t<=0)return e;if(t>=e.length)return Gs;switch(e.backing._tag){case"ISlice":return Pr({_tag:"ISlice",chunk:e.backing.chunk,offset:e.backing.offset+t,length:e.backing.length-t});case"IConcat":return t>e.left.length?$t(e.right,t-e.left.length):Pr({_tag:"IConcat",left:$t(e.left,t),right:e.right});default:return Pr({_tag:"ISlice",chunk:e,offset:t,length:e.length-t})}});var eM=u(2,(e,t)=>{let r=Zt(e),n=r.length,o=0;for(;o<n&&t(r[o]);)o++;return $t(e,o)});var We=u(2,(e,t)=>{if(e.backing._tag==="IEmpty")return t;if(t.backing._tag==="IEmpty")return e;let r=t.depth-e.depth;if(Math.abs(r)<=1)return Pr({_tag:"IConcat",left:e,right:t});if(r<-1)if(e.left.depth>=e.right.depth){let n=We(e.right,t);return Pr({_tag:"IConcat",left:e.left,right:n})}else{let n=We(e.right.right,t);if(n.depth===e.depth-3){let o=Pr({_tag:"IConcat",left:e.right.left,right:n});return Pr({_tag:"IConcat",left:e.left,right:o})}else{let o=Pr({_tag:"IConcat",left:e.left,right:e.right.left});return Pr({_tag:"IConcat",left:o,right:n})}}else if(t.right.depth>=t.left.depth){let n=We(e,t.left);return Pr({_tag:"IConcat",left:n,right:t.right})}else{let n=We(e,t.left.left);if(n.depth===t.depth-3){let o=Pr({_tag:"IConcat",left:n,right:t.left.right});return Pr({_tag:"IConcat",left:o,right:t.right})}else{let o=Pr({_tag:"IConcat",left:t.left.right,right:t.right});return Pr({_tag:"IConcat",left:n,right:o})}}}),Vh=u(2,(e,t)=>Le(hc(e,t))),Bi=u(2,(e,t)=>Le(Nz(e,t))),c4=u(2,(e,t)=>Le(Pz(e,t)));var tM=u(2,(e,t)=>{if(e.backing._tag==="ISingleton")return t(e.backing.a,0);let r=Gs,n=0;for(let o of e)r=We(r,t(o,n++));return r});var bC=tM(R);var le=e=>e.length===0,Vt=e=>e.length>0,va=a4(0),ib=e=>dt(e,0),Cn=ib,yC=e=>a4(e,e.length-1),hf=e=>dt(e,e.length-1);var bt=u(2,(e,t)=>e.backing._tag==="ISingleton"?V(t(e.backing.a,0)):Le(p(Zt(e),Ai((r,n)=>t(r,n))))),rM=u(3,(e,t,r)=>{let[n,o]=Uz(e,t,r);return[n,Le(o)]});var mf=u(2,(e,t)=>[bs(e,t),$t(e,t)]);var nM=u(2,(e,t)=>{let r=0;for(let n of Zt(e)){if(t(n))break;r++}return mf(e,r)});var to=e=>$t(e,1),u4=u(2,(e,t)=>$t(e,e.length-t)),oM=u(2,(e,t)=>{let r=[];for(let n of Zt(e))if(t(n))r.push(n);else break;return Le(r)});var sM=u(3,(e,t,r)=>Le(sR(e,t,r)));var Uhe=u(2,(e,t)=>pt(wE(e,t))),SC=(e,t)=>e<=t?Uhe(t-e+1,r=>e+r):V(e);var iM=_E;var xf=mc,p4=Pg;var aM=Symbol.for("effect/Duration"),m4=BigInt(0),l4=BigInt(24),EC=BigInt(60),cM=BigInt(1e3),f4=BigInt(1e6),d4=BigInt(1e9),qhe=/^(-?\d+(?:\.\d+)?)\s+(nanos?|micros?|millis?|seconds?|minutes?|hours?|days?|weeks?)$/,Qe=e=>{if(CC(e))return e;if(go(e))return wn(e);if(Bu(e))return Ks(e);if(Array.isArray(e)&&e.length===2&&e.every(go))return e[0]===-1/0||e[1]===-1/0||Number.isNaN(e[0])||Number.isNaN(e[1])?Pa:e[0]===1/0||e[1]===1/0?ab:Ks(BigInt(Math.round(e[0]*1e9))+BigInt(Math.round(e[1])));if(cr(e)){let t=qhe.exec(e);if(t){let[r,n,o]=t,s=Number(n);switch(o){case"nano":case"nanos":return Ks(BigInt(n));case"micro":case"micros":return zhe(BigInt(n));case"milli":case"millis":return wn(s);case"second":case"seconds":return uM(s);case"minute":case"minutes":return jhe(s);case"hour":case"hours":return $he(s);case"day":case"days":return Vhe(s);case"week":case"weeks":return Ghe(s)}}}throw new Error("Invalid DurationInput")};var h4={_tag:"Millis",millis:0},Whe={_tag:"Infinity"},Hhe={[aM]:aM,[H](){return se(this,uE(this.value))},[W](e){return CC(e)&&Yhe(this,e)},toString(){return`Duration(${fM(this)})`},toJSON(){switch(this.value._tag){case"Millis":return{_id:"Duration",_tag:"Millis",millis:this.value.millis};case"Nanos":return{_id:"Duration",_tag:"Nanos",hrtime:Qhe(this)};case"Infinity":return{_id:"Duration",_tag:"Infinity"}}},[he](){return this.toJSON()},pipe(){return v(this,arguments)}},Qs=e=>{let t=Object.create(Hhe);return go(e)?isNaN(e)||e<=0?t.value=h4:Number.isFinite(e)?Number.isInteger(e)?t.value={_tag:"Millis",millis:e}:t.value={_tag:"Nanos",nanos:BigInt(Math.round(e*1e6))}:t.value=Whe:e<=m4?t.value=h4:t.value={_tag:"Nanos",nanos:e},t},CC=e=>F(e,aM),x4=e=>e.value._tag!=="Infinity",Bhe=e=>{switch(e.value._tag){case"Millis":return e.value.millis===0;case"Nanos":return e.value.nanos===m4;case"Infinity":return!1}},Pa=Qs(0),ab=Qs(1/0),Ks=e=>Qs(e),zhe=e=>Qs(e*cM),wn=e=>Qs(e),uM=e=>Qs(e*1e3),jhe=e=>Qs(e*6e4),$he=e=>Qs(e*36e5),Vhe=e=>Qs(e*864e5),Ghe=e=>Qs(e*6048e5),Kr=e=>Jhe(e,{onMillis:t=>t,onNanos:t=>Number(t)/1e6});var g4=e=>{let t=Qe(e);switch(t.value._tag){case"Infinity":return g();case"Nanos":return x(t.value.nanos);case"Millis":return x(BigInt(Math.round(t.value.millis*1e6)))}},Khe=e=>{let t=Qe(e);switch(t.value._tag){case"Infinity":throw new Error("Cannot convert infinite duration to nanos");case"Nanos":return t.value.nanos;case"Millis":return BigInt(Math.round(t.value.millis*1e6))}},Qhe=e=>{let t=Qe(e);switch(t.value._tag){case"Infinity":return[1/0,0];case"Nanos":return[Number(t.value.nanos/d4),Number(t.value.nanos%d4)];case"Millis":return[Math.floor(t.value.millis/1e3),Math.round(t.value.millis%1e3*1e6)]}},Jhe=u(2,(e,t)=>{let r=Qe(e);switch(r.value._tag){case"Nanos":return t.onNanos(r.value.nanos);case"Infinity":return t.onMillis(1/0);case"Millis":return t.onMillis(r.value.millis)}}),gf=u(3,(e,t,r)=>{let n=Qe(e),o=Qe(t);if(n.value._tag==="Infinity"||o.value._tag==="Infinity")return r.onMillis(Kr(n),Kr(o));if(n.value._tag==="Nanos"||o.value._tag==="Nanos"){let s=n.value._tag==="Nanos"?n.value.nanos:BigInt(Math.round(n.value.millis*1e6)),i=o.value._tag==="Nanos"?o.value.nanos:BigInt(Math.round(o.value.millis*1e6));return r.onNanos(s,i)}return r.onMillis(n.value.millis,o.value.millis)}),b4=fc((e,t)=>gf(e,t,{onMillis:(r,n)=>r<n?-1:r>n?1:0,onNanos:(r,n)=>r<n?-1:r>n?1:0})),y4=kh(wh(b4,Qe)),pM=(e,t)=>gf(e,t,{onMillis:(r,n)=>r===n,onNanos:(r,n)=>r===n});var Zhe=Gu(b4),S4=u(2,(e,t)=>Zhe(Qe(e),{minimum:Qe(t.minimum),maximum:Qe(t.maximum)}));var E4=u(2,(e,t)=>gf(e,t,{onMillis:(r,n)=>Qs(r+n),onNanos:(r,n)=>Qs(r+n)})),lM=u(2,(e,t)=>gf(e,t,{onMillis:(r,n)=>r<n,onNanos:(r,n)=>r<n})),wC=u(2,(e,t)=>gf(e,t,{onMillis:(r,n)=>r<=n,onNanos:(r,n)=>r<=n})),OC=u(2,(e,t)=>gf(e,t,{onMillis:(r,n)=>r>n,onNanos:(r,n)=>r>n})),cb=u(2,(e,t)=>gf(e,t,{onMillis:(r,n)=>r>=n,onNanos:(r,n)=>r>=n})),Yhe=u(2,(e,t)=>pM(Qe(e),Qe(t))),Xhe=e=>{let t=Qe(e);if(t.value._tag==="Infinity")return{days:1/0,hours:1/0,minutes:1/0,seconds:1/0,millis:1/0,nanos:1/0};let r=Khe(t),n=r/f4,o=n/cM,s=o/EC,i=s/EC,a=i/l4;return{days:Number(a),hours:Number(i%l4),minutes:Number(s%EC),seconds:Number(o%EC),millis:Number(n%cM),nanos:Number(r%f4)}},fM=e=>{let t=Qe(e);if(t.value._tag==="Infinity")return"Infinity";if(Bhe(t))return"0";let r=Xhe(t),n=[];return r.days!==0&&n.push(`${r.days}d`),r.hours!==0&&n.push(`${r.hours}h`),r.minutes!==0&&n.push(`${r.minutes}m`),r.seconds!==0&&n.push(`${r.seconds}s`),r.millis!==0&&n.push(`${r.millis}ms`),r.nanos!==0&&n.push(`${r.nanos}ns`),n.join(" ")};var dM=Math.pow(2,5),C4=dM-1,w4=dM/2,O4=dM/4;function eme(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function dp(e,t){return t>>>e&C4}function hp(e){return 1<<e}function _C(e,t){return eme(e&t-1)}var _4=(e,t)=>({value:e,previous:t});function bf(e,t,r,n){let o=n;if(!e){let s=n.length;o=new Array(s);for(let i=0;i<s;++i)o[i]=n[i]}return o[t]=r,o}function hM(e,t,r){let n=r.length-1,o=0,s=0,i=r;if(e)o=s=t;else for(i=new Array(n);o<t;)i[s++]=r[o++];for(++o;o<=n;)i[s++]=r[o++];return e&&(i.length=n),i}function k4(e,t,r,n){let o=n.length;if(e){let c=o;for(;c>=t;)n[c--]=n[c];return n[t]=r,n}let s=0,i=0,a=new Array(o+1);for(;s<t;)a[i++]=n[s++];for(a[t]=r;s<o;)a[++i]=n[s++];return a}var Rc=class e{_tag="EmptyNode";modify(t,r,n,o,s,i){let a=n(g());return ge(a)?new e:(++i.value,new Gh(t,o,s,a))}};function Js(e){return _a(e,"EmptyNode")}function rme(e){return Js(e)||e._tag==="LeafNode"||e._tag==="CollisionNode"}function kC(e,t){return Js(e)?!1:t===e.edit}var Gh=class e{edit;hash;key;value;_tag="LeafNode";constructor(t,r,n,o){this.edit=t,this.hash=r,this.key=n,this.value=o}modify(t,r,n,o,s,i){if(N(s,this.key)){let c=n(this.value);return c===this.value?this:ge(c)?(--i.value,new Rc):kC(this,t)?(this.value=c,this):new e(t,o,s,c)}let a=n(g());return ge(a)?this:(++i.value,T4(t,r,this.hash,this,o,new e(t,o,s,a)))}},mM=class e{edit;hash;children;_tag="CollisionNode";constructor(t,r,n){this.edit=t,this.hash=r,this.children=n}modify(t,r,n,o,s,i){if(o===this.hash){let c=kC(this,t),l=this.updateCollisionList(c,t,this.hash,this.children,n,s,i);return l===this.children?this:l.length>1?new e(t,this.hash,l):l[0]}let a=n(g());return ge(a)?this:(++i.value,T4(t,r,this.hash,this,o,new Gh(t,o,s,a)))}updateCollisionList(t,r,n,o,s,i,a){let c=o.length;for(let f=0;f<c;++f){let d=o[f];if("key"in d&&N(i,d.key)){let h=d.value,m=s(h);return m===h?o:ge(m)?(--a.value,hM(t,f,o)):bf(t,f,new Gh(r,n,i,m),o)}}let l=s(g());return ge(l)?o:(++a.value,bf(t,c,new Gh(r,n,i,l),o))}},ub=class e{edit;mask;children;_tag="IndexedNode";constructor(t,r,n){this.edit=t,this.mask=r,this.children=n}modify(t,r,n,o,s,i){let a=this.mask,c=this.children,l=dp(r,o),f=hp(l),d=_C(a,f),h=a&f,m=kC(this,t);if(!h){let U=new Rc().modify(t,r+5,n,o,s,i);return U?c.length>=w4?ome(t,l,U,a,c):new e(t,a|f,k4(m,d,U,c)):this}let y=c[d],T=y.modify(t,r+5,n,o,s,i);if(y===T)return this;let C=a,O;if(Js(T)){if(C&=~f,!C)return new Rc;if(c.length<=2&&rme(c[d^1]))return c[d^1];O=hM(m,d,c)}else O=bf(m,d,T,c);return m?(this.mask=C,this.children=O,this):new e(t,C,O)}},xM=class e{edit;size;children;_tag="ArrayNode";constructor(t,r,n){this.edit=t,this.size=r,this.children=n}modify(t,r,n,o,s,i){let a=this.size,c=this.children,l=dp(r,o),f=c[l],d=(f||new Rc).modify(t,r+5,n,o,s,i);if(f===d)return this;let h=kC(this,t),m;if(Js(f)&&!Js(d))++a,m=bf(h,l,d,c);else if(!Js(f)&&Js(d)){if(--a,a<=O4)return nme(t,a,l,c);m=bf(h,l,new Rc,c)}else m=bf(h,l,d,c);return h?(this.size=a,this.children=m,this):new e(t,a,m)}};function nme(e,t,r,n){let o=new Array(t-1),s=0,i=0;for(let a=0,c=n.length;a<c;++a)if(a!==r){let l=n[a];l&&!Js(l)&&(o[s++]=l,i|=1<<a)}return new ub(e,i,o)}function ome(e,t,r,n,o){let s=[],i=n,a=0;for(let c=0;i;++c)i&1&&(s[c]=o[a++]),i>>>=1;return s[t]=r,new xM(e,a+1,s)}function sme(e,t,r,n,o,s){if(r===o)return new mM(e,r,[s,n]);let i=dp(t,r),a=dp(t,o);if(i===a)return c=>new ub(e,hp(i)|hp(a),[c]);{let c=i<a?[n,s]:[s,n];return new ub(e,hp(i)|hp(a),c)}}function T4(e,t,r,n,o,s){let i,a=t;for(;;){let c=sme(e,a,r,n,o,s);if(typeof c=="function")i=_4(c,i),a=a+5;else{let l=c;for(;i!=null;)l=i.value(l),i=i.previous;return l}}}var I4="effect/HashMap",TC=Symbol.for(I4),ame={[TC]:TC,[Symbol.iterator](){return new IC(this,(e,t)=>[e,t])},[H](){let e=M(I4);for(let t of this)e^=p(M(t[0]),G(M(t[1])));return se(this,e)},[W](e){if(bM(e)){if(e._size!==this._size)return!1;for(let t of this){let r=p(e,AC(t[0],M(t[0])));if(ge(r))return!1;if(!N(t[1],r.value))return!1}return!0}return!1},toString(){return De(this.toJSON())},toJSON(){return{_id:"HashMap",values:Array.from(this).map(ve)}},[he](){return this.toJSON()},pipe(){return v(this,arguments)}},gM=(e,t,r,n)=>{let o=Object.create(ame);return o._editable=e,o._edit=t,o._root=r,o._size=n,o},IC=class e{map;f;v;constructor(t,r){this.map=t,this.f=r,this.v=R4(this.map._root,this.f,void 0)}next(){if(ge(this.v))return{done:!0,value:void 0};let t=this.v.value;return this.v=RC(t.cont),{done:!1,value:t.value}}[Symbol.iterator](){return new e(this.map,this.f)}},RC=e=>e?A4(e[0],e[1],e[2],e[3],e[4]):g(),R4=(e,t,r=void 0)=>{switch(e._tag){case"LeafNode":return X(e.value)?x({value:t(e.key,e.value.value),cont:r}):RC(r);case"CollisionNode":case"ArrayNode":case"IndexedNode":{let n=e.children;return A4(n.length,n,0,t,r)}default:return RC(r)}},A4=(e,t,r,n,o)=>{for(;r<e;){let s=t[r++];if(s&&!Js(s))return R4(s,n,[e,t,r,n,o])}return RC(o)},cme=gM(!1,0,new Rc,0),Qh=()=>cme;var M4=e=>{let t=pb(Qh());for(let r of e)yf(t,r[0],r[1]);return SM(t)},bM=e=>F(e,TC),v4=e=>e&&Js(e._root),P4=u(2,(e,t)=>AC(e,t,M(t))),AC=u(3,(e,t,r)=>{let n=e._root,o=0;for(;;)switch(n._tag){case"LeafNode":return N(t,n.key)?n.value:g();case"CollisionNode":{if(r===n.hash){let s=n.children;for(let i=0,a=s.length;i<a;++i){let c=s[i];if("key"in c&&N(t,c.key))return c.value}}return g()}case"IndexedNode":{let s=dp(o,r),i=hp(s);if(n.mask&i){n=n.children[_C(n.mask,i)],o+=5;break}return g()}case"ArrayNode":{if(n=n.children[dp(o,r)],n){o+=5;break}return g()}default:return g()}});var yM=u(2,(e,t)=>X(AC(e,t,M(t))));var yf=u(3,(e,t,r)=>vC(e,t,()=>x(r))),ume=u(3,(e,t,r)=>e._editable?(e._root=t,e._size=r,e):t===e._root?e:gM(e._editable,e._edit,t,r)),MC=e=>new IC(e,t=>t);var Jh=e=>e._size;var pb=e=>gM(!0,e._edit+1,e._root,e._size),SM=e=>(e._editable=!1,e),F4=u(2,(e,t)=>{let r=pb(e);return t(r),SM(r)}),vC=u(3,(e,t,r)=>N4(e,t,M(t),r)),N4=u(4,(e,t,r,n)=>{let o={value:e._size},s=e._root.modify(e._editable?e._edit:NaN,0,n,r,t,o);return p(e,ume(s,o.value))});var PC=u(2,(e,t)=>vC(e,t,g));var D4=u(2,(e,t)=>Zh(e,Qh(),(r,n,o)=>yf(r,o,t(n,o))));var FC=u(2,(e,t)=>Zh(e,void 0,(r,n,o)=>t(n,o))),Zh=u(3,(e,t,r)=>{let n=e._root;if(n._tag==="LeafNode")return X(n.value)?r(t,n.value.value,n.key):t;if(n._tag==="EmptyNode")return t;let o=[n.children],s;for(;s=o.pop();)for(let i=0,a=s.length;i<a;){let c=s[i++];c&&!Js(c)&&(c._tag==="LeafNode"?X(c.value)&&(t=r(t,c.value.value,c.key)):o.push(c.children))}return t});var U4="effect/HashSet",NC=Symbol.for(U4),pme={[NC]:NC,[Symbol.iterator](){return MC(this._keyMap)},[H](){return se(this,G(M(this._keyMap))(M(U4)))},[W](e){return EM(e)?Jh(this._keyMap)===Jh(e._keyMap)&&N(this._keyMap,e._keyMap):!1},toString(){return De(this.toJSON())},toJSON(){return{_id:"HashSet",values:Array.from(this).map(ve)}},[he](){return this.toJSON()},pipe(){return v(this,arguments)}},DC=e=>{let t=Object.create(pme);return t._keyMap=e,t},EM=e=>F(e,NC),lme=DC(Qh()),lb=()=>lme,q4=e=>{let t=LC(lb());for(let r of e)Yh(t,r);return UC(t)},W4=(...e)=>{let t=LC(lb());for(let r of e)Yh(t,r);return UC(t)},H4=u(2,(e,t)=>yM(e._keyMap,t));var B4=e=>Jh(e._keyMap),LC=e=>DC(pb(e._keyMap)),UC=e=>(e._keyMap._editable=!1,e),CM=u(2,(e,t)=>{let r=LC(e);return t(r),UC(r)}),Yh=u(2,(e,t)=>e._keyMap._editable?(yf(t,!0)(e._keyMap),e):DC(yf(t,!0)(e._keyMap))),wM=u(2,(e,t)=>e._keyMap._editable?(PC(t)(e._keyMap),e):DC(PC(t)(e._keyMap))),z4=u(2,(e,t)=>CM(e,r=>{for(let n of t)wM(r,n)}));var j4=u(2,(e,t)=>CM(lb(),r=>{OM(e,n=>Yh(r,n));for(let n of t)Yh(r,n)}));var OM=u(2,(e,t)=>FC(e._keyMap,(r,n)=>t(n))),$4=u(3,(e,t,r)=>Zh(e._keyMap,t,(n,o,s)=>r(n,s)));var V4=EM,Zs=lb,mp=q4,Sf=W4,G4=H4;var Ac=B4;var zi=Yh,Ef=wM,_M=z4;var Mc=j4;var K4=OM,xp=$4;var Q4=Symbol.for("effect/MutableRef"),dme={[Q4]:Q4,toString(){return De(this.toJSON())},toJSON(){return{_id:"MutableRef",current:ve(this.current)}},[he](){return this.toJSON()},pipe(){return v(this,arguments)}},ko=e=>{let t=Object.create(dme);return t.current=e,t},qC=u(3,(e,t,r)=>N(t,e.current)?(e.current=r,!0):!1);var Ie=e=>e.current;var Fn=u(2,(e,t)=>(e.current=t,e));var BC="effect/FiberId",gp=Symbol.for(BC),Xh="None",kM="Runtime",TM="Composite",hme=Ke(`${BC}-${Xh}`),IM=class{[gp]=gp;_tag=Xh;id=-1;startTimeMillis=-1;[H](){return hme}[W](t){return db(t)&&t._tag===Xh}toString(){return De(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag}}[he](){return this.toJSON()}},WC=class{id;startTimeMillis;[gp]=gp;_tag=kM;constructor(t,r){this.id=t,this.startTimeMillis=r}[H](){return se(this,Ke(`${BC}-${this._tag}-${this.id}-${this.startTimeMillis}`))}[W](t){return db(t)&&t._tag===kM&&this.id===t.id&&this.startTimeMillis===t.startTimeMillis}toString(){return De(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,id:this.id,startTimeMillis:this.startTimeMillis}}[he](){return this.toJSON()}},HC=class{left;right;[gp]=gp;_tag=TM;constructor(t,r){this.left=t,this.right=r}_hash;[H](){return p(Ke(`${BC}-${this._tag}`),G(M(this.left)),G(M(this.right)),se(this))}[W](t){return db(t)&&t._tag===TM&&N(this.left,t.left)&&N(this.right,t.right)}toString(){return De(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,left:ve(this.left),right:ve(this.right)}}[he](){return this.toJSON()}},Cf=new IM,Z4=(e,t)=>new WC(e,t),Y4=(e,t)=>new HC(e,t),db=e=>F(e,gp);var RM=u(2,(e,t)=>e._tag===Xh?t:t._tag===Xh?e:new HC(e,t)),X4=e=>p(e,xp(Cf,(t,r)=>RM(r)(t)));var fb=e=>{switch(e._tag){case Xh:return Zs();case kM:return Sf(e.id);case TM:return p(fb(e.left),Mc(fb(e.right)))}},J4=ne(Symbol.for("effect/Fiber/Id/_fiberCounter"),()=>ko(0));var wf=e=>Array.from(fb(e)).map(r=>`#${r}`).join(",");var e5=()=>{let e=Ie(J4);return p(J4,Fn(e+1)),new WC(e,Date.now())};var Nn=Cf,t5=Z4,r5=Y4,n5=db;var MM=RM,o5=X4;var vM=fb;var s5=wf;var zC=e5;var i5=bM,Pc=Qh;var em=M4,a5=v4,PM=P4;var on=yf,FM=MC;var jC=Jh;var c5=F4,u5=vC;var p5=D4;var l5=FC,NM=Zh;var mb=Symbol.for("effect/List"),DM=e=>Ee(e),xme=e=>O1(An(e),DM),gme=xme(N),bme={[mb]:mb,_tag:"Cons",toString(){return De(this.toJSON())},toJSON(){return{_id:"List",_tag:"Cons",values:DM(this).map(ve)}},[he](){return this.toJSON()},[W](e){return $C(e)&&this._tag===e._tag&&gme(this,e)},[H](){return se(this,qo(DM(this)))},[Symbol.iterator](){let e=!1,t=this;return{next(){if(e)return this.return();if(t._tag==="Nil")return e=!0,this.return();let r=t.head;return t=t.tail,{done:e,value:r}},return(r){return e||(e=!0),{done:!0,value:r}}}},pipe(){return v(this,arguments)}},tm=(e,t)=>{let r=Object.create(bme);return r.head=e,r.tail=t,r},yme=Ke("Nil"),Sme={[mb]:mb,_tag:"Nil",toString(){return De(this.toJSON())},toJSON(){return{_id:"List",_tag:"Nil"}},[he](){return this.toJSON()},[H](){return yme},[W](e){return $C(e)&&this._tag===e._tag},[Symbol.iterator](){return{next(){return{done:!0,value:void 0}}}},pipe(){return v(this,arguments)}},hb=Object.create(Sme),$C=e=>F(e,mb),Na=e=>e._tag==="Nil",Of=e=>e._tag==="Cons";var Eme=()=>hb,Fc=(e,t)=>tm(e,t),Ys=Eme,xb=e=>tm(e,hb),VC=e=>{let t=e[Symbol.iterator](),r;if((r=t.next())&&!r.done){let n=tm(r.value,hb),o=n;for(;(r=t.next())&&!r.done;){let s=tm(r.value,hb);o.tail=s,o=s}return n}else return hb};var f5=u(2,(e,t)=>Cme(t,e)),GC=u(2,(e,t)=>Fc(t,e)),Cme=u(2,(e,t)=>{if(Na(e))return t;if(Na(t))return e;{let r=tm(t.head,e),n=r,o=t.tail;for(;!Na(o);){let s=tm(o.head,e);n.tail=s,n=s,o=o.tail}return r}});var d5=u(3,(e,t,r)=>{let n=t,o=e;for(;!Na(o);)n=r(n,o.head),o=o.tail;return n});var h5=e=>{let t=Ys(),r=e;for(;!Na(r);)t=GC(t,r.head),r=r.tail;return t};var m5=Object.assign(Object.create(Array.prototype),{[H](){return se(this,qo(this))},[W](e){return Array.isArray(e)&&this.length===e.length?this.every((t,r)=>N(t,e[r])):!1}}),Sp=(function(){function e(t){t&&Object.assign(this,t)}return e.prototype=bh,e})(),rm=e=>Object.assign(Object.create(bh),e);var wme=Symbol.for("effect/DifferContextPatch");function x5(e){return e}var bb={...Sp.prototype,[wme]:{_Value:x5,_Patch:x5}},Ome=Object.assign(Object.create(bb),{_tag:"Empty"}),_me=Object.create(Ome),UM=()=>_me,kme=Object.assign(Object.create(bb),{_tag:"AndThen"}),Tme=(e,t)=>{let r=Object.create(kme);return r.first=e,r.second=t,r},Ime=Object.assign(Object.create(bb),{_tag:"AddService"}),Rme=(e,t)=>{let r=Object.create(Ime);return r.key=e,r.service=t,r},Ame=Object.assign(Object.create(bb),{_tag:"RemoveService"}),Mme=e=>{let t=Object.create(Ame);return t.key=e,t},vme=Object.assign(Object.create(bb),{_tag:"UpdateService"}),Pme=(e,t)=>{let r=Object.create(vme);return r.key=e,r.update=t,r},g5=(e,t)=>{let r=new Map(e.unsafeMap),n=UM();for(let[o,s]of t.unsafeMap.entries())if(r.has(o)){let i=r.get(o);r.delete(o),N(i,s)||(n=gb(Pme(o,()=>s))(n))}else r.delete(o),n=gb(Rme(o,s))(n);for(let[o]of r.entries())n=gb(Mme(o))(n);return n},gb=u(2,(e,t)=>Tme(e,t)),b5=u(2,(e,t)=>{if(e._tag==="Empty")return t;let r=!1,n=V(e),o=new Map(t.unsafeMap);for(;Vt(n);){let i=Cn(n),a=to(n);switch(i._tag){case"Empty":{n=a;break}case"AddService":{o.set(i.key,i.service),n=a;break}case"AndThen":{n=Et(Et(a,i.second),i.first);break}case"RemoveService":{o.delete(i.key),n=a;break}case"UpdateService":{o.set(i.key,i.update(o.get(i.key))),r=!0,n=a;break}}}if(!r)return Vs(o);let s=new Map;for(let[i]of t.unsafeMap)o.has(i)&&(s.set(i,o.get(i)),o.delete(i));for(let[i,a]of o)s.set(i,a);return Vs(s)});var Nme=Symbol.for("effect/DifferHashSetPatch");function qM(e){return e}var QC={...Sp.prototype,[Nme]:{_Value:qM,_Key:qM,_Patch:qM}},Dme=Object.assign(Object.create(QC),{_tag:"Empty"}),Lme=Object.create(Dme),WM=()=>Lme,Ume=Object.assign(Object.create(QC),{_tag:"AndThen"}),qme=(e,t)=>{let r=Object.create(Ume);return r.first=e,r.second=t,r},Wme=Object.assign(Object.create(QC),{_tag:"Add"}),Hme=e=>{let t=Object.create(Wme);return t.value=e,t},Bme=Object.assign(Object.create(QC),{_tag:"Remove"}),zme=e=>{let t=Object.create(Bme);return t.value=e,t},y5=(e,t)=>{let[r,n]=xp([e,WM()],([o,s],i)=>G4(i)(o)?[Ef(i)(o),s]:[o,KC(Hme(i))(s)])(t);return xp(n,(o,s)=>KC(zme(s))(o))(r)},KC=u(2,(e,t)=>qme(e,t)),S5=u(2,(e,t)=>{if(e._tag==="Empty")return t;let r=t,n=V(e);for(;Vt(n);){let o=Cn(n),s=to(n);switch(o._tag){case"Empty":{n=s;break}case"AndThen":{n=Et(o.first)(Et(o.second)(s));break}case"Add":{r=zi(o.value)(r),n=s;break}case"Remove":r=Ef(o.value)(r),n=s}}return r});var $me=Symbol.for("effect/DifferReadonlyArrayPatch");function E5(e){return e}var Sb={...Sp.prototype,[$me]:{_Value:E5,_Patch:E5}},Vme=Object.assign(Object.create(Sb),{_tag:"Empty"}),Gme=Object.create(Vme),HM=()=>Gme,Kme=Object.assign(Object.create(Sb),{_tag:"AndThen"}),Qme=(e,t)=>{let r=Object.create(Kme);return r.first=e,r.second=t,r},Jme=Object.assign(Object.create(Sb),{_tag:"Append"}),Zme=e=>{let t=Object.create(Jme);return t.values=e,t},Yme=Object.assign(Object.create(Sb),{_tag:"Slice"}),Xme=(e,t)=>{let r=Object.create(Yme);return r.from=e,r.until=t,r},exe=Object.assign(Object.create(Sb),{_tag:"Update"}),txe=(e,t)=>{let r=Object.create(exe);return r.index=e,r.patch=t,r},C5=e=>{let t=0,r=HM();for(;t<e.oldValue.length&&t<e.newValue.length;){let n=e.oldValue[t],o=e.newValue[t],s=e.differ.diff(n,o);N(s,e.differ.empty)||(r=yb(r,txe(t,s))),t=t+1}return t<e.oldValue.length&&(r=yb(r,Xme(0,t))),t<e.newValue.length&&(r=yb(r,Zme(Az(t)(e.newValue)))),r},yb=u(2,(e,t)=>Qme(e,t)),w5=u(3,(e,t,r)=>{if(e._tag==="Empty")return t;let n=t.slice(),o=Vr(e);for(;Ii(o);){let s=Lr(o),i=Ri(o);switch(s._tag){case"Empty":{o=i;break}case"AndThen":{i.unshift(s.first,s.second),o=i;break}case"Append":{for(let a of s.values)n.push(a);o=i;break}case"Slice":{n=n.slice(s.from,s.until),o=i;break}case"Update":{n[s.index]=r.patch(s.patch,n[s.index]),o=i;break}}}return n});var O5=Symbol.for("effect/Differ"),nxe={[O5]:{_P:R,_V:R},pipe(){return v(this,arguments)}},Ep=e=>{let t=Object.create(nxe);return t.empty=e.empty,t.diff=e.diff,t.combine=e.combine,t.patch=e.patch,t},BM=()=>Ep({empty:UM(),combine:(e,t)=>gb(t)(e),diff:(e,t)=>g5(e,t),patch:(e,t)=>b5(t)(e)});var zM=()=>Ep({empty:WM(),combine:(e,t)=>KC(t)(e),diff:(e,t)=>y5(e,t),patch:(e,t)=>S5(t)(e)});var jM=e=>Ep({empty:HM(),combine:(t,r)=>yb(t,r),diff:(t,r)=>C5({oldValue:t,newValue:r,differ:e}),patch:(t,r)=>w5(t,r,e)});var JC=()=>_5((e,t)=>t),_5=e=>Ep({empty:R,combine:(t,r)=>t===R?r:r===R?t:n=>r(t(n)),diff:(t,r)=>N(t,r)?R:ah(r),patch:(t,r)=>e(r,t(r))});var Eb=255,k5=8,ZC=e=>e&Eb,YC=e=>e>>k5&Eb,_f=(e,t)=>(e&Eb)+((t&e&Eb)<<k5),XC=_f(0,0),T5=e=>_f(e,e),I5=e=>_f(e,0);var R5=u(2,(e,t)=>_f(ZC(e)&~t,YC(e)));var VM=u(2,(e,t)=>e|t);var A5=e=>~e>>>0&Eb;var oxe=0,ji=1,v5=2,GM=4,ew=16,KM=32;var P5=e=>nw(e,KM),tw=u(2,(e,t)=>e&~t);var rw=u(2,(e,t)=>e|t);var Nc=e=>Cb(e)&&!sxe(e),Cb=e=>nw(e,ji);var nw=u(2,(e,t)=>(e&t)!==0),QM=(...e)=>e.reduce((t,r)=>t|r,0),F5=QM(oxe);var JM=e=>nw(e,GM);var sxe=e=>nw(e,ew);var Xs=u(2,(e,t)=>_f(e^t,t)),Dc=u(2,(e,t)=>e&(A5(ZC(t))|YC(t))|ZC(t)&YC(t));var ZM=Ep({empty:XC,diff:(e,t)=>Xs(e,t),combine:(e,t)=>VM(t)(e),patch:(e,t)=>Dc(t,e)});var N5=XC;var YM=T5,XM=I5;var ev=R5;var D5={_tag:"Empty"},ov=(e,t)=>({_tag:"Par",left:e,right:t}),ow=(e,t)=>({_tag:"Seq",left:e,right:t}),sv=(e,t)=>({_tag:"Single",dataSource:e,blockedRequest:t});var L5=e=>{let t=xb(e),r=Ys();for(;;){let[n,o]=d5(t,[U5(),Ys()],([s,i],a)=>{let[c,l]=ixe(a);return[dxe(s,c),f5(i,l)]});if(r=axe(r,n),Na(o))return h5(r);t=o}throw new Error("BUG: BlockedRequests.flatten - please report an issue at https://github.com/Effect-TS/effect/issues")},ixe=e=>{let t=e,r=U5(),n=Ys(),o=Ys();for(;;)switch(t._tag){case"Empty":{if(Na(n))return[r,o];t=n.head,n=n.tail;break}case"Par":{n=Fc(t.right,n),t=t.left;break}case"Seq":{let s=t.left,i=t.right;switch(s._tag){case"Empty":{t=i;break}case"Par":{let a=s.left,c=s.right;t=ov(ow(a,i),ow(c,i));break}case"Seq":{let a=s.left,c=s.right;t=ow(a,ow(c,i));break}case"Single":{t=s,o=Fc(i,o);break}}break}case"Single":{if(r=fxe(r,t),Na(n))return[r,o];t=n.head,n=n.tail;break}}throw new Error("BUG: BlockedRequests.step - please report an issue at https://github.com/Effect-TS/effect/issues")},axe=(e,t)=>{if(Na(e))return xb(rv(t));if(hxe(t))return e;let r=Sxe(e.head),n=mxe(t);return r.length===1&&n.length===1&&N(r[0],n[0])?Fc(yxe(e.head,rv(t)),e.tail):Fc(rv(t),e)},cxe=Symbol.for("effect/RequestBlock/Entry"),nv=class{request;result;listeners;ownerId;state;[cxe]=uxe;constructor(t,r,n,o,s){this.request=t,this.result=r,this.listeners=n,this.ownerId=o,this.state=s}},uxe={_R:e=>e};var iv=e=>new nv(e.request,e.result,e.listeners,e.ownerId,e.state),pxe=Symbol.for("effect/RequestBlock/RequestBlockParallel"),lxe={_R:e=>e},Ob=class{map;[pxe]=lxe;constructor(t){this.map=t}},U5=()=>new Ob(Pc());var fxe=(e,t)=>new Ob(u5(e.map,t.dataSource,r=>$1(ct(r,Pn(t.blockedRequest)),()=>V(t.blockedRequest)))),dxe=(e,t)=>new Ob(NM(e.map,t.map,(r,n,o)=>on(r,o,j(PM(r,o),{onNone:()=>n,onSome:s=>We(n,s)})))),hxe=e=>a5(e.map),mxe=e=>Array.from(FM(e.map)),rv=e=>bxe(p5(e.map,t=>V(t))),xxe=Symbol.for("effect/RequestBlock/RequestBlockSequential"),gxe={_R:e=>e},sw=class{map;[xxe]=gxe;constructor(t){this.map=t}},bxe=e=>new sw(e),yxe=(e,t)=>new sw(NM(t.map,e.map,(r,n,o)=>on(r,o,j(PM(r,o),{onNone:()=>ee(),onSome:s=>We(s,n)}))));var Sxe=e=>Array.from(FM(e.map)),q5=e=>Array.from(e.map);var Cp="Empty",wp="Fail",kf="Interrupt",Tf="Parallel",If="Sequential";var z5="effect/Cause",cv=Symbol.for(z5),Cxe={_E:e=>e},om={[cv]:Cxe,[H](){return p(M(z5),G(M(Oxe(this))),se(this))},[W](e){return _b(e)&&wxe(this,e)},pipe(){return v(this,arguments)},toJSON(){switch(this._tag){case"Empty":return{_id:"Cause",_tag:this._tag};case"Die":return{_id:"Cause",_tag:this._tag,defect:ve(this.defect)};case"Interrupt":return{_id:"Cause",_tag:this._tag,fiberId:this.fiberId.toJSON()};case"Fail":return{_id:"Cause",_tag:this._tag,failure:ve(this.error)};case"Sequential":case"Parallel":return{_id:"Cause",_tag:this._tag,left:ve(this.left),right:ve(this.right)}}},toString(){return zo(this)},[he](){return this.toJSON()}},Dn=(()=>{let e=Object.create(om);return e._tag=Cp,e})(),$i=e=>{let t=Object.create(om);return t._tag=wp,t.error=e,t},Fr=e=>{let t=Object.create(om);return t._tag="Die",t.defect=e,t},To=e=>{let t=Object.create(om);return t._tag=kf,t.fiberId=e,t},Qr=(e,t)=>{let r=Object.create(om);return r._tag=Tf,r.left=e,r.right=t,r},Rt=(e,t)=>{let r=Object.create(om);return r._tag=If,r.left=e,r.right=t,r},_b=e=>F(e,cv),uv=e=>e._tag===Cp,j5=e=>e._tag===wp,Mf=e=>e._tag==="Die";var vf=e=>e._tag===Cp?!0:Rf(e,!0,(t,r)=>{switch(r._tag){case Cp:return x(t);case"Die":case wp:case kf:return x(!1);default:return g()}});var sm=e=>X(V5(e)),Pf=e=>uw(void 0,kxe)(e),kb=e=>gs(Rf(e,ee(),(t,r)=>r._tag===wp?x(p(t,Et(r.error))):g())),Ff=e=>gs(Rf(e,ee(),(t,r)=>r._tag==="Die"?x(p(t,Et(r.defect))):g())),Nf=e=>Rf(e,Zs(),(t,r)=>r._tag===kf?x(p(t,zi(r.fiberId))):g()),aw=e=>Op(e,t=>t._tag===wp?x(t.error):g()),Vi=e=>{let t=aw(e);switch(t._tag){case"None":return Z(e);case"Some":return $(t.value)}};var $5=e=>Df(e,{onEmpty:x(Dn),onFail:ct($i),onDie:t=>x(Fr(t)),onInterrupt:t=>x(To(t)),onSequential:Ju(Rt),onParallel:Ju(Qr)}),V5=e=>Op(e,t=>t._tag===kf?x(t.fiberId):g()),pv=e=>Df(e,{onEmpty:g(),onFail:()=>g(),onDie:t=>x(Fr(t)),onInterrupt:()=>g(),onSequential:Ju(Rt),onParallel:Ju(Qr)}),G5=e=>Df(e,{onEmpty:g(),onFail:t=>x(Fr(t)),onDie:t=>x(Fr(t)),onInterrupt:()=>g(),onSequential:Ju(Rt),onParallel:Ju(Qr)});var cw=e=>Df(e,{onEmpty:Dn,onFail:()=>Dn,onDie:Fr,onInterrupt:To,onSequential:Rt,onParallel:Qr}),K5=e=>Df(e,{onEmpty:Dn,onFail:Fr,onDie:Fr,onInterrupt:To,onSequential:Rt,onParallel:Qr});var Tb=u(2,(e,t)=>lv(e,r=>$i(t(r)))),lv=u(2,(e,t)=>Df(e,{onEmpty:Dn,onFail:r=>t(r),onDie:r=>Fr(r),onInterrupt:r=>To(r),onSequential:(r,n)=>Rt(r,n),onParallel:(r,n)=>Qr(r,n)})),fv=e=>lv(e,R);var wxe=(e,t)=>{let r=V(e),n=V(t);for(;Vt(r)&&Vt(n);){let[o,s]=p(Cn(r),Rf([Zs(),ee()],([c,l],f)=>{let[d,h]=av(f);return x([p(c,Mc(d)),p(l,We(h))])})),[i,a]=p(Cn(n),Rf([Zs(),ee()],([c,l],f)=>{let[d,h]=av(f);return x([p(c,Mc(d)),p(l,We(h))])}));if(!N(o,i))return!1;r=s,n=a}return!0},Oxe=e=>_xe(V(e),ee()),_xe=(e,t)=>{for(;;){let[r,n]=p(e,mc([Zs(),ee()],([s,i],a)=>{let[c,l]=av(a);return[p(s,Mc(c)),p(i,We(l))]})),o=Ac(r)>0?p(t,Et(r)):t;if(le(n))return gs(o);e=n,t=o}throw new Error(ql("Cause.flattenCauseLoop"))},Op=u(2,(e,t)=>{let r=[e];for(;r.length>0;){let n=r.pop(),o=t(n);switch(o._tag){case"None":{switch(n._tag){case If:case Tf:{r.push(n.right),r.push(n.left);break}}break}case"Some":return o}}return g()});var av=e=>{let t=e,r=[],n=Zs(),o=ee();for(;t!==void 0;)switch(t._tag){case Cp:{if(r.length===0)return[n,o];t=r.pop();break}case wp:{if(n=zi(n,fp(t._tag,t.error)),r.length===0)return[n,o];t=r.pop();break}case"Die":{if(n=zi(n,fp(t._tag,t.defect)),r.length===0)return[n,o];t=r.pop();break}case kf:{if(n=zi(n,fp(t._tag,t.fiberId)),r.length===0)return[n,o];t=r.pop();break}case If:{switch(t.left._tag){case Cp:{t=t.right;break}case If:{t=Rt(t.left.left,Rt(t.left.right,t.right));break}case Tf:{t=Qr(Rt(t.left.left,t.right),Rt(t.left.right,t.right));break}default:{o=Et(o,t.right),t=t.left;break}}break}case Tf:{r.push(t.right),t=t.left;break}}throw new Error(ql("Cause.evaluateCauseLoop"))};var kxe={emptyCase:zr,failCase:ls,dieCase:ls,interruptCase:zr,sequentialCase:(e,t,r)=>t&&r,parallelCase:(e,t,r)=>t&&r};var H5="SequentialCase",B5="ParallelCase",Df=u(2,(e,{onDie:t,onEmpty:r,onFail:n,onInterrupt:o,onParallel:s,onSequential:i})=>uw(e,void 0,{emptyCase:()=>r,failCase:(a,c)=>n(c),dieCase:(a,c)=>t(c),interruptCase:(a,c)=>o(c),sequentialCase:(a,c,l)=>i(c,l),parallelCase:(a,c,l)=>s(c,l)})),Rf=u(3,(e,t,r)=>{let n=t,o=e,s=[];for(;o!==void 0;){let i=r(n,o);switch(n=X(i)?i.value:n,o._tag){case If:{s.push(o.right),o=o.left;break}case Tf:{s.push(o.right),o=o.left;break}default:{o=void 0;break}}o===void 0&&s.length>0&&(o=s.pop())}return n}),uw=u(3,(e,t,r)=>{let n=[e],o=[];for(;n.length>0;){let i=n.pop();switch(i._tag){case Cp:{o.push(Z(r.emptyCase(t)));break}case wp:{o.push(Z(r.failCase(t,i.error)));break}case"Die":{o.push(Z(r.dieCase(t,i.defect)));break}case kf:{o.push(Z(r.interruptCase(t,i.fiberId)));break}case If:{n.push(i.right),n.push(i.left),o.push($({_tag:H5}));break}case Tf:{n.push(i.right),n.push(i.left),o.push($({_tag:B5}));break}}}let s=[];for(;o.length>0;){let i=o.pop();switch(i._tag){case"Left":{switch(i.left._tag){case H5:{let a=s.pop(),c=s.pop(),l=r.sequentialCase(t,a,c);s.push(l);break}case B5:{let a=s.pop(),c=s.pop(),l=r.parallelCase(t,a,c);s.push(l);break}}break}case"Right":{s.push(i.right);break}}}if(s.length===0)throw new Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return s.pop()}),zo=(e,t)=>Pf(e)?"All fibers interrupted without errors.":lw(e).map(function(r){return t?.renderErrorCause!==!0||r.cause===void 0?r.stack:`${r.stack} {
${Q5(r.cause,"  ")}
}`}).join(`
`),Q5=(e,t)=>{let r=e.stack.split(`
`),n=`${t}[cause]: ${r[0]}`;for(let o=1,s=r.length;o<s;o++)n+=`
${t}${r[o]}`;return e.cause&&(n+=` {
${Q5(e.cause,`${t}  `)}
${t}}`),n},iw=class e extends globalThis.Error{span=void 0;constructor(t){let r=typeof t=="object"&&t!==null,n=Error.stackTraceLimit;Error.stackTraceLimit=1,super(pw(t),r&&"cause"in t&&typeof t.cause<"u"?{cause:new e(t.cause)}:void 0),this.message===""&&(this.message="An error has occurred"),Error.stackTraceLimit=n,this.name=t instanceof Error?t.name:"Error",r&&(Af in t&&(this.span=t[Af]),Object.keys(t).forEach(o=>{o in this||(this[o]=t[o])})),this.stack=Ixe(`${this.name}: ${this.message}`,t instanceof Error&&t.stack?t.stack:"",this.span)}},pw=e=>{if(typeof e=="string")return e;if(typeof e=="object"&&e!==null&&e instanceof Error)return e.message;try{if(F(e,"toString")&&_i(e.toString)&&e.toString!==Object.prototype.toString&&e.toString!==globalThis.Array.prototype.toString)return e.toString()}catch{}return Cg(e)},Txe=/\((.*)\)/g,Ib=ne("effect/Tracer/spanToTrace",()=>new WeakMap),Ixe=(e,t,r)=>{let n=[e],o=t.startsWith(e)?t.slice(e.length).split(`
`):t.split(`
`);for(let s=1;s<o.length;s++){if(o[s].includes(" at new BaseEffectError")||o[s].includes(" at new YieldableError")){s++;continue}if(o[s].includes("Generator.next")||o[s].includes("effect_internal_function"))break;n.push(o[s].replace(/at .*effect_instruction_i.*\((.*)\)/,"at $1").replace(/EffectPrimitive\.\w+/,"<anonymous>"))}if(r){let s=r,i=0;for(;s&&s._tag==="Span"&&i<10;){let a=Ib.get(s);if(typeof a=="function"){let c=a();if(typeof c=="string"){let l=c.matchAll(Txe),f=!1;for(let[,d]of l)f=!0,n.push(`    at ${s.name} (${d})`);f||n.push(`    at ${s.name} (${c.replace(/^at /,"")})`)}else n.push(`    at ${s.name}`)}else n.push(`    at ${s.name}`);s=yr(s.parent),i++}}return n.join(`
`)},Af=Symbol.for("effect/SpanAnnotation"),lw=e=>uw(e,void 0,{emptyCase:()=>[],dieCase:(t,r)=>[new iw(r)],failCase:(t,r)=>[new iw(r)],interruptCase:()=>[],parallelCase:(t,r,n)=>[...r,...n],sequentialCase:(t,r,n)=>[...r,...n]});var _p="Pending",Lf="Done";var Rxe="effect/Deferred",Z5=Symbol.for(Rxe),Y5={_E:e=>e,_A:e=>e},X5=e=>({_tag:_p,joiners:e}),dv=e=>({_tag:Lf,effect:e});var kp=class e{self;called=!1;constructor(t){this.self=t}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new e(this.self)}};var Lc=(e,t)=>{let r=new Tr("Blocked");return r.effect_instruction_i0=e,r.effect_instruction_i1=t,r},bw=e=>{let t=new Tr("RunBlocked");return t.effect_instruction_i0=e,t},Uc=Symbol.for("effect/Effect"),fw=class{patch;op;_op=wg;constructor(t,r){this.patch=t,this.op=r}},Tr=class{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[Uc]=Ta;constructor(t){this._op=t}[W](t){return this===t}[H](){return se(this,zu(this))}pipe(){return v(this,arguments)}toJSON(){return{_id:"Effect",_op:this._op,effect_instruction_i0:ve(this.effect_instruction_i0),effect_instruction_i1:ve(this.effect_instruction_i1),effect_instruction_i2:ve(this.effect_instruction_i2)}}toString(){return De(this.toJSON())}[he](){return this.toJSON()}[Symbol.iterator](){return new kp(new qs(this))}},dw=class{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[Uc]=Ta;constructor(t){this._op=t,this._tag=t}[W](t){return mm(t)&&t._op==="Failure"&&N(this.effect_instruction_i0,t.effect_instruction_i0)}[H](){return p(Ke(this._tag),G(M(this.effect_instruction_i0)),se(this))}get cause(){return this.effect_instruction_i0}pipe(){return v(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,cause:this.cause.toJSON()}}toString(){return De(this.toJSON())}[he](){return this.toJSON()}[Symbol.iterator](){return new kp(new qs(this))}},hw=class{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[Uc]=Ta;constructor(t){this._op=t,this._tag=t}[W](t){return mm(t)&&t._op==="Success"&&N(this.effect_instruction_i0,t.effect_instruction_i0)}[H](){return p(Ke(this._tag),G(M(this.effect_instruction_i0)),se(this))}get value(){return this.effect_instruction_i0}pipe(){return v(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,value:ve(this.value)}}toString(){return De(this.toJSON())}[he](){return this.toJSON()}[Symbol.iterator](){return new kp(new qs(this))}},et=e=>F(e,Uc),de=e=>{let t=new Tr(fE);return t.effect_instruction_i0=e,t},yw=u(3,(e,t,r)=>er(n=>b(e,o=>b(pr(q(()=>n(t(o)))),s=>q(()=>r(o,s)).pipe(Gt({onFailure:i=>{switch(s._tag){case mt:return Re(Rt(s.effect_instruction_i0,i));case xt:return Re(i)}},onSuccess:()=>s})))))),tt=u(2,(e,t)=>b(e,()=>S(t))),Ct=e=>tt(e,void 0),vb=function(){let e=new Tr(uc);switch(arguments.length){case 2:{e.effect_instruction_i0=arguments[0],e.commit=arguments[1];break}case 3:{e.effect_instruction_i0=arguments[0],e.effect_instruction_i1=arguments[1],e.commit=arguments[2];break}case 4:{e.effect_instruction_i0=arguments[0],e.effect_instruction_i1=arguments[1],e.effect_instruction_i2=arguments[2],e.commit=arguments[3];break}default:throw new Error(ql("you're not supposed to end up here"))}return e},im=(e,t=Nn)=>{let r=new Tr(Bl),n;return r.effect_instruction_i0=o=>{n=e(o)},r.effect_instruction_i1=t,so(r,o=>et(n)?n:ae)},Pb=(e,t=Nn)=>q(()=>im(e,t)),no=(e,t=Nn)=>vb(e,function(){let r,n;function o(c){r?r(c):n===void 0&&(n=c)}let s=new Tr(Bl);s.effect_instruction_i0=c=>{r=c,n&&c(n)},s.effect_instruction_i1=t;let i,a;return this.effect_instruction_i0.length!==1?(a=new AbortController,i=rt(()=>this.effect_instruction_i0(o,a.signal))):i=rt(()=>this.effect_instruction_i0(o)),i||a?so(s,c=>(a&&a.abort(),i??ae)):s});var La=u(2,(e,t)=>{let r=new Tr(dh);return r.effect_instruction_i0=e,r.effect_instruction_i1=t,r}),Ss=u(2,(e,t)=>Jr(e,{onFailure:t,onSuccess:S})),Fb=u(3,(e,t,r)=>La(e,n=>{let o=Vi(n);switch(o._tag){case"Left":return t(o.left)?r(o.left):Re(n);case"Right":return Re(o.right)}})),r$=u(2,(e,t)=>La(e,r=>{let n=Vi(r);switch(n._tag){case"Left":return p(t(n.left),_e(()=>Re(r)));case"Right":return Re(n.right)}})),n$=e=>de((t,r)=>e(Cb(r.runtimeFlags))),e$=Symbol.for("effect/OriginalAnnotation");var Sw=(e,t)=>X(t)?new Proxy(e,{has(r,n){return n===Af||n===e$||n in r},get(r,n){return n===Af?t.value:n===e$?e:r[n]}}):e,oo=e=>jr(e)&&!(Af in e)?de(t=>Re(Fr(Sw(e,vw(t))))):Re(Fr(e)),Ip=e=>qc(()=>Fr(new Tv(e))),Rp=e=>b(E(e),oo),ei=e=>Jr(e,{onFailure:t=>S($(t)),onSuccess:t=>S(Z(t))}),pr=e=>Nb(e,{onFailure:Be,onSuccess:ht}),ke=e=>jr(e)&&!(Af in e)?de(t=>Re($i(Sw(e,vw(t))))):Re($i(e)),ti=e=>b(E(e),ke),Re=e=>{let t=new dw(mt);return t.effect_instruction_i0=e,t},qc=e=>b(E(e),Re),ri=de(e=>S(e.id())),jo=e=>de(t=>e(t.id())),b=u(2,(e,t)=>{let r=new Tr(hh);return r.effect_instruction_i0=e,r.effect_instruction_i1=t,r}),Ap=u(2,(e,t)=>b(e,r=>{let n=typeof t=="function"?t(r):t;return et(n)?n:k1(n)?im(o=>{n.then(s=>o(S(s)),s=>o(ke(new hm(s,"An unknown error occurred in Effect.andThen"))))}):S(n)})),Ew=e=>{let t=new Tr("OnStep");return t.effect_instruction_i0=e,t},$o=e=>b(e,R),Mp=e=>Jr(e,{onFailure:S,onSuccess:ke}),Nb=u(2,(e,t)=>Gt(e,{onFailure:r=>S(t.onFailure(r)),onSuccess:r=>S(t.onSuccess(r))})),Gt=u(2,(e,t)=>{let r=new Tr(mh);return r.effect_instruction_i0=e,r.effect_instruction_i1=t.onFailure,r.effect_instruction_i2=t.onSuccess,r}),Jr=u(2,(e,t)=>Gt(e,{onFailure:r=>{if(Ff(r).length>0)return Re(K5(r));let o=kb(r);return o.length>0?t.onFailure(ib(o)):Re(r)},onSuccess:t.onSuccess})),Ln=u(2,(e,t)=>q(()=>{let r=Ee(e),n=Gl(r.length),o=0;return tt(Fp({while:()=>o<r.length,body:()=>t(r[o],o),step:s=>{n[o++]=s}}),n)})),Vo=u(2,(e,t)=>q(()=>{let r=Ee(e),n=0;return Fp({while:()=>n<r.length,body:()=>t(r[n],n),step:()=>{n++}})})),Cw=u(e=>typeof e[0]=="boolean"||et(e[0]),(e,t)=>et(e)?b(e,r=>r?t.onTrue():t.onFalse()):e?t.onTrue():t.onFalse()),Xt=b(ri,e=>Db(e)),Db=e=>Re(To(e)),Gi=e=>{let t=new Tr(pc);return t.effect_instruction_i0=YM(ji),t.effect_instruction_i1=()=>e,t},o$=e=>vb(e,function(){let t=new Tr(pc);return t.effect_instruction_i0=YM(ji),t.effect_instruction_i1=r=>Cb(r)?rt(()=>this.effect_instruction_i0(Gi)):rt(()=>this.effect_instruction_i0(Go)),t}),Ua=u(2,(e,t)=>er(r=>b(pr(r(e)),n=>Pv(t,n)))),_=u(2,(e,t)=>b(e,r=>E(()=>t(r)))),Lb=u(2,(e,t)=>Jr(e,{onFailure:r=>ti(()=>t.onFailure(r)),onSuccess:r=>E(()=>t.onSuccess(r))})),vp=u(2,(e,t)=>Gt(e,{onFailure:r=>{let n=Vi(r);switch(n._tag){case"Left":return ti(()=>t(n.left));case"Right":return Re(n.right)}},onSuccess:S})),ww=u(2,(e,t)=>Io(e,r=>Kb(r)?ae:t(r.effect_instruction_i0))),Io=u(2,(e,t)=>er(r=>Gt(r(e),{onFailure:n=>{let o=Be(n);return Gt(t(o),{onFailure:s=>Be(Rt(n,s)),onSuccess:()=>o})},onSuccess:n=>{let o=ht(n);return we(t(o),o)}}))),so=u(2,(e,t)=>Io(e,Vf({onFailure:r=>Pf(r)?Ct(t(Nf(r))):ae,onSuccess:()=>ae}))),Uf=u(2,(e,t)=>Mxe(e,t,S)),qf=e=>yv(e,R),yv=u(2,(e,t)=>Jr(e,{onFailure:r=>oo(t(r)),onSuccess:S})),s$=uR,am=de((e,t)=>S(t.runtimeFlags)),S=e=>{let t=new hw(xt);return t.effect_instruction_i0=e,t},q=e=>{let t=new Tr(uc);return t.commit=e,t},E=e=>{let t=new Tr(lE);return t.effect_instruction_i0=e,t},Nr=u(e=>e.length===3||e.length===2&&!(jr(e[1])&&"onlyEffect"in e[1]),(e,t)=>b(e,r=>{let n=typeof t=="function"?t(r):t;return et(n)?tt(n,r):k1(n)?im(o=>{n.then(s=>o(S(r)),s=>o(ke(new hm(s,"An unknown error occurred in Effect.tap"))))}):S(r)})),Ow=e=>de(t=>{let r=t.getFiberRef(Mb),n=p(r,_e(()=>t.scope()));return e(Lt(Mb,x(n)))}),Mxe=u(3,(e,t,r)=>Gt(e,{onFailure:n=>Ff(n).length>0?Re(vg(G5(n))):t(),onSuccess:r})),Go=e=>{let t=new Tr(pc);return t.effect_instruction_i0=XM(ji),t.effect_instruction_i1=()=>e,t},er=e=>vb(e,function(){let t=new Tr(pc);return t.effect_instruction_i0=XM(ji),t.effect_instruction_i1=r=>Cb(r)?rt(()=>this.effect_instruction_i0(Gi)):rt(()=>this.effect_instruction_i0(Go)),t}),ae=S(void 0);var Pp=e=>{let t=new Tr(pc);return t.effect_instruction_i0=e,t.effect_instruction_i1=void 0,t},Ki=u(2,(e,t)=>b(t,r=>r?p(e,_(x)):S(g()))),Fp=e=>{let t=new Tr(xh);return t.effect_instruction_i0=e.while,t.effect_instruction_i1=e.body,t.effect_instruction_i2=e.step,t},Ab=e=>q(()=>{let t=new Tr(zl);return t.effect_instruction_i0=e(),t}),_w=function(){let e=arguments.length===1?arguments[0]:arguments[1].bind(arguments[0]);return Ab(()=>e(p))},cm=(e,...t)=>Object.defineProperty(t.length===0?function(...r){return Ab(()=>e.apply(this,r))}:function(...r){let n=Ab(()=>e.apply(this,r));for(let o of t)n=o(n,...r);return n},"length",{value:e.length,configurable:!0}),i$=u(2,(e,t)=>Lt(e,Bb,t)),a$=u(2,(e,t)=>Lt(e,pm,t)),kw=u(2,(e,t)=>{let r=new Tr(pc);return r.effect_instruction_i0=t,r.effect_instruction_i1=()=>e,r}),c$=u(2,(e,t)=>Lt(e,fm,t)),u$=u(2,(e,t)=>Lt(e,Ba,t)),qa=e=>{let t=new Tr(gh);return typeof e?.priority<"u"?kv(t,e.priority):t},Wf=u(2,(e,t)=>b(e,r=>_(t,n=>[r,n])));var Hf=u(2,(e,t)=>b(e,r=>tt(t,r))),we=u(2,(e,t)=>b(e,()=>t)),Wa=u(3,(e,t,r)=>b(e,n=>_(t,o=>r(n,o)))),Np=Pb(()=>{let e=setInterval(()=>{},2147483647);return E(()=>clearInterval(e))}),Wc=e=>b(ri,t=>p(e,Ko(t))),Ko=u(2,(e,t)=>b(e.interruptAsFork(t),()=>e.await)),Sv={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER,pipe(){return v(this,arguments)}},Ev={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:5e4,pipe(){return v(this,arguments)}},Cv={_tag:"Error",syslog:3,label:"ERROR",ordinal:4e4,pipe(){return v(this,arguments)}},Tw={_tag:"Warning",syslog:4,label:"WARN",ordinal:3e4,pipe(){return v(this,arguments)}},um={_tag:"Info",syslog:6,label:"INFO",ordinal:2e4,pipe(){return v(this,arguments)}},Iw={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4,pipe(){return v(this,arguments)}},wv={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0,pipe(){return v(this,arguments)}},Ov={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER,pipe(){return v(this,arguments)}},p$=[Sv,wv,Iw,um,Tw,Cv,Ev,Ov],vxe="effect/FiberRef",l$=Symbol.for(vxe),Pxe={_A:e=>e},Ro=e=>de(t=>ht(t.getFiberRef(e)));var qr=u(2,(e,t)=>b(Ro(e),t)),Tp=u(2,(e,t)=>f$(e,()=>[void 0,t]));var f$=u(2,(e,t)=>de(r=>{let[n,o]=t(r.getFiberRef(e));return r.setFiberRef(e,o),S(n)}));var Fxe="effect/RequestResolver",d$=Symbol.for(Fxe),Nxe={_A:e=>e,_R:e=>e},t$=class e{runAll;target;[d$]=Nxe;constructor(t,r){this.runAll=t,this.target=r}[H](){return se(this,this.target?M(this.target):zu(this))}[W](t){return this.target?Dxe(t)&&N(this.target,t.target):this===t}identified(...t){return new e(this.runAll,pt(t))}pipe(){return v(this,arguments)}},Dxe=e=>F(e,d$);var Lt=u(3,(e,t,r)=>yw(Hf(Ro(t),Tp(t,r)),()=>e,n=>Tp(t,n))),Zr=u(3,(e,t,r)=>qr(t,n=>Lt(e,t,r(n)))),lr=(e,t)=>Dp(e,{differ:JC(),fork:t?.fork??R,join:t?.join}),_v=e=>{let t=zM();return Dp(e,{differ:t,fork:t.empty})},Lxe=e=>{let t=jM(JC());return Dp(e,{differ:t,fork:t.empty})},Ub=e=>{let t=BM();return Dp(e,{differ:t,fork:t.empty})},Dp=(e,t)=>({...ki,[l$]:Pxe,initial:e,commit(){return Ro(this)},diff:(n,o)=>t.differ.diff(n,o),combine:(n,o)=>t.differ.combine(n,o),patch:n=>o=>t.differ.patch(n,o),fork:t.fork,join:t.join??((n,o)=>o)}),h$=e=>Dp(e,{differ:ZM,fork:ZM.empty}),Yr=ne(Symbol.for("effect/FiberRef/currentContext"),()=>Ub(En())),Qi=ne(Symbol.for("effect/FiberRef/currentSchedulingPriority"),()=>lr(0)),qb=ne(Symbol.for("effect/FiberRef/currentMaxOpsBeforeYield"),()=>lr(2048)),Ha=ne(Symbol.for("effect/FiberRef/currentLogAnnotation"),()=>lr(Pc())),Wb=ne(Symbol.for("effect/FiberRef/currentLogLevel"),()=>lr(um)),Hb=ne(Symbol.for("effect/FiberRef/currentLogSpan"),()=>lr(Ys())),kv=u(2,(e,t)=>Lt(e,Qi,t)),m$=u(2,(e,t)=>Lt(e,qb,t)),Bb=ne(Symbol.for("effect/FiberRef/currentConcurrency"),()=>lr("unbounded")),pm=ne(Symbol.for("effect/FiberRef/currentRequestBatching"),()=>lr(!0)),lm=ne(Symbol.for("effect/FiberRef/currentUnhandledErrorLogLevel"),()=>lr(x(Iw))),zb=ne(Symbol.for("effect/FiberRef/versionMismatchErrorLogLevel"),()=>lr(x(Tw))),x$=u(2,(e,t)=>Lt(e,lm,t)),ni=ne(Symbol.for("effect/FiberRef/currentMetricLabels"),()=>Lxe(ds())),g$=Ro(ni),Mb=ne(Symbol.for("effect/FiberRef/currentForkScopeOverride"),()=>lr(g(),{fork:()=>g(),join:(e,t)=>e})),Lp=ne(Symbol.for("effect/FiberRef/currentInterruptedCause"),()=>lr(Dn,{fork:()=>Dn,join:(e,t)=>e})),fm=ne(Symbol.for("effect/FiberRef/currentTracerEnabled"),()=>lr(!0)),Ba=ne(Symbol.for("effect/FiberRef/currentTracerTiming"),()=>lr(!0)),Bf=ne(Symbol.for("effect/FiberRef/currentTracerSpanAnnotations"),()=>lr(Pc())),jb=ne(Symbol.for("effect/FiberRef/currentTracerSpanLinks"),()=>lr(ee())),$b=Symbol.for("effect/Scope"),Vb=Symbol.for("effect/CloseableScope"),dm=(e,t)=>e.addFinalizer(()=>Ct(t)),Up=(e,t)=>e.addFinalizer(t),Ji=(e,t)=>e.close(t),Es=(e,t)=>e.fork(t),b$=e=>y$(R)(e),y$=u(2,(e,t)=>{let r=p(e,aw,ct(t));switch(r._tag){case"None":return p(Ff(e),va,j({onNone:()=>{let n=Ee(Nf(e)).flatMap(o=>Ee(vM(o)).map(s=>`#${s}`));return new E$(n?`Interrupted by fibers: ${n.join(", ")}`:void 0)},onSome:R}));case"Some":return r.value}}),Gb=(function(){class e extends globalThis.Error{commit(){return ke(this)}toJSON(){let r={...this};return this.message&&(r.message=this.message),this.cause&&(r.cause=this.cause),r}[he](){return this.toString!==globalThis.Error.prototype.toString?this.stack?`${this.toString()}
${this.stack.split(`
`).slice(1).join(`
`)}`:this.toString():"Bun"in globalThis?zo($i(this),{renderErrorCause:!0}):this}}return Object.assign(e.prototype,F1),e})(),zf=(e,t)=>{class r extends Gb{_tag=t}return Object.assign(r.prototype,e),r.prototype.name=t,r},mw=Symbol.for("effect/Cause/errors/RuntimeException"),Tv=zf({[mw]:mw},"RuntimeException"),S$=e=>F(e,mw),xw=Symbol.for("effect/Cause/errors/InterruptedException"),E$=zf({[xw]:xw},"InterruptedException"),Iv=e=>F(e,xw),hv=Symbol.for("effect/Cause/errors/IllegalArgument"),jf=zf({[hv]:hv},"IllegalArgumentException");var gw=Symbol.for("effect/Cause/errors/NoSuchElement"),Ao=zf({[gw]:gw},"NoSuchElementException"),Rv=e=>F(e,gw),mv=Symbol.for("effect/Cause/errors/InvalidPubSubCapacityException"),C$=zf({[mv]:mv},"InvalidPubSubCapacityException"),xv=Symbol.for("effect/Cause/errors/ExceededCapacityException"),Uxe=zf({[xv]:xv},"ExceededCapacityException");var gv=Symbol.for("effect/Cause/errors/Timeout"),w$=zf({[gv]:gv},"TimeoutException"),O$=e=>new w$(`Operation timed out after '${fM(e)}'`);var bv=Symbol.for("effect/Cause/errors/UnknownException"),hm=(function(){class e extends Gb{_tag="UnknownException";error;constructor(r,n){super(n??"An unknown error occurred",{cause:r}),this.error=r}}return Object.assign(e.prototype,{[bv]:bv,name:"UnknownException"}),e})();var mm=e=>et(e)&&"_tag"in e&&(e._tag==="Success"||e._tag==="Failure"),Rw=e=>e._tag==="Failure",Kb=e=>e._tag==="Success",_$=e=>{switch(e._tag){case mt:return sm(e.effect_instruction_i0);case xt:return!1}},Av=u(2,(e,t)=>{switch(e._tag){case mt:return Be(e.effect_instruction_i0);case xt:return ht(t)}}),xm=e=>Av(e,void 0),k$=e=>{switch(e._tag){case mt:return x(e.effect_instruction_i0);case xt:return g()}},qp=(e,t)=>qxe(e,t?.parallel?Qr:Rt),Aw=e=>Be(Fr(e)),T$=u(2,(e,t)=>{switch(e._tag){case mt:return!1;case xt:return t(e.effect_instruction_i0)}}),Wp=e=>Be($i(e)),Be=e=>{let t=new dw(mt);return t.effect_instruction_i0=e,t},Mv=u(2,(e,t)=>{switch(e._tag){case mt:return Be(e.effect_instruction_i0);case xt:return t(e.effect_instruction_i0)}}),I$=u(2,(e,t)=>{switch(e._tag){case mt:return S(Be(e.effect_instruction_i0));case xt:return t(e.effect_instruction_i0)}}),R$=e=>p(e,Mv(R)),A$=u(2,(e,t)=>{switch(e._tag){case mt:return S(Be(e.effect_instruction_i0));case xt:return pr(t(e.effect_instruction_i0))}}),M$=e=>{switch(e._tag){case"Left":return Wp(e.left);case"Right":return ht(e.right)}},v$=e=>{switch(e._tag){case"None":return Wp(void 0);case"Some":return ht(e.value)}},P$=u(2,(e,t)=>{switch(e._tag){case mt:return t(e.effect_instruction_i0);case xt:return e.effect_instruction_i0}}),$f=e=>Be(To(e)),Rb=u(2,(e,t)=>{switch(e._tag){case mt:return Be(e.effect_instruction_i0);case xt:return ht(t(e.effect_instruction_i0))}}),F$=u(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case mt:return Be(p(e.effect_instruction_i0,Tb(t)));case xt:return ht(r(e.effect_instruction_i0))}}),N$=u(2,(e,t)=>{switch(e._tag){case mt:return Be(p(e.effect_instruction_i0,Tb(t)));case xt:return ht(e.effect_instruction_i0)}}),D$=u(2,(e,t)=>{switch(e._tag){case mt:return Be(t(e.effect_instruction_i0));case xt:return ht(e.effect_instruction_i0)}}),Vf=u(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case mt:return t(e.effect_instruction_i0);case xt:return r(e.effect_instruction_i0)}}),Gf=u(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case mt:return t(e.effect_instruction_i0);case xt:return r(e.effect_instruction_i0)}}),ht=e=>{let t=new hw(xt);return t.effect_instruction_i0=e,t},Xr=ht(void 0),L$=u(2,(e,t)=>oi(e,t,{onSuccess:(r,n)=>[r,n],onFailure:Rt})),U$=u(2,(e,t)=>oi(e,t,{onSuccess:(r,n)=>r,onFailure:Rt})),q$=u(2,(e,t)=>oi(e,t,{onSuccess:(r,n)=>n,onFailure:Rt})),W$=u(2,(e,t)=>oi(e,t,{onSuccess:(r,n)=>[r,n],onFailure:Qr})),H$=u(2,(e,t)=>oi(e,t,{onSuccess:(r,n)=>r,onFailure:Qr})),B$=u(2,(e,t)=>oi(e,t,{onSuccess:(r,n)=>n,onFailure:Qr})),oi=u(3,(e,t,{onFailure:r,onSuccess:n})=>{switch(e._tag){case mt:switch(t._tag){case xt:return Be(e.effect_instruction_i0);case mt:return Be(r(e.effect_instruction_i0,t.effect_instruction_i0))}case xt:switch(t._tag){case xt:return ht(n(e.effect_instruction_i0,t.effect_instruction_i0));case mt:return Be(t.effect_instruction_i0)}}}),qxe=(e,t)=>{let r=pt(e);return Vt(r)?p(to(r),mc(p(Cn(r),Rb(V)),(n,o)=>p(n,oi(o,{onSuccess:(s,i)=>p(s,Et(i)),onFailure:t}))),Rb(gs),Rb(n=>Zt(n)),x):g()},Zi=e=>({...ki,[Z5]:Y5,state:ko(X5([])),commit(){return Ut(this)},blockingOn:e}),sn=()=>b(ri,e=>z$(e)),z$=e=>E(()=>Zi(e)),Ut=e=>Pb(t=>{let r=Ie(e.state);switch(r._tag){case Lf:return t(r.effect);case _p:return r.joiners.push(t),Wxe(e,t)}},e.blockingOn),vv=u(2,(e,t)=>Ua(t,e)),Kf=u(2,(e,t)=>E(()=>{let r=Ie(e.state);switch(r._tag){case Lf:return!1;case _p:{Fn(e.state,dv(t));for(let n=0,o=r.joiners.length;n<o;n++)r.joiners[n](t);return!0}}})),Pv=u(2,(e,t)=>Kf(e,t)),j$=u(2,(e,t)=>Kf(e,ke(t)));var gm=u(2,(e,t)=>Kf(e,Re(t)));var $$=e=>b(ri,t=>Kf(e,Db(t))),Qf=u(2,(e,t)=>Kf(e,Db(t))),V$=e=>E(()=>Ie(e.state)._tag===Lf),G$=e=>E(()=>{let t=Ie(e.state);switch(t._tag){case Lf:return x(t.effect);case _p:return g()}}),Hc=u(2,(e,t)=>Kf(e,S(t)));var za=(e,t)=>{let r=Ie(e.state);if(r._tag===_p){Fn(e.state,dv(t));for(let n=0,o=r.joiners.length;n<o;n++)r.joiners[n](t)}},Wxe=(e,t)=>E(()=>{let r=Ie(e.state);if(r._tag===_p){let n=r.joiners.indexOf(t);n>=0&&r.joiners.splice(n,1)}}),Hxe=de(e=>ht(e.currentContext)),Cs=()=>Hxe;var si=e=>b(Cs(),e),ws=u(2,(e,t)=>Lt(Yr,t)(e)),Mw=u(2,(e,t)=>Zr(Yr,r=>_o(r,t))(e)),Jf=u(2,(e,t)=>si(r=>ws(e,t(r)))),Fv=u(2,(e,t)=>b(e,r=>b(t.predicate(r),n=>n?S(r):t.orElse(r)))),K$=u(2,(e,t)=>Fv(e,{predicate:t.predicate,orElse:r=>ke(t.orFailWith(r))})),vw=e=>{let t=e.currentSpan;return t!==void 0&&t._tag==="Span"?x(t):g()},Bxe={_tag:"Span",spanId:"noop",traceId:"noop",sampled:!1,status:{_tag:"Ended",startTime:BigInt(0),endTime:BigInt(0),exit:Xr},attributes:new Map,links:[],kind:"internal",attribute(){},event(){},end(){},addLinks(){}},Q$=e=>Object.assign(Object.create(Bxe),e);var wt=sn;var He=Ut;var J$=Pv,Z$=j$;var Zf=gm;var Y$=$$;var Qb=V$,X$=G$,Cr=Hc;var Nv=Zi,e8=za;var en={};Yn(en,{all:()=>Dv,as:()=>jxe,asVoid:()=>$xe,causeOption:()=>Vxe,die:()=>zc,exists:()=>Gxe,fail:()=>At,failCause:()=>st,flatMap:()=>Kxe,flatMapEffect:()=>Qxe,flatten:()=>Lv,forEachEffect:()=>t8,fromEither:()=>Jxe,fromOption:()=>Zxe,getOrElse:()=>Yxe,interrupt:()=>Uv,isExit:()=>Jb,isFailure:()=>Bc,isInterrupted:()=>zxe,isSuccess:()=>Yi,map:()=>bm,mapBoth:()=>Pw,mapError:()=>Xxe,mapErrorCause:()=>ege,match:()=>qt,matchEffect:()=>r8,succeed:()=>xe,void:()=>Bp,zip:()=>Fw,zipLeft:()=>tge,zipPar:()=>rge,zipParLeft:()=>nge,zipParRight:()=>oge,zipRight:()=>zp,zipWith:()=>sge});var Jb=mm,Bc=Rw,Yi=Kb,zxe=_$,jxe=Av,$xe=xm,Vxe=k$,Dv=qp,zc=Aw,Gxe=T$,At=Wp,st=Be,Kxe=Mv,Qxe=I$,Lv=R$,t8=A$,Jxe=M$,Zxe=v$,Yxe=P$,Uv=$f,bm=Rb,Pw=F$,Xxe=N$,ege=D$,qt=Vf,r8=Gf,xe=ht,Bp=Xr;var Fw=L$,tge=U$,zp=q$,rge=W$,nge=H$,oge=B$,sge=oi;var n8=Symbol.for("effect/MutableHashMap"),ige={[n8]:n8,[Symbol.iterator](){return new qv(this)},toString(){return De(this.toJSON())},toJSON(){return{_id:"MutableHashMap",values:Array.from(this).map(ve)}},[he](){return this.toJSON()},pipe(){return v(this,arguments)}},qv=class e{self;referentialIterator;bucketIterator;constructor(t){this.self=t,this.referentialIterator=t.referential[Symbol.iterator]()}next(){if(this.bucketIterator!==void 0)return this.bucketIterator.next();let t=this.referentialIterator.next();return t.done?(this.bucketIterator=new Wv(this.self.buckets.values()),this.next()):t}[Symbol.iterator](){return new e(this.self)}},Wv=class{backing;constructor(t){this.backing=t}currentBucket;next(){if(this.currentBucket===void 0){let r=this.backing.next();if(r.done)return r;this.currentBucket=r.value[Symbol.iterator]()}let t=this.currentBucket.next();return t.done?(this.currentBucket=void 0,this.next()):t}},Yf=()=>{let e=Object.create(ige);return e.referential=new Map,e.buckets=new Map,e.bucketsSize=0,e};var Wr=u(2,(e,t)=>{if(ju(t)===!1)return e.referential.has(t)?x(e.referential.get(t)):g();let r=t[H](),n=e.buckets.get(r);return n===void 0?g():age(e,n,t)});var age=(e,t,r,n=!1)=>{for(let o=0,s=t.length;o<s;o++)if(r[W](t[o][0])){let i=t[o][1];return n&&(t.splice(o,1),e.bucketsSize--),x(i)}return g()},Xi=u(2,(e,t)=>X(Wr(e,t))),Qo=u(3,(e,t,r)=>{if(ju(t)===!1)return e.referential.set(t,r),e;let n=t[H](),o=e.buckets.get(n);return o===void 0?(e.buckets.set(n,[[t,r]]),e.bucketsSize++,e):(o8(e,o,t),o.push([t,r]),e.bucketsSize++,e)}),o8=(e,t,r)=>{for(let n=0,o=t.length;n<o;n++)if(r[W](t[n][0])){t.splice(n,1),e.bucketsSize--;return}};var Xf=u(2,(e,t)=>{if(ju(t)===!1)return e.referential.delete(t),e;let r=t[H](),n=e.buckets.get(r);return n===void 0||(o8(e,n,t),n.length===0&&e.buckets.delete(r)),e});var Nw=e=>e.referential.size+e.bucketsSize;var s8=Symbol.for("effect/MutableList"),cge={[s8]:s8,[Symbol.iterator](){let e=!1,t=this.head;return{next(){if(e)return this.return();if(t==null)return e=!0,this.return();let r=t.value;return t=t.next,{done:e,value:r}},return(r){return e||(e=!0),{done:!0,value:r}}}},toString(){return De(this.toJSON())},toJSON(){return{_id:"MutableList",values:Array.from(this).map(ve)}},[he](){return this.toJSON()},pipe(){return v(this,arguments)}},uge=e=>({value:e,removed:!1,prev:void 0,next:void 0}),i8=()=>{let e=Object.create(cge);return e.head=void 0,e.tail=void 0,e._length=0,e};var Hv=e=>Lw(e)===0,Lw=e=>e._length;var a8=u(2,(e,t)=>{let r=uge(t);return e.head===void 0&&(e.head=r),e.tail===void 0||(e.tail.next=r,r.prev=e.tail),e.tail=r,e._length+=1,e}),c8=e=>{let t=e.head;if(t!==void 0)return pge(e,t),t.value};var pge=(e,t)=>{t.removed||(t.removed=!0,t.prev!==void 0&&t.next!==void 0?(t.prev.next=t.next,t.next.prev=t.prev):t.prev!==void 0?(e.tail=t.prev,t.prev.next=void 0):t.next!==void 0?(e.head=t.next,t.next.prev=void 0):(e.tail=void 0,e.head=void 0),e._length>0&&(e._length-=1))};var p8=Symbol.for("effect/MutableQueue"),Mt=Symbol.for("effect/mutable/MutableQueue/Empty"),lge={[p8]:p8,[Symbol.iterator](){return Array.from(this.queue)[Symbol.iterator]()},toString(){return De(this.toJSON())},toJSON(){return{_id:"MutableQueue",values:Array.from(this).map(ve)}},[he](){return this.toJSON()},pipe(){return v(this,arguments)}},l8=e=>{let t=Object.create(lge);return t.queue=i8(),t.capacity=e,t},Uw=e=>l8(e),jc=()=>l8(void 0),qw=e=>Lw(e.queue),$c=e=>Hv(e.queue);var f8=e=>e.capacity===void 0?1/0:e.capacity,ii=u(2,(e,t)=>{let r=Lw(e.queue);return e.capacity!==void 0&&r===e.capacity?!1:(a8(t)(e.queue),!0)}),Zb=u(2,(e,t)=>{let r=t[Symbol.iterator](),n,o=ee(),s=!0;for(;s&&(n=r.next())&&!n.done;)s=ii(n.value)(e);for(;n!=null&&!n.done;)o=Et(n.value)(o),n=r.next();return gs(o)}),Jo=u(2,(e,t)=>Hv(e.queue)?t:c8(e.queue)),ym=u(2,(e,t)=>{let r=ee(),n=0;for(;n<t;){let o=Jo(Mt)(e);if(o===Mt)break;r=Et(o)(r),n+=1}return gs(r)});var fge="effect/Clock",Bv=Symbol.for(fge),Mo=nn("effect/Clock"),dge=2**31-1,d8={unsafeSchedule(e,t){let r=Kr(t);if(r>dge)return ls;let n=!1,o=setTimeout(()=>{n=!0,e()},r);return()=>(clearTimeout(o),!n)}},h8=(function(){let e=BigInt(1e6);if(typeof performance>"u")return()=>BigInt(Date.now())*e;let t;return()=>(t===void 0&&(t=BigInt(Date.now())*e-BigInt(Math.round(performance.now()*1e6))),t+BigInt(Math.round(performance.now()*1e6)))})(),hge=(function(){let e=typeof process=="object"&&"hrtime"in process&&typeof process.hrtime.bigint=="function"?process.hrtime:void 0;if(!e)return h8;let t=h8()-e.bigint();return()=>t+e.bigint()})(),zv=class{[Bv]=Bv;unsafeCurrentTimeMillis(){return Date.now()}unsafeCurrentTimeNanos(){return hge()}currentTimeMillis=E(()=>this.unsafeCurrentTimeMillis());currentTimeNanos=E(()=>this.unsafeCurrentTimeNanos());scheduler(){return S(d8)}sleep(t){return no(r=>{let n=d8.unsafeSchedule(()=>r(ae),t);return Ct(E(n))})}},jv=()=>new zv;var Vv="InvalidData",Gv="MissingData",Kv="SourceUnavailable",Qv="Unsupported";var xge="effect/ConfigError",Jv=Symbol.for(xge),Sm={_tag:"ConfigError",[Jv]:Jv},Hw=(e,t)=>{let r=Object.create(Sm);return r._op="And",r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),Object.defineProperty(r,"message",{enumerable:!1,get(){return this.toString()}}),r},Bw=(e,t)=>{let r=Object.create(Sm);return r._op="Or",r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),Object.defineProperty(r,"message",{enumerable:!1,get(){return this.toString()}}),r},Zv=(e,t,r={pathDelim:"."})=>{let n=Object.create(Sm);return n._op=Vv,n.path=e,n.message=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`(Invalid data at ${p(this.path,xc(r.pathDelim))}: "${this.message}")`}}),n},ja=(e,t,r={pathDelim:"."})=>{let n=Object.create(Sm);return n._op=Gv,n.path=e,n.message=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`(Missing data at ${p(this.path,xc(r.pathDelim))}: "${this.message}")`}}),n},g8=(e,t,r,n={pathDelim:"."})=>{let o=Object.create(Sm);return o._op=Kv,o.path=e,o.message=t,o.cause=r,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Source unavailable at ${p(this.path,xc(n.pathDelim))}: "${this.message}")`}}),o},b8=(e,t,r={pathDelim:"."})=>{let n=Object.create(Sm);return n._op=Qv,n.path=e,n.message=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`(Unsupported operation at ${p(this.path,xc(r.pathDelim))}: "${this.message}")`}}),n};var Vc=u(2,(e,t)=>{switch(e._op){case"And":return Hw(Vc(e.left,t),Vc(e.right,t));case"Or":return Bw(Vc(e.left,t),Vc(e.right,t));case Vv:return Zv([...t,...e.path],e.message);case Gv:return ja([...t,...e.path],e.message);case Kv:return g8([...t,...e.path],e.message,e.cause);case Qv:return b8([...t,...e.path],e.message)}});var y8={_tag:"Empty"};var zw=u(2,(e,t)=>{let r=xb(t),n=e;for(;Of(r);){let o=r.head;switch(o._tag){case"Empty":{r=r.tail;break}case"AndThen":{r=Fc(o.first,Fc(o.second,r.tail));break}case"MapName":{n=Ai(n,o.f),r=r.tail;break}case"Nested":{n=Th(n,o.name),r=r.tail;break}case"Unnested":{if(p(Ia(n),Q1(o.name)))n=Ri(n),r=r.tail;else return $(ja(n,`Expected ${o.name} to be in path in ConfigProvider#unnested`));break}}}return Z(n)});var Xv="Constant",eP="Fail",tP="Fallback",rP="Described",nP="Lazy",jw="MapOrFail",$w="Nested",Vw="Primitive",oP="Sequence",sP="HashMap",iP="ZipWith";var Gw=(e,t)=>[...e,...t],bge="effect/ConfigProvider",E8=Symbol.for(bge),Em=nn("effect/ConfigProvider"),yge="effect/ConfigProviderFlat",C8=Symbol.for(yge),Sge=e=>({[E8]:E8,pipe(){return v(this,arguments)},...e}),Ege=e=>({[C8]:C8,patch:e.patch,load:(t,r,n=!0)=>e.load(t,r,n),enumerateChildren:e.enumerateChildren}),Cge=e=>Sge({load:t=>b(ai(e,ds(),t,!1),r=>j(Ia(r),{onNone:()=>ke(ja(ds(),`Expected a single value having structure: ${t}`)),onSome:S})),flattened:e}),w8=e=>{let{pathDelim:t,seqDelim:r}=Object.assign({},{pathDelim:"_",seqDelim:","},e),n=c=>p(c,xc(t)),o=c=>c.split(t),s=()=>typeof process<"u"&&"env"in process&&typeof process.env=="object"?process.env:{};return Cge(Ege({load:(c,l,f=!0)=>{let d=n(c),h=s(),m=d in h?x(h[d]):g();return p(m,vp(()=>ja(c,`Expected ${d} to exist in the process context`)),b(y=>Tge(y,c,l,r,f)))},enumerateChildren:c=>E(()=>{let l=s(),h=Object.keys(l).map(m=>o(m.toUpperCase())).filter(m=>{for(let y=0;y<c.length;y++){let T=p(c,tR(y)),C=m[y];if(C===void 0||T!==C)return!1}return!0}).flatMap(m=>m.slice(c.length,c.length+1));return mp(h)}),patch:y8}))};var wge=(e,t,r,n)=>{let o=pR(r.length,c=>c>=n.length?g():x([e(c),c+1])),s=pR(n.length,c=>c>=r.length?g():x([t(c),c+1])),i=Gw(r,o),a=Gw(n,s);return[i,a]},Oge=(e,t)=>{let r=t;if(r._tag==="Nested"){let n=e.slice();for(;r._tag==="Nested";)n.push(r.name),r=r.config;return n}return e},ai=(e,t,r,n)=>{let o=r;switch(o._tag){case Xv:return S(Vr(o.value));case rP:return q(()=>ai(e,t,o.config,n));case eP:return ke(ja(t,o.message));case tP:return p(q(()=>ai(e,t,o.first,n)),Ss(s=>o.condition(s)?p(ai(e,t,o.second,n),Ss(i=>ke(Bw(s,i)))):ke(s)));case nP:return q(()=>ai(e,t,o.config(),n));case jw:return q(()=>p(ai(e,t,o.original,n),b(Ln(s=>p(o.mapOrFail(s),vp(Vc(Oge(t,o.original))))))));case $w:return q(()=>ai(e,Gw(t,Vr(o.name)),o.config,n));case Vw:return p(zw(t,e.patch),b(s=>p(e.load(s,o,n),b(i=>{if(i.length===0){let a=p(OE(s),_e(()=>"<n/a>"));return ke(ja([],`Expected ${o.description} with name ${a}`))}return S(i)}))));case oP:return p(zw(t,e.patch),b(s=>p(e.enumerateChildren(s),b(Rge),b(i=>i.length===0?q(()=>_(ai(e,t,o.config,!0),Vr)):p(Ln(i,a=>ai(e,kz(t,`[${a}]`),o.config,!0)),_(a=>{let c=Rh(a);return c.length===0?Vr(ds()):Vr(c)}))))));case sP:return q(()=>p(zw(t,e.patch),b(s=>p(e.enumerateChildren(s),b(i=>p(i,Ln(a=>ai(e,Gw(s,Vr(a)),o.valueConfig,n)),_(a=>a.length===0?Vr(Pc()):p(Ige(a),Ai(c=>em(oR(Ee(i),c)))))))))));case iP:return q(()=>p(ai(e,t,o.left,n),ei,b(s=>p(ai(e,t,o.right,n),ei,b(i=>{if(kt(s)&&kt(i))return ke(Hw(s.left,i.left));if(kt(s)&&Ho(i))return ke(s.left);if(Ho(s)&&kt(i))return ke(i.left);if(Ho(s)&&Ho(i)){let a=p(t,xc(".")),c=_ge(t,a),[l,f]=wge(c,c,p(s.right,Ai(Z)),p(i.right,Ai(Z)));return p(l,oR(f),Ln(([d,h])=>p(Wf(d,h),_(([m,y])=>o.zip(m,y)))))}throw new Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/effect/issues")})))))}},_ge=(e,t)=>r=>$(ja(e,`The element at index ${r} in a sequence at path "${t}" was missing`));var kge=(e,t)=>e.split(new RegExp(`\\s*${Uh(t)}\\s*`)),Tge=(e,t,r,n,o)=>o?p(kge(e,n),Ln(s=>r.parse(s.trim())),vp(Vc(t))):p(r.parse(e),Lb({onFailure:Vc(t),onSuccess:Vr})),Ige=e=>Object.keys(e[0]).map(t=>e.map(r=>r[t])),Rge=e=>p(Ln(e,Mge),Lb({onFailure:()=>ds(),onSuccess:dc(Fi)}),ei,_(gE));var Age=/^(\[(\d+)\])$/,Mge=e=>{let t=e.match(Age);if(t!==null){let r=t[2];return p(r!==void 0&&r.length>0?x(r):g(),kr(vge))}return g()};var vge=e=>{let t=Number.parseInt(e);return Number.isNaN(t)?g():x(t)};var O8=Symbol.for("effect/Console"),Zo=nn("effect/Console"),_8={[O8]:O8,assert(e,...t){return E(()=>{console.assert(e,...t)})},clear:E(()=>{console.clear()}),count(e){return E(()=>{console.count(e)})},countReset(e){return E(()=>{console.countReset(e)})},debug(...e){return E(()=>{console.debug(...e)})},dir(e,t){return E(()=>{console.dir(e,t)})},dirxml(...e){return E(()=>{console.dirxml(...e)})},error(...e){return E(()=>{console.error(...e)})},group(e){return e?.collapsed?E(()=>console.groupCollapsed(e?.label)):E(()=>console.group(e?.label))},groupEnd:E(()=>{console.groupEnd()}),info(...e){return E(()=>{console.info(...e)})},log(...e){return E(()=>{console.log(...e)})},table(e,t){return E(()=>{console.table(e,t)})},time(e){return E(()=>console.time(e))},timeEnd(e){return E(()=>console.timeEnd(e))},timeLog(e,...t){return E(()=>{console.timeLog(e,...t)})},trace(...e){return E(()=>{console.trace(...e)})},warn(...e){return E(()=>{console.warn(...e)})},unsafe:console};var Fge="effect/Random",Yb=Symbol.for(Fge),Gc=nn("effect/Random"),aP=class{seed;[Yb]=Yb;PRNG;constructor(t){this.seed=t,this.PRNG=new aE(t)}get next(){return E(()=>this.PRNG.number())}get nextBoolean(){return _(this.next,t=>t>.5)}get nextInt(){return E(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER))}nextRange(t,r){return _(this.next,n=>(r-t)*n+t)}nextIntBetween(t,r){return E(()=>this.PRNG.integer(r-t)+t)}shuffle(t){return T8(t,r=>this.nextIntBetween(0,r))}},T8=(e,t)=>q(()=>p(E(()=>Array.from(e)),b(r=>{let n=[];for(let o=r.length;o>=2;o=o-1)n.push(o);return p(n,Vo(o=>p(t(o),_(s=>Nge(r,o-1,s)))),tt(pt(r)))}))),Nge=(e,t,r)=>{let n=e[t];return e[t]=e[r],e[r]=n,e},uP=e=>new aP(M(e)),cP=class{values;[Yb]=Yb;index=0;constructor(t){if(this.values=t,t.length===0)throw new Error("Requires at least one value")}getNextValue(){let t=this.values[this.index];return this.index=(this.index+1)%this.values.length,t}get next(){return E(()=>{let t=this.getNextValue();return typeof t=="number"?Math.max(0,Math.min(1,t)):M(t)/2147483647})}get nextBoolean(){return E(()=>{let t=this.getNextValue();return typeof t=="boolean"?t:M(t)%2===0})}get nextInt(){return E(()=>{let t=this.getNextValue();return typeof t=="number"&&Number.isFinite(t)?Math.round(t):Math.abs(M(t))})}nextRange(t,r){return _(this.next,n=>(r-t)*n+t)}nextIntBetween(t,r){return E(()=>{let n=this.getNextValue();if(typeof n=="number"&&Number.isFinite(n))return Math.max(t,Math.min(r-1,Math.round(n)));let o=Math.abs(M(n));return t+o%(r-t)})}shuffle(t){return T8(t,r=>this.nextIntBetween(0,r))}},I8=e=>new cP(e);var A8=Symbol.for("effect/Tracer"),Dge=e=>({[A8]:A8,...e}),Kc=nn("effect/Tracer"),an=nn("effect/ParentSpan"),M8=(function(){let e="abcdef0123456789",t=e.length;return function(r){let n="";for(let o=0;o<r;o++)n+=e.charAt(Math.floor(Math.random()*t));return n}})(),pP=class{name;parent;context;startTime;kind;_tag="Span";spanId;traceId="native";sampled=!0;status;attributes;events=[];links;constructor(t,r,n,o,s,i){this.name=t,this.parent=r,this.context=n,this.startTime=s,this.kind=i,this.status={_tag:"Started",startTime:s},this.attributes=new Map,this.traceId=r._tag==="Some"?r.value.traceId:M8(32),this.spanId=M8(16),this.links=Array.from(o)}end(t,r){this.status={_tag:"Ended",endTime:t,exit:r,startTime:this.status.startTime}}attribute(t,r){this.attributes.set(t,r)}event(t,r,n){this.events.push([t,r,n??{}])}addLinks(t){this.links.push(...t)}},v8=Dge({span:(e,t,r,n,o,s)=>new pP(e,t,r,n,o,s),context:e=>e()});var Un=e=>{if(e?.captureStackTrace===!1)return e;if(e?.captureStackTrace!==void 0&&typeof e.captureStackTrace!="boolean")return e;let t=Error.stackTraceLimit;Error.stackTraceLimit=3;let r=new Error;Error.stackTraceLimit=t;let n=!1;return{...e,captureStackTrace:()=>{if(n!==!1)return n;if(r.stack!==void 0){let o=r.stack.split(`
`);if(o[3]!==void 0)return n=o[3].trim(),n}}}},Cm=Hi()("effect/Tracer/DisablePropagation",{defaultValue:ls});var Lge=p(En(),qe(Mo,jv()),qe(Zo,_8),qe(Gc,uP(Math.random())),qe(Em,w8()),qe(Kc,v8)),Ot=ne(Symbol.for("effect/DefaultServices/currentServices"),()=>Ub(Lge)),P8=e=>{let t=Qe(e);return Xb(r=>r.sleep(t))},Kw=e=>de(t=>e(t.currentDefaultServices)),Xb=e=>Kw(t=>e(t.unsafeMap.get(Mo.key))),F8=Xb(e=>e.currentTimeMillis),N8=Xb(e=>e.currentTimeNanos),D8=u(2,(e,t)=>Zr(Ot,qe(Mo,t))(e)),L8=u(2,(e,t)=>Zr(Ot,qe(Em,t))(e)),lP=e=>Kw(t=>e(t.unsafeMap.get(Em.key))),U8=e=>lP(t=>t.load(e));var Qw=e=>Kw(t=>e(t.unsafeMap.get(Gc.key))),q8=u(2,(e,t)=>Zr(Ot,qe(Gc,t))(e));var Jw=e=>Kw(t=>e(t.unsafeMap.get(Kc.key))),W8=u(2,(e,t)=>Zr(Ot,qe(Kc,t))(e));var $a=P8,ea=F8,H8=N8,Zw=Xb,B8=Mo;function z8(e){return new Va(e)}function Yw(){return z8(new Map)}var fP=Symbol.for("effect/FiberRefs"),Va=class{locals;[fP]=fP;constructor(t){this.locals=t}pipe(){return v(this,arguments)}},Uge=(e,t,r,n=!1)=>{let o=e,s=t,i=r,a=n,c;for(;c===void 0;)if(ut(s)&&ut(i)){let l=Lr(s)[0],f=Ri(s),d=Lr(i)[0],h=Lr(i)[1],m=Ri(i);l.startTimeMillis<d.startTimeMillis?(i=m,a=!0):l.startTimeMillis>d.startTimeMillis?s=f:l.id<d.id?(i=m,a=!0):l.id>d.id?s=f:c=[h,a]}else c=[o.initial,!0];return c},Xw=u(3,(e,t,r)=>{let n=new Map(e.locals);return r.locals.forEach((o,s)=>{let i=o[0][1];if(!o[0][0][W](t)){if(!n.has(s)){if(N(i,s.initial))return;n.set(s,[[t,s.join(s.initial,i)]]);return}let a=n.get(s),[c,l]=Uge(s,a,o);if(l){let f=s.diff(c,i),d=a[0][1],h=s.join(d,s.patch(f)(d));if(!N(d,h)){let m,y=a[0][0];y[W](t)?m=[[y,h],...a.slice(1)]:m=[[t,h],...a],n.set(s,m)}}}}),new Va(n)}),hP=u(2,(e,t)=>{let r=new Map;return j8(e,r,t),new Va(r)}),j8=(e,t,r)=>{e.locals.forEach((n,o)=>{let s=n[0][1],i=o.patch(o.fork)(s);N(s,i)?t.set(o,n):t.set(o,[[r,i],...n])})},$8=e=>mp(e.locals.keys()),V8=e=>Vo($8(e),t=>Tp(t,Jc(e,t))),Om=u(2,(e,t)=>{let r=new Map(e.locals);return r.delete(t),new Va(r)}),ey=u(2,(e,t)=>e.locals.has(t)?x(Lr(e.locals.get(t))[1]):g()),Jc=u(2,(e,t)=>p(ey(e,t),_e(()=>t.initial))),ed=u(2,(e,{fiberId:t,fiberRef:r,value:n})=>{if(e.locals.size===0)return new Va(new Map([[r,[[t,n]]]]));let o=new Map(e.locals);return dP(o,t,r,n),new Va(o)}),dP=(e,t,r,n)=>{let o=e.get(r)??[],s;if(ut(o)){let[i,a]=Lr(o);if(i[W](t)){if(N(a,n))return;s=[[t,n],...o.slice(1)]}else s=[[t,n],...o]}else s=[[t,n]];e.set(r,s)},G8=u(2,(e,{entries:t,forkAs:r})=>{if(e.locals.size===0)return new Va(new Map(t));let n=new Map(e.locals);return r!==void 0&&j8(e,n,r),t.forEach(([o,s])=>{s.length===1?dP(n,s[0][0],o,s[0][1]):s.forEach(([i,a])=>{dP(n,i,o,a)})}),new Va(n)});var K8=Om;var mP=ey,td=Jc,Q8=Xw,J8=V8,Z8=ed,Y8=G8;var X8=Yw;var $p={};Yn($p,{All:()=>eV,Debug:()=>sO,Error:()=>rO,Fatal:()=>tO,Info:()=>oO,None:()=>tV,Order:()=>ry,Trace:()=>iO,Warning:()=>nO,allLevels:()=>qge,fromLiteral:()=>cO,greaterThan:()=>aO,greaterThanEqual:()=>zge,lessThan:()=>Hge,lessThanEqual:()=>Bge,locally:()=>Wge});var eV=Sv,tO=Ev,rO=Cv,nO=Tw,oO=um,sO=Iw,iO=wv,tV=Ov,qge=p$,Wge=u(2,(e,t)=>Lt(e,Wb,t)),ry=p(Fi,wh(e=>e.ordinal)),Hge=jl(ry),Bge=Oh(ry),aO=$l(ry),zge=_h(ry),cO=e=>{switch(e){case"All":return eV;case"Debug":return sO;case"Error":return rO;case"Fatal":return tO;case"Info":return oO;case"Trace":return iO;case"None":return tV;case"Warning":return nO}};var rV=(e,t)=>({label:e,startTime:t}),xP=e=>e.replace(/[\s="]/g,"_"),ny=e=>t=>`${xP(t.label)}=${e-t.startTime}ms`;var oV=rV;var Hr={};Yn(Hr,{RefTypeId:()=>yP,get:()=>_t,getAndSet:()=>sd,getAndUpdate:()=>SP,getAndUpdateSome:()=>EP,make:()=>tr,modify:()=>Yo,modifySome:()=>CP,set:()=>Dr,setAndGet:()=>wP,unsafeMake:()=>$ge,update:()=>Os,updateAndGet:()=>OP,updateSome:()=>_P,updateSomeAndGet:()=>kP});var iV=lc,gP=ki;var jge=cz;var cn=class extends jge{};var qn=Symbol.for("effect/Readable");var Bnt={[qn]:qn,pipe(){return v(this,arguments)}};var oy=Symbol.for("effect/Ref"),sy={_A:e=>e},bP=class extends cn{ref;commit(){return this.get}[oy]=sy;[qn]=qn;constructor(t){super(),this.ref=t,this.get=E(()=>Ie(this.ref))}get;modify(t){return E(()=>{let r=Ie(this.ref),[n,o]=t(r);return r!==o&&Fn(o)(this.ref),n})}},rd=e=>new bP(ko(e)),nd=e=>E(()=>rd(e)),Wn=e=>e.get,ta=u(2,(e,t)=>e.modify(()=>[void 0,t])),aV=u(2,(e,t)=>e.modify(r=>[r,t])),cV=u(2,(e,t)=>e.modify(r=>[r,t(r)])),uV=u(2,(e,t)=>e.modify(r=>{let n=t(r);switch(n._tag){case"None":return[r,r];case"Some":return[r,n.value]}})),pV=u(2,(e,t)=>e.modify(()=>[t,t])),uO=u(2,(e,t)=>e.modify(t)),lV=u(3,(e,t,r)=>e.modify(n=>{let o=r(n);switch(o._tag){case"None":return[t,n];case"Some":return o.value}})),od=u(2,(e,t)=>e.modify(r=>[void 0,t(r)])),fV=u(2,(e,t)=>e.modify(r=>{let n=t(r);return[n,n]})),dV=u(2,(e,t)=>e.modify(r=>[void 0,j(t(r),{onNone:()=>r,onSome:n=>n})])),hV=u(2,(e,t)=>e.modify(r=>{let n=t(r);switch(n._tag){case"None":return[r,r];case"Some":return[n.value,n.value]}}));var yP=oy,tr=nd,_t=Wn,sd=aV,SP=cV,EP=uV,Yo=uO,CP=lV,Dr=ta,wP=pV,Os=od,OP=fV,_P=dV,kP=hV,$ge=rd;var mV=Jw;var gV="Empty",bV="Add",yV="Remove",SV="Update",EV="AndThen",CV={_tag:gV},ay=(e,t)=>{let r=new Map(e.locals),n=CV;for(let[o,s]of t.locals.entries()){let i=Lr(s)[1],a=r.get(o);if(a!==void 0){let c=Lr(a)[1];N(c,i)||(n=pO({_tag:SV,fiberRef:o,patch:o.diff(c,i)})(n))}else n=pO({_tag:bV,fiberRef:o,value:i})(n);r.delete(o)}for(let[o]of r.entries())n=pO({_tag:yV,fiberRef:o})(n);return n},pO=u(2,(e,t)=>({_tag:EV,first:e,second:t})),lO=u(3,(e,t,r)=>{let n=r,o=Vr(e);for(;ut(o);){let s=Lr(o),i=Ri(o);switch(s._tag){case gV:{o=i;break}case bV:{n=ed(n,{fiberId:t,fiberRef:s.fiberRef,value:s.value}),o=i;break}case yV:{n=Om(n,s.fiberRef),o=i;break}case SV:{let a=Jc(n,s.fiberRef);n=ed(n,{fiberId:t,fiberRef:s.fiberRef,value:s.fiberRef.patch(s.patch)(a)}),o=i;break}case EV:{o=Th(s.first)(Th(s.second)(i));break}}}return n});var OV="effect/MetricLabel",TP=Symbol.for(OV),IP=class{key;value;[TP]=TP;_hash;constructor(t,r){this.key=t,this.value=r,this._hash=Ke(OV+this.key+this.value)}[H](){return this._hash}[W](t){return Vge(t)&&this.key===t.key&&this.value===t.value}pipe(){return v(this,arguments)}},id=(e,t)=>new IP(e,t),Vge=e=>F(e,TP);var _V=u(e=>et(e[0]),function(){let e=arguments;return Zr(e[0],Ha,typeof e[1]=="string"?on(e[1],e[2]):t=>Object.entries(e[1]).reduce((r,[n,o])=>on(r,n,o),t))}),km=e=>_(e,x),kV=e=>vp(e,x),AP=e=>{let t,r;return typeof e=="function"?t=e:(t=e.try,r=e.catch),q(()=>{try{return S(rt(t))}catch(n){return ke(r?rt(()=>r(n)):new hm(n,"An unknown error occurred in Effect.try"))}})},TV=u(3,(e,t,r)=>Ss(e,n=>F(n,t)&&n[t]===r.failure?r.onFailure(n):ke(n))),IV=u(2,(e,t)=>La(e,r=>{let n=Op(r,o=>Mf(o)?x(o):g());switch(n._tag){case"None":return Re(r);case"Some":return t(n.value.defect)}})),RV=u(2,(e,t)=>Gt(e,{onFailure:r=>{let n=t(r);switch(n._tag){case"None":return Re(r);case"Some":return n.value}},onSuccess:S})),AV=u(2,(e,t)=>La(e,r=>{let n=Op(r,o=>Mf(o)?x(o):g());switch(n._tag){case"None":return Re(r);case"Some":{let o=t(n.value.defect);return o._tag==="Some"?o.value:Re(r)}}})),MV=u(e=>et(e[0]),(e,...t)=>{let r=t[t.length-1],n;return t.length===2?n=_a(t[0]):n=o=>{let s=F(o,"_tag")?o._tag:void 0;if(!s)return!1;for(let i=0;i<t.length-1;i++)if(t[i]===s)return!0;return!1},Fb(e,n,r)}),vV=u(2,(e,t)=>{let r;return Fb(e,n=>(r??=Object.keys(t),F(n,"_tag")&&cr(n._tag)&&r.includes(n._tag)),n=>t[n._tag](n))}),PV=e=>Nb(e,{onFailure:R,onSuccess:()=>Dn}),Ka=Zw,FV=Ka(S),NV=u(2,(e,t)=>we($a(t),e)),hO=e=>de((t,r)=>e({id:t.id(),status:r,interruptors:Nf(t.getFiberRef(Lp))})),DV=hO(e=>Ac(e.interruptors)>0?Xt:ae),LV=hO(S),Tm=e=>fy(e,xO,ay),Gge=e=>fy(e,Wf(xO,am),([t,r],[n,o])=>[ay(t,n),Xs(r,o)]),UV=S({}),cy=oE(_,b),uy=ph(_),qV=uh(_),WV=u(2,(e,t)=>q(()=>{let r=e[Symbol.iterator](),n=[],o,s=S(!1),i=0;for(;(o=r.next())&&!o.done;){let a=o.value,c=i++;s=b(s,l=>l?(n.push(a),S(!0)):t(a,c))}return _(s,()=>n)})),HV=u(2,(e,t)=>q(()=>{let r=e[Symbol.iterator](),n=[],o,s=S(!0),i=0;for(;(o=r.next())&&!o.done;){let a=o.value,c=i++;s=b(s,l=>_(l?t(a,c):S(!1),f=>(f||n.push(a),f)))}return _(s,()=>n)})),BV=e=>_(Cs(),e),MP=e=>Uf(e,()=>b(qa(),()=>MP(e))),zV=u(2,(e,t)=>_(Ln(e,R),hc(t))),jV=u(3,(e,t,r)=>py(e,t,n=>Rp(()=>r(n)))),$V=u(3,(e,t,r)=>py(e,t,()=>Ip(r))),py=u(3,(e,t,r)=>b(e,n=>t(n)?S(n):r(n))),VV=u(3,(e,t,r)=>q(()=>t(e)?S(e):ke(r(e)))),GV=u(e=>et(e[0]),(e,t,r)=>py(e,t,n=>r===void 0?ke(new Ao):ti(()=>r(n)))),KV=u(2,(e,t)=>q(()=>{let r=e[Symbol.iterator](),n=r.next();return n.done?S(g()):QV(r,0,t,n.value)})),QV=(e,t,r,n)=>b(r(n,t),o=>{if(o)return S(x(n));let s=e.next();return s.done?S(g()):QV(e,t+1,r,s.value)}),JV=e=>q(()=>{let t=pt(e);return Vt(t)?p(to(t),mc(Cn(t),(r,n)=>Uf(r,()=>n))):Rp(()=>new jf("Received an empty collection of effects"))}),ZV=u(2,(e,t)=>Mp(t(Mp(e)))),ly=u(2,(e,t)=>Jr(e,{onFailure:r=>S(t.onFailure(r)),onSuccess:r=>S(t.onSuccess(r))})),YV=u(2,(e,t)=>q(()=>XV(e[Symbol.iterator](),0,t))),XV=(e,t,r)=>{let n=e.next();return n.done?S(!0):b(r(n.value,t),o=>o?XV(e,t+1,r):S(o))},mO=e=>{let t=b(b(e,()=>qa()),()=>t);return t},xO=de(e=>S(e.getFiberRefs())),e9=e=>b(e,t=>{let n=t[Symbol.iterator]().next();return n.done?ke(new Ao):S(n.value)}),gO=e=>ly(e,{onFailure:Ar,onSuccess:Ar}),t9=e=>Gt(e,{onFailure:t=>PP(t,"An error was silently ignored because it is not anticipated to be useful"),onSuccess:()=>ae}),r9=e=>EO((t,r)=>Q8(r,t,e)),n9=e=>ly(e,{onFailure:zr,onSuccess:ls}),o9=e=>ly(e,{onFailure:ls,onSuccess:zr}),vP=(e,t)=>q(()=>t.while(e)?b(t.body(e),r=>vP(r,t)):S(e)),Zc=e=>(...t)=>{let r=br(e),n;for(let o=0,s=t.length;o<s;o++){let i=t[o];_b(i)&&(n!==void 0?n=Rt(n,i):n=i,t=[...t.slice(0,o),...t.slice(o+1)],o--)}return n===void 0&&(n=Dn),de(o=>(o.log(t,n,r),ae))},s9=Zc(),i9=Zc(iO),PP=Zc(sO),a9=Zc(oO),c9=Zc(nO),u9=Zc(rO),p9=Zc(tO),l9=u(2,(e,t)=>b(ea,r=>Zr(e,Hb,GC(oV(t,r))))),f9=Ro(Ha),d9=(e,t)=>t.discard?m9(e,t.while,t.step,t.body):_(h9(e,t.while,t.step,t.body),Ee),h9=(e,t,r,n)=>q(()=>t(e)?b(n(e),o=>_(h9(r(e),t,r,n),GC(o))):E(()=>Ys())),m9=(e,t,r,n)=>q(()=>t(e)?b(n(e),()=>m9(r(e),t,r,n)):ae),x9=u(3,(e,t,r)=>q(()=>{let n=e[Symbol.iterator](),o=[],s=S(t),i,a=0;for(;!(i=n.next()).done;){let c=a++,l=i.value;s=b(s,f=>_(r(f,l,c),([d,h])=>(o.push(h),d)))}return _(s,c=>[c,o])})),Im=u(2,(e,t)=>Gt(e,{onFailure:r=>qc(()=>t(r)),onSuccess:S})),bO=e=>p(sn(),b(t=>p(Gge(e),Ua(t),FP,_(r=>we(r,p(Ut(t),b(([n,o])=>tt(Wf(ad(n[0]),Pp(n[1])),o)))))))),g9=e=>Jr(e,{onFailure:t=>S(t),onSuccess:S}),yO=e=>_(e,t=>!t),b9=e=>b(e,t=>{switch(t._tag){case"None":return ae;case"Some":return ke(new Ao)}}),FP=e=>_(tr(!0),t=>Ct(Ki(e,sd(t,!1)))),y9=e=>Jr(e,{onFailure:()=>S(g()),onSuccess:t=>S(x(t))}),S9=u(2,(e,t)=>Uf(e,()=>ti(t))),E9=u(2,(e,t)=>Uf(e,()=>E(t))),C9=e=>Gt(e,{onFailure:t=>{let r=Ee(kb(t));return r.length===0?Re(t):ke(r)},onSuccess:S}),ad=e=>EO((t,r)=>p(e,lO(t,r))),w9=e=>e.length>=1?no((t,r)=>{try{e(r).then(n=>t(S(n)),n=>t(oo(n)))}catch(n){t(oo(n))}}):no(t=>{try{e().then(r=>t(S(r)),r=>t(oo(r)))}catch(r){t(oo(r))}}),Vp=u(3,(e,t,r)=>si(n=>ws(e,qe(n,t,r)))),Gp=u(3,(e,t,r)=>si(n=>b(r,o=>ws(e,p(n,qe(t,o)))))),O9=Qw(S),_9=u(3,(e,t,r)=>Ee(e).reduce((n,o,s)=>b(n,i=>r(i,o,s)),S(t))),k9=u(3,(e,t,r)=>Ee(e).reduceRight((n,o,s)=>b(n,i=>r(o,i,s)),S(t))),T9=u(3,(e,t,r)=>b(E(()=>e[Symbol.iterator]()),n=>I9(n,0,t,r.while,r.body))),I9=(e,t,r,n,o)=>{let s=e.next();return!s.done&&n(r)?b(o(r,s.value,t),i=>I9(e,t+1,i,n,o)):S(r)},R9=u(2,(e,t)=>q(()=>A9(e,t))),A9=(e,t)=>b(e,r=>t<=0?S(r):we(qa(),A9(e,t-1))),M9=e=>Gt(e,{onFailure:ke,onSuccess:S}),v9=e=>q(()=>J8(e)),Qa=$a,cd=S(g()),P9=e=>S(x(e)),fy=u(3,(e,t,r)=>b(t,n=>b(e,o=>_(t,s=>[r(n,s),o])))),F9=u(e=>et(e[0]),function(){return NP(arguments[0],typeof arguments[1]=="string"?[id(arguments[1],arguments[2])]:Object.entries(arguments[1]).map(([e,t])=>id(e,t)))}),NP=u(2,(e,t)=>Zr(e,ni,r=>fs(r,t))),N9=u(2,(e,t)=>q(()=>{let r=e[Symbol.iterator](),n=[],o,s=S(!1),i=0;for(;(o=r.next())&&!o.done;){let a=o.value,c=i++;s=b(s,l=>l?S(!0):(n.push(a),t(a,c)))}return _(s,()=>n)})),D9=u(2,(e,t)=>q(()=>{let r=e[Symbol.iterator](),n=[],o,s=S(!0),i=0;for(;(o=r.next())&&!o.done;){let a=o.value,c=i++;s=b(s,l=>p(l?t(a,c):S(!1),_(f=>(f&&n.push(a),f))))}return _(s,()=>n)})),L9=u(2,(e,{onFailure:t,onSuccess:r})=>Gt(e,{onFailure:n=>{let o=Vi(n);switch(o._tag){case"Left":return we(t(o.left),Re(n));case"Right":return Re(n)}},onSuccess:n=>tt(r(n),n)})),SO=u(2,(e,t)=>La(e,r=>j(pv(r),{onNone:()=>Re(r),onSome:n=>we(t(n),Re(r))}))),dy=u(2,(e,t)=>Gt(e,{onFailure:r=>{let n=Vi(r);switch(n._tag){case"Left":return we(t(n.left),Re(r));case"Right":return Re(r)}},onSuccess:S})),U9=u(3,(e,t,r)=>dy(e,n=>_a(n,t)?r(n):ae)),q9=u(2,(e,t)=>Gt(e,{onFailure:r=>we(t(r),Re(r)),onSuccess:S})),W9=e=>DP(e,H8),DP=u(2,(e,t)=>fy(e,t,(r,n)=>Ks(n-r))),Kge=mV,H9=Kge(S),LP=e=>{let t,r;typeof e=="function"?t=e:(t=e.try,r=e.catch);let n=o=>r?ti(()=>r(o)):ke(new hm(o,"An unknown error occurred in Effect.tryPromise"));return t.length>=1?no((o,s)=>{try{t(s).then(i=>o(S(i)),i=>o(n(i)))}catch(i){o(n(i))}}):no(o=>{try{t().then(s=>o(S(s)),s=>o(n(s)))}catch(s){o(n(s))}})},B9=u(2,(e,t)=>b(e,r=>AP({try:()=>t.try(r),catch:t.catch}))),z9=u(2,(e,t)=>b(e,r=>LP({try:t.try.length>=1?n=>t.try(r,n):()=>t.try(r),catch:t.catch}))),j9=u(2,(e,t)=>q(()=>t()?cd:km(e))),$9=u(2,(e,t)=>b(t,r=>r?cd:km(e))),V9=e=>Im(e,fv),EO=e=>de(t=>(t.setFiberRefs(e(t.id(),t.getFiberRefs())),ae)),G9=u(3,(e,t,r)=>Jf(e,n=>qe(n,t,r(vn(n,t))))),CO=u(2,(e,t)=>q(()=>t()?_(e,x):S(g()))),K9=u(3,(e,t,r)=>b(Ro(t),n=>r(n)?_(e,o=>[n,x(o)]):S([n,g()]))),Q9=u(3,(e,t,r)=>b(_t(t),n=>r(n)?_(e,o=>[n,x(o)]):S([n,g()]))),J9=u(2,(e,t)=>t(e)),Z9=(e,t)=>(...r)=>b(e,n=>t(n)(...r)),Y9=(e,t)=>(...r)=>_(e,n=>t(n)(...r)),UP=e=>new Proxy({},{get(t,r,n){return(...o)=>b(e,s=>s[r](...o))}}),qP=e=>new Proxy({},{get(t,r,n){return b(e,o=>et(o[r])?o[r]:S(o[r]))}}),X9=e=>({functions:UP(e),constants:qP(e)}),eG=e=>_(Cs(),xs(e)),WP=e=>b(Cs(),xs(e)),tG=function(){let e=arguments;return gO(b(wO,t=>E(()=>{if(typeof e[0]=="string")t.attribute(e[0],e[1]);else for(let r in e[0])t.attribute(r,e[0][r])})))},rG=function(){let e=arguments,t=Array.isArray(e[0])?e[0]:[{_tag:"SpanLink",span:e[0],attributes:e[1]??{}}];return gO(b(wO,r=>E(()=>r.addLinks(t))))},nG=u(e=>et(e[0]),function(){let e=arguments;return Zr(e[0],Bf,typeof e[1]=="string"?on(e[1],e[2]):t=>Object.entries(e[1]).reduce((r,[n,o])=>on(r,n,o),t))}),oG=WP(an),wO=b(Cs(),e=>{let t=e.unsafeMap.get(an.key);return t!==void 0&&t._tag==="Span"?S(t):ke(new Ao)}),sG=u(e=>et(e[0]),(e,t,r)=>Zr(e,jb,Pn({_tag:"SpanLink",span:t,attributes:r??{}}))),iG=BigInt(0),aG=kr(e=>jt(e.context,Cm)?e._tag==="Span"?aG(e.parent):g():x(e)),OO=(e,t,r)=>{let n=!e.getFiberRef(fm)||r.context&&jt(r.context,Cm),o=e.getFiberRef(Yr),s=r.parent?x(r.parent):r.root?g():aG(xs(o,an)),i;if(n)i=Q$({name:t,parent:s,context:qe(r.context??En(),Cm,!0)});else{let a=e.getFiberRef(Ot),c=jt(a,Kc),l=jt(a,B8),f=e.getFiberRef(Ba),d=e.getFiberRefs(),h=mP(d,Bf),m=mP(d,jb),y=m._tag==="Some"?r.links!==void 0?[...Zt(m.value),...r.links??[]]:Zt(m.value):r.links??ds();i=c.span(t,s,r.context??En(),y,f?l.unsafeCurrentTimeNanos():iG,r.kind??"internal",r),h._tag==="Some"&&l5(h.value,(T,C)=>i.attribute(C,T)),r.attributes!==void 0&&Object.entries(r.attributes).forEach(([T,C])=>i.attribute(T,C))}return typeof r.captureStackTrace=="function"&&Ib.set(i,r.captureStackTrace),i},cG=(e,t)=>(t=Un(t),de(r=>S(OO(r,e,t)))),uG=Ro(Bf),pG=Ro(jb),Rm=(e,t,r,n)=>E(()=>{e.status._tag!=="Ended"&&(Rw(t)&&Ib.has(e)&&e.attribute("code.stacktrace",Ib.get(e)()),e.end(n?r.unsafeCurrentTimeNanos():iG,t))}),fO=(e,...t)=>{let r=Un(t.length===1?void 0:t[0]),n=t[t.length-1];return de(o=>{let s=OO(o,e,r),i=o.getFiberRef(Ba),a=jt(o.getFiberRef(Ot),Mo);return Io(n(s),c=>Rm(s,c,a,i))})},dO=u(2,(e,t)=>Vp(e,an,t)),HP=function(){let e=typeof arguments[0]!="string",t=e?arguments[1]:arguments[0],r=Un(e?arguments[2]:arguments[1]);if(e){let n=arguments[0];return fO(t,r,o=>dO(n,o))}return n=>fO(t,r,o=>dO(n,o))},lG=e=>function(){let t=e.captureStackTrace??!1;if(e.captureStackTrace!==!1){let r=Error.stackTraceLimit;Error.stackTraceLimit=2;let n=new Error;Error.stackTraceLimit=r;let o=!1;t=()=>{if(o!==!1)return o;if(n.stack)return o=n.stack.trim().split(`
`).slice(2).join(`
`).trim(),o}}return q(()=>{let r=typeof e.options=="function"?e.options.apply(null,arguments):e.options;return HP(q(()=>rt(()=>e.body.apply(this,arguments))),r.name,{...r,captureStackTrace:t})})},fG=e=>e==null?ke(new Ao):S(e),dG=e=>Ss(_(e,x),t=>Rv(t)?cd:ke(t));var hG="Sequential",mG="Parallel",Qge="ParallelN",Xo={_tag:hG},hy={_tag:mG},xG=e=>({_tag:Qge,parallelism:e}),BP=e=>e._tag===hG,zP=e=>e._tag===mG;var Am=Xo,_O=hy,kO=xG;var ud=ay;var pd=lO;var IO="effect/FiberStatus",Kp=Symbol.for(IO),TO="Done",gG="Running",bG="Suspended",Jge=Ke(`${IO}-${TO}`),VP=class{[Kp]=Kp;_tag=TO;[H](){return Jge}[W](t){return RO(t)&&t._tag===TO}},GP=class{runtimeFlags;[Kp]=Kp;_tag=gG;constructor(t){this.runtimeFlags=t}[H](){return p(M(IO),G(M(this._tag)),G(M(this.runtimeFlags)),se(this))}[W](t){return RO(t)&&t._tag===gG&&this.runtimeFlags===t.runtimeFlags}},KP=class{runtimeFlags;blockingOn;[Kp]=Kp;_tag=bG;constructor(t,r){this.runtimeFlags=t,this.blockingOn=r}[H](){return p(M(IO),G(M(this._tag)),G(M(this.runtimeFlags)),G(M(this.blockingOn)),se(this))}[W](t){return RO(t)&&t._tag===bG&&this.runtimeFlags===t.runtimeFlags&&N(this.blockingOn,t.blockingOn)}},yG=new VP,SG=e=>new GP(e),EG=(e,t)=>new KP(e,t),RO=e=>F(e,Kp),CG=e=>e._tag===TO;var wG=yG,QP=SG,OG=EG;var _G=CG;var Yge=Symbol.for("effect/Micro"),AO=Symbol.for("effect/Micro/MicroExit");var TG=Symbol.for("effect/Micro/MicroCause");var Xge={_E:R},MO=class extends globalThis.Error{_tag;traces;[TG];constructor(t,r,n){let o=`MicroCause.${t}`,s,i,a;if(r instanceof globalThis.Error){s=`(${o}) ${r.name}`,i=r.message;let c=i.split(`
`).length;a=r.stack?`(${o}) ${r.stack.split(`
`).slice(0,c+3).join(`
`)}`:`${s}: ${i}`}else s=o,i=cc(r,0),a=`${s}: ${i}`;n.length>0&&(a+=`
    ${n.join(`
    `)}`),super(i),this._tag=t,this.traces=n,this[TG]=Xge,this.name=s,this.stack=a}pipe(){return v(this,arguments)}toString(){return this.stack}[he](){return this.stack}};var ZP=class extends MO{defect;constructor(t,r=[]){super("Die",t,r),this.defect=t}},ebe=(e,t=[])=>new ZP(e,t),YP=class extends MO{constructor(t=[]){super("Interrupt","interrupted",t)}},tbe=(e=[])=>new YP(e);var MG=e=>e._tag==="Interrupt";var IG=Symbol.for("effect/Micro/MicroFiber"),rbe={_A:R,_E:R},vO=class{context;interruptible;[IG];_stack=[];_observers=[];_exit;_children;currentOpCount=0;constructor(t,r=!0){this.context=t,this.interruptible=r,this[IG]=rbe}getRef(t){return Jj(this.context,t)}addObserver(t){return this._exit?(t(this._exit),Ar):(this._observers.push(t),()=>{let r=this._observers.indexOf(t);r>=0&&this._observers.splice(r,1)})}_interrupted=!1;unsafeInterrupt(){this._exit||(this._interrupted=!0,this.interruptible&&this.evaluate(rF))}unsafePoll(){return this._exit}evaluate(t){if(this._exit)return;if(this._yielded!==void 0){let o=this._yielded;this._yielded=void 0,o()}let r=this.runLoop(t);if(r===Mm)return;let n=RG.interruptChildren&&RG.interruptChildren(this);if(n!==void 0)return this.evaluate(ld(n,()=>r));this._exit=r;for(let o=0;o<this._observers.length;o++)this._observers[o](r);this._observers.length=0}runLoop(t){let r=!1,n=t;this.currentOpCount=0;try{for(;;){if(this.currentOpCount++,!r&&this.getRef(Nm).shouldYield(this)){r=!0;let o=n;n=ld(cbe,()=>o)}if(n=n[XP](this),n===Mm){let o=this._yielded;return AO in o?(this._yielded=void 0,o):Mm}}}catch(o){return F(n,XP)?LO(o):LO(`MicroFiber.runLoop: Not a valid effect: ${String(n)}`)}}getCont(t){for(;;){let r=this._stack.pop();if(!r)return;let n=r[PO]&&r[PO](this);if(n)return{[t]:n};if(r[t])return r}}_yielded=void 0;yieldWith(t){return this._yielded=t,Mm}children(){return this._children??=new Set}},RG=ne("effect/Micro/fiberMiddleware",()=>({interruptChildren:void 0}));var nbe=e=>xy(()=>{for(let n of e)n.unsafeInterrupt();let t=e[Symbol.iterator](),r=xy(()=>{let n=t.next();for(;!n.done;){if(n.value.unsafePoll()){n=t.next();continue}let o=n.value;return FG(s=>{o.addObserver(i=>{s(r)})})}return Fm});return r}),vG=Symbol.for("effect/Micro/identifier"),vt=Symbol.for("effect/Micro/args"),XP=Symbol.for("effect/Micro/evaluate"),Qp=Symbol.for("effect/Micro/successCont"),vm=Symbol.for("effect/Micro/failureCont"),PO=Symbol.for("effect/Micro/ensureCont"),Mm=Symbol.for("effect/Micro/Yield"),obe={_A:R,_E:R,_R:R},sbe={...iV,_op:"Micro",[Yge]:obe,pipe(){return v(this,arguments)},[Symbol.iterator](){return new Wl(new qs(this))},toJSON(){return{_id:"Micro",op:this[vG],...vt in this?{args:this[vt]}:void 0}},toString(){return De(this)},[he](){return De(this)}};function ibe(e){return LO("Micro.evaluate: Not implemented")}var qO=e=>({...sbe,[vG]:e.op,[XP]:e.eval??ibe,[Qp]:e.contA,[vm]:e.contE,[PO]:e.ensure}),Jp=e=>{let t=qO(e);return function(){let r=Object.create(t);return r[vt]=e.single===!1?arguments:arguments[0],r}},PG=e=>{let t={...qO(e),[AO]:AO,_tag:e.op,get[e.prop](){return this[vt]},toJSON(){return{_id:"MicroExit",_tag:e.op,[e.prop]:this[vt]}},[W](r){return mbe(r)&&r._tag===e.op&&N(this[vt],r[vt])},[H](){return se(this,G(Ke(e.op))(M(this[vt])))}};return function(r){let n=Object.create(t);return n[vt]=r,n[Qp]=void 0,n[vm]=void 0,n[PO]=void 0,n}},Pm=PG({op:"Success",prop:"value",eval(e){let t=e.getCont(Qp);return t?t[Qp](this[vt],e):e.yieldWith(this)}}),FO=PG({op:"Failure",prop:"cause",eval(e){let t=e.getCont(vm);for(;MG(this[vt])&&t&&e.interruptible;)t=e.getCont(vm);return t?t[vm](this[vt],e):e.yieldWith(this)}});var NO=Jp({op:"Sync",eval(e){let t=this[vt](),r=e.getCont(Qp);return r?r[Qp](t,e):e.yieldWith(HO(t))}}),xy=Jp({op:"Suspend",eval(e){return this[vt]()}}),abe=Jp({op:"Yield",eval(e){let t=!1;return e.getRef(Nm).scheduleTask(()=>{t||e.evaluate(Fm)},this[vt]??0),e.yieldWith(()=>{t=!0})}}),cbe=abe(0);var DO=Pm(void 0);var WO=Jp({op:"WithMicroFiber",eval(e){return this[vt](e)}});var ube=Jp({op:"Async",single:!1,eval(e){let t=this[vt][0],r=!1,n=!1,o=this[vt][1]?new AbortController:void 0,s=t(i=>{r||(r=!0,n?e.evaluate(i):n=i)},o?.signal);return n!==!1?n:(n=!0,e._yielded=()=>{r=!0},o===void 0&&s===void 0||e._stack.push(pbe(()=>(r=!0,o?.abort(),s??Fm))),Mm)}}),pbe=Jp({op:"AsyncFinalizer",ensure(e){e.interruptible&&(e.interruptible=!1,e._stack.push(nF(!0)))},contE(e,t){return MG(e)?ld(this[vt](),()=>FO(e)):FO(e)}}),FG=e=>ube(e,e.length>=2);var lbe=u(2,(e,t)=>hbe(e,r=>t));var fbe=e=>Sbe(e,{onFailure:BO,onSuccess:HO});var ld=u(2,(e,t)=>{let r=Object.create(dbe);return r[vt]=e,r[Qp]=t,r}),dbe=qO({op:"OnSuccess",eval(e){return e._stack.push(this),this[vt]}});var hbe=u(2,(e,t)=>ld(e,r=>Pm(t(r)))),mbe=e=>F(e,AO),HO=Pm,BO=FO,rF=BO(tbe());var LO=e=>BO(ebe(e));var Fm=HO(void 0),xbe=e=>{for(let t of e)if(t._tag==="Failure")return t;return Fm},gbe="setImmediate"in globalThis?globalThis.setImmediate:e=>setTimeout(e,0),UO=class{tasks=[];running=!1;scheduleTask(t,r){this.tasks.push(t),this.running||(this.running=!0,gbe(this.afterScheduled))}afterScheduled=()=>{this.running=!1,this.runTasks()};runTasks(){let t=this.tasks;this.tasks=[];for(let r=0,n=t.length;r<n;r++)t[r]()}shouldYield(t){return t.currentOpCount>=t.getRef(eF)}flush(){for(;this.tasks.length>0;)this.runTasks()}};var bbe=u(2,(e,t)=>WO(r=>{let n=r.context;return r.context=t(n),Ebe(e,()=>(r.context=n,DO))}));var NG=u(2,(e,t)=>bbe(e,_o(t)));var eF=class extends Hi()("effect/Micro/currentMaxOpsBeforeYield",{defaultValue:()=>2048}){},tF=class extends Hi()("effect/Micro/currentConcurrency",{defaultValue:()=>"unbounded"}){},Nm=class extends Hi()("effect/Micro/currentScheduler",{defaultValue:()=>new UO}){};var DG=u(2,(e,t)=>{let r=Object.create(ybe);return r[vt]=e,r[Qp]=t.onSuccess,r[vm]=t.onFailure,r}),ybe=qO({op:"OnSuccessAndFailure",eval(e){return e._stack.push(this),this[vt]}}),Sbe=u(2,(e,t)=>DG(e,{onFailure:r=>NO(()=>t.onFailure(r)),onSuccess:r=>NO(()=>t.onSuccess(r))}));var JP=Symbol.for("effect/Micro/MicroScope");var AG=class e{[JP];state={_tag:"Open",finalizers:new Set};constructor(){this[JP]=JP}unsafeAddFinalizer(t){this.state._tag==="Open"&&this.state.finalizers.add(t)}addFinalizer(t){return xy(()=>this.state._tag==="Open"?(this.state.finalizers.add(t),DO):t(this.state.exit))}unsafeRemoveFinalizer(t){this.state._tag==="Open"&&this.state.finalizers.delete(t)}close(t){return xy(()=>{if(this.state._tag==="Open"){let r=Array.from(this.state.finalizers).reverse();return this.state={_tag:"Closed",exit:t},ld(_be(r,n=>fbe(n(t))),xbe)}return DO})}get fork(){return NO(()=>{let t=new e;if(this.state._tag==="Closed")return t.state=this.state,t;function r(n){return t.close(n)}return this.state.finalizers.add(r),t.unsafeAddFinalizer(n=>NO(()=>this.unsafeRemoveFinalizer(r))),t})}};var Ebe=u(2,(e,t)=>wbe(r=>DG(r(e),{onFailure:n=>ld(t(BO(n)),()=>FO(n)),onSuccess:n=>ld(t(HO(n)),()=>Pm(n))})));var nF=Jp({op:"SetInterruptible",ensure(e){if(e.interruptible=this[vt],e._interrupted&&e.interruptible)return()=>rF}}),Cbe=e=>WO(t=>t.interruptible?e:(t.interruptible=!0,t._stack.push(nF(!1)),t._interrupted?rF:e)),wbe=e=>WO(t=>t.interruptible?(t.interruptible=!1,t._stack.push(nF(!0)),e(Cbe)):e(R));var Obe=Jp({op:"While",contA(e,t){return this[vt].step(e),this[vt].while()?(t._stack.push(this),this[vt].body()):Fm},eval(e){return this[vt].while()?(e._stack.push(this),this[vt].body()):Fm}}),_be=(e,t,r)=>WO(n=>{let o=r?.concurrency==="inherit"?n.getRef(tF):r?.concurrency??1,s=o==="unbounded"?Number.POSITIVE_INFINITY:Math.max(1,o),i=Ee(e),a=i.length;if(a===0)return r?.discard?DO:Pm([]);let c=r?.discard?void 0:new Array(a),l=0;return s===1?lbe(Obe({while:()=>l<i.length,body:()=>t(i[l],l),step:c?f=>c[l++]=f:f=>l++}),c):FG(f=>{let d=new Set,h,m=0,y=0,T=!1,C=!1;function O(){for(T=!0;m<s&&l<a;){let U=l,I=i[U];l++,m++;try{let K=kbe(n,t(I,U),!0,!0);d.add(K),K.addObserver(Q=>{d.delete(K),!C&&(Q._tag==="Failure"?h===void 0&&(h=Q,a=l,d.forEach(z=>z.unsafeInterrupt())):c!==void 0&&(c[U]=Q.value),y++,m--,y===a?f(h??Pm(c)):!T&&m<s&&O())})}catch(K){h=LO(K),a=l,d.forEach(Q=>Q.unsafeInterrupt())}}T=!1}return O(),xy(()=>(C=!0,l=a,nbe(d)))})});var kbe=(e,t,r=!1,n=!1)=>{let o=new vO(e.context,e.interruptible);return n||(e.children().add(o),o.addObserver(()=>e.children().delete(o))),r?o.evaluate(t):e.getRef(Nm).scheduleTask(()=>o.evaluate(t),0),o};var LG=(e,t)=>{let r=new vO(Nm.context(t?.scheduler??new UO));if(r.evaluate(e),t?.signal)if(t.signal.aborted)r.unsafeInterrupt();else{let n=()=>r.unsafeInterrupt();t.signal.addEventListener("abort",n,{once:!0}),r.addObserver(()=>t.signal.removeEventListener("abort",n))}return r};var zO=class{buckets=[];scheduleTask(t,r){let n=this.buckets.length,o,s=0;for(;s<n&&this.buckets[s][0]<=r;s++)o=this.buckets[s];o&&o[0]===r?o[1].push(t):s===n?this.buckets.push([r,[t]]):this.buckets.splice(s,0,[r,[t]])}},oF=class{maxNextTickBeforeTimer;running=!1;tasks=new zO;constructor(t){this.maxNextTickBeforeTimer=t}starveInternal(t){let r=this.tasks.buckets;this.tasks.buckets=[];for(let[n,o]of r)for(let s=0;s<o.length;s++)o[s]();this.tasks.buckets.length===0?this.running=!1:this.starve(t)}starve(t=0){t>=this.maxNextTickBeforeTimer?setTimeout(()=>this.starveInternal(0),0):Promise.resolve(void 0).then(()=>this.starveInternal(t+1))}shouldYield(t){return t.currentOpCount>t.getFiberRef(qb)?t.getFiberRef(Qi):!1}scheduleTask(t,r){this.tasks.scheduleTask(t,r),this.running||(this.running=!0,this.starve())}},qG=ne(Symbol.for("effect/Scheduler/defaultScheduler"),()=>new oF(2048)),Zp=class{tasks=new zO;deferred=!1;scheduleTask(t,r){this.deferred?qG.scheduleTask(t,r):this.tasks.scheduleTask(t,r)}shouldYield(t){return t.currentOpCount>t.getFiberRef(qb)?t.getFiberRef(Qi):!1}flush(){for(;this.tasks.buckets.length>0;){let t=this.tasks.buckets;this.tasks.buckets=[];for(let[r,n]of t)for(let o=0;o<n.length;o++)n[o]()}this.deferred=!0}};var ra=ne(Symbol.for("effect/FiberRef/currentScheduler"),()=>lr(qG)),WG=u(2,(e,t)=>Lt(e,ra,t));var jO=ne(Symbol.for("effect/FiberRef/currentRequestMap"),()=>lr(new Map));var sF=(e,t,r,n)=>{switch(e){case void 0:return t();case"unbounded":return r();case"inherit":return qr(Bb,o=>o==="unbounded"?r():o>1?n(o):t());default:return e>1?n(e):t()}},gy=(e,t,r)=>{switch(e){case void 0:return t();case"unbounded":return r();case"inherit":return qr(Bb,n=>n==="unbounded"||n>1?r():t());default:return e>1?r():t()}};var $O="InterruptSignal",VO="Stateful",GO="Resume",KO="YieldNow",QO=e=>({_tag:$O,cause:e}),Dm=e=>({_tag:VO,onFiber:e}),dd=e=>({_tag:GO,effect:e}),HG=()=>({_tag:KO});var Rbe="effect/FiberScope",JO=Symbol.for(Rbe),iF=class{[JO]=JO;fiberId=Nn;roots=new Set;add(t,r){this.roots.add(r),r.addObserver(()=>{this.roots.delete(r)})}},aF=class{fiberId;parent;[JO]=JO;constructor(t,r){this.fiberId=t,this.parent=r}add(t,r){this.parent.tell(Dm(n=>{n.addChild(r),r.addObserver(()=>{n.removeChild(r)})}))}},zG=e=>new aF(e.id(),e),Xc=ne(Symbol.for("effect/FiberScope/Global"),()=>new iF);var Abe="effect/Fiber",Lm=Symbol.for(Abe),by={_E:e=>e,_A:e=>e},Mbe={[Lm]:by,pipe(){return v(this,arguments)}},vbe="effect/Fiber",ZO=Symbol.for(vbe);var cF=e=>ZO in e,YO=e=>e.await;var XO=e=>e.inheritAll;var uF=u(2,cm(function*(e,t){for(let r of e){if(cF(r)){r.unsafeInterruptAsFork(t);continue}yield*r.interruptAsFork(t)}for(let r of e)cF(r)&&r.unsafePoll()||(yield*r.await)})),pF=u(2,(e,t)=>e.interruptAsFork(t)),_s=e=>Hf($o(e.await),e.inheritAll);var got={...ki,commit(){return _s(this)},...Mbe,id:()=>Nn,await:Np,children:S([]),inheritAll:Np,poll:S(g()),interruptAsFork:()=>Np};var $G=e=>e.poll;var Yp="effect/FiberCurrent";var Pbe="effect/Logger",Um=Symbol.for(Pbe),fF={_Message:e=>e,_Output:e=>e},On=e=>({[Um]:fF,log:e,pipe(){return v(this,arguments)}}),VG=u(2,(e,t)=>On(r=>e.log({...r,message:t(r.message)}))),e_=u(2,(e,t)=>On(r=>e.log(t(r)))),GG=u(2,(e,t)=>On(r=>t(r.logLevel)?x(e.log(r)):g())),Sy=u(2,(e,t)=>On(r=>t(e.log(r)))),KG={[Um]:fF,log:Ar,pipe(){return v(this,arguments)}},t_=e=>({[Um]:fF,log:({message:t})=>e(t),pipe(){return v(this,arguments)}}),QG=e=>t_(()=>e),JG=e=>t_(e),r_=u(2,(e,t)=>On(r=>[e.log(r),t.log(r)])),ZG=u(2,(e,t)=>Sy(r_(e,t),r=>r[0])),YG=u(2,(e,t)=>Sy(r_(e,t),r=>r[1])),Fbe=/^[^\s"=]*$/,XG=(e,t)=>({annotations:r,cause:n,date:o,fiberId:s,logLevel:i,message:a,spans:c})=>{let l=y=>y.match(Fbe)?y:e(y),f=(y,T)=>`${xP(y)}=${l(T)}`,d=(y,T)=>" "+f(y,T),h=f("timestamp",o.toISOString());h+=d("level",i.label),h+=d("fiber",wf(s));let m=Kl(a);for(let y=0;y<m.length;y++)h+=d("message",cc(m[y],t));uv(n)||(h+=d("cause",zo(n,{renderErrorCause:!0})));for(let y of c)h+=" "+ny(o.getTime())(y);for(let[y,T]of r)h+=d(y,cc(T,t));return h},Nbe=e=>`"${e.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`,n_=On(XG(Nbe)),o_=On(XG(JSON.stringify,0)),Ey=On(({annotations:e,cause:t,date:r,fiberId:n,logLevel:o,message:s,spans:i})=>{let a=r.getTime(),c={},l={};if(jC(e)>0)for(let[d,h]of e)c[d]=yy(h);if(Of(i))for(let d of i)l[d.label]=a-d.startTime;let f=Kl(s);return{message:f.length===1?yy(f[0]):f.map(yy),logLevel:o.label,timestamp:r.toISOString(),cause:vf(t)?void 0:zo(t,{renderErrorCause:!0}),annotations:c,spans:l,fiberId:wf(n)}}),yy=e=>{switch(typeof e){case"bigint":case"function":case"symbol":return String(e);default:return ve(e)}},s_=Sy(Ey,Cg),e7=e=>typeof e=="object"&&e!=null&&Um in e,Dbe=(e,...t)=>{let r="";for(let n=0;n<t.length;n++)r+=`\x1B[${t[n]}m`;return r+e+"\x1B[0m"},Lbe=(e,...t)=>e,ci={bold:"1",red:"31",green:"32",yellow:"33",blue:"34",cyan:"36",white:"37",gray:"90",black:"30",bgBrightRed:"101"},Ube={None:[],All:[],Trace:[ci.gray],Debug:[ci.blue],Info:[ci.green],Warning:[ci.yellow],Error:[ci.red],Fatal:[ci.bgBrightRed,ci.black]},qbe={None:"",All:"",Trace:"color:gray",Debug:"color:blue",Info:"color:green",Warning:"color:orange",Error:"color:red",Fatal:"background-color:red;color:white"},Wbe=e=>`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:${e.getSeconds().toString().padStart(2,"0")}.${e.getMilliseconds().toString().padStart(3,"0")}`,t7=typeof process=="object"&&process!==null&&typeof process.stdout=="object"&&process.stdout!==null,Hbe=t7&&process.stdout.isTTY===!0,Bbe=t7||"Deno"in globalThis,dF=e=>{let t=e?.mode??"auto",n=(t==="auto"?Bbe?"tty":"browser":t)==="browser",o=typeof e?.colors=="boolean"?e.colors:Hbe||n,s=e?.formatDate??Wbe;return n?jbe({colors:o,formatDate:s}):zbe({colors:o,formatDate:s,stderr:e?.stderr===!0})},zbe=e=>{let t=e.colors?Dbe:Lbe;return On(({annotations:r,cause:n,context:o,date:s,fiberId:i,logLevel:a,message:c,spans:l})=>{let f=td(o,Ot),d=jt(f,Zo).unsafe,h=e.stderr===!0?d.error:d.log,m=Kl(c),y=t(`[${e.formatDate(s)}]`,ci.white)+` ${t(a.label,...Ube[a._tag])} (${wf(i)})`;if(Of(l)){let C=s.getTime(),O=ny(C);for(let U of l)y+=" "+O(U)}y+=":";let T=0;if(m.length>0){let C=yy(m[0]);typeof C=="string"&&(y+=" "+t(C,ci.bold,ci.cyan),T++)}if(h(y),d.group(),vf(n)||h(zo(n,{renderErrorCause:!0})),T<m.length)for(;T<m.length;T++)h(fh(m[T]));if(jC(r)>0)for(let[C,O]of r)h(t(`${C}:`,ci.bold,ci.white),fh(O));d.groupEnd()})},jbe=e=>{let t=e.colors?"%c":"";return On(({annotations:r,cause:n,context:o,date:s,fiberId:i,logLevel:a,message:c,spans:l})=>{let f=td(o,Ot),d=jt(f,Zo).unsafe,h=Kl(c),m=`${t}[${e.formatDate(s)}]`,y=[];if(e.colors&&y.push("color:gray"),m+=` ${t}${a.label}${t} (${wf(i)})`,e.colors&&y.push(qbe[a._tag],""),Of(l)){let C=s.getTime(),O=ny(C);for(let U of l)m+=" "+O(U)}m+=":";let T=0;if(h.length>0){let C=yy(h[0]);typeof C=="string"&&(m+=` ${t}${C}`,e.colors&&y.push("color:deepskyblue"),T++)}if(d.groupCollapsed(m,...y),vf(n)||d.error(zo(n,{renderErrorCause:!0})),T<h.length)for(;T<h.length;T++)d.log(fh(h[T]));if(jC(r)>0)for(let[C,O]of r){let U=fh(O);e.colors?d.log(`%c${C}:`,"color:gray",U):d.log(`${C}:`,U)}d.groupEnd()})},i_=ne("effect/Logger/prettyLoggerDefault",()=>dF());var n7="effect/MetricBoundaries",hF=Symbol.for(n7),mF=class{values;[hF]=hF;constructor(t){this.values=t,this._hash=p(Ke(n7),G(qo(this.values)))}_hash;[H](){return this._hash}[W](t){return $be(t)&&N(this.values,t.values)}pipe(){return v(this,arguments)}},$be=e=>F(e,hF),xF=e=>{let t=p(e,X1(V(Number.POSITIVE_INFINITY)),lR);return new mF(t)};var a_=e=>p(wE(e.count-1,t=>e.start*Math.pow(e.factor,t)),Le,xF);var Vbe="effect/MetricKeyType",Cy=Symbol.for(Vbe),s7="effect/MetricKeyType/Counter",gF=Symbol.for(s7),i7="effect/MetricKeyType/Frequency",bF=Symbol.for(i7),a7="effect/MetricKeyType/Gauge",yF=Symbol.for(a7),c7="effect/MetricKeyType/Histogram",SF=Symbol.for(c7),u7="effect/MetricKeyType/Summary",EF=Symbol.for(u7),wy={_In:e=>e,_Out:e=>e},CF=class{incremental;bigint;[Cy]=wy;[gF]=gF;constructor(t,r){this.incremental=t,this.bigint=r,this._hash=Ke(s7)}_hash;[H](){return this._hash}[W](t){return qm(t)}pipe(){return v(this,arguments)}},Gbe=Ke(i7),wF=class{preregisteredWords;[Cy]=wy;[bF]=bF;constructor(t){this.preregisteredWords=t}[H](){return Gbe}[W](t){return TF(t)}pipe(){return v(this,arguments)}},Kbe=Ke(a7),OF=class{bigint;[Cy]=wy;[yF]=yF;constructor(t){this.bigint=t}[H](){return Kbe}[W](t){return IF(t)}pipe(){return v(this,arguments)}},_F=class{boundaries;[Cy]=wy;[SF]=SF;constructor(t){this.boundaries=t,this._hash=p(Ke(c7),G(M(this.boundaries)))}_hash;[H](){return this._hash}[W](t){return RF(t)&&N(this.boundaries,t.boundaries)}pipe(){return v(this,arguments)}},kF=class{maxAge;maxSize;error;quantiles;[Cy]=wy;[EF]=EF;constructor(t,r,n,o){this.maxAge=t,this.maxSize=r,this.error=n,this.quantiles=o,this._hash=p(Ke(u7),G(M(this.maxAge)),G(M(this.maxSize)),G(M(this.error)),G(qo(this.quantiles)))}_hash;[H](){return this._hash}[W](t){return AF(t)&&N(this.maxAge,t.maxAge)&&this.maxSize===t.maxSize&&this.error===t.error&&N(this.quantiles,t.quantiles)}pipe(){return v(this,arguments)}},p7=e=>new CF(e?.incremental??!1,e?.bigint??!1),l7=e=>new wF(e?.preregisteredWords??[]),f7=e=>new OF(e?.bigint??!1),d7=e=>new _F(e),h7=e=>new kF(Qe(e.maxAge),e.maxSize,e.error,e.quantiles);var qm=e=>F(e,gF),TF=e=>F(e,bF),IF=e=>F(e,yF),RF=e=>F(e,SF),AF=e=>F(e,EF);var Qbe="effect/MetricKey",m7=Symbol.for(Qbe),Jbe={_Type:e=>e},Zbe=An(N),Xp=class{name;keyType;description;tags;[m7]=Jbe;constructor(t,r,n,o=[]){this.name=t,this.keyType=r,this.description=n,this.tags=o,this._hash=p(Ke(this.name+this.description),G(M(this.keyType)),G(qo(this.tags)))}_hash;[H](){return this._hash}[W](t){return Ybe(t)&&this.name===t.name&&N(this.keyType,t.keyType)&&N(this.description,t.description)&&Zbe(this.tags,t.tags)}pipe(){return v(this,arguments)}},Ybe=e=>F(e,m7),x7=(e,t)=>new Xp(e,p7(t),br(t?.description)),g7=(e,t)=>new Xp(e,l7(t),br(t?.description)),b7=(e,t)=>new Xp(e,f7(t),br(t?.description)),y7=(e,t,r)=>new Xp(e,d7(t),br(r)),S7=e=>new Xp(e.name,h7(e),br(e.description));var E7=u(2,(e,t)=>t.length===0?e:new Xp(e.name,e.keyType,e.description,fs(e.tags,t)));var eye="effect/MetricState",Oy=Symbol.for(eye),C7="effect/MetricState/Counter",vF=Symbol.for(C7),w7="effect/MetricState/Frequency",PF=Symbol.for(w7),O7="effect/MetricState/Gauge",FF=Symbol.for(O7),_7="effect/MetricState/Histogram",NF=Symbol.for(_7),k7="effect/MetricState/Summary",DF=Symbol.for(k7),_y={_A:e=>e},LF=class{count;[Oy]=_y;[vF]=vF;constructor(t){this.count=t}[H](){return p(M(C7),G(M(this.count)),se(this))}[W](t){return rye(t)&&this.count===t.count}pipe(){return v(this,arguments)}},tye=An(N),UF=class{occurrences;[Oy]=_y;[PF]=PF;constructor(t){this.occurrences=t}_hash;[H](){return p(Ke(w7),G(qo(Ee(this.occurrences.entries()))),se(this))}[W](t){return nye(t)&&tye(Ee(this.occurrences.entries()),Ee(t.occurrences.entries()))}pipe(){return v(this,arguments)}},qF=class{value;[Oy]=_y;[FF]=FF;constructor(t){this.value=t}[H](){return p(M(O7),G(M(this.value)),se(this))}[W](t){return oye(t)&&this.value===t.value}pipe(){return v(this,arguments)}},WF=class{buckets;count;min;max;sum;[Oy]=_y;[NF]=NF;constructor(t,r,n,o,s){this.buckets=t,this.count=r,this.min=n,this.max=o,this.sum=s}[H](){return p(M(_7),G(M(this.buckets)),G(M(this.count)),G(M(this.min)),G(M(this.max)),G(M(this.sum)),se(this))}[W](t){return sye(t)&&N(this.buckets,t.buckets)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return v(this,arguments)}},HF=class{error;quantiles;count;min;max;sum;[Oy]=_y;[DF]=DF;constructor(t,r,n,o,s,i){this.error=t,this.quantiles=r,this.count=n,this.min=o,this.max=s,this.sum=i}[H](){return p(M(k7),G(M(this.error)),G(M(this.quantiles)),G(M(this.count)),G(M(this.min)),G(M(this.max)),G(M(this.sum)),se(this))}[W](t){return iye(t)&&this.error===t.error&&N(this.quantiles,t.quantiles)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return v(this,arguments)}},T7=e=>new LF(e),I7=e=>new UF(e),R7=e=>new qF(e),A7=e=>new WF(e.buckets,e.count,e.min,e.max,e.sum),M7=e=>new HF(e.error,e.quantiles,e.count,e.min,e.max,e.sum);var rye=e=>F(e,vF),nye=e=>F(e,PF),oye=e=>F(e,FF),sye=e=>F(e,NF),iye=e=>F(e,DF);var cye="effect/MetricHook",uye=Symbol.for(cye),pye={_In:e=>e,_Out:e=>e},ky=e=>({[uye]:pye,pipe(){return v(this,arguments)},...e});var v7=BigInt(0),F7=e=>{let t=e.keyType.bigint?v7:0,r=e.keyType.incremental?e.keyType.bigint?o=>o>=v7:o=>o>=0:o=>!0,n=o=>{r(o)&&(t=t+o)};return ky({get:()=>T7(t),update:n,modify:n})},N7=e=>{let t=new Map;for(let n of e.keyType.preregisteredWords)t.set(n,0);let r=n=>{let o=t.get(n)??0;t.set(n,o+1)};return ky({get:()=>I7(t),update:r,modify:r})},D7=(e,t)=>{let r=t;return ky({get:()=>R7(r),update:n=>{r=n},modify:n=>{r=r+n}})},L7=e=>{let t=e.keyType.boundaries.values,r=t.length,n=new Uint32Array(r+1),o=new Float64Array(r),s=0,i=0,a=Number.MAX_VALUE,c=Number.MIN_VALUE;p(t,dc(Fi),Ai((d,h)=>{o[h]=d}));let l=d=>{let h=0,m=r;for(;h!==m;){let y=Math.floor(h+(m-h)/2),T=o[y];d<=T?m=y:h=y,m===h+1&&(d<=o[h]?m=h:h=m)}n[h]=n[h]+1,s=s+1,i=i+d,d<a&&(a=d),d>c&&(c=d)},f=()=>{let d=Gl(r),h=0;for(let m=0;m<r;m++){let y=o[m],T=n[m];h=h+T,d[m]=[y,h]}return d};return ky({get:()=>A7({buckets:f(),count:s,min:a,max:c,sum:i}),update:l,modify:l})},U7=e=>{let{error:t,maxAge:r,maxSize:n,quantiles:o}=e.keyType,s=p(o,dc(Fi)),i=Gl(n),a=0,c=0,l=0,f=0,d=0,h=y=>{let T=[],C=0;for(;C!==n-1;){let O=i[C];if(O!=null){let[U,I]=O,K=wn(y-U);cb(K,Pa)&&wC(K,r)&&T.push(I)}C=C+1}return lye(t,s,dc(T,Fi))},m=(y,T)=>{if(n>0){a=a+1;let C=a%n;i[C]=[T,y]}f=c===0?y:Math.min(f,y),d=c===0?y:Math.max(d,y),c=c+1,l=l+y};return ky({get:()=>M7({error:t,quantiles:h(Date.now()),count:c,min:f,max:d,sum:l}),update:([y,T])=>m(y,T),modify:([y,T])=>m(y,T)})},lye=(e,t,r)=>{let n=r.length;if(!ut(t))return ds();let o=t[0],s=t.slice(1),i=P7(e,n,g(),0,o,r),a=Vr(i);return s.forEach(c=>{a.push(P7(e,n,i.value,i.consumed,c,i.rest))}),Ai(a,c=>[c.quantile,c.value])},P7=(e,t,r,n,o,s)=>{let i=e,a=t,c=r,l=n,f=o,d=s,h=e,m=t,y=r,T=n,C=o,O=s;for(;;){if(!ut(d))return{quantile:f,value:g(),consumed:l,rest:[]};if(f===1)return{quantile:f,value:x(rR(d)),consumed:l+d.length,rest:[]};let U=Lr(d),I=Rz(d,ce=>ce===U),K=f*a,Q=i/2*K,z=l+I[0].length,te=Math.abs(z-K);if(z<K-Q){h=i,m=a,y=Ia(d),T=z,C=f,O=I[1],i=h,a=m,c=y,l=T,f=C,d=O;continue}if(z>K+Q){let ce=ge(c)?x(U):c;return{quantile:f,value:ce,consumed:l,rest:d}}switch(c._tag){case"None":{h=i,m=a,y=Ia(d),T=z,C=f,O=I[1],i=h,a=m,c=y,l=T,f=C,d=O;continue}case"Some":{let ce=Math.abs(K-c.value);if(te<ce){h=i,m=a,y=Ia(d),T=z,C=f,O=I[1],i=h,a=m,c=y,l=T,f=C,d=O;continue}return{quantile:f,value:x(c.value),consumed:l,rest:d}}}}throw new Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/effect/issues")};var dye="effect/MetricPair",hye=Symbol.for(dye),mye={_Type:e=>e};var q7=(e,t)=>({[hye]:mye,metricKey:e,metricState:t,pipe(){return v(this,arguments)}});var gye="effect/MetricRegistry",W7=Symbol.for(gye),BF=class{[W7]=W7;map=Yf();snapshot(){let t=[];for(let[r,n]of this.map)t.push(q7(r,n.get()));return t}get(t){let r=p(this.map,Wr(t),yr);if(r==null){if(qm(t.keyType))return this.getCounter(t);if(IF(t.keyType))return this.getGauge(t);if(TF(t.keyType))return this.getFrequency(t);if(RF(t.keyType))return this.getHistogram(t);if(AF(t.keyType))return this.getSummary(t);throw new Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/effect/issues")}else return r}getCounter(t){let r=p(this.map,Wr(t),yr);if(r==null){let n=F7(t);p(this.map,Xi(t))||p(this.map,Qo(t,n)),r=n}return r}getFrequency(t){let r=p(this.map,Wr(t),yr);if(r==null){let n=N7(t);p(this.map,Xi(t))||p(this.map,Qo(t,n)),r=n}return r}getGauge(t){let r=p(this.map,Wr(t),yr);if(r==null){let n=D7(t,t.keyType.bigint?BigInt(0):0);p(this.map,Xi(t))||p(this.map,Qo(t,n)),r=n}return r}getHistogram(t){let r=p(this.map,Wr(t),yr);if(r==null){let n=L7(t);p(this.map,Xi(t))||p(this.map,Qo(t,n)),r=n}return r}getSummary(t){let r=p(this.map,Wr(t),yr);if(r==null){let n=U7(t);p(this.map,Xi(t))||p(this.map,Qo(t,n)),r=n}return r}},H7=()=>new BF;var yye="effect/Metric",zF=Symbol.for(yye),Sye={_Type:e=>e,_In:e=>e,_Out:e=>e},Ty=ne(Symbol.for("effect/Metric/globalMetricRegistry"),()=>H7()),na=function(e,t,r,n){let o=Object.assign(s=>Nr(s,i=>ui(o,i)),{[zF]:Sye,keyType:e,unsafeUpdate:t,unsafeValue:r,unsafeModify:n,register(){return this.unsafeValue([]),this},pipe(){return v(this,arguments)}});return o},Wm=u(2,(e,t)=>na(e.keyType,(r,n)=>e.unsafeUpdate(t(r),n),e.unsafeValue,(r,n)=>e.unsafeModify(t(r),n))),hd=(e,t)=>md(x7(e,t)),B7=(e,t)=>md(g7(e,t)),z7=u(2,(e,t)=>Wm(e,()=>t)),md=e=>{let t,r=new WeakMap,n=o=>{if(o.length===0)return t!==void 0||(t=Ty.get(e)),t;let s=r.get(o);return s!==void 0||(s=Ty.get(E7(e,o)),r.set(o,s)),s};return na(e.keyType,(o,s)=>n(s).update(o),o=>n(o).get(),(o,s)=>n(s).modify(o))},j7=(e,t)=>md(b7(e,t)),Hm=(e,t,r)=>md(y7(e,t,r)),$7=e=>qm(e.keyType)?ui(e,e.keyType.bigint?BigInt(1):1):c_(e,e.keyType.bigint?BigInt(1):1),V7=u(2,(e,t)=>qm(e.keyType)?ui(e,t):c_(e,t)),jF=u(2,(e,t)=>na(e.keyType,e.unsafeUpdate,r=>t(e.unsafeValue(r)),e.unsafeModify)),G7=u(2,(e,t)=>na(t(e.keyType),e.unsafeUpdate,e.unsafeValue,e.unsafeModify)),c_=u(2,(e,t)=>qr(ni,r=>E(()=>e.unsafeModify(t,r)))),K7=u(2,(e,t)=>ui(e,t)),Q7=e=>na(void 0,Ar,()=>e,Ar),J7=e=>na(void 0,Ar,e,Ar),Z7=e=>ZF($F(e)),$F=e=>md(S7(e)),Bm=u(3,(e,t,r)=>VF(e,[id(t,r)])),Y7=u(2,(e,t)=>jF(na(e.keyType,(r,n)=>e.unsafeUpdate(r,fs(t(r),n)),e.unsafeValue,(r,n)=>e.unsafeModify(r,fs(t(r),n))),Ar)),VF=u(2,(e,t)=>na(e.keyType,(r,n)=>e.unsafeUpdate(r,fs(t,n)),r=>e.unsafeValue(fs(t,r)),(r,n)=>e.unsafeModify(r,fs(t,n)))),X7=(e,t)=>{let r=a_({start:.5,factor:2,count:35}),n=p(Hm(e,r,t),Bm("time_unit","milliseconds"));return Wm(n,Kr)},eK=(e,t,r)=>{let n=p(Hm(e,xF(t),r),Bm("time_unit","milliseconds"));return Wm(n,Kr)},tK=u(2,(e,t)=>r=>Gt(r,{onFailure:n=>we(ui(e,t),Re(n)),onSuccess:n=>we(ui(e,t),S(n))})),rK=u(2,(e,t)=>GF(e,t,R)),GF=u(3,(e,t,r)=>{let n=o=>ui(t,r(o));return SO(e,o=>Vo(Ff(o),n))}),nK=u(2,(e,t)=>KF(e,t,R)),KF=u(3,(e,t,r)=>Zw(n=>{let o=n.unsafeCurrentTimeNanos();return Nr(e,s=>{let i=n.unsafeCurrentTimeNanos(),a=Ks(i-o);return ui(t,r(a))})})),oK=u(2,(e,t)=>QF(e,t,r=>r)),QF=u(3,(e,t,r)=>dy(e,o=>ui(t,r(o)))),sK=u(2,(e,t)=>JF(e,t,r=>r)),JF=u(3,(e,t,r)=>Nr(e,o=>ui(t,r(o)))),ui=u(2,(e,t)=>qr(ni,r=>E(()=>e.unsafeUpdate(t,r)))),iK=e=>qr(ni,t=>E(()=>e.unsafeValue(t))),ZF=e=>Wm(e,t=>[t,Date.now()]),aK=u(2,(e,t)=>na([e.keyType,t.keyType],(r,n)=>{let[o,s]=r;e.unsafeUpdate(o,n),t.unsafeUpdate(s,n)},r=>[e.unsafeValue(r),t.unsafeValue(r)],(r,n)=>{let[o,s]=r;e.unsafeModify(o,n),t.unsafeModify(s,n)})),YF=()=>Ty.snapshot(),cK=E(YF);var Eye="effect/Request",XF=Symbol.for(Eye),Cye={_E:e=>e,_A:e=>e},wye={...bh,[XF]:Cye},pK=e=>F(e,XF);var lK=(function(){function e(t){t&&Object.assign(this,t)}return e.prototype=wye,e})();var e2=u(2,(e,t)=>qr(jO,r=>E(()=>{if(r.has(e)){let n=r.get(e);n.state.completed||(n.state.completed=!0,za(n.result,t))}})));var zm=class{count=0;observers=new Set;interrupted=!1;addObserver(t){this.observers.add(t)}removeObserver(t){this.observers.delete(t)}increment(){this.count++,this.observers.forEach(t=>t(this.count))}decrement(){this.count--,this.observers.forEach(t=>t(this.count))}};var el={Forward:0,Backward:1},u_=class e{self;stack;direction;count=0;constructor(t,r,n){this.self=t,this.stack=r,this.direction=n}clone(){return new e(this.self,this.stack.slice(),this.direction)}reversed(){return new e(this.self,this.stack.slice(),this.direction===el.Forward?el.Backward:el.Forward)}next(){let t=this.entry;switch(this.count++,this.direction===el.Forward?this.moveNext():this.movePrev(),t._tag){case"None":return{done:!0,value:this.count};case"Some":return{done:!1,value:t.value}}}get key(){return this.stack.length>0?x(this.stack[this.stack.length-1].key):g()}get value(){return this.stack.length>0?x(this.stack[this.stack.length-1].value):g()}get entry(){return ct(OE(this.stack),t=>[t.key,t.value])}get index(){let t=0,r=this.stack;if(r.length===0){let n=this.self._root;return n!=null?n.count:0}else r[r.length-1].left!=null&&(t=r[r.length-1].left.count);for(let n=r.length-2;n>=0;--n)r[n+1]===r[n].right&&(++t,r[n].left!=null&&(t+=r[n].left.count));return t}moveNext(){let t=this.stack;if(t.length===0)return;let r=t[t.length-1];if(r.right!=null)for(r=r.right;r!=null;)t.push(r),r=r.left;else for(t.pop();t.length>0&&t[t.length-1].right===r;)r=t[t.length-1],t.pop()}get hasNext(){let t=this.stack;if(t.length===0)return!1;if(t[t.length-1].right!=null)return!0;for(let r=t.length-1;r>0;--r)if(t[r-1].left===t[r])return!0;return!1}movePrev(){let t=this.stack;if(t.length===0)return;let r=t[t.length-1];if(r!=null&&r.left!=null)for(r=r.left;r!=null;)t.push(r),r=r.right;else for(t.pop();t.length>0&&t[t.length-1].left===r;)r=t[t.length-1],t.pop()}get hasPrev(){let t=this.stack;if(t.length===0)return!1;if(t[t.length-1].left!=null)return!0;for(let r=t.length-1;r>0;--r)if(t[r-1].right===t[r])return!0;return!1}};var fe={Red:0,Black:1},oa=({color:e,count:t,key:r,left:n,right:o,value:s})=>({color:e,key:r,value:s,left:n,right:o,count:t});function t2(e,t){e.key=t.key,e.value=t.value,e.left=t.left,e.right=t.right,e.color=t.color,e.count=t.count}var eu=({count:e,key:t,left:r,right:n,value:o},s)=>({color:s,key:t,value:o,left:r,right:n,count:e}),fr=e=>{e.count=1+(e.left?.count??0)+(e.right?.count??0)};var fK="effect/RedBlackTree",r2=Symbol.for(fK),kye={_Key:e=>e,_Value:e=>e},Tye={[r2]:kye,[H](){let e=M(fK);for(let t of this)e^=p(M(t[0]),G(M(t[1])));return se(this,e)},[W](e){if(dK(e)){if((this._root?.count??0)!==(e._root?.count??0))return!1;let t=Array.from(e);return Array.from(this).every((r,n)=>{let o=t[n];return N(r[0],o[0])&&N(r[1],o[1])})}return!1},[Symbol.iterator](){let e=[],t=this._root;for(;t!=null;)e.push(t),t=t.left;return new u_(this,e,el.Forward)},toString(){return De(this.toJSON())},toJSON(){return{_id:"RedBlackTree",values:Array.from(this).map(ve)}},[he](){return this.toJSON()},pipe(){return v(this,arguments)}},jm=(e,t)=>{let r=Object.create(Tye);return r._ord=e,r._root=t,r},dK=e=>F(e,r2),hK=e=>jm(e,void 0),mK=u(2,(e,t)=>{let r=hK(t);for(let[n,o]of e)r=o2(r,n,o);return r});var xK=u(2,(e,t)=>{let r=e._ord,n=e._root;for(;n!==void 0;){let o=r(t,n.key);if(N(t,n.key))return x(n.value);o<=0?n=n.left:n=n.right}return g()});var n2=u(2,(e,t)=>X(xK(e,t))),o2=u(3,(e,t,r)=>{let n=e._ord,o=e._root,s=[],i=[];for(;o!=null;){let a=n(t,o.key);s.push(o),i.push(a),a<=0?o=o.left:o=o.right}s.push({color:fe.Red,key:t,value:r,left:void 0,right:void 0,count:1});for(let a=s.length-2;a>=0;--a){let c=s[a];i[a]<=0?s[a]={color:c.color,key:c.key,value:c.value,left:s[a+1],right:c.right,count:c.count+1}:s[a]={color:c.color,key:c.key,value:c.value,left:c.left,right:s[a+1],count:c.count+1}}for(let a=s.length-1;a>1;--a){let c=s[a-1],l=s[a];if(c.color===fe.Black||l.color===fe.Black)break;let f=s[a-2];if(f.left===c)if(c.left===l){let d=f.right;if(d&&d.color===fe.Red)c.color=fe.Black,f.right=eu(d,fe.Black),f.color=fe.Red,a-=1;else{if(f.color=fe.Red,f.left=c.right,c.color=fe.Black,c.right=f,s[a-2]=c,s[a-1]=l,fr(f),fr(c),a>=3){let h=s[a-3];h.left===f?h.left=c:h.right=c}break}}else{let d=f.right;if(d&&d.color===fe.Red)c.color=fe.Black,f.right=eu(d,fe.Black),f.color=fe.Red,a-=1;else{if(c.right=l.left,f.color=fe.Red,f.left=l.right,l.color=fe.Black,l.left=c,l.right=f,s[a-2]=l,s[a-1]=c,fr(f),fr(c),fr(l),a>=3){let h=s[a-3];h.left===f?h.left=l:h.right=l}break}}else if(c.right===l){let d=f.left;if(d&&d.color===fe.Red)c.color=fe.Black,f.left=eu(d,fe.Black),f.color=fe.Red,a-=1;else{if(f.color=fe.Red,f.right=c.left,c.color=fe.Black,c.left=f,s[a-2]=c,s[a-1]=l,fr(f),fr(c),a>=3){let h=s[a-3];h.right===f?h.right=c:h.left=c}break}}else{let d=f.left;if(d&&d.color===fe.Red)c.color=fe.Black,f.left=eu(d,fe.Black),f.color=fe.Red,a-=1;else{if(c.left=l.right,f.color=fe.Red,f.right=l.left,l.color=fe.Black,l.right=c,l.left=f,s[a-2]=l,s[a-1]=c,fr(f),fr(c),fr(l),a>=3){let h=s[a-3];h.right===f?h.right=l:h.left=l}break}}}return s[0].color=fe.Black,jm(e._ord,s[0])}),gK=e=>bK(e,el.Forward);var bK=(e,t)=>{let r=e[Symbol.iterator](),n=0;return{[Symbol.iterator]:()=>bK(e,t),next:()=>{n++;let o=r.key;switch(t===el.Forward?r.moveNext():r.movePrev(),o._tag){case"None":return{done:!0,value:n};case"Some":return{done:!1,value:o.value}}}}};var yK=u(2,(e,t)=>{if(!n2(e,t))return e;let r=e._ord,n=r,o=e._root,s=[];for(;o!==void 0;){let c=n(t,o.key);s.push(o),N(t,o.key)?o=void 0:c<=0?o=o.left:o=o.right}if(s.length===0)return e;let i=new Array(s.length),a=s[s.length-1];i[i.length-1]={color:a.color,key:a.key,value:a.value,left:a.left,right:a.right,count:a.count};for(let c=s.length-2;c>=0;--c)a=s[c],a.left===s[c+1]?i[c]={color:a.color,key:a.key,value:a.value,left:i[c+1],right:a.right,count:a.count}:i[c]={color:a.color,key:a.key,value:a.value,left:a.left,right:i[c+1],count:a.count};if(a=i[i.length-1],a.left!==void 0&&a.right!==void 0){let c=i.length;for(a=a.left;a.right!=null;)i.push(a),a=a.right;let l=i[c-1];i.push({color:a.color,key:l.key,value:l.value,left:a.left,right:a.right,count:a.count}),i[c-1].key=a.key,i[c-1].value=a.value;for(let f=i.length-2;f>=c;--f)a=i[f],i[f]={color:a.color,key:a.key,value:a.value,left:a.left,right:i[f+1],count:a.count};i[c-1].left=i[c]}if(a=i[i.length-1],a.color===fe.Red){let c=i[i.length-2];c.left===a?c.left=void 0:c.right===a&&(c.right=void 0),i.pop();for(let l=0;l<i.length;++l)i[l].count--;return jm(r,i[0])}else if(a.left!==void 0||a.right!==void 0){a.left!==void 0?t2(a,a.left):a.right!==void 0&&t2(a,a.right),a.color=fe.Black;for(let c=0;c<i.length-1;++c)i[c].count--;return jm(r,i[0])}else{if(i.length===1)return jm(r,void 0);{for(let l=0;l<i.length;++l)i[l].count--;let c=i[i.length-2];Iye(i),c.left===a?c.left=void 0:c.right=void 0}}return jm(r,i[0])});var Iye=e=>{let t,r,n,o;for(let s=e.length-1;s>=0;--s){if(t=e[s],s===0){t.color=fe.Black;return}if(r=e[s-1],r.left===t){if(n=r.right,n!==void 0&&n.right!==void 0&&n.right.color===fe.Red){if(n=r.right=oa(n),o=n.right=oa(n.right),r.right=n.left,n.left=r,n.right=o,n.color=r.color,t.color=fe.Black,r.color=fe.Black,o.color=fe.Black,fr(r),fr(n),s>1){let i=e[s-2];i.left===r?i.left=n:i.right=n}e[s-1]=n;return}else if(n!==void 0&&n.left!==void 0&&n.left.color===fe.Red){if(n=r.right=oa(n),o=n.left=oa(n.left),r.right=o.left,n.left=o.right,o.left=r,o.right=n,o.color=r.color,r.color=fe.Black,n.color=fe.Black,t.color=fe.Black,fr(r),fr(n),fr(o),s>1){let i=e[s-2];i.left===r?i.left=o:i.right=o}e[s-1]=o;return}if(n!==void 0&&n.color===fe.Black)if(r.color===fe.Red){r.color=fe.Black,r.right=eu(n,fe.Red);return}else{r.right=eu(n,fe.Red);continue}else if(n!==void 0){if(n=oa(n),r.right=n.left,n.left=r,n.color=r.color,r.color=fe.Red,fr(r),fr(n),s>1){let i=e[s-2];i.left===r?i.left=n:i.right=n}e[s-1]=n,e[s]=r,s+1<e.length?e[s+1]=t:e.push(t),s=s+2}}else{if(n=r.left,n!==void 0&&n.left!==void 0&&n.left.color===fe.Red){if(n=r.left=oa(n),o=n.left=oa(n.left),r.left=n.right,n.right=r,n.left=o,n.color=r.color,t.color=fe.Black,r.color=fe.Black,o.color=fe.Black,fr(r),fr(n),s>1){let i=e[s-2];i.right===r?i.right=n:i.left=n}e[s-1]=n;return}else if(n!==void 0&&n.right!==void 0&&n.right.color===fe.Red){if(n=r.left=oa(n),o=n.right=oa(n.right),r.left=o.right,n.right=o.left,o.right=r,o.left=n,o.color=r.color,r.color=fe.Black,n.color=fe.Black,t.color=fe.Black,fr(r),fr(n),fr(o),s>1){let i=e[s-2];i.right===r?i.right=o:i.left=o}e[s-1]=o;return}if(n!==void 0&&n.color===fe.Black)if(r.color===fe.Red){r.color=fe.Black,r.left=eu(n,fe.Red);return}else{r.left=eu(n,fe.Red);continue}else if(n!==void 0){if(n=oa(n),r.left=n.right,n.right=r,n.color=r.color,r.color=fe.Red,fr(r),fr(n),s>1){let i=e[s-2];i.right===r?i.right=n:i.left=n}e[s-1]=n,e[s]=r,s+1<e.length?e[s+1]=t:e.push(t),s=s+2}}}};var SK=mK;var s2=n2,EK=o2,i2=gK;var CK=yK;var a2=Symbol.for("effect/SortedSet"),Aye={[a2]:{_A:e=>e},[H](){return p(M(this.keyTree),G(M(a2)),se(this))},[W](e){return u2(e)&&N(this.keyTree,e.keyTree)},[Symbol.iterator](){return i2(this.keyTree)},toString(){return De(this.toJSON())},toJSON(){return{_id:"SortedSet",values:Array.from(this).map(ve)}},[he](){return this.toJSON()},pipe(){return v(this,arguments)}},c2=e=>{let t=Object.create(Aye);return t.keyTree=e,t},u2=e=>F(e,a2);var p_=u(2,(e,t)=>c2(SK(Array.from(e).map(r=>[r,!0]),t)));var _K=u(2,(e,t)=>s2(e.keyTree,t)?e:c2(EK(e.keyTree,t,!0)));var Mye=u(2,(e,t)=>{for(let r of e)if(!t(r))return!1;return!0});var vye=u(2,(e,t)=>s2(e.keyTree,t));var OK=u(2,(e,t)=>Mye(e,r=>vye(t,r)));var kK=u(2,(e,t)=>c2(CK(e.keyTree,t)));var l_=e=>i2(e.keyTree),TK=()=>(e,t)=>OK(e,t)&&OK(t,e);var Pye="effect/Supervisor",Gm=Symbol.for(Pye),Iy={_T:e=>e},$m=class e{underlying;value0;[Gm]=Iy;constructor(t,r){this.underlying=t,this.value0=r}get value(){return this.value0}onStart(t,r,n,o){this.underlying.onStart(t,r,n,o)}onEnd(t,r){this.underlying.onEnd(t,r)}onEffect(t,r){this.underlying.onEffect(t,r)}onSuspend(t){this.underlying.onSuspend(t)}onResume(t){this.underlying.onResume(t)}map(t){return new e(this,p(this.value,_(t)))}zip(t){return new Vm(this,t)}},Vm=class e{left;right;_tag="Zip";[Gm]=Iy;constructor(t,r){this.left=t,this.right=r}get value(){return Wf(this.left.value,this.right.value)}onStart(t,r,n,o){this.left.onStart(t,r,n,o),this.right.onStart(t,r,n,o)}onEnd(t,r){this.left.onEnd(t,r),this.right.onEnd(t,r)}onEffect(t,r){this.left.onEffect(t,r),this.right.onEffect(t,r)}onSuspend(t){this.left.onSuspend(t),this.right.onSuspend(t)}onResume(t){this.left.onResume(t),this.right.onResume(t)}map(t){return new $m(this,p(this.value,_(t)))}zip(t){return new e(this,t)}},d2=e=>F(e,Gm)&&_a(e,"Zip"),l2=class{[Gm]=Iy;fibers=new Set;get value(){return E(()=>Array.from(this.fibers))}onStart(t,r,n,o){this.fibers.add(o)}onEnd(t,r){this.fibers.delete(r)}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new $m(this,p(this.value,_(t)))}zip(t){return new Vm(this,t)}onRun(t,r){return t()}},f2=class{effect;[Gm]=Iy;constructor(t){this.effect=t}get value(){return this.effect}onStart(t,r,n,o){}onEnd(t,r){}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new $m(this,p(this.value,_(t)))}zip(t){return new Vm(this,t)}onRun(t,r){return t()}},IK=class{ref;[Gm]=Iy;constructor(t){this.ref=t}get value(){return E(()=>Ie(this.ref))}onStart(t,r,n,o){p(this.ref,Fn(p(Ie(this.ref),_K(o))))}onEnd(t,r){p(this.ref,Fn(p(Ie(this.ref),kK(r))))}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new $m(this,p(this.value,_(t)))}zip(t){return new Vm(this,t)}onRun(t,r){return t()}},Fye=()=>new l2,RK=E(Fye),Nye=e=>new f2(e),xd=ne("effect/Supervisor/none",()=>Nye(ae));var AK=Ep;var vK="Empty",PK="AddSupervisor",FK="RemoveSupervisor",NK="AndThen",Km={_tag:vK},d_=(e,t)=>({_tag:NK,first:e,second:t}),Dye=(e,t)=>Lye(t,V(e)),Lye=(e,t)=>{let r=e,n=t;for(;Vt(n);){let o=Cn(n);switch(o._tag){case vK:{n=to(n);break}case PK:{r=r.zip(o.supervisor),n=to(n);break}case FK:{r=h2(r,o.supervisor),n=to(n);break}case NK:{n=Et(o.first)(Et(o.second)(to(n)));break}}}return r},h2=(e,t)=>N(e,t)?xd:d2(e)?h2(e.left,t).zip(h2(e.right,t)):e,h_=e=>N(e,xd)?Zs():d2(e)?p(h_(e.left),Mc(h_(e.right))):Sf(e),Uye=(e,t)=>{if(N(e,t))return Km;let r=h_(e),n=h_(t),o=p(n,_M(r),xp(Km,(i,a)=>d_(i,{_tag:PK,supervisor:a}))),s=p(r,_M(n),xp(Km,(i,a)=>d_(i,{_tag:FK,supervisor:a})));return d_(o,s)},DK=AK({empty:Km,patch:Dye,combine:d_,diff:Uye});var x2=hd("effect_fiber_started",{incremental:!0}),x_=hd("effect_fiber_active"),g2=hd("effect_fiber_successes",{incremental:!0}),b2=hd("effect_fiber_failures",{incremental:!0}),y2=Bm(Hm("effect_fiber_lifetimes",a_({start:.5,factor:2,count:35})),"time_unit","milliseconds"),Ry="Continue",zye="Done",LK="Yield",jye={_E:e=>e,_A:e=>e},m_=e=>{throw new Error(`BUG: FiberRuntime - ${cc(e)} - please report an issue at https://github.com/Effect-TS/effect/issues`)},tu=Symbol.for("effect/internal/fiberRuntime/YieldedOp"),ru=ne("effect/internal/fiberRuntime/yieldedOpChannel",()=>({currentOp:null})),Ay={[hh]:(e,t,r)=>rt(()=>t.effect_instruction_i1(r)),OnStep:(e,t,r)=>ht(ht(r)),[mh]:(e,t,r)=>rt(()=>t.effect_instruction_i2(r)),[wg]:(e,t,r)=>(e.patchRuntimeFlags(e.currentRuntimeFlags,t.patch),Nc(e.currentRuntimeFlags)&&e.isInterrupted()?Be(e.getInterruptedCause()):ht(r)),[xh]:(e,t,r)=>(rt(()=>t.effect_instruction_i2(r)),rt(()=>t.effect_instruction_i0())?(e.pushStack(t),rt(()=>t.effect_instruction_i1())):ae),[zl]:(e,t,r)=>{let n=rt(()=>t.effect_instruction_i0.next(r));return n.done?ht(n.value):(e.pushStack(t),Sg(n.value))}},$ye={[$O]:(e,t,r,n)=>(e.processNewInterruptSignal(n.cause),Nc(t)?Be(n.cause):r),[GO]:(e,t,r,n)=>{throw new Error("It is illegal to have multiple concurrent run loops in a single fiber")},[VO]:(e,t,r,n)=>(n.onFiber(e,QP(t)),r),[KO]:(e,t,r,n)=>b(qa(),()=>r)},Vye=e=>Vo(L5(e),t=>es(q5(t),([r,n])=>{let o=new Map,s=[];for(let a of n){s.push(Zt(a));for(let c of a)o.set(c.request,c)}let i=s.flat();return Lt(rSe(r.runAll(s),i,()=>i.forEach(a=>{a.listeners.interrupted=!0})),jO,o)},!1,!1)),Gye=_g(),My=class extends cn{[Lm]=by;[ZO]=jye;_fiberRefs;_fiberId;_queue=new Array;_children=null;_observers=new Array;_running=!1;_stack=[];_asyncInterruptor=null;_asyncBlockingOn=null;_exitValue=null;_steps=[];_isYielding=!1;currentRuntimeFlags;currentOpCount=0;currentSupervisor;currentScheduler;currentTracer;currentSpan;currentContext;currentDefaultServices;constructor(t,r,n){if(super(),this.currentRuntimeFlags=n,this._fiberId=t,this._fiberRefs=r,JM(n)){let o=this.getFiberRef(ni);x2.unsafeUpdate(1,o),x_.unsafeUpdate(1,o)}this.refreshRefCache()}commit(){return _s(this)}id(){return this._fiberId}resume(t){this.tell(dd(t))}get status(){return this.ask((t,r)=>r)}get runtimeFlags(){return this.ask((t,r)=>_G(r)?t.currentRuntimeFlags:r.runtimeFlags)}scope(){return zG(this)}get children(){return this.ask(t=>Array.from(t.getChildren()))}getChildren(){return this._children===null&&(this._children=new Set),this._children}getInterruptedCause(){return this.getFiberRef(Lp)}fiberRefs(){return this.ask(t=>t.getFiberRefs())}ask(t){return q(()=>{let r=Zi(this._fiberId);return this.tell(Dm((n,o)=>{za(r,E(()=>t(n,o)))})),Ut(r)})}tell(t){this._queue.push(t),this._running||(this._running=!0,this.drainQueueLaterOnExecutor())}get await(){return no(t=>{let r=n=>t(S(n));return this.tell(Dm((n,o)=>{n._exitValue!==null?r(this._exitValue):n.addObserver(r)})),E(()=>this.tell(Dm((n,o)=>{n.removeObserver(r)})))},this.id())}get inheritAll(){return de((t,r)=>{let n=t.id(),o=t.getFiberRefs(),s=r.runtimeFlags,i=this.getFiberRefs(),a=Xw(o,n,i);t.setFiberRefs(a);let c=t.getFiberRef(WK),l=p(Xs(s,c),ev(ji),ev(ew));return Pp(l)})}get poll(){return E(()=>br(this._exitValue))}unsafePoll(){return this._exitValue}interruptAsFork(t){return E(()=>this.tell(QO(To(t))))}unsafeInterruptAsFork(t){this.tell(QO(To(t)))}addObserver(t){this._exitValue!==null?t(this._exitValue):this._observers.push(t)}removeObserver(t){this._observers=this._observers.filter(r=>r!==t)}getFiberRefs(){return this.setFiberRef(WK,this.currentRuntimeFlags),this._fiberRefs}unsafeDeleteFiberRef(t){this._fiberRefs=Om(this._fiberRefs,t)}getFiberRef(t){return this._fiberRefs.locals.has(t)?this._fiberRefs.locals.get(t)[0][1]:t.initial}setFiberRef(t,r){this._fiberRefs=ed(this._fiberRefs,{fiberId:this._fiberId,fiberRef:t,value:r}),this.refreshRefCache()}refreshRefCache(){this.currentDefaultServices=this.getFiberRef(Ot),this.currentTracer=this.currentDefaultServices.unsafeMap.get(Kc.key),this.currentSupervisor=this.getFiberRef(O_),this.currentScheduler=this.getFiberRef(ra),this.currentContext=this.getFiberRef(Yr),this.currentSpan=this.currentContext.unsafeMap.get(an.key)}setFiberRefs(t){this._fiberRefs=t,this.refreshRefCache()}addChild(t){this.getChildren().add(t)}removeChild(t){this.getChildren().delete(t)}transferChildren(t){let r=this._children;if(this._children=null,r!==null&&r.size>0)for(let n of r)n._exitValue===null&&t.add(this.currentRuntimeFlags,n)}drainQueueOnCurrentThread(){let t=!0;for(;t;){let r=Ry,n=globalThis[Yp];globalThis[Yp]=this;try{for(;r===Ry;)r=this._queue.length===0?zye:this.evaluateMessageWhileSuspended(this._queue.splice(0,1)[0])}finally{this._running=!1,globalThis[Yp]=n}this._queue.length>0&&!this._running?(this._running=!0,r===LK?(this.drainQueueLaterOnExecutor(),t=!1):t=!0):t=!1}}drainQueueLaterOnExecutor(){this.currentScheduler.scheduleTask(this.run,this.getFiberRef(Qi))}drainQueueWhileRunning(t,r){let n=r;for(;this._queue.length>0;){let o=this._queue.splice(0,1)[0];n=$ye[o._tag](this,t,n,o)}return n}isInterrupted(){return!vf(this.getFiberRef(Lp))}addInterruptedCause(t){let r=this.getFiberRef(Lp);this.setFiberRef(Lp,Rt(r,t))}processNewInterruptSignal(t){this.addInterruptedCause(t),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(this._children===null||this._children.size===0)return!1;let t=!1;for(let r of this._children)r.tell(QO(To(this.id()))),t=!0;return t}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){let t=this._children.values();this._children=null;let r=!1;return Fp({while:()=>!r,body:()=>{let o=t.next();return o.done?E(()=>{r=!0}):Ct(o.value.await)},step:()=>{}})}return null}reportExitValue(t){if(JM(this.currentRuntimeFlags)){let r=this.getFiberRef(ni),n=this.id().startTimeMillis,o=Date.now();switch(y2.unsafeUpdate(o-n,r),x_.unsafeUpdate(-1,r),t._tag){case xt:{g2.unsafeUpdate(1,r);break}case mt:{b2.unsafeUpdate(1,r);break}}}if(t._tag==="Failure"){let r=this.getFiberRef(lm);!Pf(t.cause)&&r._tag==="Some"&&this.log("Fiber terminated with an unhandled error",t.cause,r)}}setExitValue(t){this._exitValue=t,this.reportExitValue(t);for(let r=this._observers.length-1;r>=0;r--)this._observers[r](t);this._observers=[]}getLoggers(){return this.getFiberRef(S_)}log(t,r,n){let o=X(n)?n.value:this.getFiberRef(Wb),s=this.getFiberRef(vy);if(aO(s,o))return;let i=this.getFiberRef(Hb),a=this.getFiberRef(Ha),c=this.getLoggers(),l=this.getFiberRefs();if(Ac(c)>0){let f=jt(this.getFiberRef(Ot),Mo),d=new Date(f.unsafeCurrentTimeMillis());nz(l,()=>{for(let h of c)h.log({fiberId:this.id(),logLevel:o,message:t,cause:r,context:l,spans:i,annotations:a,date:d})})}}evaluateMessageWhileSuspended(t){switch(t._tag){case KO:return LK;case $O:return this.processNewInterruptSignal(t.cause),this._asyncInterruptor!==null&&(this._asyncInterruptor(Be(t.cause)),this._asyncInterruptor=null),Ry;case GO:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(t.effect),Ry;case VO:return t.onFiber(this,this._exitValue!==null?wG:OG(this.currentRuntimeFlags,this._asyncBlockingOn)),Ry;default:return m_(t)}}evaluateEffect(t){this.currentSupervisor.onResume(this);try{let r=Nc(this.currentRuntimeFlags)&&this.isInterrupted()?Be(this.getInterruptedCause()):t;for(;r!==null;){let n=r,o=this.runLoop(n);if(o===tu){let s=ru.currentOp;ru.currentOp=null,s._op===gh?P5(this.currentRuntimeFlags)?(this.tell(HG()),this.tell(dd(Xr)),r=null):r=Xr:s._op===Bl&&(r=null)}else{this.currentRuntimeFlags=p(this.currentRuntimeFlags,rw(ew));let s=this.interruptAllChildren();s!==null?r=b(s,()=>o):(this._queue.length===0?this.setExitValue(o):this.tell(dd(o)),r=null)}}}finally{this.currentSupervisor.onSuspend(this)}}start(t){if(this._running)this.tell(dd(t));else{this._running=!0;let r=globalThis[Yp];globalThis[Yp]=this;try{this.evaluateEffect(t)}finally{this._running=!1,globalThis[Yp]=r,this._queue.length>0&&this.drainQueueLaterOnExecutor()}}}startFork(t){this.tell(dd(t))}patchRuntimeFlags(t,r){let n=Dc(t,r);return globalThis[Yp]=this,this.currentRuntimeFlags=n,n}initiateAsync(t,r){let n=!1,o=s=>{n||(n=!0,this.tell(dd(s)))};Nc(t)&&(this._asyncInterruptor=o);try{r(o)}catch(s){o(Re(Fr(s)))}}pushStack(t){this._stack.push(t),t._op==="OnStep"&&this._steps.push({refs:this.getFiberRefs(),flags:this.currentRuntimeFlags})}popStack(){let t=this._stack.pop();if(t)return t._op==="OnStep"&&this._steps.pop(),t}getNextSuccessCont(){let t=this.popStack();for(;t;){if(t._op!==dh)return t;t=this.popStack()}}getNextFailCont(){let t=this.popStack();for(;t;){if(t._op!==hh&&t._op!==xh&&t._op!==zl)return t;t=this.popStack()}}Tag(t){return E(()=>vn(this.currentContext,t))}Left(t){return ke(t.left)}None(t){return ke(new Ao)}Right(t){return ht(t.right)}Some(t){return ht(t.value)}Micro(t){return im(r=>{let n=r,o=LG(NG(t,this.currentContext));return o.addObserver(s=>{if(s._tag==="Success")return n(ht(s.value));switch(s.cause._tag){case"Interrupt":return n(Be(To(Nn)));case"Fail":return n(ke(s.cause.error));case"Die":return n(oo(s.cause.defect))}}),im(s=>{n=i=>{s(ae)},o.unsafeInterrupt()})})}[lE](t){let r=rt(()=>t.effect_instruction_i0()),n=this.getNextSuccessCont();return n!==void 0?(n._op in Ay||m_(n),Ay[n._op](this,n,r)):(ru.currentOp=ht(r),tu)}[xt](t){let r=t,n=this.getNextSuccessCont();return n!==void 0?(n._op in Ay||m_(n),Ay[n._op](this,n,r.effect_instruction_i0)):(ru.currentOp=r,tu)}[mt](t){let r=t.effect_instruction_i0,n=this.getNextFailCont();if(n!==void 0)switch(n._op){case dh:case mh:return Nc(this.currentRuntimeFlags)&&this.isInterrupted()?Be(cw(r)):rt(()=>n.effect_instruction_i1(r));case"OnStep":return Nc(this.currentRuntimeFlags)&&this.isInterrupted()?Be(cw(r)):ht(Be(r));case wg:return this.patchRuntimeFlags(this.currentRuntimeFlags,n.patch),Nc(this.currentRuntimeFlags)&&this.isInterrupted()?Be(Rt(r,this.getInterruptedCause())):Be(r);default:m_(n)}else return ru.currentOp=Be(r),tu}[fE](t){return rt(()=>t.effect_instruction_i0(this,QP(this.currentRuntimeFlags)))}Blocked(t){let r=this.getFiberRefs(),n=this.currentRuntimeFlags;if(this._steps.length>0){let o=[],s=this._steps[this._steps.length-1],i=this.popStack();for(;i&&i._op!=="OnStep";)o.push(i),i=this.popStack();this.setFiberRefs(s.refs),this.currentRuntimeFlags=s.flags;let a=ud(s.refs,r),c=Xs(s.flags,n);return ht(Lc(t.effect_instruction_i0,de(l=>{for(;o.length>0;)l.pushStack(o.pop());return l.setFiberRefs(pd(l.id(),l.getFiberRefs())(a)),l.currentRuntimeFlags=Dc(c)(l.currentRuntimeFlags),t.effect_instruction_i1})))}return er(o=>b(Zm(bw(t.effect_instruction_i0)),()=>o(t.effect_instruction_i1)))}RunBlocked(t){return Vye(t.effect_instruction_i0)}[pc](t){let r=t.effect_instruction_i0,n=this.currentRuntimeFlags,o=Dc(n,r);if(Nc(o)&&this.isInterrupted())return Be(this.getInterruptedCause());if(this.patchRuntimeFlags(this.currentRuntimeFlags,r),t.effect_instruction_i1){let s=Xs(o,n);return this.pushStack(new fw(s,t)),rt(()=>t.effect_instruction_i1(n))}else return Xr}[hh](t){return this.pushStack(t),t.effect_instruction_i0}OnStep(t){return this.pushStack(t),t.effect_instruction_i0}[dh](t){return this.pushStack(t),t.effect_instruction_i0}[mh](t){return this.pushStack(t),t.effect_instruction_i0}[Bl](t){return this._asyncBlockingOn=t.effect_instruction_i1,this.initiateAsync(this.currentRuntimeFlags,t.effect_instruction_i0),ru.currentOp=t,tu}[gh](t){return this._isYielding=!1,ru.currentOp=t,tu}[xh](t){let r=t.effect_instruction_i0,n=t.effect_instruction_i1;return r()?(this.pushStack(t),n()):Xr}[zl](t){return Ay[zl](this,t,void 0)}[uc](t){return rt(()=>t.commit())}runLoop(t){let r=t;for(this.currentOpCount=0;;){if((this.currentRuntimeFlags&v5)!==0&&this.currentSupervisor.onEffect(this,r),this._queue.length>0&&(r=this.drainQueueWhileRunning(this.currentRuntimeFlags,r)),!this._isYielding){this.currentOpCount+=1;let n=this.currentScheduler.shouldYield(this);if(n!==!1){this._isYielding=!0,this.currentOpCount=0;let o=r;r=b(qa({priority:n}),()=>o)}}try{if(r=this.currentTracer.context(()=>{if(Gye!==r[Uc]._V){let n=this.getFiberRef(zb);if(n._tag==="Some"){let o=r[Uc]._V;this.log(`Executing an Effect versioned ${o} with a Runtime of version ${_g()}, you may want to dedupe the effect dependencies, you can use the language service plugin to detect this at compile time: https://github.com/Effect-TS/language-service`,Dn,n)}}return this[r._op](r)},this),r===tu){let n=ru.currentOp;return n._op===gh||n._op===Bl?tu:(ru.currentOp=null,n._op===xt||n._op===mt?n:Be(Fr(n)))}}catch(n){r!==tu&&!F(r,"_op")||!(r._op in this)?r=Ip(`Not a valid effect: ${cc(r)}`):Iv(n)?r=Be(Rt(Fr(n),To(Nn))):r=oo(n)}}}run=()=>{this.drainQueueOnCurrentThread()}},vy=ne("effect/FiberRef/currentMinimumLogLevel",()=>lr(cO("Info"))),Jm=e=>On(t=>{let r=td(t.context,Ot);jt(r,Zo).unsafe.log(e.log(t))}),BK=e=>On(t=>{let r=td(t.context,Ot),n=jt(r,Zo).unsafe;switch(t.logLevel._tag){case"Debug":return n.debug(e.log(t));case"Info":return n.info(e.log(t));case"Trace":return n.trace(e.log(t));case"Warning":return n.warn(e.log(t));case"Error":case"Fatal":return n.error(e.log(t));default:return n.log(e.log(t))}}),zK=e=>On(t=>{let r=td(t.context,Ot);jt(r,Zo).unsafe.error(e.log(t))}),bd=ne(Symbol.for("effect/Logger/defaultLogger"),()=>Jm(n_)),jK=ne(Symbol.for("effect/Logger/jsonLogger"),()=>Jm(s_)),$K=ne(Symbol.for("effect/Logger/logFmtLogger"),()=>Jm(o_)),VK=ne(Symbol.for("effect/Logger/prettyLogger"),()=>i_),GK=ne(Symbol.for("effect/Logger/structuredLogger"),()=>Jm(Ey)),S2=ne(Symbol.for("effect/Logger/tracerLogger"),()=>On(({annotations:e,cause:t,context:r,fiberId:n,logLevel:o,message:s})=>{let i=xs(Jc(r,Yr),an);if(i._tag==="None"||i.value._tag==="ExternalSpan")return;let a=vn(Jc(r,Ot),Mo),c={};for(let[l,f]of e)c[l]=f;c["effect.fiberId"]=s5(n),c["effect.logLevel"]=o.label,t!==null&&t._tag!=="Empty"&&(c["effect.cause"]=zo(t,{renderErrorCause:!0})),i.value.event(cc(Array.isArray(s)&&s.length===1?s[0]:s),a.unsafeCurrentTimeNanos(),c)})),KK=e=>e_(e,t=>{let r=kr(ey(t.context,Yr),xs(an));return r._tag==="None"?t:{...t,annotations:p(t.annotations,on("effect.traceId",r.value.traceId),on("effect.spanId",r.value.spanId),r.value._tag==="Span"?on("effect.spanName",r.value.name):R)}}),S_=ne(Symbol.for("effect/FiberRef/currentLoggers"),()=>_v(Sf(bd,S2))),QK=u(3,(e,t,r)=>b(w_,n=>{let o=[],s=q(()=>{if(o.length===0)return ae;let i=o;return o=[],r(i)});return er(i=>p(Qa(t),we(s),mO,i,Zm,b(a=>dm(n,Wc(a))),we(sa(()=>s)),tt(On(a=>{o.push(e.log(a))}))))})),JK=function(){if(typeof arguments[0]=="string")return un(Ha,on(arguments[0],arguments[1]));let e=Object.entries(arguments[0]);return un(Ha,c5(t=>{for(let r=0;r<e.length;r++){let[n,o]=e[r];on(t,n,o)}return t}))},ZK=u(2,(e,t)=>{let r=typeof t=="string"?cO(t):t;return de(n=>{let o=n.getFiberRef(vy);return aO(o,r)?S(g()):_(e,x)})}),tl=u(e=>et(e[0]),(e,t)=>Go(Nr(e,r=>sa(n=>t(r,n))))),YK=u(e=>et(e[0]),(e,t)=>rs(e,sa(r=>t(r)))),sa=e=>de(t=>{let r=t.getFiberRefs(),n=tw(t.currentRuntimeFlags,ji);return b(w_,o=>Up(o,s=>de(i=>{let a=i.getFiberRefs(),c=i.currentRuntimeFlags,l=ud(a,r),f=Xs(c,n),d=ud(r,a);return i.setFiberRefs(pd(l,i.id(),r)),rs(kw(e(s),f),E(()=>{i.setFiberRefs(pd(d,i.id(),i.getFiberRefs()))}))})))}),XK=e=>Lt(Mb,x(Xc))(e),UK=Symbol.for("effect/Effect/existsPar/found"),eQ=u(e=>Lo(e[0])&&!et(e[0]),(e,t,r)=>gy(r?.concurrency,()=>q(()=>tQ(e[Symbol.iterator](),0,t)),()=>Jr(ks(e,(n,o)=>Cw(t(n,o),{onTrue:()=>ke(UK),onFalse:()=>ae}),r),{onFailure:n=>n===UK?S(!0):ke(n),onSuccess:()=>S(!1)}))),tQ=(e,t,r)=>{let n=e.next();return n.done?S(!1):b(r(n.value,t),o=>o?S(o):tQ(e,t+1,r))},rQ=u(e=>Lo(e[0])&&!et(e[0]),(e,t,r)=>{let n=r?.negate?(o,s)=>_(t(o,s),nb):t;return gy(r?.concurrency,()=>q(()=>Ee(e).reduceRight((o,s,i)=>Wa(o,q(()=>n(s,i)),(a,c)=>c?[s,...a]:a),E(()=>new Array))),()=>_(ks(e,(o,s)=>_(n(o,s),i=>i?x(o):g()),r),Fz))}),Kye=e=>{if(Array.isArray(e)||Lo(e))return[e,g()];let t=Object.keys(e),r=t.length;return[t.map(n=>e[n]),x(n=>{let o={};for(let s=0;s<r;s++)o[t[s]]=n[s];return o})]},Qye=(e,t,r)=>{let n=[];for(let o of e)n.push(ei(o));return b(ks(n,R,{concurrency:r?.concurrency,batching:r?.batching,concurrentFinalizers:r?.concurrentFinalizers}),o=>{let s=g(),i=o.length,a=new Array(i),c=new Array(i),l=!1;for(let f=0;f<i;f++){let d=o[f];d._tag==="Left"?(a[f]=x(d.left),l=!0):(c[f]=d.right,a[f]=s)}return l?t._tag==="Some"?ke(t.value(a)):ke(a):r?.discard?ae:t._tag==="Some"?S(t.value(c)):S(c)})},Jye=(e,t,r)=>{let n=[];for(let o of e)n.push(ei(o));return r?.discard?ks(n,R,{concurrency:r?.concurrency,batching:r?.batching,discard:!0,concurrentFinalizers:r?.concurrentFinalizers}):_(ks(n,R,{concurrency:r?.concurrency,batching:r?.batching,concurrentFinalizers:r?.concurrentFinalizers}),o=>t._tag==="Some"?t.value(o):o)},Ja=(e,t)=>{let[r,n]=Kye(e);return t?.mode==="validate"?Qye(r,n,t):t?.mode==="either"?Jye(r,n,t):t?.discard!==!0&&n._tag==="Some"?_(ks(r,R,t),n.value):ks(r,R,t)},nQ=e=>t=>Ja(t,e),oQ=(e,t)=>_(Ja(Ee(e).map(pr),t),hc(r=>Kb(r)?x(r.effect_instruction_i0):g())),E2=u(2,(e,t)=>Array.from({length:t},()=>e)),sQ=u(e=>et(e[0]),(e,t,r)=>Ja(E2(e,t),r)),ks=u(e=>Lo(e[0]),(e,t,r)=>de(n=>{let o=r?.batching===!0||r?.batching==="inherit"&&n.getFiberRef(pm);return r?.discard?sF(r.concurrency,()=>gd(Am,r?.concurrentFinalizers)(s=>o?es(e,(i,a)=>s(t(i,a)),!0,!1,1):Vo(e,(i,a)=>s(t(i,a)))),()=>gd(_O,r?.concurrentFinalizers)(s=>es(e,(i,a)=>s(t(i,a)),o,!1)),s=>gd(kO(s),r?.concurrentFinalizers)(i=>es(e,(a,c)=>i(t(a,c)),o,!1,s))):sF(r?.concurrency,()=>gd(Am,r?.concurrentFinalizers)(s=>o?m2(e,1,(i,a)=>s(t(i,a)),!0):Ln(e,(i,a)=>s(t(i,a)))),()=>gd(_O,r?.concurrentFinalizers)(s=>Qm(e,(i,a)=>s(t(i,a)),o)),s=>gd(kO(s),r?.concurrentFinalizers)(i=>m2(e,s,(a,c)=>i(t(a,c)),o)))})),Qm=(e,t,r)=>q(()=>{let n=Ee(e),o=new Array(n.length);return we(es(n,(i,a)=>b(t(i,a),c=>E(()=>o[a]=c)),r,!1),S(o))}),es=(e,t,r,n,o)=>er(s=>Ow(i=>de(a=>{let c=Array.from(e).reverse(),l=c.length;if(l===0)return ae;let f=0,d=!1,h=o?Math.min(c.length,o):c.length,m=new Set,y=new Array,T=()=>m.forEach(ce=>{ce.currentScheduler.scheduleTask(()=>{ce.unsafeInterruptAsFork(a.id())},0)}),C=new Array,O=new Array,U=new Array,I=()=>{let ce=y.filter(({exit:Ye})=>Ye._tag==="Failure").sort((Ye,at)=>Ye.index<at.index?-1:Ye.index===at.index?0:1).map(({exit:Ye})=>Ye);return ce.length===0&&ce.push(Xr),ce},K=(ce,Ye=!1)=>{let at=Go(i(ce)),Ue=Zye(at,a,a.currentRuntimeFlags,Xc);return a.currentScheduler.scheduleTask(()=>{Ye&&Ue.unsafeInterruptAsFork(a.id()),Ue.resume(at)},0),Ue},Q=()=>{n||(l-=c.length,c=[]),d=!0,T()},z=r?Ew:pr,te=K(no(ce=>{let Ye=(Ue,_r)=>{Ue._op==="Blocked"?U.push(Ue):(y.push({index:_r,exit:Ue}),Ue._op==="Failure"&&!d&&Q())},at=()=>{if(c.length>0){let Ue=c.pop(),_r=f++,Ns=()=>{let In=c.pop();return _r=f++,b(qa(),()=>b(z(s(t(In,_r))),Ds))},Ds=In=>c.length>0&&(Ye(In,_r),c.length>0)?Ns():S(In),wi=b(z(s(t(Ue,_r))),Ds),Zn=K(wi);C.push(Zn),m.add(Zn),d&&Zn.currentScheduler.scheduleTask(()=>{Zn.unsafeInterruptAsFork(a.id())},0),Zn.addObserver(In=>{let Ls;if(In._op==="Failure"?Ls=In:Ls=In.effect_instruction_i0,O.push(Zn),m.delete(Zn),Ye(Ls,_r),y.length===l)ce(S(_e(qp(I(),{parallel:!0}),()=>Xr)));else if(U.length+y.length===l){let ih=I(),C1=U.map(xg=>xg.effect_instruction_i0).reduce(ov);ce(S(Lc(C1,es([_e(qp(ih,{parallel:!0}),()=>Xr),...U.map(xg=>xg.effect_instruction_i1)],xg=>xg,r,!0,o))))}else at()})}};for(let Ue=0;Ue<h;Ue++)at()}));return Ct(Io($o(s(_s(te))),Vf({onFailure:ce=>{Q();let Ye=U.length+1,at=Math.min(typeof o=="number"?o:U.length,U.length),Ue=Array.from(U);return no(_r=>{let Ns=[],Ds=0,wi=0,Zn=(Ls,ih)=>C1=>{Ns[Ls]=C1,Ds++,Ds===Ye&&_r(ht(Be(ce))),Ue.length>0&&ih&&In()},In=()=>{K(Ue.pop(),!0).addObserver(Zn(wi,!0)),wi++};te.addObserver(Zn(wi,!1)),wi++;for(let Ls=0;Ls<at;Ls++)In()})},onSuccess:()=>Ln(O,ce=>ce.inheritAll)})))}))),m2=(e,t,r,n)=>q(()=>{let o=Ee(e),s=new Array(o.length);return we(es(o,(a,c)=>_(r(a,c),l=>s[c]=l),n,!1,t),S(s))}),nu=e=>de((t,r)=>S(Py(e,t,r.runtimeFlags))),Zm=e=>Yye(e,Xc),iQ=u(2,(e,t)=>nu(ww(e,r=>{let n=Vi(r);switch(n._tag){case"Left":return t(n.left);case"Right":return Re(n.right)}}))),Py=(e,t,r,n=null)=>{let o=g_(e,t,r,n);return o.resume(e),o},Zye=(e,t,r,n=null)=>g_(e,t,r,n),g_=(e,t,r,n=null)=>{let o=zC(),s=t.getFiberRefs(),i=hP(s,o),a=new My(o,i,r),c=Jc(i,Yr),l=a.currentSupervisor;return l.onStart(c,e,x(t),a),a.addObserver(d=>l.onEnd(d,a)),(n!==null?n:p(t.getFiberRef(Mb),_e(()=>t.scope()))).add(r,a),a},Yye=(e,t)=>de((r,n)=>S(Py(e,r,n.runtimeFlags,t))),C2=u(e=>_i(e[2]),(e,t,r,n)=>gy(n?.concurrency,()=>Ee(e).reduce((o,s,i)=>Wa(o,s,(a,c)=>r(a,c,i)),S(t)),()=>b(tr(t),o=>b(ks(e,(s,i)=>b(s,a=>Os(o,c=>r(c,a,i))),n),()=>_t(o))))),w2=u(e=>Lo(e[0]),(e,t,r)=>p(ks(e,(n,o)=>ei(t(n,o)),r),_(n=>s$(n,R)))),aQ=u(e=>Lo(e[0]),(e,t,r)=>b(w2(e,t,{concurrency:r?.concurrency,batching:r?.batching,concurrentFinalizers:r?.concurrentFinalizers}),([n,o])=>Ii(n)?ke(n):r?.discard?ae:S(o))),cQ=e=>de((t,r)=>no(n=>{let o=new Set,s,i=Dn,a=()=>{for(let f of o)f.unsafeInterruptAsFork(t.id())},c=!1,l=!0;for(let f of e){l=!1;let d=Py(Gi(f),t,r.runtimeFlags);if(o.add(d),d.addObserver(h=>{o.delete(d),s||(h._tag==="Success"?(c=!0,s=d,i=Dn,a()):i=Qr(h.cause,i)),c&&o.size===0&&n(s?we(XO(s),s.unsafePoll()):Re(i))}),s)break}return l?n(Rp(()=>new jf("Received an empty collection of effects"))):(c=!0,uF(o,t.id()))})),uQ=u(e=>Lo(e[0])&&!et(e[0]),(e,t,r,n)=>gy(n?.concurrency,()=>Ee(e).reduce((o,s,i)=>Wa(o,s,(a,c)=>r(a,c,i)),t),()=>q(()=>p(C2([t,...e],g(),(o,s,i)=>{switch(o._tag){case"None":return x(s);case"Some":return x(r(o.value,s,i))}},n),_(o=>{switch(o._tag){case"None":throw new Error("BUG: Effect.reduceEffect - please report an issue at https://github.com/Effect-TS/effect/issues");case"Some":return o.value}}))))),b_=e=>si(t=>j(xs(t,ts),{onNone:()=>e,onSome:r=>{switch(r.strategy._tag){case"Parallel":return e;case"Sequential":case"ParallelN":return b(Es(r,_O),n=>Za(e,n))}}})),qK=e=>t=>si(r=>j(xs(r,ts),{onNone:()=>t,onSome:n=>n.strategy._tag==="ParallelN"&&n.strategy.parallelism===e?t:b(Es(n,kO(e)),o=>Za(t,o))})),pQ=e=>t=>gd(e,!0)(t),gd=(e,t)=>r=>si(n=>j(xs(n,ts),{onNone:()=>r(R),onSome:o=>{if(t===!0){let s=e._tag==="Parallel"?b_:e._tag==="Sequential"?y_:qK(e.parallelism);switch(o.strategy._tag){case"Parallel":return s(r(b_));case"Sequential":return s(r(y_));case"ParallelN":return s(r(qK(o.strategy.parallelism)))}}else return r(R)}})),li=e=>b(ts,e),Fy=e=>b(ia(),t=>Io(e(t),r=>t.close(r))),E_=e=>b(ia(),t=>T2(e,t)),y_=e=>si(t=>j(xs(t,ts),{onNone:()=>e,onSome:r=>{switch(r.strategy._tag){case"Sequential":return e;case"Parallel":case"ParallelN":return b(Es(r,Am),n=>Za(e,n))}}})),lQ=(e,t)=>O2([id(e,t)]),O2=e=>un(ni,t=>fs(t,e)),fQ=u(2,(e,t)=>Fy(r=>b(Za(e,r),t))),dQ=u(e=>et(e[1]),(e,t,r)=>_2(e,t,(n,o)=>[n,o],r)),_2=u(e=>et(e[1]),(e,t,r,n)=>$o(ou(pr(e),pr(t),(o,s)=>oi(o,s,{onSuccess:r,onFailure:(i,a)=>n?.concurrent?Qr(i,a):Rt(i,a)}),n)));var hQ=u(e=>Lo(e[0]),(e,t,r)=>Mp(ks(e,(n,o)=>Mp(t(n,o)),r))),mQ=e=>un(Ot,qe(Mo,e)),xQ=e=>un(Ot,qe(Gc,e)),C_=e=>un(Ot,qe(Em,e)),gQ=e=>li(t=>b(Es(t,Xo),r=>p(e,Za(r),_(n=>[jo(o=>Ji(r,$f(o))),n])))),bQ=u(e=>et(e[1]),(e,t,r)=>ou(e,t,(n,o)=>[n,o],r)),yQ=u(e=>et(e[1]),(e,t,r)=>r?.concurrent!==!0&&(r?.batching===void 0||r.batching===!1)?Hf(e,t):ou(e,t,(n,o)=>n,r)),SQ=u(e=>et(e[1]),(e,t,r)=>r?.concurrent!==!0&&(r?.batching===void 0||r.batching===!1)?we(e,t):ou(e,t,(n,o)=>o,r)),ou=u(e=>et(e[1]),(e,t,r,n)=>_(Ja([e,t],{concurrency:n?.concurrent?2:1,batching:n?.batching,concurrentFinalizers:n?.concurrentFinalizers}),([o,s])=>r(o,s))),k2=e=>e===N5?ae:p(am,b(t=>{let r=Dc(t,e),n=Xs(r,t);return p(Pp(e),we(sa(()=>Pp(n))),Ct)}),Go),ts=nn("effect/Scope"),w_=ts,Xye=(e,t)=>{e.state._tag==="Open"&&e.state.finalizers.set({},t)},eSe={[$b]:$b,[Vb]:Vb,pipe(){return v(this,arguments)},fork(e){return E(()=>{let t=EQ(e);if(this.state._tag==="Closed")return t.state=this.state,t;let r={},n=o=>t.close(o);return this.state.finalizers.set(r,n),Xye(t,o=>E(()=>{this.state._tag==="Open"&&this.state.finalizers.delete(r)})),t})},close(e){return q(()=>{if(this.state._tag==="Closed")return ae;let t=Array.from(this.state.finalizers.values()).reverse();return this.state={_tag:"Closed",exit:e},t.length===0?ae:BP(this.strategy)?p(Ln(t,r=>pr(r(e))),b(r=>p(qp(r),ct(xm),_e(()=>Xr)))):zP(this.strategy)?p(Qm(t,r=>pr(r(e)),!1),b(r=>p(qp(r,{parallel:!0}),ct(xm),_e(()=>Xr)))):p(m2(t,this.strategy.parallelism,r=>pr(r(e)),!1),b(r=>p(qp(r,{parallel:!0}),ct(xm),_e(()=>Xr))))})},addFinalizer(e){return q(()=>this.state._tag==="Closed"?e(this.state.exit):(this.state.finalizers.set({},e),ae))}},EQ=(e=Xo)=>{let t=Object.create(eSe);return t.strategy=e,t.state={_tag:"Open",finalizers:new Map},t},ia=(e=Xo)=>E(()=>EQ(e)),Za=u(2,(e,t)=>Jf(e,_o(Oo(ts,t)))),T2=u(2,(e,t)=>p(e,Za(t),Io(r=>t.close(r)))),tSe=e=>Dp(e,{differ:DK,fork:Km}),Hn=u(2,(e,t)=>Ct(tl(b(Ro(e),r=>tt(Tp(e,t),r)),r=>Tp(e,r)))),un=u(2,(e,t)=>qr(e,r=>Hn(e,t(r))));var WK=h$(F5),O_=tSe(xd),CQ=e=>ks(e,YO),I2=e=>({...gP,commit(){return _s(this)},[Lm]:by,id:()=>Ee(e).reduce((r,n)=>MM(r,n.id()),Nn),await:pr(Qm(e,r=>$o(r.await),!1)),children:_(Qm(e,r=>r.children,!1),Rh),inheritAll:Vo(e,r=>r.inheritAll),poll:_(Ln(e,r=>r.poll),Pg(x(ht(new Array)),(r,n)=>{switch(n._tag){case"None":return g();case"Some":switch(r._tag){case"None":return g();case"Some":return x(oi(n.value,r.value,{onSuccess:(o,s)=>[o,...s],onFailure:Qr}))}}})),interruptAsFork:r=>Vo(e,n=>n.interruptAsFork(r))});var R2=u(3,(e,t,r)=>A2(e,t,{onSelfWin:(n,o)=>b(n.await,s=>{switch(s._tag){case xt:return b(n.inheritAll,()=>r.onSelfDone(s,o));case mt:return r.onSelfDone(s,o)}}),onOtherWin:(n,o)=>b(n.await,s=>{switch(s._tag){case xt:return b(n.inheritAll,()=>r.onOtherDone(s,o));case mt:return r.onOtherDone(s,o)}})})),wQ=e=>er(t=>jo(r=>b(Zm(t(e)),n=>p(t(_s(n)),so(()=>p(n,pF(r))))))),__=u(2,(e,t)=>jo(r=>R2(e,t,{onSelfDone:(n,o)=>Gf(n,{onFailure:s=>p(_s(o),Im(i=>Qr(s,i))),onSuccess:s=>p(o,Ko(r),tt(s))}),onOtherDone:(n,o)=>Gf(n,{onFailure:s=>p(_s(o),Im(i=>Qr(i,s))),onSuccess:s=>p(o,Ko(r),tt(s))})}))),A2=u(3,(e,t,r)=>de((n,o)=>{let s=o.runtimeFlags,i=ko(!0),a=g_(e,n,s,r.selfScope),c=g_(t,n,s,r.otherScope);return no(l=>{a.addObserver(()=>HK(a,c,r.onSelfWin,i,l)),c.addObserver(()=>HK(c,a,r.onOtherWin,i,l)),a.startFork(e),c.startFork(t)},MM(a.id(),c.id()))})),HK=(e,t,r,n,o)=>{qC(!0,!1)(n)&&o(r(e,t))},rs=u(2,(e,t)=>er(r=>Gt(r(e),{onFailure:n=>Gt(t,{onFailure:o=>Re(Rt(n,o)),onSuccess:()=>Re(n)}),onSuccess:n=>tt(t,n)}))),rSe=(e,t,r)=>jo(n=>b(b(Zm(Gi(e)),o=>no(s=>{let i=t.map(l=>l.listeners.count),a=()=>{i.every(l=>l===0)&&t.every(l=>l.result.state.current._tag==="Pending"?!0:!!(l.result.state.current._tag==="Done"&&mm(l.result.state.current.effect)&&l.result.state.current.effect._tag==="Failure"&&sm(l.result.state.current.effect.cause)))&&(c.forEach(l=>l()),r?.(),s(Wc(o)))};o.addObserver(l=>{c.forEach(f=>f()),s(l)});let c=t.map((l,f)=>{let d=h=>{i[f]=h,a()};return l.listeners.addObserver(d),()=>l.listeners.removeObserver(d)});return a(),E(()=>{c.forEach(l=>l())})})),()=>q(()=>{let o=t.flatMap(s=>s.state.completed?[]:[s]);return Vo(o,s=>e2(s.request,$f(n)))})));var pi=(e,t)=>(t=Un(t),Go(de(r=>{let n=vn(r.getFiberRef(Yr),ts),o=OO(r,e,t),s=r.getFiberRef(Ba),i=jt(r.getFiberRef(Ot),Mo);return tt(Up(n,a=>Rm(o,a,i,s)),o)}))),k_=e=>un(Ot,qe(Kc,e)),OQ=function(){let e=typeof arguments[0]!="string",t=e?arguments[1]:arguments[0],r=Un(e?arguments[2]:arguments[1]);if(e){let n=arguments[0];return b(pi(t,Un(r)),o=>Vp(n,an,o))}return n=>b(pi(t,Un(r)),o=>Vp(n,an,o))};var _Q=(e,t,r,n)=>rm({_tag:"Complete",key:e,exit:t,entryStats:r,timeToLiveMillis:n}),kQ=(e,t)=>rm({_tag:"Pending",key:e,deferred:t}),nSe=(e,t)=>rm({_tag:"Refreshing",deferred:e,complete:t}),M2=Symbol.for("effect/Cache/MapKey"),v2=class{current;[M2]=M2;previous=void 0;next=void 0;constructor(t){this.current=t}[H](){return p(M(this.current),G(M(this.previous)),G(M(this.next)),se(this))}[W](t){return this===t?!0:oSe(t)&&N(this.current,t.current)&&N(this.previous,t.previous)&&N(this.next,t.next)}},Ym=e=>new v2(e),oSe=e=>F(e,M2),P2=class{head=void 0;tail=void 0;add(t){if(t!==this.tail)if(this.tail===void 0)this.head=t,this.tail=t;else{let r=t.previous,n=t.next;n!==void 0&&(t.next=void 0,r!==void 0?(r.next=n,n.previous=r):(this.head=n,this.head.previous=void 0)),this.tail.next=t,t.previous=this.tail,this.tail=t}}remove(){let t=this.head;if(t!==void 0){let r=t.next;r!==void 0?(t.next=void 0,this.head=r,this.head.previous=void 0):(this.head=void 0,this.tail=void 0)}return t}},sSe=()=>new P2,iSe=(e,t,r,n,o,s)=>({map:e,keys:t,accesses:r,updating:n,hits:o,misses:s}),aSe=()=>iSe(Yf(),sSe(),jc(),ko(!1),0,0),cSe="effect/Cache",uSe=Symbol.for(cSe),pSe={_Key:e=>e,_Error:e=>e,_Value:e=>e},lSe="effect/ConsumerCache",fSe=Symbol.for(lSe),dSe={_Key:e=>e,_Error:e=>e,_Value:e=>e},hSe=e=>e,T_=e=>({loadedMillis:e}),F2=class{capacity;context;fiberId;lookup;timeToLive;[uSe]=pSe;[fSe]=dSe;cacheState;constructor(t,r,n,o,s){this.capacity=t,this.context=r,this.fiberId=n,this.lookup=o,this.timeToLive=s,this.cacheState=aSe()}get(t){return _(this.getEither(t),gE)}get cacheStats(){return E(()=>hSe({hits:this.cacheState.hits,misses:this.cacheState.misses,size:Nw(this.cacheState.map)}))}getOption(t){return q(()=>j(Wr(this.cacheState.map,t),{onNone:()=>{let r=Ym(t);return this.trackAccess(r),this.trackMiss(),S(g())},onSome:r=>this.resolveMapValue(r)}))}getOptionComplete(t){return q(()=>j(Wr(this.cacheState.map,t),{onNone:()=>{let r=Ym(t);return this.trackAccess(r),this.trackMiss(),S(g())},onSome:r=>this.resolveMapValue(r,!0)}))}contains(t){return E(()=>Xi(this.cacheState.map,t))}entryStats(t){return E(()=>{let r=Wr(this.cacheState.map,t);if(X(r))switch(r.value._tag){case"Complete":{let n=r.value.entryStats.loadedMillis;return x(T_(n))}case"Pending":return g();case"Refreshing":{let n=r.value.complete.entryStats.loadedMillis;return x(T_(n))}}return g()})}getEither(t){return q(()=>{let r=t,n,o,s=yr(Wr(this.cacheState.map,r));return s===void 0&&(o=Nv(this.fiberId),n=Ym(r),Xi(this.cacheState.map,r)?s=yr(Wr(this.cacheState.map,r)):Qo(this.cacheState.map,r,kQ(n,o))),s===void 0?(this.trackAccess(n),this.trackMiss(),_(this.lookupValueOf(t,o),Z)):b(this.resolveMapValue(s),j({onNone:()=>this.getEither(t),onSome:i=>S($(i))}))})}invalidate(t){return E(()=>{Xf(this.cacheState.map,t)})}invalidateWhen(t,r){return E(()=>{let n=Wr(this.cacheState.map,t);X(n)&&n.value._tag==="Complete"&&n.value.exit._tag==="Success"&&r(n.value.exit.value)&&Xf(this.cacheState.map,t)})}get invalidateAll(){return E(()=>{this.cacheState.map=Yf()})}refresh(t){return Ka(r=>q(()=>{let n=t,o=Nv(this.fiberId),s=yr(Wr(this.cacheState.map,n));if(s===void 0&&(Xi(this.cacheState.map,n)?s=yr(Wr(this.cacheState.map,n)):Qo(this.cacheState.map,n,kQ(Ym(n),o))),s===void 0)return Ct(this.lookupValueOf(t,o));switch(s._tag){case"Complete":{if(this.hasExpired(r,s.timeToLiveMillis)){let i=yr(Wr(this.cacheState.map,n));return N(i,s)&&Xf(this.cacheState.map,n),Ct(this.get(t))}return p(this.lookupValueOf(t,o),CO(()=>{let i=yr(Wr(this.cacheState.map,n));if(N(i,s)){let a=nSe(o,s);return Qo(this.cacheState.map,n,a),!0}return!1}),Ct)}case"Pending":return He(s.deferred);case"Refreshing":return He(s.deferred)}}))}set(t,r){return Ka(n=>E(()=>{let o=n.unsafeCurrentTimeMillis(),s=t,i=xe(r),a=_Q(Ym(s),i,T_(o),o+Kr(Qe(this.timeToLive(i))));Qo(this.cacheState.map,s,a)}))}get size(){return E(()=>Nw(this.cacheState.map))}get values(){return E(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push(r[1].exit.value);return t})}get entries(){return E(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push([r[0],r[1].exit.value]);return t})}get keys(){return E(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push(r[0]);return t})}resolveMapValue(t,r=!1){return Ka(n=>{switch(t._tag){case"Complete":return this.trackAccess(t.key),this.hasExpired(n,t.timeToLiveMillis)?(Xf(this.cacheState.map,t.key.current),S(g())):(this.trackHit(),_(t.exit,x));case"Pending":return this.trackAccess(t.key),this.trackHit(),r?S(g()):_(He(t.deferred),x);case"Refreshing":return this.trackAccess(t.complete.key),this.trackHit(),this.hasExpired(n,t.complete.timeToLiveMillis)?r?S(g()):_(He(t.deferred),x):_(t.complete.exit,x)}})}trackHit(){this.cacheState.hits=this.cacheState.hits+1}trackMiss(){this.cacheState.misses=this.cacheState.misses+1}trackAccess(t){if(ii(this.cacheState.accesses,t),qC(this.cacheState.updating,!1,!0)){let r=!0;for(;r;){let o=Jo(this.cacheState.accesses,Mt);o===Mt?r=!1:this.cacheState.keys.add(o)}let n=Nw(this.cacheState.map);for(r=n>this.capacity;r;){let o=this.cacheState.keys.remove();o!==void 0?Xi(this.cacheState.map,o.current)&&(Xf(this.cacheState.map,o.current),n=n-1,r=n>this.capacity):r=!1}Fn(this.cacheState.updating,!1)}}hasExpired(t,r){return t.unsafeCurrentTimeMillis()>r}lookupValueOf(t,r){return Ka(n=>q(()=>{let o=t;return p(this.lookup(t),ws(this.context),pr,b(s=>{let i=n.unsafeCurrentTimeMillis(),a=T_(i),c=_Q(Ym(o),s,a,i+Kr(Qe(this.timeToLive(s))));return Qo(this.cacheState.map,o,c),we(J$(r,s),s)}),so(()=>we(Y$(r),E(()=>{Xf(this.cacheState.map,o)}))))}))}};var TQ=(e,t,r)=>new F2(e,En(),Cf,t,n=>Qe(r(n)));var I_=Dn,Ya=$i,Bn=Fr,yd=To,IQ=Qr,RQ=Rt,AQ=_b;var MQ=j5,R_=Mf;var aa=sm,A_=Pf;var vQ=Nf;var Xa=Vi,Xm=$5;var Is=Tb;var ex=b$;var Sd=jf;var PQ=Ao;var M_=Tv,FQ=S$;var Ny=zo;var Y={};Yn(Y,{Do:()=>dCe,EffectTypeId:()=>Ek,Service:()=>EOe,Tag:()=>SOe,acquireRelease:()=>wr,acquireReleaseInterruptible:()=>fEe,acquireUseRelease:()=>uD,addFinalizer:()=>dEe,all:()=>Po,allSuccesses:()=>d0e,allWith:()=>f0e,allowInterrupt:()=>Y0e,andThen:()=>MCe,annotateCurrentSpan:()=>oOe,annotateLogs:()=>fwe,annotateLogsScoped:()=>dwe,annotateSpans:()=>nOe,ap:()=>Bwe,as:()=>Kt,asSome:()=>cD,asSomeError:()=>sEe,asVoid:()=>uo,async:()=>oD,asyncEffect:()=>I0e,awaitAllChildren:()=>SEe,bind:()=>hCe,bindAll:()=>mCe,bindTo:()=>xCe,blocked:()=>zwe,cacheRequestResult:()=>Gwe,cached:()=>u0e,cachedFunction:()=>p0e,cachedInvalidateWithTTL:()=>c0e,cachedWithTTL:()=>a0e,catch:()=>P0e,catchAll:()=>yx,catchAllCause:()=>hi,catchAllDefect:()=>F0e,catchIf:()=>N0e,catchSome:()=>D0e,catchSomeCause:()=>kd,catchSomeDefect:()=>L0e,catchTag:()=>U0e,catchTags:()=>q0e,cause:()=>W0e,checkInterruptible:()=>X0e,clock:()=>hD,clockWith:()=>qEe,configProviderWith:()=>XEe,console:()=>BEe,consoleWith:()=>zEe,context:()=>Sx,contextWith:()=>BY,contextWithEffect:()=>rCe,currentParentSpan:()=>iOe,currentSpan:()=>sOe,custom:()=>R0e,daemonChildren:()=>EEe,delay:()=>VEe,descriptor:()=>CEe,descriptorWith:()=>wEe,die:()=>_d,dieMessage:()=>il,dieSync:()=>iD,diffFiberRefs:()=>OEe,disconnect:()=>eEe,dropUntil:()=>Ck,dropWhile:()=>wk,either:()=>pl,ensureErrorType:()=>_Oe,ensureRequirementsType:()=>kOe,ensureSuccessType:()=>OOe,ensuring:()=>pa,ensuringChild:()=>_Ee,ensuringChildren:()=>kEe,eventually:()=>H0e,every:()=>m0e,exists:()=>x0e,exit:()=>Ir,fail:()=>Fo,failCause:()=>Wt,failCauseSync:()=>sD,failSync:()=>_k,fiberId:()=>TEe,fiberIdWith:()=>dD,filter:()=>HY,filterEffectOrElse:()=>OCe,filterEffectOrFail:()=>_Ce,filterMap:()=>g0e,filterOrDie:()=>SCe,filterOrDieMessage:()=>ECe,filterOrElse:()=>CCe,filterOrFail:()=>wCe,finalizersMask:()=>gEe,findFirst:()=>nD,firstSuccessOf:()=>Swe,flatMap:()=>P,flatten:()=>po,flip:()=>iEe,flipWith:()=>aEe,fn:()=>COe,fnUntraced:()=>wOe,forEach:()=>Br,forever:()=>yD,fork:()=>IEe,forkAll:()=>REe,forkDaemon:()=>ul,forkIn:()=>yt,forkScoped:()=>cu,forkWithErrorHandler:()=>AEe,fromFiber:()=>MEe,fromFiberEffect:()=>vEe,fromNullable:()=>xOe,functionWithSpan:()=>dOe,gen:()=>ao,getFiberRefs:()=>VCe,getRuntimeFlags:()=>_we,head:()=>b0e,if:()=>yCe,ignore:()=>aD,ignoreLogged:()=>B0e,inheritFiberRefs:()=>GCe,interrupt:()=>al,interruptWith:()=>tEe,interruptible:()=>co,interruptibleMask:()=>rEe,intoDeferred:()=>pS,isEffect:()=>di,isFailure:()=>twe,isSuccess:()=>rwe,iterate:()=>UCe,labelMetrics:()=>Awe,labelMetricsScoped:()=>vwe,let:()=>gCe,liftPredicate:()=>oEe,linkSpanCurrent:()=>pOe,linkSpans:()=>uOe,locally:()=>KCe,locallyScoped:()=>JCe,locallyScopedWith:()=>ZCe,locallyWith:()=>QCe,log:()=>nwe,logAnnotations:()=>hwe,logDebug:()=>iwe,logError:()=>uwe,logFatal:()=>pwe,logInfo:()=>awe,logTrace:()=>swe,logWarning:()=>cwe,logWithLevel:()=>owe,loop:()=>qCe,makeLatch:()=>Dwe,makeSemaphore:()=>fl,makeSpan:()=>ED,makeSpanScoped:()=>lOe,map:()=>w,mapAccum:()=>cEe,mapBoth:()=>cS,mapError:()=>mi,mapErrorCause:()=>uEe,mapInputContext:()=>nCe,match:()=>la,matchCause:()=>uu,matchCauseEffect:()=>zn,matchEffect:()=>jn,merge:()=>pEe,mergeAll:()=>y0e,metricLabels:()=>Pwe,negate:()=>lEe,never:()=>bx,none:()=>A0e,onError:()=>pD,onExit:()=>hEe,onInterrupt:()=>nEe,once:()=>l0e,option:()=>bCe,optionFromOptional:()=>gOe,orDie:()=>Ik,orDieWith:()=>gwe,orElse:()=>SD,orElseFail:()=>bwe,orElseSucceed:()=>ywe,parallelErrors:()=>z0e,parallelFinalizers:()=>mEe,partition:()=>S0e,patchFiberRefs:()=>YCe,patchRuntimeFlags:()=>kwe,promise:()=>sS,provide:()=>Ex,provideService:()=>oCe,provideServiceEffect:()=>gD,race:()=>lS,raceAll:()=>vCe,raceFirst:()=>bD,raceWith:()=>ll,random:()=>Ewe,randomWith:()=>Cwe,reduce:()=>oS,reduceEffect:()=>w0e,reduceRight:()=>C0e,reduceWhile:()=>E0e,repeat:()=>Tk,repeatN:()=>WCe,repeatOrElse:()=>HCe,replicate:()=>O0e,replicateEffect:()=>_0e,request:()=>Vwe,retry:()=>$0e,retryOrElse:()=>G0e,runCallback:()=>Lwe,runFork:()=>Td,runPromise:()=>lu,runPromiseExit:()=>Uwe,runRequestBlock:()=>jwe,runSync:()=>Ox,runSyncExit:()=>qwe,runtime:()=>pu,sandbox:()=>j0e,schedule:()=>BCe,scheduleForked:()=>zCe,scheduleFrom:()=>jCe,scope:()=>kk,scopeWith:()=>lD,scoped:()=>fD,scopedWith:()=>uS,sequentialFinalizers:()=>xEe,serviceConstants:()=>cCe,serviceFunction:()=>sCe,serviceFunctionEffect:()=>iCe,serviceFunctions:()=>aCe,serviceMembers:()=>uCe,serviceOption:()=>pCe,serviceOptional:()=>lCe,setFiberRefs:()=>XCe,sleep:()=>GEe,spanAnnotations:()=>aOe,spanLinks:()=>cOe,step:()=>$we,succeed:()=>B,succeedNone:()=>iS,succeedSome:()=>M0e,summarized:()=>PCe,supervised:()=>PEe,suspend:()=>Je,sync:()=>Ze,tagMetrics:()=>Rwe,tagMetricsScoped:()=>Mwe,takeUntil:()=>h0e,takeWhile:()=>WY,tap:()=>pn,tapBoth:()=>FCe,tapDefect:()=>NCe,tapError:()=>DCe,tapErrorCause:()=>wx,tapErrorTag:()=>LCe,timed:()=>KEe,timedWith:()=>QEe,timeout:()=>JEe,timeoutFail:()=>mD,timeoutFailCause:()=>xD,timeoutOption:()=>ZEe,timeoutTo:()=>YEe,tracer:()=>Zwe,tracerWith:()=>Ywe,transplant:()=>FEe,transposeMapOption:()=>yOe,transposeOption:()=>bOe,try:()=>K0e,tryMap:()=>Q0e,tryMapPromise:()=>J0e,tryPromise:()=>aS,uninterruptible:()=>au,uninterruptibleMask:()=>cl,unless:()=>kCe,unlessEffect:()=>TCe,unsafeMakeLatch:()=>Rk,unsafeMakeSemaphore:()=>Nwe,unsandbox:()=>Z0e,updateFiberRefs:()=>ewe,updateService:()=>fCe,useSpan:()=>fOe,using:()=>bEe,validate:()=>Wwe,validateAll:()=>k0e,validateFirst:()=>T0e,validateWith:()=>Hwe,void:()=>be,when:()=>Cx,whenEffect:()=>ICe,whenFiberRef:()=>RCe,whenLogLevel:()=>xwe,whenRef:()=>ACe,whileLoop:()=>$Ce,withClock:()=>HEe,withClockScoped:()=>WEe,withConcurrency:()=>NEe,withConfigProvider:()=>eCe,withConfigProviderScoped:()=>tCe,withConsole:()=>$Ee,withConsoleScoped:()=>jEe,withEarlyRelease:()=>yEe,withExecutionPlan:()=>V0e,withFiberRuntime:()=>Ok,withLogSpan:()=>lwe,withMaxOpsBeforeYield:()=>UEe,withMetric:()=>Fwe,withParentSpan:()=>mOe,withRandom:()=>zY,withRandomFixed:()=>wwe,withRandomScoped:()=>Owe,withRequestBatching:()=>Kwe,withRequestCache:()=>Jwe,withRequestCaching:()=>Qwe,withRuntimeFlagsPatch:()=>Twe,withRuntimeFlagsPatchScoped:()=>Iwe,withScheduler:()=>DEe,withSchedulingPriority:()=>LEe,withSpan:()=>jY,withSpanScoped:()=>hOe,withTracer:()=>Xwe,withTracerEnabled:()=>tOe,withTracerScoped:()=>eOe,withTracerTiming:()=>rOe,withUnhandledErrorLogLevel:()=>mwe,yieldNow:()=>v0e,zip:()=>lo,zipLeft:()=>dl,zipRight:()=>ue,zipWith:()=>fa});var mSe="effect/ScheduleInterval",Dy=Symbol.for(mSe),N2={[Dy]:Dy,startMillis:0,endMillis:0},v_=(e,t)=>e>t?N2:{[Dy]:Dy,startMillis:e,endMillis:t},NQ=u(2,(e,t)=>DQ(e,t)===e),DQ=u(2,(e,t)=>e.endMillis<=t.startMillis?e:t.endMillis<=e.startMillis?t:e.startMillis<t.startMillis?e:t.startMillis<e.startMillis?t:e.endMillis<=t.endMillis?e:t);var LQ=e=>e.startMillis>=e.endMillis;var UQ=u(2,(e,t)=>{let r=Math.max(e.startMillis,t.startMillis),n=Math.min(e.endMillis,t.endMillis);return v_(r,n)}),qQ=e=>wn(e.endMillis-e.startMillis);var WQ=e=>v_(e,Number.POSITIVE_INFINITY);var P_=v_,D2=N2,HQ=NQ;var BQ=LQ;var zQ=UQ,jQ=qQ;var $Q=WQ;var gSe="effect/ScheduleIntervals",U2=Symbol.for(gSe),q2=e=>({[U2]:U2,intervals:e});var VQ=u(2,(e,t)=>bSe(e.intervals,t.intervals,ee())),bSe=(e,t,r)=>{let n=e,o=t,s=r;for(;Vt(n)&&Vt(o);){let i=p(Cn(n),zQ(Cn(o))),a=BQ(i)?s:p(s,Et(i));p(Cn(n),HQ(Cn(o)))?n=to(n):o=to(o),s=a}return q2(gs(s))},F_=e=>p(e.intervals,va,_e(()=>D2)).startMillis,GQ=e=>p(e.intervals,va,_e(()=>D2)).endMillis,KQ=u(2,(e,t)=>F_(e)<F_(t)),QQ=e=>Vt(e.intervals);var JQ=q2;var ZQ=VQ,tx=F_,N_=GQ,YQ=KQ,XQ=QQ;var W2="Continue",eJ="Done",tJ=e=>({_tag:W2,intervals:e}),rJ=e=>({_tag:W2,intervals:JQ(V(e))}),nJ={_tag:eJ},oJ=e=>e._tag===W2,sJ=e=>e._tag===eJ;var iJ=tJ;var H2=rJ,rx=nJ,B2=oJ,rl=sJ;var ca={};Yn(ca,{CloseableScopeTypeId:()=>CSe,Scope:()=>j2,ScopeTypeId:()=>ESe,addFinalizer:()=>su,addFinalizerExit:()=>$2,close:()=>nx,extend:()=>ox,fork:()=>Ly,make:()=>V2,use:()=>wSe});var ESe=$b,CSe=Vb,j2=ts,su=dm,$2=Up,nx=Ji,ox=Za,Ly=Es,wSe=T2,V2=ia;var K2=class{permits;waiters=new Set;taken=0;constructor(t){this.permits=t}get free(){return this.permits-this.taken}take=t=>Pb(r=>{if(this.free<t){let n=()=>{this.free<t||(this.waiters.delete(n),this.taken+=t,r(S(t)))};return this.waiters.add(n),E(()=>{this.waiters.delete(n)})}return this.taken+=t,r(S(t))});updateTakenUnsafe(t,r){return this.taken=r(this.taken),this.waiters.size>0&&t.getFiberRef(ra).scheduleTask(()=>{let n=this.waiters.values(),o=n.next();for(;o.done===!1&&this.free>0;)o.value(),o=n.next()},t.getFiberRef(Qi)),S(this.free)}updateTaken(t){return de(r=>this.updateTakenUnsafe(r,t))}resize=t=>Ct(de(r=>(this.permits=t,this.free<0?ae:this.updateTakenUnsafe(r,n=>n))));release=t=>this.updateTaken(r=>r-t);releaseAll=this.updateTaken(t=>0);withPermits=t=>r=>er(n=>b(n(this.take(t)),o=>rs(n(r),this.release(o))));withPermitsIfAvailable=t=>r=>er(n=>q(()=>this.free<t?cd:(this.taken+=t,rs(n(km(r)),this.release(t)))))},sx=e=>new K2(e),cJ=e=>E(()=>sx(e)),Q2=class extends cn{isOpen;waiters=[];scheduled=!1;constructor(t){super(),this.isOpen=t}commit(){return this.await}unsafeSchedule(t){return this.scheduled||this.waiters.length===0?ae:(this.scheduled=!0,t.currentScheduler.scheduleTask(this.flushWaiters,t.getFiberRef(Qi)),ae)}flushWaiters=()=>{this.scheduled=!1;let t=this.waiters;this.waiters=[];for(let r=0;r<t.length;r++)t[r](Xr)};open=de(t=>this.isOpen?ae:(this.isOpen=!0,this.unsafeSchedule(t)));unsafeOpen(){this.isOpen||(this.isOpen=!0,this.flushWaiters())}release=de(t=>this.isOpen?ae:this.unsafeSchedule(t));await=Pb(t=>this.isOpen?t(ae):(this.waiters.push(t),E(()=>{let r=this.waiters.indexOf(t);r!==-1&&this.waiters.splice(r,1)})));unsafeClose(){this.isOpen=!1}close=E(()=>{this.isOpen=!1});whenOpen=t=>we(this.await,t)},Z2=e=>new Q2(e??!1),uJ=e=>E(()=>Z2(e)),pJ=e=>U_(e,CQ),lJ=u(2,(e,t)=>_(Y2(e,t),r=>r[0])),Y2=u(2,(e,t)=>{let r=Qe(t);return b(Cs(),n=>_(Wy(g()),o=>[ws(OSe(e,r,o),n),_Se(o)]))}),aJ=(e,t,r)=>{let n=Kr(Qe(t));return p(sn(),Nr(o=>Ua(e,o)),_(o=>x([r+n,o])))},OSe=(e,t,r)=>er(n=>p(Ka(o=>o.currentTimeMillis),b(o=>nN(r,s=>{switch(s._tag){case"None":return x(aJ(e,t,o));case"Some":{let[i]=s.value;return i-o<=0?x(aJ(e,t,o)):g()}}})),b(o=>ge(o)?Ip("BUG: Effect.cachedInvalidate - please report an issue at https://github.com/Effect-TS/effect/issues"):n(Ut(o.value[1]))))),_Se=e=>ta(e,g()),fJ=u(2,(e,t)=>U_(e,r=>t(I2(r)))),U_=u(2,(e,t)=>b(RK,r=>p(X2(e,r),rs(b(r.value,t))))),dJ=u(e=>Lo(e[0]),(e,t)=>t?.discard?Vo(e,nu):_(Ln(e,nu),I2)),Uy=u(2,(e,t)=>de((r,n)=>{let o=t,s=Py(e,r,n.runtimeFlags,Xc);if(o.state._tag==="Open"){let i=()=>jo(c=>N(c,s.id())?ae:Ct(Wc(s))),a={};o.state.finalizers.set(a,i),s.addObserver(()=>{o.state._tag!=="Closed"&&o.state.finalizers.delete(a)})}else s.unsafeInterruptAsFork(r.id());return S(s)})),q_=e=>li(t=>Uy(e,t)),hJ=e=>_s(e),mJ=e=>q(()=>b(e,_s)),G2=Symbol.for("effect/Effect/memoizeFunction.key"),L_=class{a;eq;[G2]=G2;constructor(t,r){this.a=t,this.eq=r}[W](t){return F(t,G2)?this.eq?this.eq(this.a,t.a):N(this.a,t.a):!1}[H](){return this.eq?0:se(this,M(this.a))}},xJ=(e,t)=>p(E(()=>Yf()),b(Wy),_(r=>n=>p(r.modifyEffect(o=>{let s=p(o,Wr(new L_(n,t)));return ge(s)?p(sn(),Nr(i=>p(Tm(e(n)),Ua(i),nu)),_(i=>[i,p(o,Qo(new L_(n,t),i))])):S([s.value,o])}),b(Ut),b(([o,s])=>p(ad(o),tt(s)))))),gJ=u(2,(e,t)=>p(pr(e),__(pr(t)),r=>$o(r))),X2=u(2,(e,t)=>Zr(O_,n=>n.zip(t))(e)),bJ=u(2,(e,t)=>eN(e,{onTimeout:()=>O$(t),duration:t})),eN=u(2,(e,{duration:t,onTimeout:r})=>$o(qy(e,{onTimeout:()=>ti(r),onSuccess:S,duration:t}))),yJ=u(2,(e,{duration:t,onTimeout:r})=>$o(qy(e,{onTimeout:()=>qc(r),onSuccess:S,duration:t}))),SJ=u(2,(e,t)=>qy(e,{duration:t,onSuccess:x,onTimeout:g})),qy=u(2,(e,{duration:t,onSuccess:r,onTimeout:n})=>jo(o=>er(s=>A2(s(e),Gi(Qa(t)),{onSelfWin:(i,a)=>b(i.await,c=>c._tag==="Success"?b(i.inheritAll,()=>tt(Ko(a,o),r(c.value))):b(Ko(a,o),()=>Be(c.cause))),onOtherWin:(i,a)=>b(i.await,c=>c._tag==="Success"?b(i.inheritAll,()=>tt(Ko(a,o),n())):b(Ko(a,o),()=>Be(c.cause))),otherScope:Xc})))),kSe="effect/Ref/SynchronizedRef",tN=Symbol.for(kSe),rN={_A:e=>e},J2=class extends cn{ref;withLock;[tN]=rN;[oy]=sy;[qn]=qn;constructor(t,r){super(),this.ref=t,this.withLock=r,this.get=Wn(this.ref)}get;commit(){return this.get}modify(t){return this.modifyEffect(r=>S(t(r)))}modifyEffect(t){return this.withLock(p(b(Wn(this.ref),t),b(([r,n])=>tt(ta(this.ref,n),r))))}},Wy=e=>E(()=>W_(e)),W_=e=>{let t=rd(e),r=sx(1);return new J2(t,r.withPermits(1))},nN=u(2,(e,t)=>e.modifyEffect(r=>{let n=t(r);switch(n._tag){case"None":return S([r,r]);case"Some":return _(n.value,o=>[o,o])}}));var EJ=u(e=>et(e[0]),(e,t,r)=>b(e,n=>Ja(t(n),r).pipe(_(o=>Object.assign({},n,o)))));var CJ=Symbol.for("effect/ManagedRuntime");var wJ="ExtendScope",OJ="Fold",oN="Fresh",_J="FromEffect",kJ="Scoped",TJ="Suspend",IJ="Provide",sN="ProvideMerge",RJ="MergeAll",AJ="ZipWith";var H_=YO;var iN=XO,_n=Wc;var B_=Ko;var vo=_s;var MJ=$G;var ax=e=>function(){if(arguments.length===1){let t=arguments[0];return(r,...n)=>e(t,r,...n)}return e.apply(this,arguments)},cx=ax((e,t,r)=>{let n=zC(),o=[[Yr,[[n,e.context]]]];r?.scheduler&&o.push([ra,[[n,r.scheduler]]]);let s=Y8(e.fiberRefs,{entries:o,forkAs:n});r?.updateRefs&&(s=r.updateRefs(s,n));let i=new My(n,s,e.runtimeFlags),a=t;r?.scope&&(a=b(Ly(r.scope,Xo),l=>we(dm(l,jo(f=>N(f,i.id())?ae:Ko(i,f))),Io(t,f=>nx(l,f)))));let c=i.currentSupervisor;return c!==xd&&(c.onStart(e.context,a,g(),i),i.addObserver(l=>c.onEnd(l,i))),Xc.add(e.runtimeFlags,i),r?.immediate===!1?i.resume(a):i.start(a),i}),zy=ax((e,t,r={})=>{let n=cx(e,t,r);return r.onExit&&n.addObserver(o=>{r.onExit(o)}),(o,s)=>zy(e)(p(n,B_(o??Nn)),{...s,onExit:s?.onExit?i=>s.onExit(Lv(i)):void 0})}),uN=ax((e,t)=>{let r=V_(e)(t);if(r._tag==="Failure")throw $_(r.effect_instruction_i0);return r.effect_instruction_i0}),aN=class extends Error{fiber;_tag="AsyncFiberException";constructor(t){super(`Fiber #${t.id().id} cannot be resolved synchronously. This is caused by using runSync on an effect that performs async work`),this.fiber=t,this.name=this._tag,this.stack=this.message}},RSe=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=0;let r=new aN(e);return Error.stackTraceLimit=t,r},vJ=e=>_a(e,"AsyncFiberException")&&"fiber"in e,z_=Symbol.for("effect/Runtime/FiberFailure"),ix=Symbol.for("effect/Runtime/FiberFailure/Cause"),cN=class extends Error{[z_];[ix];constructor(t){let r=lw(t)[0];super(r?.message||"An error has occurred"),this[z_]=z_,this[ix]=t,this.name=r?`(FiberFailure) ${r.name}`:"FiberFailure",r?.stack&&(this.stack=r.stack)}toJSON(){return{_id:"FiberFailure",cause:this[ix].toJSON()}}toString(){return"(FiberFailure) "+zo(this[ix],{renderErrorCause:!0})}[he](){return this.toString()}},$_=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=0;let r=new cN(e);return Error.stackTraceLimit=t,r},PJ=e=>F(e,z_),FJ=e=>{let t=e;switch(t._op){case"Failure":case"Success":return t;case"Left":return Wp(t.left);case"Right":return ht(t.right);case"Some":return ht(t.value);case"None":return Wp(Ao())}},V_=ax((e,t)=>{let r=FJ(t);if(r)return r;let n=new Zp,o=cx(e)(t,{scheduler:n});n.flush();let s=o.unsafePoll();return s||Aw(Sw(RSe(o),vw(o)))}),pN=ax((e,t,r)=>G_(e,t,r).then(n=>{switch(n._tag){case xt:return n.effect_instruction_i0;case mt:throw $_(n.effect_instruction_i0)}})),G_=ax((e,t,r)=>new Promise(n=>{let o=FJ(t);o&&n(o);let s=cx(e)(t);s.addObserver(i=>{n(i)}),r?.signal!==void 0&&(r.signal.aborted?s.unsafeInterruptAsFork(s.id()):r.signal.addEventListener("abort",()=>{s.unsafeInterruptAsFork(s.id())},{once:!0}))})),j_=class{context;runtimeFlags;fiberRefs;constructor(t,r,n){this.context=t,this.runtimeFlags=r,this.fiberRefs=n}pipe(){return v(this,arguments)}},ux=e=>new j_(e.context,e.runtimeFlags,e.fiberRefs),px=()=>de((e,t)=>S(new j_(e.getFiberRef(Yr),t.runtimeFlags,e.getFiberRefs()))),lN=QM(ji,KM,GM),ua=ux({context:En(),runtimeFlags:lN,fiberRefs:X8()}),K_=u(2,(e,t)=>ux({context:e.context,runtimeFlags:t(e.runtimeFlags),fiberRefs:e.fiberRefs})),NJ=u(2,(e,t)=>K_(e,tw(t))),DJ=u(2,(e,t)=>K_(e,rw(t))),fN=u(2,(e,t)=>ux({context:t(e.context),runtimeFlags:e.runtimeFlags,fiberRefs:e.fiberRefs})),LJ=u(3,(e,t,r)=>fN(e,qe(t,r))),Q_=u(2,(e,t)=>ux({context:e.context,runtimeFlags:e.runtimeFlags,fiberRefs:t(e.fiberRefs)})),UJ=u(3,(e,t,r)=>Q_(e,Z8({fiberId:Nn,fiberRef:t,value:r}))),qJ=u(2,(e,t)=>Q_(e,K8(t))),WJ=zy(ua),HJ=cx(ua),BJ=pN(ua),zJ=G_(ua),jJ=uN(ua),$J=V_(ua),VJ=e=>q(()=>{let t;return b(sn(),r=>b(px(),n=>er(o=>we(nu(o(Gt(e(s=>zy(n)(Ua(s,r))),{onFailure:s=>gm(r,s),onSuccess:s=>(t=s,ae)}))),o(so(Ut(r),()=>t??ae))))))});var GJ=u(2,(e,t)=>e.modifyEffect(r=>_(t(r),n=>[r,n]))),KJ=u(2,(e,t)=>e.modifyEffect(r=>{let n=t(r);switch(n._tag){case"None":return S([r,r]);case"Some":return _(n.value,o=>[r,o])}}));var hN=u(2,(e,t)=>e.modifyEffect(t)),QJ=u(3,(e,t,r)=>e.modifyEffect(n=>p(r(n),_e(()=>S([t,n]))))),JJ=u(2,(e,t)=>e.modifyEffect(r=>_(t(r),n=>[void 0,n]))),ZJ=u(2,(e,t)=>e.modifyEffect(r=>_(t(r),n=>[n,n]))),YJ=u(2,(e,t)=>e.modifyEffect(r=>{let n=t(r);switch(n._tag){case"None":return S([void 0,r]);case"Some":return _(n.value,o=>[void 0,o])}}));var ASe="effect/Layer",Y_=Symbol.for(ASe),MSe={_RIn:e=>e,_E:e=>e,_ROut:e=>e},fi={[Y_]:MSe,pipe(){return v(this,arguments)}},vSe="effect/Layer/MemoMap",jy=Symbol.for(vSe),mN=Hi()("effect/Layer/CurrentMemoMap",{defaultValue:()=>PSe()}),$y=e=>F(e,Y_),xN=e=>e._op_layer===oN,J_=class{ref;[jy];constructor(t){this.ref=t,this[jy]=jy}getOrElseMemoize(t,r){return p(hN(this.ref,n=>{let o=n.get(t);if(o!==void 0){let[s,i]=o,a=p(s,b(([c,l])=>p(ad(c),tt(l))),Io(Vf({onFailure:()=>ae,onSuccess:()=>Up(r,i)})));return S([a,n])}return p(nd(0),b(s=>p(sn(),b(i=>p(nd(()=>ae),_(a=>{let c=er(f=>p(ia(),b(d=>p(f(b(oZ(t,d,!0),h=>Tm(h(this)))),pr,b(h=>{switch(h._tag){case mt:return p(gm(i,h.effect_instruction_i0),we(Ji(d,h)),we(Re(h.effect_instruction_i0)));case xt:return p(ta(a,m=>p(Ji(d,m),Ki(uO(s,y=>[y===1,y-1])),Ct)),we(od(s,m=>m+1)),we(Up(r,m=>p(E(()=>n.delete(t)),we(Wn(a)),b(y=>y(m))))),we(Hc(i,h.effect_instruction_i0)),tt(h.effect_instruction_i0[1]))}}))))),l=[p(Ut(i),Io(Gf({onFailure:()=>ae,onSuccess:()=>od(s,f=>f+1)}))),f=>p(Wn(a),b(d=>d(f)))];return[c,xN(t)?n:n.set(t,l)]}))))))}),$o)}},gN=q(()=>_(Wy(new Map),e=>new J_(e))),PSe=()=>new J_(W_(new Map)),nZ=e=>li(t=>nl(e,t)),nl=u(2,(e,t)=>b(gN,r=>X_(e,r,t))),X_=u(3,(e,t,r)=>b(oZ(e,r),n=>Vp(n(t),mN,t))),oZ=(e,t,r=!1)=>{let n=e;switch(n._op_layer){case"Locally":return E(()=>o=>n.f(o.getOrElseMemoize(n.self,t)));case"ExtendScope":return E(()=>o=>li(s=>o.getOrElseMemoize(n.layer,s)));case"Fold":return E(()=>o=>p(o.getOrElseMemoize(n.layer,t),Gt({onFailure:s=>o.getOrElseMemoize(n.failureK(s),t),onSuccess:s=>o.getOrElseMemoize(n.successK(s),t)})));case"Fresh":return E(()=>o=>p(n.layer,nl(t)));case"FromEffect":return r?E(()=>o=>n.effect):E(()=>o=>o.getOrElseMemoize(e,t));case"Provide":return E(()=>o=>p(o.getOrElseMemoize(n.first,t),b(s=>p(o.getOrElseMemoize(n.second,t),ws(s)))));case"Scoped":return r?E(()=>o=>Za(n.effect,t)):E(()=>o=>o.getOrElseMemoize(e,t));case"Suspend":return E(()=>o=>o.getOrElseMemoize(n.evaluate(),t));case"ProvideMerge":return E(()=>o=>p(o.getOrElseMemoize(n.first,t),Wa(o.getOrElseMemoize(n.second,t),n.zipK)));case"ZipWith":return _w(function*(){let o=yield*Es(t,hy),s=yield*Es(o,Xo),i=yield*Es(o,Xo);return a=>p(a.getOrElseMemoize(n.first,s),ou(a.getOrElseMemoize(n.second,i),n.zipK,{concurrent:!0}))});case"MergeAll":{let o=n.layers;return _(Es(t,hy),s=>i=>{let a=new Array(o.length);return _(es(o,cm(function*(c,l){let f=yield*Es(s,Xo),d=yield*i.getOrElseMemoize(c,f);a[l]=d}),!1,!1),()=>YA(...a))})}}},Ed=u(2,(e,t)=>ik(e,{onFailure:t,onSuccess:iu})),bN=u(2,(e,t)=>sk(e,{onFailure:t,onSuccess:iu})),yN=e=>Vy(Bn(e)),sZ=e=>tk(()=>Bn(e())),iZ=e=>ok(e,()=>En()),ek=()=>io(Cs()),aZ=e=>{let t=Object.create(fi);return t._op_layer=wJ,t.layer=e,t},SN=e=>Vy(Ya(e)),EN=e=>tk(()=>Ya(e())),Vy=e=>io(Re(e)),tk=e=>io(qc(e)),Rs=u(2,(e,t)=>ik(e,{onFailure:SN,onSuccess:t})),cZ=u(2,(e,t)=>Rs(e,jt(t))),CN=e=>{let t=Object.create(fi);return t._op_layer=oN,t.layer=e,t},ol=u(2,(e,t)=>{let r=$h(e),n=r?e:t;return io(_(r?t:e,s=>Oo(n,s)))}),uZ=e=>io(_(e,()=>En()));function io(e){let t=Object.create(fi);return t._op_layer=_J,t.effect=e,t}var pZ=u(3,(e,t,r)=>rk(e,Lt(t,r))),rk=u(2,(e,t)=>{let r=Object.create(fi);return r._op_layer="Locally",r.self=e,r.f=t,r}),nk=u(3,(e,t,r)=>rk(e,Zr(t,r))),lZ=(e,t)=>ec(Hn(e,t)),fZ=(e,t)=>ec(un(e,t)),dZ=(e,t,r)=>io(_(e,n=>Oo(t,r(n)))),hZ=e=>E_(we(li(t=>p(e,nl(t))),Np)),mZ=function(){return arguments.length===1?e=>eZ(arguments[0],e):eZ(arguments[0],arguments[1])},eZ=(e,t)=>fx(e,new Proxy({...t},{get(r,n,o){if(n in r)return r[n];let s=Error.stackTraceLimit;Error.stackTraceLimit=2;let i=new Error(`${e.key}: Unimplemented method "${n.toString()}"`);return Error.stackTraceLimit=s,i.name="UnimplementedError",FSe(i)},has:zr})),FSe=e=>{let t=oo(e);function r(){return t}return Object.assign(r,t),Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r},ok=u(2,(e,t)=>Rs(e,r=>iu(t(r)))),xZ=u(2,(e,t)=>Ed(e,r=>EN(()=>t(r)))),sk=u(2,(e,{onFailure:t,onSuccess:r})=>{let n=Object.create(fi);return n._op_layer=OJ,n.layer=e,n.failureK=t,n.successK=r,n}),ik=u(2,(e,{onFailure:t,onSuccess:r})=>sk(e,{onFailure:n=>{let o=Xa(n);switch(o._tag){case"Left":return t(o.left);case"Right":return Vy(o.right)}},onSuccess:r})),gZ=e=>li(t=>_(bO(nl(e,t)),io)),wN=u(2,(e,t)=>ON(e,t,(r,n)=>_o(r,n))),ak=(...e)=>{let t=Object.create(fi);return t._op_layer=RJ,t.layers=e,t},bZ=e=>Ed(e,t=>yN(t)),yZ=u(2,(e,t)=>Ed(e,t)),SZ=e=>wN(ek(),e),EZ=u(4,(e,t,r,n)=>ok(e,o=>Oo(r,n(vn(o,t))))),CZ=u(2,(e,t)=>Ky(()=>{let r=nn("effect/Layer/retry/{ state: unknown }");return p(fx(r,{state:t.initial}),Rs(n=>wZ(e,t,r,p(n,jt(r)).state)))})),wZ=(e,t,r,n)=>p(e,Ed(o=>p(NSe(t,r,o,n),Rs(s=>CN(wZ(e,t,r,p(s,jt(r)).state)))))),NSe=(e,t,r,n)=>ol(t,p(ea,b(o=>p(e.step(o,r,n),b(([s,i,a])=>rl(a)?ke(r):p($a(wn(tx(a.intervals)-o)),tt({state:s}))))))),sl=u(2,(e,t)=>{let r=$h(e),n=r?e:t;return Gy(_(r?t:e,s=>Oo(n,s)))}),ec=e=>Gy(p(e,tt(En()))),Gy=e=>{let t=Object.create(fi);return t._op_layer=kJ,t.effect=e,t},OZ=Gy(_(tl(ia(),(e,t)=>e.close(t)),e=>Oo(j2,e))),_Z=e=>ol(e,e),fx=u(2,(e,t)=>{let r=$h(e);return io(S(Oo(r?e:t,r?t:e)))}),iu=e=>io(S(e)),kZ=iu(En()),Ky=e=>{let t=Object.create(fi);return t._op_layer=TJ,t.evaluate=e,t},ck=u(2,(e,t)=>{let r=$h(e),n=r?e:t,o=r?t:e;return io(E(()=>Oo(n,o())))}),TZ=e=>io(E(e)),IZ=u(2,(e,t)=>Rs(e,r=>io(tt(t(r),r)))),RZ=u(2,(e,t)=>Ed(e,r=>io(b(t(r),()=>ke(r))))),AZ=u(2,(e,t)=>bN(e,r=>io(b(t(r),()=>Re(r))))),MZ=e=>p(li(t=>nl(e,t)),b(t=>p(px(),ws(t)))),vZ=u(2,(e,t)=>b(li(r=>X_(e,t,r)),r=>p(px(),ws(r)))),Cd=u(2,(e,t)=>Ky(()=>{let r=Object.create(fi);return r._op_layer=IJ,r.first=Object.create(fi,{_op_layer:{value:sN,enumerable:!0},first:{value:ek(),enumerable:!0},second:{value:Array.isArray(t)?ak(...t):t},zipK:{value:(n,o)=>p(n,_o(o))}}),r.second=e,r})),PZ=u(2,(e,t)=>{let r=Object.create(fi);return r._op_layer=sN,r.first=t,r.second=Cd(e,t),r.zipK=(n,o)=>p(n,_o(o)),r}),ON=u(3,(e,t,r)=>Ky(()=>{let n=Object.create(fi);return n._op_layer=AJ,n.first=e,n.second=t,n.zipK=r,n})),uk=e=>{let t=nn("effect/Layer/unwrapEffect/Layer.Layer<R1, E1, A>");return Rs(ol(t,e),r=>jt(r,t))},lx=e=>{let t=nn("effect/Layer/unwrapScoped/Layer.Layer<R1, E1, A>");return Rs(sl(t,e),r=>jt(r,t))},FZ=u(e=>$y(e[0]),function(){let e=arguments;return nk(e[0],Ha,typeof e[1]=="string"?on(e[1],e[2]):t=>Object.entries(e[1]).reduce((r,[n,o])=>on(r,n,o),t))}),NZ=u(e=>$y(e[0]),function(){let e=arguments;return nk(e[0],Bf,typeof e[1]=="string"?on(e[1],e[2]):t=>Object.entries(e[1]).reduce((r,[n,o])=>on(r,n,o),t))}),DZ=function(){let e=typeof arguments[0]!="string",t=e?arguments[1]:arguments[0],r=Un(e?arguments[2]:arguments[1]);if(e){let n=arguments[0];return lx(_(r?.onEnd?Nr(pi(t,r),o=>sa(s=>r.onEnd(o,s))):pi(t,r),o=>Z_(n,o)))}return n=>lx(_(r?.onEnd?Nr(pi(t,r),o=>sa(s=>r.onEnd(o,s))):pi(t,r),o=>Z_(n,o)))},Z_=u(2,(e,t)=>Cd(e,iu(Oo(an,t)))),tZ=u(2,(e,t)=>Fy(r=>b(nl(t,r),n=>Mw(e,n)))),rZ=u(2,(e,t)=>{let r=ud(ua.fiberRefs,t.fiberRefs),n=Xs(ua.runtimeFlags,t.runtimeFlags);return er(o=>de(s=>{let i=s.getFiberRef(Yr),a=s.getFiberRefs(),c=pd(s.id(),a)(r),l=s.currentRuntimeFlags,f=Dc(n)(l),d=ud(c,a),h=Xs(f,l);return s.setFiberRefs(c),s.currentRuntimeFlags=f,rs(Mw(o(e),_o(i,t.context)),de(m=>(m.setFiberRefs(pd(m.id(),m.getFiberRefs())(d)),m.currentRuntimeFlags=Dc(h)(m.currentRuntimeFlags),ae)))}))}),pk=u(2,(e,t)=>Array.isArray(t)?tZ(e,ak(...t)):$y(t)?tZ(e,t):ob(t)?Mw(e,t):CJ in t?b(t.runtimeEffect,r=>rZ(e,r)):rZ(e,t));var LZ=_(Ro(Ot),jt(Zo)),UZ=e=>qr(Ot,t=>e(jt(t,Zo))),qZ=u(2,(e,t)=>Zr(e,Ot,qe(Zo,t))),WZ=e=>un(Ot,qe(Zo,e));var HZ=rm;var BZ=e=>LSe(e.slice(0)),LSe=e=>Object.setPrototypeOf(e,m5);var _N=Sp;var kN=(function(){let e=Symbol.for("effect/Data/Error/plainArgs");return{BaseEffectError:class extends Gb{constructor(r){super(r?.message,r?.cause?{cause:r.cause}:void 0),r&&(Object.assign(this,r),Object.defineProperty(this,e,{value:r,enumerable:!1}))}toJSON(){return{...this[e],...this}}}}.BaseEffectError})(),zZ=e=>{let t={BaseEffectError:class extends kN{_tag=e}};return t.BaseEffectError.prototype.name=e,t.BaseEffectError};var fk=Symbol.for("effect/DateTime"),dk=Symbol.for("effect/DateTime/TimeZone"),VZ={[fk]:fk,pipe(){return v(this,arguments)},[he](){return this.toString()},toJSON(){return Yy(this).toJSON()}},USe={...VZ,_tag:"Utc",[H](){return se(this,ac(this.epochMillis))},[W](e){return hx(e)&&e._tag==="Utc"&&this.epochMillis===e.epochMillis},toString(){return`DateTime.Utc(${Yy(this).toJSON()})`}},qSe={...VZ,_tag:"Zoned",[H](){return p(ac(this.epochMillis),G(M(this.zone)),se(this))},[W](e){return hx(e)&&e._tag==="Zoned"&&this.epochMillis===e.epochMillis&&N(this.zone,e.zone)},toString(){return`DateTime.Zoned(${UN(this)})`}},GZ={[dk]:dk,[he](){return this.toString()}},WSe={...GZ,_tag:"Named",[H](){return se(this,Ke(`Named:${this.id}`))},[W](e){return mx(e)&&e._tag==="Named"&&this.id===e.id},toString(){return`TimeZone.Named(${this.id})`},toJSON(){return{_id:"TimeZone",_tag:"Named",id:this.id}}},HSe={...GZ,_tag:"Offset",[H](){return se(this,Ke(`Offset:${this.offset}`))},[W](e){return mx(e)&&e._tag==="Offset"&&this.offset===e.offset},toString(){return`TimeZone.Offset(${NN(this.offset)})`},toJSON(){return{_id:"TimeZone",_tag:"Offset",offset:this.offset}}},tc=(e,t,r)=>{let n=Object.create(qSe);return n.epochMillis=e,n.zone=t,Object.defineProperty(n,"partsUtc",{value:r,enumerable:!1,writable:!0}),Object.defineProperty(n,"adjustedEpochMillis",{value:void 0,enumerable:!1,writable:!0}),Object.defineProperty(n,"partsAdjusted",{value:void 0,enumerable:!1,writable:!0}),n},hx=e=>F(e,fk);var mx=e=>F(e,dk),KZ=e=>mx(e)&&e._tag==="Offset",QZ=e=>mx(e)&&e._tag==="Named",JZ=e=>e._tag==="Utc",RN=e=>e._tag==="Zoned",ZZ=ar((e,t)=>e.epochMillis===t.epochMillis);var BSe=e=>{let t=Object.create(USe);return t.epochMillis=e,Object.defineProperty(t,"partsUtc",{value:void 0,enumerable:!1,writable:!0}),t},dx=e=>{let t=e.getTime();if(Number.isNaN(t))throw new Sd("Invalid date");return BSe(t)},AN=e=>{if(hx(e))return e;if(e instanceof Date)return dx(e);if(typeof e=="object"){let t=new Date(0);return JSe(t,e),dx(t)}else if(typeof e=="string"&&!zSe(e))return dx(new Date(e+"Z"));return dx(new Date(e))},zSe=e=>/Z|[+-]\d{2}$|[+-]\d{2}:?\d{2}$|\]$/.test(e),jSe=-864e13+720*60*1e3,$Se=864e13-840*60*1e3,MN=(e,t)=>{if(t?.timeZone===void 0&&hx(e)&&RN(e))return e;let r=AN(e);if(r.epochMillis<jSe||r.epochMillis>$Se)throw new RangeError(`Epoch millis out of range: ${r.epochMillis}`);let n;if(t?.timeZone===void 0){let o=new Date(r.epochMillis).getTimezoneOffset()*-60*1e3;n=Zy(o)}else if(mx(t?.timeZone))n=t.timeZone;else if(typeof t?.timeZone=="number")n=Zy(t.timeZone);else{let o=PN(t.timeZone);if(ge(o))throw new Sd(`Invalid time zone: ${t.timeZone}`);n=o.value}return t?.adjustForTimeZone!==!0?tc(r.epochMillis,n,r.partsUtc):ZSe(r.epochMillis,n,t?.disambiguation??"compatible")},TN=Vl(MN);var VSe=/^(.{17,35})\[(.+)\]$/,YZ=e=>{let t=VSe.exec(e);if(t===null){let o=LN(e);return o!==null?TN(e,{timeZone:o}):g()}let[,r,n]=t;return TN(r,{timeZone:n})};var Jy=ne("effect/DateTime/validZoneCache",()=>new Map),GSe={day:"numeric",month:"numeric",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"longOffset",fractionalSecondDigits:3,hourCycle:"h23"},KSe=e=>{let t=e.resolvedOptions().timeZone;if(Jy.has(t))return Jy.get(t);let r=Object.create(WSe);return r.id=t,r.format=e,Jy.set(t,r),r},vN=e=>{if(Jy.has(e))return Jy.get(e);try{return KSe(new Intl.DateTimeFormat("en-US",{...GSe,timeZone:e}))}catch{throw new Sd(`Invalid time zone: ${e}`)}},Zy=e=>{let t=Object.create(HSe);return t.offset=e,t},XZ=Vl(vN);var QSe=/^(?:GMT|[+-])/,PN=e=>{if(QSe.test(e)){let t=LN(e);return t===null?g():x(Zy(t))}return XZ(e)},eY=e=>e._tag==="Offset"?NN(e.offset):e.id;var Yy=e=>new Date(e.epochMillis),hk=e=>{if(e._tag==="Utc")return new Date(e.epochMillis);if(e.zone._tag==="Offset")return new Date(e.epochMillis+e.zone.offset);if(e.adjustedEpochMillis!==void 0)return new Date(e.adjustedEpochMillis);let t=e.zone.format.formatToParts(e.epochMillis).filter(n=>n.type!=="literal"),r=new Date(0);return r.setUTCFullYear(Number(t[2].value),Number(t[0].value)-1,Number(t[1].value)),r.setUTCHours(Number(t[3].value),Number(t[4].value),Number(t[5].value),Number(t[6].value)),e.adjustedEpochMillis=r.getTime(),r},FN=e=>hk(e).getTime()-DN(e),NN=e=>{let t=Math.abs(e),r=Math.floor(t/(3600*1e3)),n=Math.round(t%(3600*1e3)/(60*1e3));return n===60&&(r+=1,n=0),`${e<0?"-":"+"}${String(r).padStart(2,"0")}:${String(n).padStart(2,"0")}`},tY=e=>NN(FN(e)),DN=e=>e.epochMillis;var JSe=(e,t)=>{if(t.year!==void 0&&e.setUTCFullYear(t.year),t.month!==void 0&&e.setUTCMonth(t.month-1),t.day!==void 0&&e.setUTCDate(t.day),t.weekDay!==void 0){let r=t.weekDay-e.getUTCDay();e.setUTCDate(e.getUTCDate()+r)}t.hours!==void 0&&e.setUTCHours(t.hours),t.minutes!==void 0&&e.setUTCMinutes(t.minutes),t.seconds!==void 0&&e.setUTCSeconds(t.seconds),t.millis!==void 0&&e.setUTCMilliseconds(t.millis)};var $Z=1440*60*1e3,ZSe=(e,t,r)=>{if(t._tag==="Offset")return tc(e-t.offset,t);let n=Qy(e-$Z,e,t),o=Qy(e+$Z,e,t);if(n===o)return tc(e-n,t);let s=n<o,i=n-o;if(s){if(Qy(e-o,e,t)===o)return tc(e-o,t);let l=tc(e-n,t),f=hk(l).getTime();if(e!==f)switch(r){case"reject":{let d=new Date(e).toISOString();throw new RangeError(`Gap time: ${d} does not exist in time zone ${t.id}`)}case"earlier":return tc(e-o,t);case"compatible":case"later":return l}return l}if(Qy(e-n,e,t)===n){if(r==="earlier"||r==="compatible"||Qy(e-n+i,e+i,t)===n)return tc(e-n,t);if(r==="reject"){let l=new Date(e).toISOString();throw new RangeError(`Ambiguous time: ${l} occurs twice in time zone ${t.id}`)}}return tc(e-o,t)},YSe=/([+-])(\d{2}):(\d{2})$/,LN=e=>{let t=YSe.exec(e);if(t===null)return null;let[,r,n,o]=t;return(r==="+"?1:-1)*(Number(n)*60+Number(o))*60*1e3},Qy=(e,t,r)=>{let n=r.format.formatToParts(e).find(s=>s.type==="timeZoneName")?.value??"";if(n==="GMT")return 0;let o=LN(n);return o===null?FN(tc(t,r)):o};var rY=e=>Yy(e).toISOString();var IN=e=>{let t=hk(e);return e._tag==="Utc"?t.toISOString():`${t.toISOString().slice(0,-1)}${tY(e)}`},UN=e=>e.zone._tag==="Offset"?IN(e):`${IN(e)}[${e.zone.id}]`;var e0e=e=>e.toUpperCase(),t0e=e=>e.toLowerCase(),nY=e=>e.length===0?e:e0e(e[0])+e.slice(1),oY=e=>e.length===0?e:t0e(e[0])+e.slice(1);var sY=e=>e.length>0;var aY=I8;var r0e="effect/Schedule",jN=Symbol.for(r0e),$N=e=>F(e,jN),n0e="effect/ScheduleDriver",lY=Symbol.for(n0e),qN={start:0,now:0,input:void 0,output:void 0,elapsed:Pa,elapsedSincePrevious:Pa,recurrence:0},wd=Hi()("effect/Schedule/CurrentIterationMetadata",{defaultValue:()=>qN}),o0e={_Out:e=>e,_In:e=>e,_R:e=>e},s0e={_Out:e=>e,_In:e=>e,_R:e=>e},WN=class{initial;step;[jN]=o0e;constructor(t,r){this.initial=t,this.step=r}pipe(){return v(this,arguments)}},uY=(e,t,r,n)=>od(e,o=>o.recurrence===0?{now:t,input:r,output:n,recurrence:o.recurrence+1,elapsed:Pa,elapsedSincePrevious:Pa,start:t}:{now:t,input:r,output:n,recurrence:o.recurrence+1,elapsed:wn(t-o.start),elapsedSincePrevious:wn(t-o.now),start:o.start}),HN=class{schedule;ref;[lY]=s0e;constructor(t,r){this.schedule=t,this.ref=r}get state(){return _(Wn(this.ref),t=>t[1])}get last(){return b(Wn(this.ref),([t,r])=>{switch(t._tag){case"None":return ti(()=>new Ao);case"Some":return S(t.value)}})}iterationMeta=rd(qN);get reset(){return ta(this.ref,[g(),this.schedule.initial]).pipe(Hf(ta(this.iterationMeta,qN)))}next(t){return p(_(Wn(this.ref),r=>r[1]),b(r=>p(ea,b(n=>p(q(()=>this.schedule.step(n,t,r)),b(([o,s,i])=>{let a=ta(this.ref,[x(s),o]);if(rl(i))return a.pipe(we(ke(g())));let c=tx(i.intervals)-n;if(c<=0)return a.pipe(we(uY(this.iterationMeta,n,t,s)),tt(s));let l=wn(c);return p(a,we(uY(this.iterationMeta,n,t,s)),we(Qa(l)),tt(s))}))))))}},Od=(e,t)=>new WN(e,t),fY=u(2,(e,t)=>dY(e,r=>E(()=>t(r)))),dY=u(2,(e,t)=>bY(e,(r,n)=>_(t(r),o=>E4(n,Qe(o)))));var hY=e=>GN(e,Ar);var mY=u(2,(e,t)=>gk(e,(r,n)=>E(()=>t(r,n)))),gk=u(2,(e,t)=>Od(e.initial,(r,n,o)=>b(e.step(r,n,o),([s,i,a])=>rl(a)?S([s,i,rx]):_(t(n,i),c=>c?[s,i,a]:[s,i,rx]))));var eS=e=>p(nd([g(),e.initial]),_(t=>new HN(e,t)));var VN=u(2,(e,t)=>xY(e,t,ZQ)),xY=u(3,(e,t,r)=>Od([e.initial,t.initial],(n,o,s)=>p(Wa(e.step(n,o,s[0]),t.step(n,o,s[1]),(i,a)=>[i,a]),b(([[i,a,c],[l,f,d]])=>B2(c)&&B2(d)?BN(e,t,o,i,a,c.intervals,l,f,d.intervals,r):S([[i,l],[a,f],rx]))))),BN=(e,t,r,n,o,s,i,a,c,l)=>{let f=l(s,c);return XQ(f)?S([[n,i],[o,a],iJ(f)]):p(s,YQ(c))?b(e.step(N_(s),r,n),([d,h,m])=>rl(m)?S([[d,i],[h,a],rx]):BN(e,t,r,d,h,m.intervals,i,a,c,l)):b(t.step(N_(c),r,i),([d,h,m])=>rl(m)?S([[n,d],[o,h],rx]):BN(e,t,r,n,o,s,d,h,m.intervals,l))};var GN=u(2,(e,t)=>gY(e,r=>E(()=>t(r)))),gY=u(2,(e,t)=>Od(e.initial,(r,n,o)=>b(e.step(r,n,o),([s,i,a])=>_(t(i),c=>[s,c,a]))));var bY=u(2,(e,t)=>Od(e.initial,(r,n,o)=>b(e.step(r,n,o),([s,i,a])=>{if(rl(a))return S([s,i,a]);let c=a.intervals,l=jQ(P_(r,tx(c)));return _(t(i,l),f=>{let d=Qe(f),h=tx(c),m=r+Kr(d),y=m-h,T=Math.max(0,N_(c)+y),C=P_(m,T);return[s,i,H2(C)]})})));var yY=e=>Od(e.initial,(t,r,n)=>p(e.step(t,r,n),_(([o,s,i])=>[o,r,i])));var bk=e=>CY(xx,t=>t<e);var SY=e=>fY(xx,()=>e);var EY=(e,t)=>Od(e,(r,n,o)=>E(()=>[t(o),o,H2($Q(r))]));var KN=u(2,(e,t)=>gk(e,(r,n)=>yO(t(r))));var QN=u(2,(e,t)=>gk(e,(r,n)=>t(r))),CY=u(2,(e,t)=>mY(e,(r,n)=>t(n)));var mk=Symbol.for("effect/Schedule/ScheduleDefect"),zN=class{error;[mk];constructor(t){this.error=t,this[mk]=mk}},i0e=e=>F(e,mk),xk=e=>Ss(e,t=>oo(new zN(t))),JN=e=>j(Op(e,t=>Mf(t)&&i0e(t.defect)?x(t.defect):g()),{onNone:()=>e,onSome:t=>$i(t.error)}),tS=e=>La(e,t=>Re(JN(t))),pY=u(2,(e,t)=>ZN(e,t,(r,n)=>ke(r))),wY=u(2,(e,t)=>{if($N(t))return pY(e,t);let r=t.schedule??yY(xx),n=t.while?QN(r,i=>{let a=t.while(i);return typeof a=="boolean"?S(a):xk(a)}):r,o=t.until?KN(n,i=>{let a=t.until(i);return typeof a=="boolean"?S(a):xk(a)}):n,s=t.times?VN(o,bk(t.times)).pipe(GN(i=>i[0])):o;return tS(pY(e,s))}),ZN=u(3,(e,t,r)=>b(eS(t),n=>Jr(e,{onFailure:o=>r(o,g()),onSuccess:o=>OY(Gp(e,wd,Wn(n.iterationMeta)),n,(s,i)=>Gp(r(s,i),wd,Wn(n.iterationMeta)),o)}))),OY=(e,t,r,n)=>Jr(t.next(n),{onFailure:()=>qf(t.last),onSuccess:o=>Jr(e,{onFailure:s=>r(s,x(o)),onSuccess:s=>OY(e,t,r,s)})}),Xy=u(2,(e,t)=>YN(e,t,(r,n)=>ke(r))),_Y=u(2,(e,t)=>$N(t)?Xy(e,t):tS(Xy(e,yk(t)))),yk=e=>{let t=e.schedule??xx,r=e.while?QN(t,o=>{let s=e.while(o);return typeof s=="boolean"?S(s):xk(s)}):t,n=e.until?KN(r,o=>{let s=e.until(o);return typeof s=="boolean"?S(s):xk(s)}):r;return e.times?VN(n,bk(e.times)):n},YN=u(3,(e,t,r)=>b(eS(t),n=>kY(Gp(e,wd,Wn(n.iterationMeta)),n,(o,s)=>Gp(r(o,s),wd,Wn(n.iterationMeta))))),kY=(e,t,r)=>Ss(e,n=>Jr(t.next(n),{onFailure:()=>p(t.last,qf,b(o=>r(n,o))),onSuccess:()=>kY(e,t,r)})),XN=u(2,(e,t)=>eD(e,void 0,t)),eD=u(3,(e,t,r)=>b(eS(r),n=>TY(Gp(e,wd,Wn(n.iterationMeta)),t,n))),TY=(e,t,r)=>Jr(r.next(t),{onFailure:()=>qf(r.last),onSuccess:()=>b(e,n=>TY(e,n,r))});var xx=EY(0,e=>e+1),tD=hY(bk(1));var IY=u(2,(e,t)=>q_(XN(e,t)));var RY=u(2,(e,t)=>q(()=>{let r=0,n;return b(Fp({while:()=>r<t.steps.length&&(n===void 0||kt(n)),body:()=>{let o=t.steps[r],s=pk(e,o.provide);if(n){let i=!1,a=s;s=q(()=>i?a:(i=!0,n)),s=tS(Xy(s,rS(o,!1)))}else{let i=rS(o,!0);s=i?tS(Xy(s,i)):s}return ei(s)},step:o=>{n=o,r++}}),()=>n)})),rS=(e,t)=>{if(t){if(e.attempts===1||!(e.schedule||e.attempts))return}else return yk({schedule:e.schedule?e.schedule:e.attempts?void 0:tD,times:e.attempts,while:e.while});return yk({schedule:e.schedule,while:e.while,times:e.attempts?e.attempts-1:void 0})};var gx=ne(Symbol.for("effect/FiberRef/currentCache"),()=>lr(TQ(65536,()=>_(sn(),e=>({listeners:new zm,handle:e})),()=>uM(60)))),nS=ne(Symbol.for("effect/FiberRef/currentCacheEnabled"),()=>lr(!1)),MY=(e,t)=>b(et(t)?t:S(t),r=>jo(n=>{let o=new Proxy(e,{});return qr(nS,s=>{if(s){let a=qr(gx,c=>b(c.getEither(o),l=>{switch(l._tag){case"Left":return l.left.listeners.interrupted?b(c.invalidateWhen(o,f=>f.handle===l.left.handle),()=>a):(l.left.listeners.increment(),er(f=>b(pr(Lc(D5,f(Ut(l.left.handle)))),d=>(l.left.listeners.decrement(),d))));case"Right":return l.right.listeners.increment(),er(f=>b(pr(Lc(sv(r,iv({request:o,result:l.right.handle,listeners:l.right.listeners,ownerId:n,state:{completed:!1}})),f(Ut(l.right.handle)))),()=>(l.right.listeners.decrement(),Ut(l.right.handle))))}}));return a}let i=new zm;return i.increment(),b(sn(),a=>rs(Lc(sv(r,iv({request:o,result:a,listeners:i,ownerId:n,state:{completed:!1}})),Ut(a)),E(()=>i.decrement())))})})),vY=(e,t)=>qr(nS,r=>r?qr(gx,n=>b(n.getEither(e),o=>{switch(o._tag){case"Left":return ae;case"Right":return vv(o.right.handle,t)}})):ae),PY=u(2,(e,t)=>Lt(e,nS,t)),FY=u(2,(e,t)=>Lt(e,gx,t));var DY=pK;var LY=lK;var Ek=Uc,di=et,a0e=lJ,c0e=Y2,u0e=bO,p0e=xJ,l0e=FP,Po=Ja,f0e=nQ,d0e=oQ,Ck=WV,wk=HV,h0e=N9,WY=D9,m0e=YV,x0e=eQ,HY=rQ,g0e=zV,nD=KV,Br=ks,b0e=e9,y0e=C2,S0e=w2,oS=_9,E0e=T9,C0e=k9,w0e=uQ,O0e=E2,_0e=sQ,k0e=aQ,T0e=hQ,oD=no,I0e=VJ,R0e=vb,Ok=de,Fo=ke,_k=ti,Wt=Re,sD=qc,_d=oo,il=Ip,iD=Rp,ao=_w,bx=Np,A0e=b9,sS=w9,B=S,iS=cd,M0e=P9,Je=q,Ze=E,be=ae;var v0e=qa,P0e=TV;var yx=Ss,hi=La,F0e=IV,N0e=Fb,D0e=r$,kd=RV,L0e=AV,U0e=MV,q0e=vV,W0e=PV,H0e=MP,aD=gO,B0e=t9,z0e=C9,j0e=M9,$0e=_Y,V0e=RY,G0e=YN,K0e=AP;var Q0e=B9,J0e=z9,aS=LP,Z0e=V9,Y0e=DV,X0e=n$,eEe=wQ,al=Xt,tEe=Db,co=Gi,rEe=o$,nEe=so,au=Go,cl=er,oEe=VV,Kt=tt,cD=km,sEe=kV,uo=Ct,iEe=Mp,aEe=ZV,w=_,cEe=x9,cS=Lb,mi=vp,uEe=Im,pEe=g9,lEe=yO,wr=tl,fEe=YK,uD=yw,dEe=sa,pa=rs,pD=ww,hEe=Io,mEe=b_,xEe=y_,gEe=pQ,kk=w_,lD=li,uS=Fy,fD=E_,bEe=fQ,yEe=gQ,SEe=pJ,EEe=XK,CEe=LV,wEe=hO,OEe=Tm,_Ee=fJ,kEe=U_,TEe=ri,dD=jo,IEe=nu,ul=Zm,REe=dJ,yt=Uy,cu=q_,AEe=iQ,MEe=hJ,vEe=mJ,PEe=X2,FEe=Ow,NEe=i$,DEe=WG,LEe=kv,UEe=m$,hD=FV,qEe=Ka,WEe=mQ,HEe=D8,BEe=LZ,zEe=UZ,jEe=WZ,$Ee=qZ,VEe=NV,GEe=Qa,KEe=W9,QEe=DP,JEe=bJ,ZEe=SJ,mD=eN,xD=yJ,YEe=qy,XEe=lP,eCe=L8,tCe=C_,Sx=Cs,BY=BV,rCe=si,nCe=Jf,Ex=pk,oCe=Vp,gD=Gp,sCe=Y9,iCe=Z9,aCe=UP,cCe=qP,uCe=X9,pCe=eG,lCe=WP,fCe=G9,dCe=UV,hCe=cy,mCe=EJ,xCe=uy,gCe=qV;var bCe=y9,pl=ei,Ir=pr,pS=Ua,yCe=Cw;var SCe=jV,ECe=$V,CCe=py,wCe=GV,OCe=Fv,_Ce=K$,kCe=j9,TCe=$9,Cx=CO,ICe=Ki,RCe=K9,ACe=Q9,P=b,MCe=Ap,po=$o,lS=__,vCe=cQ,bD=gJ,ll=R2,PCe=fy,pn=Nr,FCe=L9,NCe=SO,DCe=dy,LCe=U9,wx=q9,yD=mO,UCe=vP,qCe=d9,Tk=wY,WCe=R9,HCe=ZN,BCe=XN,zCe=IY,jCe=eD,$Ce=Fp,VCe=xO,GCe=r9,KCe=Lt,QCe=Zr,JCe=Hn,ZCe=un,YCe=ad,XCe=v9,ewe=EO,twe=n9,rwe=o9,la=ly,uu=Nb,zn=Gt,jn=Jr,nwe=s9,owe=(e,...t)=>Zc(e)(...t),swe=i9,iwe=PP,awe=a9,cwe=c9,uwe=u9,pwe=p9,lwe=l9,fwe=_V,dwe=JK,hwe=f9,mwe=x$,xwe=ZK,Ik=qf,gwe=yv,SD=Uf,bwe=S9,ywe=E9,Swe=JV,Ewe=O9,Cwe=Qw,zY=q8,wwe=u(2,(e,t)=>zY(e,aY(t))),Owe=xQ,pu=px,_we=am,kwe=Pp,Twe=kw,Iwe=k2,Rwe=F9,Awe=NP,Mwe=lQ,vwe=O2,Pwe=g$,Fwe=J9,Nwe=sx,fl=cJ,Rk=Z2,Dwe=uJ,Td=HJ,Lwe=WJ,lu=BJ,Uwe=zJ,Ox=jJ,qwe=$J,Wwe=dQ,Hwe=_2,lo=bQ,dl=yQ,ue=SQ,fa=ou,Bwe=u(2,(e,t)=>fa(e,t,(r,n)=>r(n))),zwe=Lc,jwe=bw,$we=Ew,Vwe=u(e=>DY(e[0]),MY),Gwe=vY,Kwe=a$,Qwe=PY,Jwe=FY,Zwe=H9,Ywe=Jw,Xwe=W8,eOe=k_,tOe=c$,rOe=u$,nOe=nG,oOe=tG,sOe=wO,iOe=oG,aOe=uG,cOe=pG,uOe=sG,pOe=rG,ED=cG,lOe=pi,fOe=fO,jY=HP,dOe=lG,hOe=OQ,mOe=dO,xOe=fG,gOe=dG,bOe=e=>Vu(e)?iS:w(e.value,Rn),yOe=u(2,(e,t)=>Vu(e)?iS:w(t(e.value),Rn)),$Y=e=>{let t=new Map;return new Proxy(e,{get(r,n,o){if(n in r)return Reflect.get(r,n,o);if(t.has(n))return t.get(n);let s=(...d)=>Ap(r,h=>typeof h[n]=="function"?(t.set(n,(...m)=>Ap(r,y=>y[n](...m))),h[n](...d)):(t.set(n,Ap(r,m=>m[n])),h[n])),i=Ap(r,d=>d[n]);Object.assign(s,i);let a=s.apply,c=s.bind,l=s.call,f=Object.setPrototypeOf({},Object.getPrototypeOf(i));return f.apply=a,f.bind=c,f.call=l,Object.setPrototypeOf(s,f),t.set(n,s),s}})},SOe=e=>()=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=2;let r=new Error;Error.stackTraceLimit=t;function n(){}return Object.setPrototypeOf(n,jh),n.key=e,Object.defineProperty(n,"use",{get(){return o=>Ap(this,o)}}),Object.defineProperty(n,"stack",{get(){return r.stack}}),$Y(n)},EOe=function(){return function(){let[e,t]=arguments,r="accessors"in t?t.accessors:!1,n=Error.stackTraceLimit;Error.stackTraceLimit=2;let o=new Error;Error.stackTraceLimit=n;let s="unchecked",i=function(d){if(s==="unchecked"){let h=Object.getPrototypeOf(d);if(h===Object.prototype||h===null)s="plain";else{let m=Object.getPrototypeOf(this);Object.setPrototypeOf(m,h),s="patched"}}if(s==="plain")Object.assign(this,d);else if(s==="patched")return Object.setPrototypeOf(d,Object.getPrototypeOf(this)),d};i.prototype._tag=e,Object.defineProperty(i,"make",{get(){return d=>new this(d)}}),Object.defineProperty(i,"use",{get(){return d=>Ap(this,d)}}),i.key=e,Object.assign(i,jh),Object.defineProperty(i,"stack",{get(){return o.stack}});let a="dependencies"in t&&t.dependencies.length>0,c=a?"DefaultWithoutDependencies":"Default",l,f=!1;if("effect"in t?(f=typeof t.effect=="function",Object.defineProperty(i,c,{get(){return f?function(){return ol(i,w(t.effect.apply(null,arguments),d=>new this(d)))}.bind(this):l??=ol(i,w(t.effect,d=>new this(d)))}})):"scoped"in t?(f=typeof t.scoped=="function",Object.defineProperty(i,c,{get(){return f?function(){return sl(i,w(t.scoped.apply(null,arguments),d=>new this(d)))}.bind(this):l??=sl(i,w(t.scoped,d=>new this(d)))}})):"sync"in t?Object.defineProperty(i,c,{get(){return l??=ck(i,()=>new this(t.sync()))}}):Object.defineProperty(i,c,{get(){return l??=fx(i,new this(t.succeed))}}),a){let d;Object.defineProperty(i,"Default",{get(){return f?function(){return Cd(this.DefaultWithoutDependencies.apply(null,arguments),t.dependencies)}:d??=Cd(this.DefaultWithoutDependencies,t.dependencies)}})}return r===!0?$Y(i):i}},COe=function(e,...t){let r=Error.stackTraceLimit;Error.stackTraceLimit=2;let n=new Error;if(Error.stackTraceLimit=r,typeof e!="string")return UY(e.length,function(...i){let a=Error.stackTraceLimit;Error.stackTraceLimit=2;let c=new Error;return Error.stackTraceLimit=a,qY({self:this,body:e,args:i,pipeables:t,spanName:"<anonymous>",spanOptions:{context:Cm.context(!0)},errorDef:n,errorCall:c})});let o=e,s=t[0];return(i,...a)=>UY(i.length,{[o](...c){let l=Error.stackTraceLimit;Error.stackTraceLimit=2;let f=new Error;return Error.stackTraceLimit=l,qY({self:this,body:i,args:c,pipeables:a,spanName:o,spanOptions:s,errorDef:n,errorCall:f})}}[o])};function UY(e,t){return Object.defineProperty(t,"length",{value:e,configurable:!0})}function qY(e){let t,r;if(ez(e.body))t=Ab(()=>e.body.apply(e.self,e.args));else try{t=e.body.apply(e.self,e.args)}catch(i){r=i,t=_d(i)}if(e.pipeables.length>0)try{for(let i of e.pipeables)t=i(t,...e.args)}catch(i){t=r?Wt(Rt(Fr(r),Fr(i))):_d(i)}let n=!1,o=()=>{if(n!==!1)return n;if(e.errorCall.stack){let i=e.errorDef.stack.trim().split(`
`),a=e.errorCall.stack.trim().split(`
`),c=i.slice(2).join(`
`).trim();c.includes("(")||(c=c.replace(/at (.*)/,"at ($1)"));let l=a.slice(2).join(`
`).trim();return l.includes("(")||(l=l.replace(/at (.*)/,"at ($1)")),n=`${c}
${l}`,n}},s=e.spanOptions&&"captureStackTrace"in e.spanOptions?e.spanOptions:{captureStackTrace:o,...e.spanOptions};return jY(t,e.spanName,s)}var wOe=cm,OOe=()=>e=>e,_Oe=()=>e=>e,kOe=()=>e=>e;var VY=Ro;var GY=qr;var KY=Yr,QY=Qi;var Ak=ra;var JY=Ba;var xi={};Yn(xi,{CurrentMemoMap:()=>ROe,LayerTypeId:()=>TOe,MemoMapTypeId:()=>IOe,annotateLogs:()=>vOe,annotateSpans:()=>POe,build:()=>FOe,buildWithMemoMap:()=>Z_e,buildWithScope:()=>OD,catchAll:()=>NOe,catchAllCause:()=>DOe,context:()=>vk,die:()=>LOe,dieSync:()=>UOe,discard:()=>qOe,effect:()=>WOe,effectContext:()=>BOe,effectDiscard:()=>HOe,empty:()=>zOe,extendScope:()=>jOe,fail:()=>$Oe,failCause:()=>GOe,failCauseSync:()=>KOe,failSync:()=>VOe,fiberRefLocallyScopedWith:()=>h_e,flatMap:()=>QOe,flatten:()=>JOe,fresh:()=>ZOe,function:()=>XOe,isFresh:()=>MOe,isLayer:()=>AOe,launch:()=>e_e,locally:()=>l_e,locallyEffect:()=>p_e,locallyScoped:()=>d_e,locallyWith:()=>f_e,makeMemoMap:()=>J_e,map:()=>aX,mapError:()=>t_e,match:()=>r_e,matchCause:()=>n_e,memoize:()=>o_e,merge:()=>_D,mergeAll:()=>s_e,mock:()=>YOe,orDie:()=>i_e,orElse:()=>a_e,parentSpan:()=>D_e,passthrough:()=>c_e,project:()=>u_e,provide:()=>cX,provideMerge:()=>A_e,retry:()=>m_e,scope:()=>x_e,scoped:()=>g_e,scopedContext:()=>b_e,scopedDiscard:()=>da,service:()=>y_e,setClock:()=>F_e,setConfigProvider:()=>N_e,setRandom:()=>L_e,setRequestBatching:()=>U_e,setRequestCache:()=>W_e,setRequestCaching:()=>q_e,setScheduler:()=>H_e,setTracer:()=>z_e,setTracerEnabled:()=>j_e,setTracerTiming:()=>$_e,setUnhandledErrorLogLevel:()=>V_e,setVersionMismatchErrorLogLevel:()=>G_e,span:()=>B_e,succeed:()=>S_e,succeedContext:()=>E_e,suspend:()=>C_e,sync:()=>w_e,syncContext:()=>O_e,tap:()=>__e,tapError:()=>k_e,tapErrorCause:()=>T_e,toRuntime:()=>I_e,toRuntimeWithMemoMap:()=>R_e,unwrapEffect:()=>v_e,unwrapScoped:()=>P_e,updateService:()=>Y_e,withParentSpan:()=>Q_e,withSpan:()=>K_e,zipWith:()=>M_e});var ZY=e=>ec(Hn(vy,e)),YY=u(2,(e,t)=>Lt(vy,t)(e)),fS=e=>ec(un(S_,zi(e))),CD=e=>uk(_(e,fS)),wD=e=>lx(_(e,fS)),dS=e=>ec(un(S_,Ef(e))),XY=u(2,(e,t)=>Rs(dS(e),()=>fS(t))),eX=u(2,(e,t)=>Rs(dS(e),()=>CD(t))),tX=u(2,(e,t)=>Rs(dS(e),()=>wD(t)));var rX=e=>ec(C_(e)),nX=e=>iu(Oo(an,e)),oX=(e,t)=>(t=Un(t),sl(an,t?.onEnd?Nr(pi(e,t),r=>sa(n=>t.onEnd(r,n))):pi(e,t))),sX=e=>ec(k_(e));var TOe=Y_,IOe=jy,ROe=mN,AOe=$y,MOe=xN,vOe=FZ,POe=NZ,FOe=nZ,OD=nl,NOe=Ed,DOe=bN,vk=ek,LOe=yN,UOe=sZ,qOe=iZ,WOe=ol,HOe=uZ,BOe=io,zOe=kZ,jOe=aZ,$Oe=SN,VOe=EN,GOe=Vy,KOe=tk,QOe=Rs,JOe=cZ,ZOe=CN,YOe=mZ,XOe=dZ;var e_e=hZ,aX=ok,t_e=xZ,r_e=ik,n_e=sk,o_e=gZ,_D=wN,s_e=ak,i_e=bZ,a_e=yZ,c_e=SZ,u_e=EZ,p_e=rk,l_e=pZ,f_e=nk,d_e=lZ,h_e=fZ,m_e=CZ,x_e=OZ,g_e=sl,da=ec,b_e=Gy,y_e=_Z,S_e=fx,E_e=iu,C_e=Ky,w_e=ck,O_e=TZ,__e=IZ,k_e=RZ,T_e=AZ,I_e=MZ,R_e=vZ,cX=Cd,A_e=PZ,M_e=ON,v_e=uk,P_e=lx,F_e=e=>da(un(Ot,qe(Mo,e))),N_e=rX,D_e=nX,L_e=e=>da(un(Ot,qe(Gc,e))),U_e=e=>da(Hn(pm,e)),q_e=e=>da(Hn(nS,e)),W_e=e=>da(et(e)?b(e,t=>Hn(gx,t)):Hn(gx,e)),H_e=e=>da(Hn(ra,e)),B_e=oX,z_e=sX,j_e=e=>da(Hn(fm,e)),$_e=e=>da(Hn(Ba,e)),V_e=e=>da(Hn(lm,e)),G_e=e=>da(Hn(zb,e)),K_e=DZ,Q_e=Z_,J_e=gN,Z_e=X_,Y_e=u(3,(e,t,r)=>cX(e,aX(vk(),n=>qe(n,t,r(vn(n,t))))));var X_e="effect/QueueEnqueue",Nk=Symbol.for(X_e),eke="effect/QueueDequeue",kx=Symbol.for(eke),tke="effect/QueueStrategy",Dk=Symbol.for(tke),rke="effect/BackingQueue",uX=Symbol.for(rke),MD={_A:e=>e},nke={_A:e=>e},vD={_In:e=>e},Lk={_Out:e=>e},kD=class extends cn{queue;takers;shutdownHook;shutdownFlag;strategy;[Nk]=vD;[kx]=Lk;constructor(t,r,n,o,s){super(),this.queue=t,this.takers=r,this.shutdownHook=n,this.shutdownFlag=o,this.strategy=s}pipe(){return v(this,arguments)}commit(){return this.take}capacity(){return this.queue.capacity()}get size(){return q(()=>Ss(this.unsafeSize(),()=>Xt))}unsafeSize(){return Ie(this.shutdownFlag)?g():x(this.queue.length()-qw(this.takers)+this.strategy.surplusSize())}get isEmpty(){return _(this.size,t=>t<=0)}get isFull(){return _(this.size,t=>t>=this.capacity())}get shutdown(){return Go(de(t=>(p(this.shutdownFlag,Fn(!0)),p(es(_x(this.takers),r=>Qf(r,t.id()),!1,!1),we(this.strategy.shutdown),Ki(Hc(this.shutdownHook,void 0)),Ct))))}get isShutdown(){return E(()=>Ie(this.shutdownFlag))}get awaitShutdown(){return Ut(this.shutdownHook)}isActive(){return!Ie(this.shutdownFlag)}unsafeOffer(t){if(Ie(this.shutdownFlag))return!1;let r;if(this.queue.length()===0){let o=p(this.takers,Jo(Mt));o!==Mt?(Rd(o,t),r=!0):r=!1}else r=!1;if(r)return!0;let n=this.queue.offer(t);return Id(this.strategy,this.queue,this.takers),n}offer(t){return q(()=>{if(Ie(this.shutdownFlag))return Xt;let r;if(this.queue.length()===0){let o=p(this.takers,Jo(Mt));o!==Mt?(Rd(o,t),r=!0):r=!1}else r=!1;if(r)return S(!0);let n=this.queue.offer(t);return Id(this.strategy,this.queue,this.takers),n?S(!0):this.strategy.handleSurplus([t],this.queue,this.takers,this.shutdownFlag)})}offerAll(t){return q(()=>{if(Ie(this.shutdownFlag))return Xt;let r=Ee(t),n=this.queue.length()===0?Ee(ske(this.takers,r.length)):ds,[o,s]=p(r,iR(n.length));for(let a=0;a<n.length;a++){let c=n[a],l=o[a];Rd(c,l)}if(s.length===0)return S(!0);let i=this.queue.offerAll(s);return Id(this.strategy,this.queue,this.takers),le(i)?S(!0):this.strategy.handleSurplus(i,this.queue,this.takers,this.shutdownFlag)})}get take(){return de(t=>{if(Ie(this.shutdownFlag))return Xt;let r=this.queue.poll(Mt);if(r!==Mt)return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),S(r);{let n=Zi(t.id());return p(q(()=>(p(this.takers,ii(n)),Id(this.strategy,this.queue,this.takers),Ie(this.shutdownFlag)?Xt:Ut(n))),so(()=>E(()=>ike(this.takers,n))))}})}get takeAll(){return q(()=>Ie(this.shutdownFlag)?Xt:E(()=>{let t=this.queue.pollUpTo(Number.POSITIVE_INFINITY);return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),pt(t)}))}takeUpTo(t){return q(()=>Ie(this.shutdownFlag)?Xt:E(()=>{let r=this.queue.pollUpTo(t);return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),pt(r)}))}takeBetween(t,r){return q(()=>pX(this,t,r,ee()))}},pX=(e,t,r,n)=>r<t?S(n):p(PD(e,r),b(o=>{let s=t-o.length;return s===1?p(Pk(e),_(i=>p(n,We(o),Pn(i)))):s>1?p(Pk(e),b(i=>pX(e,s-1,r-o.length-1,p(n,We(o),Pn(i))))):S(p(n,We(o)))}));var lX=e=>p(E(()=>Uw(e)),b(t=>hS(Uk(t),IX()))),fX=e=>p(E(()=>Uw(e)),b(t=>hS(Uk(t),FD()))),dX=e=>p(E(()=>Uw(e)),b(t=>hS(Uk(t),RX()))),hX=()=>p(E(()=>jc()),b(e=>hS(Uk(e),FD()))),oke=(e,t,r,n,o)=>new kD(e,t,r,n,o),hS=(e,t)=>p(sn(),_(r=>oke(e,jc(),r,ko(!1),t))),TD=class{mutable;[uX]=nke;constructor(t){this.mutable=t}poll(t){return Jo(this.mutable,t)}pollUpTo(t){return ym(this.mutable,t)}offerAll(t){return Zb(this.mutable,t)}offer(t){return ii(this.mutable,t)}capacity(){return f8(this.mutable)}length(){return qw(this.mutable)}},Uk=e=>new TD(e),mX=e=>e.capacity(),xX=e=>e.size,gX=e=>e.isFull,bX=e=>e.isEmpty,yX=e=>e.isShutdown,SX=e=>e.awaitShutdown,EX=e=>e.shutdown,CX=u(2,(e,t)=>e.offer(t));var wX=u(2,(e,t)=>e.offerAll(t)),OX=e=>_(e.takeUpTo(1),va),Pk=e=>e.take,_X=e=>e.takeAll,PD=u(2,(e,t)=>e.takeUpTo(t)),kX=u(3,(e,t,r)=>e.takeBetween(t,r)),TX=u(2,(e,t)=>e.takeBetween(t,t)),IX=()=>new ID,FD=()=>new RD,RX=()=>new AD,ID=class{[Dk]=MD;putters=jc();surplusSize(){return qw(this.putters)}onCompleteTakersWithEmptyQueue(t){for(;!$c(this.putters)&&!$c(t);){let r=Jo(t,void 0),n=Jo(this.putters,void 0);n[2]&&Rd(n[1],!0),Rd(r,n[0])}}get shutdown(){return p(ri,b(t=>p(E(()=>_x(this.putters)),b(r=>es(r,([n,o,s])=>s?p(Qf(o,t),Ct):ae,!1,!1)))))}handleSurplus(t,r,n,o){return de(s=>{let i=Zi(s.id());return p(q(()=>(this.unsafeOffer(t,i),this.unsafeOnQueueEmptySpace(r,n),Id(this,r,n),Ie(o)?Xt:Ut(i))),so(()=>E(()=>this.unsafeRemove(i))))})}unsafeOnQueueEmptySpace(t,r){let n=!0;for(;n&&(t.capacity()===Number.POSITIVE_INFINITY||t.length()<t.capacity());){let o=p(this.putters,Jo(Mt));if(o===Mt)n=!1;else{let s=t.offer(o[0]);s&&o[2]?Rd(o[1],!0):s||Fk(this.putters,p(_x(this.putters),Et(o))),Id(this,t,r)}}}unsafeOffer(t,r){let n=Ee(t);for(let o=0;o<n.length;o++){let s=n[o];o===n.length-1?p(this.putters,ii([s,r,!0])):p(this.putters,ii([s,r,!1]))}}unsafeRemove(t){Fk(this.putters,p(_x(this.putters),Bi(([,r])=>r!==t)))}},RD=class{[Dk]=MD;surplusSize(){return 0}get shutdown(){return ae}onCompleteTakersWithEmptyQueue(){}handleSurplus(t,r,n,o){return S(!1)}unsafeOnQueueEmptySpace(t,r){}},AD=class{[Dk]=MD;surplusSize(){return 0}get shutdown(){return ae}onCompleteTakersWithEmptyQueue(){}handleSurplus(t,r,n,o){return E(()=>(this.unsafeOffer(r,t),Id(this,r,n),!0))}unsafeOnQueueEmptySpace(t,r){}unsafeOffer(t,r){let n=r[Symbol.iterator](),o,s=!0;for(;!(o=n.next()).done&&s;){if(t.capacity()===0)return;t.poll(Mt),s=t.offer(o.value)}}},Rd=(e,t)=>za(e,S(t)),Fk=(e,t)=>p(e,Zb(t)),_x=e=>p(e,ym(Number.POSITIVE_INFINITY)),ske=(e,t)=>p(e,ym(t)),ike=(e,t)=>{Fk(e,p(_x(e),Bi(r=>t!==r)))},Id=(e,t,r)=>{let n=!0;for(;n&&t.length()!==0;){let o=p(r,Jo(Mt));if(o!==Mt){let s=t.poll(Mt);s!==Mt?(Rd(o,s),e.unsafeOnQueueEmptySpace(t,r)):Fk(r,p(_x(r),Et(o))),n=!0}else n=!1}n&&t.length()===0&&!$c(r)&&e.onCompleteTakersWithEmptyQueue(r)};var Rr=Symbol.for("effect/PubSub/AbsentValue"),MX=(e,t)=>r=>{r.has(e)||r.set(e,new Set),r.get(e).add(t)},ake=(e,t)=>r=>{if(!r.has(e))return;let n=r.get(e);n.delete(t),n.size===0&&r.delete(e)},vX=e=>q(()=>{let t=GD(e);return Bk(t,new $D)}),PX=e=>q(()=>{let t=GD(e);return Bk(t,new Wk)}),FX=e=>q(()=>{let t=GD(e);return Bk(t,new VD)}),NX=e=>q(()=>{let t=cke(e);return Bk(t,new Wk)});var DX=e=>e.shutdown;var LX=u(2,(e,t)=>e.publish(t));var UX=e=>e.subscribe,GD=e=>{let t=typeof e=="number"?{capacity:e}:e;fke(t.capacity);let r=t.replay&&t.replay>0?new Hk(Math.ceil(t.replay)):void 0;return t.capacity===1?new qD(r):j6(t.capacity)===t.capacity?new LD(t.capacity,r):new ND(t.capacity,r)},cke=e=>new HD(e?.replay?new Hk(e.replay):void 0),uke=(e,t,r)=>_(sn(),n=>pke(e,t,e.subscribe(),jc(),n,ko(!1),r)),pke=(e,t,r,n,o,s,i)=>new zD(e,t,r,n,o,s,i,e.replayWindow()),ND=class{capacity;replayBuffer;array;publisherIndex=0;subscribers;subscriberCount=0;subscribersIndex=0;constructor(t,r){this.capacity=t,this.replayBuffer=r,this.array=Array.from({length:t}),this.subscribers=Array.from({length:t})}replayWindow(){return this.replayBuffer?new Ix(this.replayBuffer):zk}isEmpty(){return this.publisherIndex===this.subscribersIndex}isFull(){return this.publisherIndex===this.subscribersIndex+this.capacity}size(){return this.publisherIndex-this.subscribersIndex}publish(t){if(this.isFull())return!1;if(this.subscriberCount!==0){let r=this.publisherIndex%this.capacity;this.array[r]=t,this.subscribers[r]=this.subscriberCount,this.publisherIndex+=1}return this.replayBuffer&&this.replayBuffer.offer(t),!0}publishAll(t){if(this.subscriberCount===0)return this.replayBuffer&&this.replayBuffer.offerAll(t),ee();let r=pt(t),n=r.length,o=this.publisherIndex-this.subscribersIndex,s=this.capacity-o,i=Math.min(n,s);if(i===0)return r;let a=0,c=this.publisherIndex+i;for(;this.publisherIndex!==c;){let l=dt(r,a++),f=this.publisherIndex%this.capacity;this.array[f]=l,this.subscribers[f]=this.subscriberCount,this.publisherIndex+=1,this.replayBuffer&&this.replayBuffer.offer(l)}return $t(r,a)}slide(){if(this.subscribersIndex!==this.publisherIndex){let t=this.subscribersIndex%this.capacity;this.array[t]=Rr,this.subscribers[t]=0,this.subscribersIndex+=1}this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.subscriberCount+=1,new DD(this,this.publisherIndex,!1)}},DD=class{self;subscriberIndex;unsubscribed;constructor(t,r,n){this.self=t,this.subscriberIndex=r,this.unsubscribed=n}isEmpty(){return this.unsubscribed||this.self.publisherIndex===this.subscriberIndex||this.self.publisherIndex===this.self.subscribersIndex}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(t){if(this.unsubscribed)return t;if(this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex),this.subscriberIndex!==this.self.publisherIndex){let r=this.subscriberIndex%this.self.capacity,n=this.self.array[r];return this.self.subscribers[r]-=1,this.self.subscribers[r]===0&&(this.self.array[r]=Rr,this.self.subscribersIndex+=1),this.subscriberIndex+=1,n}return t}pollUpTo(t){if(this.unsubscribed)return ee();this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);let r=this.self.publisherIndex-this.subscriberIndex,n=Math.min(t,r);if(n<=0)return ee();let o=[],s=this.subscriberIndex+n;for(;this.subscriberIndex!==s;){let i=this.subscriberIndex%this.self.capacity,a=this.self.array[i];this.self.subscribers[i]-=1,this.self.subscribers[i]===0&&(this.self.array[i]=Rr,this.self.subscribersIndex+=1),o.push(a),this.subscriberIndex+=1}return pt(o)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.subscriberCount-=1,this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);this.subscriberIndex!==this.self.publisherIndex;){let t=this.subscriberIndex%this.self.capacity;this.self.subscribers[t]-=1,this.self.subscribers[t]===0&&(this.self.array[t]=Rr,this.self.subscribersIndex+=1),this.subscriberIndex+=1}}},LD=class{capacity;replayBuffer;array;mask;publisherIndex=0;subscribers;subscriberCount=0;subscribersIndex=0;constructor(t,r){this.capacity=t,this.replayBuffer=r,this.array=Array.from({length:t}),this.mask=t-1,this.subscribers=Array.from({length:t})}replayWindow(){return this.replayBuffer?new Ix(this.replayBuffer):zk}isEmpty(){return this.publisherIndex===this.subscribersIndex}isFull(){return this.publisherIndex===this.subscribersIndex+this.capacity}size(){return this.publisherIndex-this.subscribersIndex}publish(t){if(this.isFull())return!1;if(this.subscriberCount!==0){let r=this.publisherIndex&this.mask;this.array[r]=t,this.subscribers[r]=this.subscriberCount,this.publisherIndex+=1}return this.replayBuffer&&this.replayBuffer.offer(t),!0}publishAll(t){if(this.subscriberCount===0)return this.replayBuffer&&this.replayBuffer.offerAll(t),ee();let r=pt(t),n=r.length,o=this.publisherIndex-this.subscribersIndex,s=this.capacity-o,i=Math.min(n,s);if(i===0)return r;let a=0,c=this.publisherIndex+i;for(;this.publisherIndex!==c;){let l=dt(r,a++),f=this.publisherIndex&this.mask;this.array[f]=l,this.subscribers[f]=this.subscriberCount,this.publisherIndex+=1,this.replayBuffer&&this.replayBuffer.offer(l)}return $t(r,a)}slide(){if(this.subscribersIndex!==this.publisherIndex){let t=this.subscribersIndex&this.mask;this.array[t]=Rr,this.subscribers[t]=0,this.subscribersIndex+=1}this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.subscriberCount+=1,new UD(this,this.publisherIndex,!1)}},UD=class{self;subscriberIndex;unsubscribed;constructor(t,r,n){this.self=t,this.subscriberIndex=r,this.unsubscribed=n}isEmpty(){return this.unsubscribed||this.self.publisherIndex===this.subscriberIndex||this.self.publisherIndex===this.self.subscribersIndex}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(t){if(this.unsubscribed)return t;if(this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex),this.subscriberIndex!==this.self.publisherIndex){let r=this.subscriberIndex&this.self.mask,n=this.self.array[r];return this.self.subscribers[r]-=1,this.self.subscribers[r]===0&&(this.self.array[r]=Rr,this.self.subscribersIndex+=1),this.subscriberIndex+=1,n}return t}pollUpTo(t){if(this.unsubscribed)return ee();this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);let r=this.self.publisherIndex-this.subscriberIndex,n=Math.min(t,r);if(n<=0)return ee();let o=[],s=this.subscriberIndex+n;for(;this.subscriberIndex!==s;){let i=this.subscriberIndex&this.self.mask,a=this.self.array[i];this.self.subscribers[i]-=1,this.self.subscribers[i]===0&&(this.self.array[i]=Rr,this.self.subscribersIndex+=1),o.push(a),this.subscriberIndex+=1}return pt(o)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.subscriberCount-=1,this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);this.subscriberIndex!==this.self.publisherIndex;){let t=this.subscriberIndex&this.self.mask;this.self.subscribers[t]-=1,this.self.subscribers[t]===0&&(this.self.array[t]=Rr,this.self.subscribersIndex+=1),this.subscriberIndex+=1}}},qD=class{replayBuffer;publisherIndex=0;subscriberCount=0;subscribers=0;value=Rr;capacity=1;constructor(t){this.replayBuffer=t}replayWindow(){return this.replayBuffer?new Ix(this.replayBuffer):zk}pipe(){return v(this,arguments)}isEmpty(){return this.subscribers===0}isFull(){return!this.isEmpty()}size(){return this.isEmpty()?0:1}publish(t){return this.isFull()?!1:(this.subscriberCount!==0&&(this.value=t,this.subscribers=this.subscriberCount,this.publisherIndex+=1),this.replayBuffer&&this.replayBuffer.offer(t),!0)}publishAll(t){if(this.subscriberCount===0)return this.replayBuffer&&this.replayBuffer.offerAll(t),ee();let r=pt(t);return le(r)?r:this.publish(ib(r))?$t(r,1):r}slide(){this.isFull()&&(this.subscribers=0,this.value=Rr),this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.subscriberCount+=1,new WD(this,this.publisherIndex,!1)}},WD=class{self;subscriberIndex;unsubscribed;constructor(t,r,n){this.self=t,this.subscriberIndex=r,this.unsubscribed=n}isEmpty(){return this.unsubscribed||this.self.subscribers===0||this.subscriberIndex===this.self.publisherIndex}size(){return this.isEmpty()?0:1}poll(t){if(this.isEmpty())return t;let r=this.self.value;return this.self.subscribers-=1,this.self.subscribers===0&&(this.self.value=Rr),this.subscriberIndex+=1,r}pollUpTo(t){if(this.isEmpty()||t<1)return ee();let r=this.self.value;return this.self.subscribers-=1,this.self.subscribers===0&&(this.self.value=Rr),this.subscriberIndex+=1,V(r)}unsubscribe(){this.unsubscribed||(this.unsubscribed=!0,this.self.subscriberCount-=1,this.subscriberIndex!==this.self.publisherIndex&&(this.self.subscribers-=1,this.self.subscribers===0&&(this.self.value=Rr)))}},HD=class{replayBuffer;publisherHead={value:Rr,subscribers:0,next:null};publisherTail=this.publisherHead;publisherIndex=0;subscribersIndex=0;capacity=Number.MAX_SAFE_INTEGER;constructor(t){this.replayBuffer=t}replayWindow(){return this.replayBuffer?new Ix(this.replayBuffer):zk}isEmpty(){return this.publisherHead===this.publisherTail}isFull(){return!1}size(){return this.publisherIndex-this.subscribersIndex}publish(t){let r=this.publisherTail.subscribers;return r!==0&&(this.publisherTail.next={value:t,subscribers:r,next:null},this.publisherTail=this.publisherTail.next,this.publisherIndex+=1),this.replayBuffer&&this.replayBuffer.offer(t),!0}publishAll(t){if(this.publisherTail.subscribers!==0)for(let r of t)this.publish(r);else this.replayBuffer&&this.replayBuffer.offerAll(t);return ee()}slide(){this.publisherHead!==this.publisherTail&&(this.publisherHead=this.publisherHead.next,this.publisherHead.value=Rr,this.subscribersIndex+=1),this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.publisherTail.subscribers+=1,new BD(this,this.publisherTail,this.publisherIndex,!1)}},BD=class{self;subscriberHead;subscriberIndex;unsubscribed;constructor(t,r,n,o){this.self=t,this.subscriberHead=r,this.subscriberIndex=n,this.unsubscribed=o}isEmpty(){if(this.unsubscribed)return!0;let t=!0,r=!0;for(;r;)this.subscriberHead===this.self.publisherTail?r=!1:this.subscriberHead.next.value!==Rr?(t=!1,r=!1):(this.subscriberHead=this.subscriberHead.next,this.subscriberIndex+=1);return t}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(t){if(this.unsubscribed)return t;let r=!0,n=t;for(;r;)if(this.subscriberHead===this.self.publisherTail)r=!1;else{let o=this.subscriberHead.next.value;o!==Rr&&(n=o,this.subscriberHead.subscribers-=1,this.subscriberHead.subscribers===0&&(this.self.publisherHead=this.self.publisherHead.next,this.self.publisherHead.value=Rr,this.self.subscribersIndex+=1),r=!1),this.subscriberHead=this.subscriberHead.next,this.subscriberIndex+=1}return n}pollUpTo(t){let r=[],n=Rr,o=0;for(;o!==t;){let s=this.poll(n);s===n?o=t:(r.push(s),o+=1)}return pt(r)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.publisherTail.subscribers-=1;this.subscriberHead!==this.self.publisherTail;)this.subscriberHead.next.value!==Rr&&(this.subscriberHead.subscribers-=1,this.subscriberHead.subscribers===0&&(this.self.publisherHead=this.self.publisherHead.next,this.self.publisherHead.value=Rr,this.self.subscribersIndex+=1)),this.subscriberHead=this.subscriberHead.next}},zD=class extends cn{pubsub;subscribers;subscription;pollers;shutdownHook;shutdownFlag;strategy;replayWindow;[kx]=Lk;constructor(t,r,n,o,s,i,a,c){super(),this.pubsub=t,this.subscribers=r,this.subscription=n,this.pollers=o,this.shutdownHook=s,this.shutdownFlag=i,this.strategy=a,this.replayWindow=c}commit(){return this.take}pipe(){return v(this,arguments)}capacity(){return this.pubsub.capacity}isActive(){return!Ie(this.shutdownFlag)}get size(){return q(()=>Ie(this.shutdownFlag)?Xt:S(this.subscription.size()+this.replayWindow.remaining))}unsafeSize(){return Ie(this.shutdownFlag)?g():x(this.subscription.size()+this.replayWindow.remaining)}get isFull(){return q(()=>Ie(this.shutdownFlag)?Xt:S(this.subscription.size()===this.capacity()))}get isEmpty(){return _(this.size,t=>t===0)}get shutdown(){return Go(de(t=>(Fn(this.shutdownFlag,!0),p(Qm(Tx(this.pollers),r=>Qf(r,t.id()),!1),we(E(()=>{this.subscribers.delete(this.subscription),this.subscription.unsubscribe(),this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers)})),Ki(Hc(this.shutdownHook,void 0)),Ct))))}get isShutdown(){return E(()=>Ie(this.shutdownFlag))}get awaitShutdown(){return Ut(this.shutdownHook)}get take(){return de(t=>{if(Ie(this.shutdownFlag))return Xt;if(this.replayWindow.remaining>0){let n=this.replayWindow.take();return S(n)}let r=$c(this.pollers)?this.subscription.poll(Mt):Mt;if(r===Mt){let n=Zi(t.id());return p(q(()=>(p(this.pollers,ii(n)),p(this.subscribers,MX(this.subscription,this.pollers)),this.strategy.unsafeCompletePollers(this.pubsub,this.subscribers,this.subscription,this.pollers),Ie(this.shutdownFlag)?Xt:Ut(n))),so(()=>E(()=>xke(this.pollers,n))))}else return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),S(r)})}get takeAll(){return q(()=>{if(Ie(this.shutdownFlag))return Xt;let t=$c(this.pollers)?dke(this.subscription):ee();return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),this.replayWindow.remaining>0?S(We(this.replayWindow.takeAll(),t)):S(t)})}takeUpTo(t){return q(()=>{if(Ie(this.shutdownFlag))return Xt;let r;if(this.replayWindow.remaining>=t){let o=this.replayWindow.takeN(t);return S(o)}else this.replayWindow.remaining>0&&(r=this.replayWindow.takeAll(),t=t-r.length);let n=$c(this.pollers)?hke(this.subscription,t):ee();return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),r?S(We(r,n)):S(n)})}takeBetween(t,r){return q(()=>qX(this,t,r,ee()))}},qX=(e,t,r,n)=>r<t?S(n):p(e.takeUpTo(r),b(o=>{let s=t-o.length;return s===1?p(e.take,_(i=>p(n,We(o),Pn(i)))):s>1?p(e.take,b(i=>qX(e,s-1,r-o.length-1,p(n,We(o),Pn(i))))):S(p(n,We(o)))})),jD=class{pubsub;subscribers;scope;shutdownHook;shutdownFlag;strategy;[Nk]=vD;[kx]=Lk;constructor(t,r,n,o,s,i){this.pubsub=t,this.subscribers=r,this.scope=n,this.shutdownHook=o,this.shutdownFlag=s,this.strategy=i}capacity(){return this.pubsub.capacity}get size(){return q(()=>Ie(this.shutdownFlag)?Xt:E(()=>this.pubsub.size()))}unsafeSize(){return Ie(this.shutdownFlag)?g():x(this.pubsub.size())}get isFull(){return _(this.size,t=>t===this.capacity())}get isEmpty(){return _(this.size,t=>t===0)}get awaitShutdown(){return Ut(this.shutdownHook)}get isShutdown(){return E(()=>Ie(this.shutdownFlag))}get shutdown(){return Go(de(t=>(p(this.shutdownFlag,Fn(!0)),p(this.scope.close($f(t.id())),we(this.strategy.shutdown),Ki(Hc(this.shutdownHook,void 0)),Ct))))}publish(t){return q(()=>Ie(this.shutdownFlag)?Xt:this.pubsub.publish(t)?(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),S(!0)):this.strategy.handleSurplus(this.pubsub,this.subscribers,V(t),this.shutdownFlag))}isActive(){return!Ie(this.shutdownFlag)}unsafeOffer(t){return Ie(this.shutdownFlag)?!1:this.pubsub.publish(t)?(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),!0):!1}publishAll(t){return q(()=>{if(Ie(this.shutdownFlag))return Xt;let r=mke(this.pubsub,t);return this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),le(r)?S(!0):this.strategy.handleSurplus(this.pubsub,this.subscribers,r,this.shutdownFlag)})}get subscribe(){let t=Nr(Ja([this.scope.fork(Xo),uke(this.pubsub,this.subscribers,this.strategy)]),r=>r[0].addFinalizer(()=>r[1].shutdown));return _(tl(t,(r,n)=>r[0].close(n)),r=>r[1])}offer(t){return this.publish(t)}offerAll(t){return this.publishAll(t)}pipe(){return v(this,arguments)}},Bk=(e,t)=>b(ia(),r=>_(sn(),n=>lke(e,new Map,r,n,ko(!1),t))),lke=(e,t,r,n,o,s)=>new jD(e,t,r,n,o,s),fke=e=>{if(e<=0)throw new C$(`Cannot construct PubSub with capacity of ${e}`)},WX=(e,t)=>{za(e,S(t))},qk=(e,t)=>p(e,Zb(t)),Tx=e=>p(e,ym(Number.POSITIVE_INFINITY)),dke=e=>e.pollUpTo(Number.POSITIVE_INFINITY),hke=(e,t)=>e.pollUpTo(t),mke=(e,t)=>e.publishAll(t),xke=(e,t)=>{qk(e,p(Tx(e),Bi(r=>r!==t)))},$D=class{publishers=jc();get shutdown(){return b(ri,t=>b(E(()=>Tx(this.publishers)),r=>es(r,([n,o,s])=>s?p(Qf(o,t),Ct):ae,!1,!1)))}handleSurplus(t,r,n,o){return de(s=>{let i=Zi(s.id());return p(q(()=>(this.unsafeOffer(n,i),this.unsafeOnPubSubEmptySpace(t,r),this.unsafeCompleteSubscribers(t,r),Ie(o)?Xt:Ut(i))),so(()=>E(()=>this.unsafeRemove(i))))})}unsafeOnPubSubEmptySpace(t,r){let n=!0;for(;n&&!t.isFull();){let o=p(this.publishers,Jo(Mt));if(o===Mt)n=!1;else{let s=t.publish(o[0]);s&&o[2]?WX(o[1],!0):s||qk(this.publishers,p(Tx(this.publishers),Et(o))),this.unsafeCompleteSubscribers(t,r)}}}unsafeCompletePollers(t,r,n,o){return KD(this,t,r,n,o)}unsafeCompleteSubscribers(t,r){return QD(this,t,r)}unsafeOffer(t,r){let n=t[Symbol.iterator](),o=n.next();if(!o.done)for(;;){let s=o.value;if(o=n.next(),o.done){p(this.publishers,ii([s,r,!0]));break}p(this.publishers,ii([s,r,!1]))}}unsafeRemove(t){qk(this.publishers,p(Tx(this.publishers),Bi(([r,n])=>n!==t)))}},Wk=class{get shutdown(){return ae}handleSurplus(t,r,n,o){return S(!1)}unsafeOnPubSubEmptySpace(t,r){}unsafeCompletePollers(t,r,n,o){return KD(this,t,r,n,o)}unsafeCompleteSubscribers(t,r){return QD(this,t,r)}},VD=class{get shutdown(){return ae}handleSurplus(t,r,n,o){return E(()=>(this.unsafeSlidingPublish(t,n),this.unsafeCompleteSubscribers(t,r),!0))}unsafeOnPubSubEmptySpace(t,r){}unsafeCompletePollers(t,r,n,o){return KD(this,t,r,n,o)}unsafeCompleteSubscribers(t,r){return QD(this,t,r)}unsafeSlidingPublish(t,r){let n=r[Symbol.iterator](),o=n.next();if(!o.done&&t.capacity>0){let s=o.value,i=!0;for(;i;){t.slide();let a=t.publish(s);a&&(o=n.next())&&!o.done?s=o.value:a&&(i=!1)}}}},KD=(e,t,r,n,o)=>{let s=!0;for(;s&&!n.isEmpty();){let i=p(o,Jo(Mt));if(i===Mt)p(r,ake(n,o)),$c(o)?s=!1:p(r,MX(n,o));else{let a=n.poll(Mt);a===Mt?qk(o,p(Tx(o),Et(i))):(WX(i,a),e.unsafeOnPubSubEmptySpace(t,r))}}},QD=(e,t,r)=>{for(let[n,o]of r)for(let s of o)e.unsafeCompletePollers(t,r,n,s)},Hk=class{capacity;constructor(t){this.capacity=t}head={value:Rr,next:null};tail=this.head;size=0;index=0;slide(){this.index++}offer(t){this.tail.value=t,this.tail.next={value:Rr,next:null},this.tail=this.tail.next,this.size===this.capacity?this.head=this.head.next:this.size+=1}offerAll(t){for(let r of t)this.offer(r)}},Ix=class{buffer;head;index;remaining;constructor(t){this.buffer=t,this.index=t.index,this.remaining=t.size,this.head=t.head}fastForward(){for(;this.index<this.buffer.index;)this.head=this.head.next,this.index++}take(){if(this.remaining===0)return;this.index<this.buffer.index&&this.fastForward(),this.remaining--;let t=this.head.value;return this.head=this.head.next,t}takeN(t){if(this.remaining===0)return ee();this.index<this.buffer.index&&this.fastForward();let r=Math.min(t,this.remaining),n=new Array(r);for(let o=0;o<r;o++){let s=this.head.value;this.head=this.head.next,n[o]=s}return this.remaining-=r,Le(n)}takeAll(){return this.takeN(this.remaining)}},zk={remaining:0,take:()=>{},takeN:()=>ee(),takeAll:()=>ee()};var mS=vX,HX=PX,BX=FX,jk=NX;var Rx=DX;var JD=LX;var rc=UX;var zX=kx;var os=lX,Ax=fX,Mx=dX,hl=hX,jX=mX,Vk=xX,$X=bX,VX=gX,xS=yX,GX=SX,Pt=EX,Ve=CX;var ZD=wX,KX=OX,$n=Pk,QX=_X,JX=PD,Gk=kX,ZX=TX;var Kk="Continue",YD="Close",XD="Yield";var bke="effect/ChannelChildExecutorDecision",XX=Symbol.for(bke),yke={[XX]:XX},eL=e=>{let t=Object.create(yke);return t._tag=Kk,t};var vx="ContinuationK",eee="ContinuationFinalizer";var ree=Symbol.for("effect/ChannelContinuation"),nee={_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutDone:e=>e,_OutErr2:e=>e,_OutElem:e=>e,_OutDone2:e=>e},Ad=class{onSuccess;onHalt;_tag=vx;[ree]=nee;constructor(t,r){this.onSuccess=t,this.onHalt=r}onExit(t){return Bc(t)?this.onHalt(t.cause):this.onSuccess(t.value)}},Qk=class{finalizer;_tag=eee;[ree]=nee;constructor(t){this.finalizer=t}};var Jk="PullAfterNext",tL="PullAfterAllEnqueued";var Cke="effect/ChannelUpstreamPullStrategy",wke=Symbol.for(Cke),Oke={_A:e=>e},_ke={[wke]:Oke},rL=e=>{let t=Object.create(_ke);return t._tag=Jk,t.emitSeparator=e,t};var Zk="BracketOut",Yk="Bridge",bS="ConcatAll",Xk="Emit",eT="Ensuring",tT="Fail",Px="Fold",rT="FromEffect",nT="PipeTo",oT="Provide",sT="Read",iT="Succeed",aT="SucceedNow",cT="Suspend";var Tke="effect/Channel",yS=Symbol.for(Tke),Ike={_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutElem:e=>e,_OutDone:e=>e},Vn={[yS]:Ike,pipe(){return v(this,arguments)}},uT=e=>F(e,yS)||di(e),iee=u(2,(e,t)=>{let r=Object.create(Vn);return r._tag=Zk,r.acquire=()=>e,r.finalizer=t,r}),SS=u(2,(e,t)=>{let r=Object.create(Vn);return r._tag=Px,r.channel=e,r.k=new Ad(dr,t),r}),fu=e=>nr(()=>{let t=[];return k(pe(e,aee(t)),r=>du(()=>[pt(t),r]))}),aee=e=>lt({onInput:t=>k(du(()=>{e.push(t)}),()=>aee(e)),onFailure:Ne,onDone:rr});var nL=(e,t,r)=>{let n=Object.create(Vn);return n._tag=bS,n.combineInners=t,n.combineAll=r,n.onPull=()=>rL(g()),n.onEmit=()=>eL,n.value=()=>e,n.k=R,n},cee=u(4,(e,t,r,n)=>{let o=Object.create(Vn);return o._tag=bS,o.combineInners=r,o.combineAll=n,o.onPull=()=>rL(g()),o.onEmit=()=>eL,o.value=()=>e,o.k=t,o});var pT=u(2,(e,t)=>{let r=Object.create(Vn);return r._tag=Yk,r.input=t,r.channel=e,r}),Md=u(2,(e,t)=>{let r=Object.create(Vn);return r._tag=eT,r.channel=e,r.finalizer=t,r}),Ne=e=>oe(Ya(e));var oe=e=>lT(()=>e),lT=e=>{let t=Object.create(Vn);return t._tag=tT,t.error=e,t},k=u(2,(e,t)=>{let r=Object.create(Vn);return r._tag=Px,r.channel=e,r.k=new Ad(t,oe),r}),Fx=u(2,(e,t)=>{let r=Object.create(Vn);return r._tag=Px,r.channel=e,r.k=new Ad(t.onSuccess,t.onFailure),r}),J=e=>{let t=Object.create(Vn);return t._tag=rT,t.effect=()=>e,t},pe=u(2,(e,t)=>{let r=Object.create(Vn);return r._tag=nT,r.left=()=>e,r.right=()=>t,r}),vd=u(2,(e,t)=>{let r=Object.create(Vn);return r._tag=oT,r.context=()=>t,r.inner=e,r});var lt=e=>Ae({onInput:e.onInput,onFailure:t=>Xe(Xa(t),{onLeft:e.onFailure,onRight:oe}),onDone:e.onDone}),Ae=e=>{let t=Object.create(Vn);return t._tag=sT,t.more=e.onInput,t.done=new Ad(e.onDone,e.onFailure),t},dr=e=>du(()=>e),rr=e=>{let t=Object.create(Vn);return t._tag=aT,t.terminal=e,t},nr=e=>{let t=Object.create(Vn);return t._tag=cT,t.channel=e,t},du=e=>{let t=Object.create(Vn);return t._tag=iT,t.evaluate=e,t},re=rr(void 0);var A=e=>{let t=Object.create(Vn);return t._tag=Xk,t.out=e,t};var ml="Done",xl="Emit",hu="FromEffect",gl="Read";var Rke=Symbol.for("effect/ChannelState"),Ake={_E:e=>e,_R:e=>e},fT={[Rke]:Ake},Pd=()=>{let e=Object.create(fT);return e._tag=ml,e},dT=()=>{let e=Object.create(fT);return e._tag=xl,e},Nx=e=>{let t=Object.create(fT);return t._tag=hu,t.effect=e,t},hT=(e,t,r,n)=>{let o=Object.create(fT);return o._tag=gl,o.upstream=e,o.onEffect=t,o.onEmit=r,o.onDone=n,o};var CS=e=>e._tag===hu;var uee=e=>CS(e)?e.effect:be,sL=e=>CS(e)?aD(e.effect):void 0;var iL="PullFromChild",mT="PullFromUpstream",xT="DrainChildExecutors",aL="Emit",Fd=class{childExecutor;parentSubexecutor;onEmit;_tag=iL;constructor(t,r,n){this.childExecutor=t,this.parentSubexecutor=r,this.onEmit=n}close(t){let r=this.childExecutor.close(t),n=this.parentSubexecutor.close(t);return r!==void 0&&n!==void 0?fa(Ir(r),Ir(n),(o,s)=>p(o,zp(s))):r!==void 0?r:n!==void 0?n:void 0}enqueuePullFromChild(t){return this}},bl=class e{upstreamExecutor;createChild;lastDone;activeChildExecutors;combineChildResults;combineWithChildResult;onPull;onEmit;_tag=mT;constructor(t,r,n,o,s,i,a,c){this.upstreamExecutor=t,this.createChild=r,this.lastDone=n,this.activeChildExecutors=o,this.combineChildResults=s,this.combineWithChildResult=i,this.onPull=a,this.onEmit=c}close(t){let r=this.upstreamExecutor.close(t),o=[...this.activeChildExecutors.map(s=>s!==void 0?s.childExecutor.close(t):void 0),r].reduce((s,i)=>s!==void 0&&i!==void 0?fa(s,Ir(i),(a,c)=>zp(a,c)):s!==void 0?s:i!==void 0?Ir(i):void 0,void 0);return o}enqueuePullFromChild(t){return new e(this.upstreamExecutor,this.createChild,this.lastDone,[...this.activeChildExecutors,t],this.combineChildResults,this.combineWithChildResult,this.onPull,this.onEmit)}},Nd=class e{upstreamExecutor;lastDone;activeChildExecutors;upstreamDone;combineChildResults;combineWithChildResult;onPull;_tag=xT;constructor(t,r,n,o,s,i,a){this.upstreamExecutor=t,this.lastDone=r,this.activeChildExecutors=n,this.upstreamDone=o,this.combineChildResults=s,this.combineWithChildResult=i,this.onPull=a}close(t){let r=this.upstreamExecutor.close(t),o=[...this.activeChildExecutors.map(s=>s!==void 0?s.childExecutor.close(t):void 0),r].reduce((s,i)=>s!==void 0&&i!==void 0?fa(s,Ir(i),(a,c)=>zp(a,c)):s!==void 0?s:i!==void 0?Ir(i):void 0,void 0);return o}enqueuePullFromChild(t){return new e(this.upstreamExecutor,this.lastDone,[...this.activeChildExecutors,t],this.upstreamDone,this.combineChildResults,this.combineWithChildResult,this.onPull)}},Dx=class{value;next;_tag=aL;constructor(t,r){this.value=t,this.next=r}close(t){let r=this.next.close(t);return r}enqueuePullFromChild(t){return this}};var pee="Pulled",lee="NoUpstream";var Fke="effect/ChannelUpstreamPullRequest",Nke=Symbol.for(Fke),Dke={_A:e=>e},fee={[Nke]:Dke},cL=e=>{let t=Object.create(fee);return t._tag=pee,t.value=e,t},dee=e=>{let t=Object.create(fee);return t._tag=lee,t.activeDownstreamCount=e,t};var wS=class e{_activeSubexecutor=void 0;_cancelled=void 0;_closeLastSubstream=void 0;_currentChannel;_done=void 0;_doneStack=[];_emitted=void 0;_executeCloseLastSubstream;_input=void 0;_inProgressFinalizer=void 0;_providedEnv;constructor(t,r,n){this._currentChannel=t,this._executeCloseLastSubstream=n,this._providedEnv=r}run(){let t;for(;t===void 0;)if(this._cancelled!==void 0)t=this.processCancellation();else if(this._activeSubexecutor!==void 0)t=this.runSubexecutor();else try{if(this._currentChannel===void 0)t=Pd();else switch(di(this._currentChannel)&&(this._currentChannel=J(this._currentChannel)),this._currentChannel._tag){case Zk:{t=this.runBracketOut(this._currentChannel);break}case Yk:{let r=this._currentChannel.input;if(this._currentChannel=this._currentChannel.channel,this._input!==void 0){let n=this._input;this._input=void 0;let o=()=>P(r.awaitRead(),()=>Je(()=>{let s=n.run();switch(s._tag){case ml:return qt(n.getDone(),{onFailure:i=>r.error(i),onSuccess:i=>r.done(i)});case xl:return P(r.emit(n.getEmit()),()=>o());case hu:return zn(s.effect,{onFailure:i=>r.error(i),onSuccess:()=>o()});case gl:return bT(s,()=>o(),i=>r.error(i))}}));t=Nx(P(ul(co(o())),s=>Ze(()=>this.addFinalizer(i=>P(_n(s),()=>Je(()=>{let a=this.restorePipe(i,n);return a!==void 0?a:be}))))))}break}case bS:{let r=new e(this._currentChannel.value(),this._providedEnv,o=>Ze(()=>{let s=this._closeLastSubstream===void 0?be:this._closeLastSubstream;this._closeLastSubstream=p(s,ue(o))}));r._input=this._input;let n=this._currentChannel;this._activeSubexecutor=new bl(r,o=>n.k(o),void 0,[],(o,s)=>n.combineInners(o,s),(o,s)=>n.combineAll(o,s),o=>n.onPull(o),o=>n.onEmit(o)),this._closeLastSubstream=void 0,this._currentChannel=void 0;break}case Xk:{this._emitted=this._currentChannel.out,this._currentChannel=this._activeSubexecutor!==void 0?void 0:re,t=dT();break}case eT:{this.runEnsuring(this._currentChannel);break}case tT:{t=this.doneHalt(this._currentChannel.error());break}case Px:{this._doneStack.push(this._currentChannel.k),this._currentChannel=this._currentChannel.channel;break}case rT:{let r=this._providedEnv===void 0?this._currentChannel.effect():p(this._currentChannel.effect(),Ex(this._providedEnv));t=Nx(zn(r,{onFailure:n=>{let o=this.doneHalt(n);return o!==void 0&&CS(o)?o.effect:be},onSuccess:n=>{let o=this.doneSucceed(n);return o!==void 0&&CS(o)?o.effect:be}}));break}case nT:{let r=this._input,n=new e(this._currentChannel.left(),this._providedEnv,o=>this._executeCloseLastSubstream(o));n._input=r,this._input=n,this.addFinalizer(o=>{let s=this.restorePipe(o,r);return s!==void 0?s:be}),this._currentChannel=this._currentChannel.right();break}case oT:{let r=this._providedEnv;this._providedEnv=this._currentChannel.context(),this._currentChannel=this._currentChannel.inner,this.addFinalizer(()=>Ze(()=>{this._providedEnv=r}));break}case sT:{let r=this._currentChannel;t=hT(this._input,R,n=>{try{this._currentChannel=r.more(n)}catch(o){this._currentChannel=r.done.onExit(zc(o))}},n=>{let o=s=>r.done.onExit(s);this._currentChannel=o(n)});break}case iT:{t=this.doneSucceed(this._currentChannel.evaluate());break}case aT:{t=this.doneSucceed(this._currentChannel.terminal);break}case cT:{this._currentChannel=this._currentChannel.channel();break}}}catch(r){this._currentChannel=oe(Bn(r))}return t}getDone(){return this._done}getEmit(){return this._emitted}cancelWith(t){this._cancelled=t}clearInProgressFinalizer(){this._inProgressFinalizer=void 0}storeInProgressFinalizer(t){this._inProgressFinalizer=t}popAllFinalizers(t){let r=[],n=this._doneStack.pop();for(;n;)n._tag==="ContinuationFinalizer"&&r.push(n.finalizer),n=this._doneStack.pop();let o=r.length===0?be:pL(r,t);return this.storeInProgressFinalizer(o),o}popNextFinalizers(){let t=[];for(;this._doneStack.length!==0;){let r=this._doneStack[this._doneStack.length-1];if(r._tag===vx)return t;t.push(r),this._doneStack.pop()}return t}restorePipe(t,r){let n=this._input;return this._input=r,n!==void 0?n.close(t):be}close(t){let r,n=this._inProgressFinalizer;n!==void 0&&(r=p(n,pa(Ze(()=>this.clearInProgressFinalizer()))));let o,s=this.popAllFinalizers(t);s!==void 0&&(o=p(s,pa(Ze(()=>this.clearInProgressFinalizer()))));let i=this._activeSubexecutor===void 0?void 0:this._activeSubexecutor.close(t);if(!(i===void 0&&r===void 0&&o===void 0))return p(Ir(uL(i)),lo(Ir(uL(r))),lo(Ir(uL(o))),w(([[a,c],l])=>p(a,zp(c),zp(l))),au,P(a=>Je(()=>a)))}doneSucceed(t){if(this._doneStack.length===0)return this._done=xe(t),this._currentChannel=void 0,Pd();let r=this._doneStack[this._doneStack.length-1];if(r._tag===vx){this._doneStack.pop(),this._currentChannel=r.onSuccess(t);return}let n=this.popNextFinalizers();if(this._doneStack.length===0)return this._doneStack=n.reverse(),this._done=xe(t),this._currentChannel=void 0,Pd();let o=pL(n.map(i=>i.finalizer),xe(t));this.storeInProgressFinalizer(o);let s=p(o,pa(Ze(()=>this.clearInProgressFinalizer())),au,P(()=>Ze(()=>this.doneSucceed(t))));return Nx(s)}doneHalt(t){if(this._doneStack.length===0)return this._done=st(t),this._currentChannel=void 0,Pd();let r=this._doneStack[this._doneStack.length-1];if(r._tag===vx){this._doneStack.pop();try{this._currentChannel=r.onHalt(t)}catch(i){this._currentChannel=oe(Bn(i))}return}let n=this.popNextFinalizers();if(this._doneStack.length===0)return this._doneStack=n.reverse(),this._done=st(t),this._currentChannel=void 0,Pd();let o=pL(n.map(i=>i.finalizer),st(t));this.storeInProgressFinalizer(o);let s=p(o,pa(Ze(()=>this.clearInProgressFinalizer())),au,P(()=>Ze(()=>this.doneHalt(t))));return Nx(s)}processCancellation(){return this._currentChannel=void 0,this._done=this._cancelled,this._cancelled=void 0,Pd()}runBracketOut(t){let r=au(zn(this.provide(t.acquire()),{onFailure:n=>Ze(()=>{this._currentChannel=oe(n)}),onSuccess:n=>Ze(()=>{this.addFinalizer(o=>this.provide(t.finalizer(n,o))),this._currentChannel=A(n)})}));return Nx(r)}provide(t){return this._providedEnv===void 0?t:p(t,Ex(this._providedEnv))}runEnsuring(t){this.addFinalizer(t.finalizer),this._currentChannel=t.channel}addFinalizer(t){this._doneStack.push(new Qk(t))}runSubexecutor(){let t=this._activeSubexecutor;switch(t._tag){case iL:return this.pullFromChild(t.childExecutor,t.parentSubexecutor,t.onEmit,t);case mT:return this.pullFromUpstream(t);case xT:return this.drainChildExecutors(t);case aL:return this._emitted=t.value,this._activeSubexecutor=t.next,dT()}}replaceSubexecutor(t){this._currentChannel=void 0,this._activeSubexecutor=t}finishWithExit(t){let r=qt(t,{onFailure:n=>this.doneHalt(n),onSuccess:n=>this.doneSucceed(n)});return this._activeSubexecutor=void 0,r===void 0?be:uee(r)}finishSubexecutorWithCloseEffect(t,...r){this.addFinalizer(()=>p(r,Br(o=>p(Ze(()=>o(t)),P(s=>s!==void 0?s:be)),{discard:!0})));let n=p(t,qt({onFailure:o=>this.doneHalt(o),onSuccess:o=>this.doneSucceed(o)}));return this._activeSubexecutor=void 0,n}applyUpstreamPullStrategy(t,r,n){switch(n._tag){case Jk:{let o=!t||r.some(s=>s!==void 0);return[n.emitSeparator,o?[void 0,...r]:r]}case tL:{let o=!t||r.some(s=>s!==void 0);return[n.emitSeparator,o?[...r,void 0]:r]}}}pullFromChild(t,r,n,o){return hT(t,R,s=>{let i=n(s);switch(i._tag){case Kk:break;case YD:{this.finishWithDoneValue(t,r,i.value);break}case XD:{let a=r.enqueuePullFromChild(o);this.replaceSubexecutor(a);break}}this._activeSubexecutor=new Dx(s,this._activeSubexecutor)},qt({onFailure:s=>{let i=this.handleSubexecutorFailure(t,r,s);return i===void 0?void 0:sL(i)},onSuccess:s=>{this.finishWithDoneValue(t,r,s)}}))}finishWithDoneValue(t,r,n){let o=r;switch(o._tag){case mT:{let s=new bl(o.upstreamExecutor,o.createChild,o.lastDone!==void 0?o.combineChildResults(o.lastDone,n):n,o.activeChildExecutors,o.combineChildResults,o.combineWithChildResult,o.onPull,o.onEmit);this._closeLastSubstream=t.close(xe(n)),this.replaceSubexecutor(s);break}case xT:{let s=new Nd(o.upstreamExecutor,o.lastDone!==void 0?o.combineChildResults(o.lastDone,n):n,o.activeChildExecutors,o.upstreamDone,o.combineChildResults,o.combineWithChildResult,o.onPull);this._closeLastSubstream=t.close(xe(n)),this.replaceSubexecutor(s);break}default:break}}handleSubexecutorFailure(t,r,n){return this.finishSubexecutorWithCloseEffect(st(n),o=>r.close(o),o=>t.close(o))}pullFromUpstream(t){if(t.activeChildExecutors.length===0)return this.performPullFromUpstream(t);let r=t.activeChildExecutors[0],n=new bl(t.upstreamExecutor,t.createChild,t.lastDone,t.activeChildExecutors.slice(1),t.combineChildResults,t.combineWithChildResult,t.onPull,t.onEmit);if(r===void 0)return this.performPullFromUpstream(n);this.replaceSubexecutor(new Fd(r.childExecutor,n,r.onEmit))}performPullFromUpstream(t){return hT(t.upstreamExecutor,r=>{let n=this._closeLastSubstream===void 0?be:this._closeLastSubstream;return this._closeLastSubstream=void 0,p(this._executeCloseLastSubstream(n),ue(r))},r=>{if(this._closeLastSubstream!==void 0){let i=this._closeLastSubstream;return this._closeLastSubstream=void 0,p(this._executeCloseLastSubstream(i),w(()=>{let a=new e(t.createChild(r),this._providedEnv,this._executeCloseLastSubstream);a._input=this._input;let[c,l]=this.applyUpstreamPullStrategy(!1,t.activeChildExecutors,t.onPull(cL(r)));this._activeSubexecutor=new Fd(a,new bl(t.upstreamExecutor,t.createChild,t.lastDone,l,t.combineChildResults,t.combineWithChildResult,t.onPull,t.onEmit),t.onEmit),X(c)&&(this._activeSubexecutor=new Dx(c.value,this._activeSubexecutor))}))}let n=new e(t.createChild(r),this._providedEnv,this._executeCloseLastSubstream);n._input=this._input;let[o,s]=this.applyUpstreamPullStrategy(!1,t.activeChildExecutors,t.onPull(cL(r)));this._activeSubexecutor=new Fd(n,new bl(t.upstreamExecutor,t.createChild,t.lastDone,s,t.combineChildResults,t.combineWithChildResult,t.onPull,t.onEmit),t.onEmit),X(o)&&(this._activeSubexecutor=new Dx(o.value,this._activeSubexecutor))},r=>{if(t.activeChildExecutors.some(s=>s!==void 0)){let s=new Nd(t.upstreamExecutor,t.lastDone,[void 0,...t.activeChildExecutors],t.upstreamExecutor.getDone(),t.combineChildResults,t.combineWithChildResult,t.onPull);if(this._closeLastSubstream!==void 0){let i=this._closeLastSubstream;return this._closeLastSubstream=void 0,p(this._executeCloseLastSubstream(i),w(()=>this.replaceSubexecutor(s)))}this.replaceSubexecutor(s);return}let n=this._closeLastSubstream,o=this.finishSubexecutorWithCloseEffect(p(r,bm(s=>t.combineWithChildResult(t.lastDone,s))),()=>n,s=>t.upstreamExecutor.close(s));return o===void 0?void 0:sL(o)})}drainChildExecutors(t){if(t.activeChildExecutors.length===0){let s=this._closeLastSubstream;return s!==void 0&&this.addFinalizer(()=>B(s)),this.finishSubexecutorWithCloseEffect(t.upstreamDone,()=>s,i=>t.upstreamExecutor.close(i))}let r=t.activeChildExecutors[0],n=t.activeChildExecutors.slice(1);if(r===void 0){let[s,i]=this.applyUpstreamPullStrategy(!0,n,t.onPull(dee(n.reduce((a,c)=>c!==void 0?a+1:a,0))));return this.replaceSubexecutor(new Nd(t.upstreamExecutor,t.lastDone,i,t.upstreamDone,t.combineChildResults,t.combineWithChildResult,t.onPull)),X(s)?(this._emitted=s.value,dT()):void 0}let o=new Nd(t.upstreamExecutor,t.lastDone,n,t.upstreamDone,t.combineChildResults,t.combineWithChildResult,t.onPull);this.replaceSubexecutor(new Fd(r.childExecutor,o,r.onEmit))}},uL=e=>e!==void 0?e:be,pL=(e,t)=>p(Br(e,r=>Ir(r(t))),w(r=>p(Dv(r),_e(()=>Bp))),P(r=>Je(()=>r))),bT=(e,t,r)=>{let n=[e],o=()=>{let s=n.pop();if(s===void 0||s.upstream===void 0)return il("Unexpected end of input for channel execution");let i=s.upstream.run();switch(i._tag){case xl:{let a=s.onEmit(s.upstream.getEmit());return n.length===0?a===void 0?Je(t):p(a,zn({onFailure:r,onSuccess:t})):a===void 0?Je(()=>o()):p(a,zn({onFailure:r,onSuccess:()=>o()}))}case ml:{let a=s.onDone(s.upstream.getDone());return n.length===0?a===void 0?Je(t):p(a,zn({onFailure:r,onSuccess:t})):a===void 0?Je(()=>o()):p(a,zn({onFailure:r,onSuccess:()=>o()}))}case hu:return n.push(s),p(s.onEffect(i.effect),hi(a=>Je(()=>{let c=s.onDone(st(a));return c===void 0?be:c})),zn({onFailure:r,onSuccess:()=>o()}));case gl:return n.push(s),n.push(i),Je(()=>o())}};return o()},ss=u(2,(e,t)=>{let r=(n,o,s)=>uD(Ze(()=>new wS(e,void 0,R)),i=>Je(()=>gT(i.run(),i).pipe(pS(n),ue(He(n)),dl(He(o)))),(i,a)=>{let c=i.close(a);return c===void 0?be:wx(c,l=>su(s,Wt(l)))});return cl(n=>Po([Ly(t,Am),wt(),wt()]).pipe(P(([o,s,i])=>n(r(s,i,o)).pipe(yt(t),P(a=>t.addFinalizer(c=>{let l=Bc(c)?vQ(c.cause):void 0;return Qb(s).pipe(P(f=>f?Cr(i,void 0).pipe(ue(H_(a)),ue(iN(a))):Cr(i,void 0).pipe(ue(l&&Ac(l)>0?B_(a,o5(l)):_n(a)),ue(iN(a)))))}).pipe(ue(n(He(s)))))))))}),gT=(e,t)=>{let r=e;switch(r._tag){case hu:return p(r.effect,P(()=>gT(t.run(),t)));case xl:return gT(t.run(),t);case ml:return Je(()=>t.getDone());case gl:return bT(r,()=>gT(t.run(),t),Wt)}};var yT="Done",hee="Await";var Uke="effect/ChannelMergeDecision",xee=Symbol.for(Uke),gee={[xee]:{_R:e=>e,_E0:e=>e,_Z0:e=>e,_E:e=>e,_Z:e=>e}},mu=e=>{let t=Object.create(gee);return t._tag=yT,t.effect=e,t},xu=e=>{let t=Object.create(gee);return t._tag=hee,t.f=e,t};var ST="BothRunning",ET="LeftDone",CT="RightDone";var qke="effect/ChannelMergeState",yee=Symbol.for(qke),dL={[yee]:yee},wT=(e,t)=>{let r=Object.create(dL);return r._tag=ST,r.left=e,r.right=t,r},hL=e=>{let t=Object.create(dL);return t._tag=ET,t.f=e,t},mL=e=>{let t=Object.create(dL);return t._tag=CT,t.f=e,t};var xL="BackPressure",gL="BufferSliding";var Bke="effect/ChannelMergeStrategy",See=Symbol.for(Bke),Eee={[See]:See},Cee=e=>{let t=Object.create(Eee);return t._tag=xL,t},wee=e=>{let t=Object.create(Eee);return t._tag=gL,t};var Oee=u(2,(e,{onBackPressure:t,onBufferSliding:r})=>{switch(e._tag){case xL:return t();case gL:return r()}});var Lx="Empty",OS="Emit",_S="Error",kS="Done",kee=e=>({_tag:Lx,notifyProducer:e}),bL=e=>({_tag:OS,notifyConsumers:e}),zke=e=>({_tag:_S,cause:e}),jke=e=>({_tag:kS,done:e}),yL=class{ref;constructor(t){this.ref=t}awaitRead(){return po(Yo(this.ref,t=>t._tag===Lx?[He(t.notifyProducer),t]:[be,t]))}get close(){return dD(t=>this.error(yd(t)))}done(t){return po(Yo(this.ref,r=>{switch(r._tag){case Lx:return[He(r.notifyProducer),r];case OS:return[Br(r.notifyConsumers,n=>Cr(n,$(t)),{discard:!0}),jke(t)];case _S:return[al,r];case kS:return[al,r]}}))}emit(t){return P(wt(),r=>po(Yo(this.ref,n=>{switch(n._tag){case Lx:return[He(n.notifyProducer),n];case OS:{let o=n.notifyConsumers[0],s=n.notifyConsumers.slice(1);if(o!==void 0)return[Cr(o,Z(t)),s.length===0?kee(r):bL(s)];throw new Error("Bug: Channel.SingleProducerAsyncInput.emit - Queue was empty! please report an issue at https://github.com/Effect-TS/effect/issues")}case _S:return[al,n];case kS:return[al,n]}})))}error(t){return po(Yo(this.ref,r=>{switch(r._tag){case Lx:return[He(r.notifyProducer),r];case OS:return[Br(r.notifyConsumers,n=>Zf(n,t),{discard:!0}),zke(t)];case _S:return[al,r];case kS:return[al,r]}}))}get take(){return this.takeWith(t=>st(Is(t,$)),t=>xe(t),t=>At(Z(t)))}takeWith(t,r,n){return P(wt(),o=>po(Yo(this.ref,s=>{switch(s._tag){case Lx:return[ue(Cr(s.notifyProducer,void 0),uu(He(o),{onFailure:t,onSuccess:Xe({onLeft:n,onRight:r})})),bL([o])];case OS:return[uu(He(o),{onFailure:t,onSuccess:Xe({onLeft:n,onRight:r})}),bL([...s.notifyConsumers,o])];case _S:return[B(t(s.cause)),s];case kS:return[B(n(s.done)),s]}})))}},OT=()=>p(wt(),P(e=>tr(kee(e))),w(e=>new yL(e)));var Tee=(e,t,r)=>k(J(tr(()=>be)),n=>p(J(au(pn(e,o=>Dr(n,s=>r(o,s))))),k(t),Md(o=>P(_t(n),s=>s(o))))),TS=u(2,(e,t)=>Ud(e,()=>t));var Ld=u(2,(e,t)=>SS(e,r=>Xe(Xa(r),{onLeft:t,onRight:oe}))),ha=u(2,(e,t)=>cee(e,t,()=>{},()=>{}));var ma=e=>{let t=Ae({onInput:()=>t,onFailure:oe,onDone:dr});return pe(e,t)};var IS=u(2,(e,t)=>Md(e,()=>t));var Vke=e=>k(e,R),Iee=u(2,(e,t)=>Fx(e,{onFailure:r=>{let n=Xa(r);switch(n._tag){case"Left":return t.onFailure(n.left);case"Right":return oe(n.right)}},onSuccess:t.onSuccess}));var _T=e=>Ce(e.takeWith(oe,t=>k(A(t),()=>_T(e)),dr));var CL=e=>nr(()=>Ree(e)),Ree=e=>p(J($n(e)),k(Xe({onLeft:qt({onFailure:oe,onSuccess:rr}),onRight:t=>k(A(t),()=>Ree(e))}))),As=()=>lt({onInput:e=>k(A(e),()=>As()),onFailure:Ne,onDone:rr}),wL=u(2,(e,t)=>Wd(e,{other:J(t),onSelfDone:r=>mu(Je(()=>r)),onOtherDone:r=>mu(Je(()=>r))})),Aee=u(2,(e,t)=>wL(e,He(t))),Ud=u(2,(e,t)=>k(e,r=>du(()=>t(r))));var OL=u(2,(e,t)=>_L(e,Is(t))),_L=u(2,(e,t)=>SS(e,r=>oe(t(r)))),qd=u(2,(e,t)=>{let r=lt({onInput:n=>k(A(t(n)),()=>r),onFailure:Ne,onDone:rr});return pe(e,r)}),kT=u(2,(e,t)=>{let r=Ae({onInput:n=>p(J(t(n)),k(A),k(()=>r)),onFailure:oe,onDone:rr});return pe(e,r)}),kL=u(3,(e,t,r)=>xa(n=>ao(function*(){let o=yield*OT(),s=_T(o),i=yield*os(r);yield*su(n,Pt(i));let a=yield*wt(),c=r===Number.POSITIVE_INFINITY?d=>R:(yield*fl(r)).withPermits;yield*(yield*s.pipe(pe(e),Dd(n))).pipe(zn({onFailure:d=>Ve(i,Wt(d)),onSuccess:Xe({onLeft:d=>ue(co(c(r)(be)),uo(Ve(i,B($(d))))),onRight:d=>ao(function*(){let h=yield*wt(),m=yield*wt();yield*Ve(i,w(He(h),Z)),yield*Cr(m,void 0).pipe(ue(cl(y=>Ir(y(He(a))).pipe(bD(Ir(y(t(d)))),P(R))).pipe(wx(y=>Zf(a,y)),pS(h))),c(1),yt(n)),yield*He(m)})})}),yD,co,yt(n));let f=Ce(uu(po($n(i)),{onFailure:oe,onSuccess:Xe({onLeft:rr,onRight:d=>k(A(d),()=>f)})}));return pT(f,o)}))),Gke=e=>t=>Kke(e)(t,Ar);var Kke=({bufferSize:e=16,concurrency:t,mergeStrategy:r=Cee()})=>(n,o)=>xa(s=>ao(function*(){let i=t==="unbounded"?Number.MAX_SAFE_INTEGER:t,a=yield*OT(),c=_T(a),l=yield*os(e);yield*su(s,Pt(l));let f=yield*hl();yield*su(s,Pt(f));let d=yield*tr(g()),h=yield*wt(),m=(yield*fl(i)).withPermits,y=yield*Dd(pe(c,n),s);function T(O){return O.pipe(P(Xe({onLeft:U=>B(x(U)),onRight:U=>Kt(Ve(l,B(Z(U))),g())})),Tk({until:U=>X(U)}),P(U=>Os(d,j({onNone:()=>x(U.value),onSome:I=>x(o(I,U.value))}))),hi(U=>aa(U)?Wt(U):Ve(l,Wt(U)).pipe(ue(Cr(h,void 0)),uo)))}yield*y.pipe(zn({onFailure:O=>Ve(l,Wt(O)).pipe(ue(B(!1))),onSuccess:Xe({onLeft:O=>ll(co(He(h)),co(m(i)(be)),{onSelfDone:(U,I)=>Kt(_n(I),!1),onOtherDone:(U,I)=>ue(_n(I),_t(d).pipe(P(j({onNone:()=>Ve(l,B($(O))),onSome:K=>Ve(l,B($(o(K,O))))})),Kt(!1)))}),onRight:O=>Oee(r,{onBackPressure:()=>ao(function*(){let U=yield*wt(),I=uS(Q=>Dd(pe(c,O),Q).pipe(P(z=>lS(Ir(T(z)),Ir(co(He(h))))),P(R)));return yield*Cr(U,void 0).pipe(ue(I),m(1),yt(s)),yield*He(U),!(yield*Qb(h))}),onBufferSliding:()=>ao(function*(){let U=yield*wt(),I=yield*wt(),K=yield*Vk(f);yield*$n(f).pipe(P(te=>Cr(te,void 0)),Cx(()=>K>=i)),yield*Ve(f,U);let Q=uS(te=>Dd(pe(c,O),te).pipe(P(ce=>Ir(T(ce)).pipe(lS(Ir(co(He(h)))),lS(Ir(co(He(U)))))),P(R)));return yield*Cr(I,void 0).pipe(ue(Q),m(1),yt(s)),yield*He(I),!(yield*Qb(h))})})})}),Tk({while:O=>O}),yt(s));let C=p($n(l),po,uu({onFailure:oe,onSuccess:Xe({onLeft:rr,onRight:O=>k(A(O),()=>C)})}),Ce);return pT(C,a)})),TL=u(3,(e,t,r)=>Gke(r)(qd(e,t)));var Wd=u(2,(e,t)=>{function r(n){return ao(function*(){let o=yield*OT(),s=_T(o),i=yield*Dd(pe(s,e),n),a=yield*Dd(pe(s,t.other),n);function c(f,d,h){return(m,y,T)=>{function C(O){let U=O;return U._tag===yT?B(J(ue(_n(d),U.effect))):w(H_(d),qt({onFailure:I=>J(U.f(st(I))),onSuccess:Xe({onLeft:I=>J(U.f(xe(I))),onRight:I=>Fe(A(I),l(T(U.f)))})}))}return qt(f,{onFailure:O=>C(m(st(O))),onSuccess:Xe({onLeft:O=>C(m(xe(O))),onRight:O=>B(k(A(O),()=>k(J(yt(co(h),n)),U=>l(y(U,d)))))})})}}function l(f){switch(f._tag){case ST:{let d=co(vo(f.left)),h=co(vo(f.right));return Ce(ll(d,h,{onSelfDone:(m,y)=>ue(_n(y),c(m,f.right,i)(t.onSelfDone,wT,T=>hL(T))),onOtherDone:(m,y)=>ue(_n(y),c(m,f.left,a)(t.onOtherDone,(T,C)=>wT(C,T),T=>mL(T)))}))}case ET:return Ce(w(Ir(a),qt({onFailure:d=>J(f.f(st(d))),onSuccess:Xe({onLeft:d=>J(f.f(xe(d))),onRight:d=>k(A(d),()=>l(hL(f.f)))})})));case CT:return Ce(w(Ir(i),qt({onFailure:d=>J(f.f(st(d))),onSuccess:Xe({onLeft:d=>J(f.f(xe(d))),onRight:d=>k(A(d),()=>l(mL(f.f)))})})))}}return J(Ok(f=>{let d=Ok(y=>(y.transferChildren(f.scope()),be)),h=co(i).pipe(pa(d),yt(n)),m=co(a).pipe(pa(d),yt(n));return fa(h,m,(y,T)=>wT(y,T))})).pipe(k(l),pT(o))})}return xa(r)});var Mee=u(2,(e,t)=>Ld(e,r=>lT(()=>Bn(t(r))))),IL=u(2,(e,t)=>Ld(e,t)),or=u(2,(e,t)=>nr(()=>{let r,n=lt({onInput:s=>k(A(s),()=>n),onFailure:s=>(r=Jke(s),oe(Bn(r))),onDone:rr}),o=Ae({onInput:s=>p(A(s),k(()=>o)),onFailure:s=>R_(s)&&Zke(s.defect)&&N(s.defect,r)?Ne(s.defect.error):oe(s),onDone:rr});return pe(pe(pe(e,n),t),o)}));var TT=e=>k(e,()=>TT(e)),RS=e=>uS(t=>ss(e,t));var vee=e=>RS(ma(e)),AS=e=>lD(t=>ss(e,t)),RL=e=>Ce(cl(t=>w(V2(),r=>iee(wx(t(ox(e,r)),n=>nx(r,st(n))),(n,o)=>nx(r,o))))),AL=e=>gu(w(kk,t=>k(J(e(t)),A)));var Pee=()=>nr(()=>{let e="",t=!1,r=o=>{let s=[];return bt(o,i=>{if(i.length!==0){let a=0,c=i.indexOf("\r"),l=i.indexOf(`
`);for(t&&(l===0?(s.push(e),e="",a=1,l=i.indexOf(`
`,a)):e=e+"\r",t=!1);c!==-1||l!==-1;)c===-1||l!==-1&&l<c?(e.length===0?s.push(i.substring(a,l)):(s.push(e+i.substring(a,l)),e=""),a=l+1,l=i.indexOf(`
`,a)):i.length===c+1?(t=!0,c=-1):l===c+1?(e.length===0?s.push(i.substring(a,c)):(e=e+i.substring(a,c),s.push(e),e=""),a=c+2,c=i.indexOf("\r",a),l=i.indexOf(`
`,a)):c=i.indexOf("\r",c+1);t?e=e+i.substring(a,i.length-1):e=e+i.substring(a,i.length)}}),Le(s)},n=Ae({onInput:o=>{let s=r(o);return le(s)?n:k(A(s),()=>n)},onFailure:o=>e.length===0?oe(o):k(A(V(e)),()=>oe(o)),onDone:o=>e.length===0?dr(o):k(A(V(e)),()=>dr(o))});return n}),Fee=e=>Qke(e),Nee=e=>P(kk,t=>Dd(e,t)),Dd=u(2,(e,t)=>lo(Ze(()=>new wS(e,void 0,R)),pu()).pipe(pn(([r,n])=>$2(t,o=>{let s=r.close(o);return s!==void 0?Ex(s,n):be})),au,w(([r])=>Je(()=>SL(r.run(),r))))),SL=(e,t)=>{let r=e;switch(r._tag){case ml:return qt(t.getDone(),{onFailure:Wt,onSuccess:n=>B($(n))});case xl:return B(Z(t.getEmit()));case hu:return p(r.effect,P(()=>SL(t.run(),t)));case gl:return bT(r,()=>SL(t.run(),t),n=>Wt(n))}},Qke=e=>nr(()=>Dee(e)),Dee=e=>Ae({onInput:t=>k(J(Ve(e,Z(t))),()=>Dee(e)),onFailure:t=>J(Ve(e,$(st(t)))),onDone:t=>J(Ve(e,$(xe(t))))}),Ce=e=>Vke(J(e)),gu=e=>nL(RL(e),(t,r)=>t,(t,r)=>t),xa=e=>nL(AL(e),(t,r)=>t,(t,r)=>t);var ML=function(){let e=typeof arguments[0]!="string",t=e?arguments[1]:arguments[0],r=Un(e?arguments[2]:arguments[1]),n=Po([ED(t,r),Sx(),hD,VY(JY)]);if(e){let o=arguments[0];return Tee(n,([s,i])=>vd(o,qe(i,an,s)),([s,,i,a],c)=>Rm(s,c,i,a))}return o=>Tee(n,([s,i])=>vd(o,qe(i,an,s)),([s,,i,a],c)=>Rm(s,c,i,a))},Lee=(...e)=>Gn(pt(e)),Gn=e=>Uee(0,e.length,e),Uee=(e,t,r)=>e===t?re:p(A(p(r,dt(e))),k(()=>Uee(e+1,t,r))),qee=u(e=>uT(e[1]),(e,t,r)=>r?.concurrent?Wd(e,{other:t,onSelfDone:n=>xu(o=>Je(()=>Fw(n,o))),onOtherDone:n=>xu(o=>Je(()=>Fw(o,n)))}):k(e,n=>Ud(t,o=>[n,o]))),vL=u(e=>uT(e[1]),(e,t,r)=>r?.concurrent?Ud(qee(e,t,{concurrent:!0}),n=>n[0]):k(e,n=>TS(t,n))),Fe=u(e=>uT(e[1]),(e,t,r)=>r?.concurrent?Ud(qee(e,t,{concurrent:!0}),n=>n[1]):k(e,()=>t)),EL=Symbol.for("effect/Channel/ChannelException"),Jke=e=>({_tag:"ChannelException",[EL]:EL,error:e}),Zke=e=>F(e,EL);var MS=Symbol.for("effect/Sink"),Yke={_A:e=>e,_In:e=>e,_L:e=>e,_E:e=>e,_R:e=>e},ln=class{channel;[MS]=Yke;constructor(t){this.channel=t}pipe(){return v(this,arguments)}},Wee=e=>F(e,MS),vS=e=>new ln(nr(()=>Kn(e())));var Hee=()=>new ln(Bee(ee())),Bee=e=>Ae({onInput:t=>Bee(p(e,We(t))),onFailure:oe,onDone:()=>dr(e)}),zee=e=>vS(()=>WL(jee(e,ee()))),jee=(e,t)=>Ae({onInput:r=>{let[n,o]=mf(r,e);return n.length<e?jee(e-n.length,We(t,n)):le(o)?dr(We(t,n)):k(A(o),()=>dr(We(t,n)))},onFailure:oe,onDone:()=>dr(t)});var $ee=e=>new ln(p(fu(Kn(e)),Ud(([t,r])=>[r,bC(t)])));var Vee=new ln(ma(As()));var FL=e=>new ln(Ne(e));var IT=(e,t,r)=>vS(()=>new ln(Gee(e,t,r))),Gee=(e,t,r)=>t(e)?lt({onInput:n=>{let[o,s]=Kee(e,n,t,r,0,n.length);return Vt(s)?p(A(s),TS(o)):Gee(o,t,r)},onFailure:Ne,onDone:()=>rr(e)}):rr(e),Kee=(e,t,r,n,o,s)=>{if(o===s)return[e,ee()];let i=n(e,p(t,dt(o)));return r(i)?Kee(i,t,r,n,o+1,s):[i,p(t,$t(o+1))]},NL=u(2,(e,t)=>{let r=p(Kn(e),fu,Iee({onFailure:n=>Kn(t.onFailure(n)),onSuccess:([n,o])=>nr(()=>{let s={ref:p(n,Bi(Vt))},i=p(du(()=>{let l=s.ref;return s.ref=ee(),l}),k(l=>Gn(l))),a=As(),c=p(i,Fe(a),pe(Kn(t.onSuccess(o))));return k(fu(c),([l,f])=>p(dr(s.ref),k(Gn),Fe(Gn(l)),TS(f)))})}));return new ln(r)}),Xke=(e,t,r)=>vS(()=>new ln(Qee(e,t,r))),Qee=(e,t,r)=>t(e)?lt({onInput:n=>Qee(r(e,n),t,r),onFailure:Ne,onDone:()=>rr(e)}):rr(e);var DL=(e,t,r)=>vS(()=>new ln(Jee(e,t,r))),Jee=(e,t,r)=>t(e)?lt({onInput:n=>p(J(eTe(e,n,t,r)),k(([o,s])=>p(s,j({onNone:()=>Jee(o,t,r),onSome:i=>p(A(i),TS(o))})))),onFailure:Ne,onDone:()=>rr(e)}):rr(e),eTe=(e,t,r,n)=>Zee(e,t,0,t.length,r,n),Zee=(e,t,r,n,o,s)=>r===n?B([e,g()]):p(s(e,p(t,dt(r))),P(i=>o(i)?Zee(i,t,r+1,n,o,s):B([i,x(p(t,$t(r+1)))])));var RT=(e,t)=>Xke(e,zr,t);var tTe=u(2,(e,t)=>NL(e,{onFailure:FL,onSuccess:t})),LL=e=>{let t=Ae({onInput:r=>p(J(Br(r,n=>e(n),{discard:!0})),k(()=>t)),onFailure:oe,onDone:()=>re});return new ln(t)},UL=e=>{let t=Ae({onInput:r=>p(J(e(r)),k(()=>t)),onFailure:oe,onDone:()=>re});return new ln(t)},qL=e=>{let t=Ae({onInput:r=>Yee(e,r,0,r.length,t),onFailure:oe,onDone:()=>re});return new ln(t)},Yee=(e,t,r,n,o)=>r===n?o:p(J(e(p(t,dt(r)))),k(s=>s?Yee(e,t,r+1,n,o):A(p(t,$t(r)))),Ld(s=>p(A(p(t,$t(r))),Fe(Ne(s)))));var WL=e=>new ln(e),HL=e=>new ln(J(e));var Xee=()=>IT(g(),ge,(e,t)=>j(e,{onNone:()=>x(t),onSome:()=>e}));var ete=()=>RT(g(),(e,t)=>yo(yC(t),()=>e));var tte=u(2,(e,t)=>new ln(p(Kn(e),Ud(t))));var rTe=u(2,(e,t)=>{function r(n){return ao(function*(){let o=yield*mS(t?.capacity??16),s=yield*ox(rc(o),n),i=yield*ox(rc(o),n),a=Fee(o),c=CL(s).pipe(pe(Kn(e)),vL(J(Pt(s))),Wd({other:CL(i).pipe(pe(Kn(t.other)),vL(J(Pt(i)))),onSelfDone:t.onSelfDone,onOtherDone:t.onOtherDone})),l=Wd(a,{other:c,onSelfDone:()=>xu(R),onOtherDone:f=>mu(f)});return new ln(l)})}return nTe(r)});var rte=RT(0,(e,t)=>e+xf(t,0,(r,n)=>r+n));var Kn=e=>di(e)?Kn(HL(e)):e.channel;var nTe=e=>new ln(xa(t=>e(t).pipe(w(r=>Kn(r)))));var nte=u(e=>Wee(e[1]),(e,t,r)=>oTe(e,t,(n,o)=>o,r)),oTe=u(e=>Wee(e[1]),(e,t,r,n)=>n?.concurrent?rTe(e,{other:t,onSelfDone:qt({onFailure:o=>mu(Wt(o)),onSuccess:o=>xu(qt({onFailure:Wt,onSuccess:s=>B(r(o,s))}))}),onOtherDone:qt({onFailure:o=>mu(Wt(o)),onSuccess:o=>xu(qt({onFailure:Wt,onSuccess:s=>B(r(s,o))}))})}):tTe(e,o=>tte(t,s=>r(o,s))));var ote=RT(0,(e,t)=>e+t.length),ste=vS(()=>{let e=[];return p(RT(void 0,(t,r)=>bt(r,n=>{e.push(String(n))})),tte(()=>e.join("")))});var ite=mu,ate=xu;var ute=Symbol.for("effect/RcRef"),BL={_tag:"Empty"},iTe={_tag:"Closed"},aTe={_A:R,_E:R},zL=class extends cn{acquire;context;scope;idleTimeToLive;[ute]=aTe;[qn]=qn;state=BL;semaphore=sx(1);constructor(t,r,n,o){super(),this.acquire=t,this.context=r,this.scope=n,this.idleTimeToLive=o,this.get=jL(this)}get;commit(){return this.get}},pte=e=>de(t=>{let r=t.getFiberRef(Yr),n=jt(r,ts),o=new zL(e.acquire,r,n,e.idleTimeToLive?Qe(e.idleTimeToLive):void 0);return tt(n.addFinalizer(()=>o.semaphore.withPermits(1)(q(()=>{let s=o.state._tag==="Acquired"?Ji(o.state.scope,Xr):ae;return o.state=iTe,s}))),o)}),jL=e=>{let t=e;return er(r=>q(()=>{switch(t.state._tag){case"Closed":return Xt;case"Acquired":return t.state.refCount++,t.state.fiber?tt(Wc(t.state.fiber),t.state):S(t.state);case"Empty":return ia().pipe(uy("scope"),cy("value",({scope:n})=>r(Lt(t.acquire,Yr,qe(t.context,ts,n)))),_(({scope:n,value:o})=>{let s={_tag:"Acquired",value:o,scope:n,fiber:void 0,refCount:1};return t.state=s,s}))}})).pipe(t.semaphore.withPermits(1),uy("state"),cy("scope",()=>ts),Nr(({scope:r,state:n})=>r.addFinalizer(()=>q(()=>(n.refCount--,n.refCount>0?ae:t.idleTimeToLive===void 0?(t.state=BL,Ji(n.scope,Xr)):Qa(t.idleTimeToLive).pipe(Gi,we(q(()=>t.state._tag==="Acquired"&&t.state.refCount===0?(t.state=BL,Ji(n.scope,Xr)):ae)),rs(E(()=>{n.fiber=void 0})),Uy(t.scope),Nr(o=>{n.fiber=o}),t.semaphore.withPermits(1)))))),_(({state:r})=>r.value))};var lte=pte,fte=jL;var Ux={};Yn(Ux,{FiberFailureCauseId:()=>xTe,FiberFailureId:()=>mTe,defaultRuntime:()=>MT,defaultRuntimeFlags:()=>dTe,deleteFiberRef:()=>TTe,disableRuntimeFlag:()=>CTe,enableRuntimeFlag:()=>ETe,isAsyncFiberException:()=>gTe,isFiberFailure:()=>bTe,make:()=>hTe,makeFiberFailure:()=>yTe,provideService:()=>OTe,runCallback:()=>lTe,runFork:()=>AT,runPromise:()=>fTe,runPromiseExit:()=>PS,runSync:()=>pTe,runSyncExit:()=>uTe,setFiberRef:()=>kTe,updateContext:()=>wTe,updateFiberRefs:()=>_Te,updateRuntimeFlags:()=>STe});var AT=cx,uTe=V_,pTe=uN,lTe=zy,fTe=pN,PS=G_,MT=ua,dTe=lN,hTe=ux,mTe=Symbol.for("effect/Runtime/FiberFailure"),xTe=ix,gTe=vJ,bTe=PJ,yTe=$_,STe=K_,ETe=DJ,CTe=NJ,wTe=fN,OTe=LJ,_Te=Q_,kTe=UJ,TTe=qJ;var yl=eS;var hte=xx;var $L=SY;var vT=wd;var xte="Left",gte="Right",bte="Both",yte="Either";var Ste={_tag:xte},Ete={_tag:gte},VL={_tag:bte},Cte={_tag:yte},GL=e=>{switch(e){case"left":return Ste;case"right":return Ete;case"both":return VL;case"either":return Cte;default:return e}};var Ote=VL;var qx=class{value;constructor(t){this.value=t}};var KL=(e,t)=>({ref:e,isNew:t,isChanged:!1,expected:e.versioned,newValue:e.versioned.value}),QL=e=>e.newValue,JL=(e,t)=>{e.isChanged=!0,e.newValue=t},Tte=e=>{e.ref.versioned=new qx(e.newValue)};var Ite=e=>e.ref.versioned!==e.expected,Rte=e=>e.isChanged;var FS="Invalid",PT="ReadWrite",RTe="ReadOnly",ZL=e=>{for(let t of e)Tte(t[1])},YL=e=>{let t=RTe;for(let[,r]of e)if(t=Ite(r)?FS:Rte(r)?PT:t,t===FS)return t;return t};var Mte=e=>{let t=new Map;for(let[,r]of e){for(let n of r.ref.todos)t.set(n[0],n[1]);r.ref.todos=new Map}return t},vte=e=>{let t=Array.from(e.entries()).sort((r,n)=>r[0]-n[0]);for(let[r,n]of t)n()},Pte=(e,t,r)=>{let n=!1;for(let[,o]of t)o.ref.todos.has(e)||(o.ref.todos.set(e,r),n=!0);return n};var XL="WithSTMRuntime",FT="OnFailure",eU="OnRetry",NT="OnSuccess",Fte="Provide",tU="Sync",rU="Succeed",nU="Retry",oU="Fail";var sU="Interrupt";var bu="Fail";var yu="Interrupt",nc="Succeed",Su="Retry";var NS="Done",DS="Suspend";var LS="Done",DT="Interrupted",US="Running";var UT="effect/STM/State",Hd=Symbol.for(UT),aU=e=>F(e,Hd),cU=e=>e._tag===US,Dte=e=>e._tag===LS;var LT=e=>({[Hd]:Hd,_tag:LS,exit:e,[H](){return p(M(UT),G(M(LS)),G(M(e)),se(this))},[W](t){return aU(t)&&t._tag===LS&&N(e,t.exit)}}),PTe=p(M(UT),G(M(DT)),G(M("interrupted"))),Lte={[Hd]:Hd,_tag:DT,[H](){return PTe},[W](e){return aU(e)&&e._tag===DT}},FTe=p(M(UT),G(M(US)),G(M("running"))),Ute={[Hd]:Hd,_tag:US,[H](){return FTe},[W](e){return aU(e)&&e._tag===US}},qS=e=>{switch(e._tag){case bu:return LT(At(e.error));case"Die":return LT(zc(e.defect));case yu:return LT(Uv(e.fiberId));case nc:return LT(xe(e.value));case Su:throw new Error("BUG: STM.STMState.fromTExit - please report an issue at https://github.com/Effect-TS/effect/issues")}};var Wx="effect/TExit",Hx=Symbol.for(Wx),WS={_A:e=>e,_E:e=>e},HS=e=>F(e,Hx);var qte=e=>e._tag===nc,DTe=e=>e._tag===Su,Wte=e=>({[Hx]:WS,_tag:bu,error:e,[H](){return p(M(Wx),G(M(bu)),G(M(e)),se(this))},[W](t){return HS(t)&&t._tag===bu&&N(e,t.error)}}),Hte=e=>({[Hx]:WS,_tag:"Die",defect:e,[H](){return p(M(Wx),G(M("Die")),G(M(e)),se(this))},[W](t){return HS(t)&&t._tag==="Die"&&N(e,t.defect)}}),Bte=e=>({[Hx]:WS,_tag:yu,fiberId:e,[H](){return p(M(Wx),G(M(yu)),G(M(e)),se(this))},[W](t){return HS(t)&&t._tag===yu&&N(e,t.fiberId)}}),uU=e=>({[Hx]:WS,_tag:nc,value:e,[H](){return p(M(Wx),G(M(nc)),G(M(e)),se(this))},[W](t){return HS(t)&&t._tag===nc&&N(e,t.value)}}),LTe=p(M(Wx),G(M(Su)),G(M("retry"))),zte={[Hx]:WS,_tag:Su,[H](){return LTe},[W](e){return HS(e)&&DTe(e)}};var jte=e=>({_tag:NS,exit:e}),pU=e=>({_tag:DS,journal:e});var $te={ref:0},Vte=()=>{let e=$te.ref+1;return $te.ref=e,e};var HTe="effect/STM",BTe=Symbol.for(HTe),qT={_R:e=>e,_E:e=>e,_A:e=>e},ga=class{effect_instruction_i0;_op=uc;effect_instruction_i1=void 0;effect_instruction_i2=void 0;[Ek];[kg];[MS];[yS];get[BTe](){return qT}constructor(t){this.effect_instruction_i0=t,this[Ek]=Ta,this[kg]=qT,this[MS]=qT,this[yS]=qT}[W](t){return this===t}[H](){return se(this,zu(this))}[Symbol.iterator](){return new kp(new qs(this))}commit(){return Kte(this,Ar,Ar)}pipe(){return v(this,arguments)}};var Kte=(e,t,r)=>de(n=>{let o=n.id(),s=n.getFiberRef(KY),i=n.getFiberRef(Ak),a=n.getFiberRef(QY),c=jTe(o,e,s,i,a);switch(c._tag){case NS:return t(c.exit),c.exit;case DS:{let l=Vte(),f={value:Ute},d=oD(h=>Qte(o,e,l,f,s,i,a,h));return cl(h=>p(h(d),hi(m=>{let y=f.value;return cU(y)&&(f.value=Lte),y=f.value,Dte(y)?(t(y.exit),y.exit):(r(),Wt(m))})))}}}),zTe=(e,t,r,n,o,s)=>{let i=new Map,a=new WT(t,i,e,n).run(),c=YL(i);if(c===PT)ZL(i);else if(c===FS)throw new Error("BUG: STM.TryCommit.tryCommit - please report an issue at https://github.com/Effect-TS/effect/issues");switch(a._tag){case nc:return r.value=qS(a),El(xe(a.value),i,o,s);case bu:{r.value=qS(a);let l=Ya(a.error);return El(st(l),i,o,s)}case"Die":{r.value=qS(a);let l=Bn(a.defect);return El(st(l),i,o,s)}case yu:{r.value=qS(a);let l=yd(e);return El(st(l),i,o,s)}case Su:return pU(i)}},jTe=(e,t,r,n,o)=>{let s=new Map,i=new WT(t,s,e,r).run(),a=YL(s);if(a===PT&&qte(i))ZL(s);else if(a===FS)throw new Error("BUG: STM.TryCommit.tryCommitSync - please report an issue at https://github.com/Effect-TS/effect/issues");switch(i._tag){case nc:return El(xe(i.value),s,n,o);case bu:{let c=Ya(i.error);return El(st(c),s,n,o)}case"Die":{let c=Bn(i.defect);return El(st(c),s,n,o)}case yu:{let c=yd(e);return El(st(c),s,n,o)}case Su:return pU(s)}},Qte=(e,t,r,n,o,s,i,a)=>{if(cU(n.value)){let c=zTe(e,t,n,o,s,i);switch(c._tag){case NS:{$Te(c.exit,a);break}case DS:{Pte(r,c.journal,()=>Qte(e,t,r,n,o,s,i,a));break}}}},El=(e,t,r,n)=>{let o=Mte(t);return o.size>0&&r.scheduleTask(()=>vte(o),n),jte(e)},$Te=(e,t)=>{t(e)};var WT=class{self;journal;fiberId;contStack=[];env;constructor(t,r,n,o){this.self=t,this.journal=r,this.fiberId=n,this.env=o}getEnv(){return this.env}pushStack(t){this.contStack.push(t)}popStack(){return this.contStack.pop()}nextSuccess(){let t=this.popStack();for(;t!==void 0&&t.effect_instruction_i0!==NT;)t=this.popStack();return t}nextFailure(){let t=this.popStack();for(;t!==void 0&&t.effect_instruction_i0!==FT;)t=this.popStack();return t}nextRetry(){let t=this.popStack();for(;t!==void 0&&t.effect_instruction_i0!==eU;)t=this.popStack();return t}run(){let t=this.self,r;for(;r===void 0&&t!==void 0;)try{let n=t;if(n)switch(n._op){case"Tag":{t=gi((o,s,i)=>vn(i,n));break}case"Left":{t=HT(n.left);break}case"None":{t=HT(new PQ);break}case"Right":{t=ft(n.right);break}case"Some":{t=ft(n.value);break}case"Commit":{switch(n.effect_instruction_i0){case"Die":{r=Hte(rt(()=>n.effect_instruction_i1()));break}case oU:{let o=this.nextFailure();o===void 0?r=Wte(rt(()=>n.effect_instruction_i1())):t=rt(()=>o.effect_instruction_i2(rt(()=>n.effect_instruction_i1())));break}case nU:{let o=this.nextRetry();o===void 0?r=zte:t=rt(()=>o.effect_instruction_i2());break}case sU:{r=Bte(this.fiberId);break}case XL:{t=rt(()=>n.effect_instruction_i1(this));break}case NT:case FT:case eU:{this.pushStack(n),t=n.effect_instruction_i1;break}case Fte:{let o=this.env;this.env=rt(()=>n.effect_instruction_i2(o)),t=p(n.effect_instruction_i1,VTe(BS(()=>this.env=o)));break}case rU:{let o=n.effect_instruction_i1,s=this.nextSuccess();s===void 0?r=uU(o):t=rt(()=>s.effect_instruction_i2(o));break}case tU:{let o=rt(()=>n.effect_instruction_i1()),s=this.nextSuccess();s===void 0?r=uU(o):t=rt(()=>s.effect_instruction_i2(o));break}}break}}}catch(n){t=Zte(n)}return r}},Jte=u(2,(e,t)=>{let r=new ga(FT);return r.effect_instruction_i1=e,r.effect_instruction_i2=t,r});var Zte=e=>Yte(()=>e);var Yte=e=>{let t=new ga("Die");return t.effect_instruction_i1=e,t},gi=e=>fn(t=>ft(e(t.journal,t.fiberId,t.getEnv()))),VTe=u(2,(e,t)=>ere(e,{onFailure:r=>lU(t,HT(r)),onSuccess:r=>lU(t,ft(r))})),HT=e=>Xte(()=>e),Xte=e=>{let t=new ga(oU);return t.effect_instruction_i1=e,t},No=u(2,(e,t)=>{let r=new ga(NT);return r.effect_instruction_i1=e,r.effect_instruction_i2=t,r}),ere=u(2,(e,{onFailure:t,onSuccess:r})=>p(e,Qn(Z),Jte(n=>p(t(n),Qn($))),No(n=>{switch(n._tag){case"Left":return ft(n.left);case"Right":return r(n.right)}}))),fn=e=>{let t=new ga(XL);return t.effect_instruction_i1=e,t};var Jn=e=>{let t=new ga(sU);return t.effect_instruction_i1=e,t},Qn=u(2,(e,t)=>p(e,No(r=>BS(()=>t(r)))));var is=new ga(nU),ft=e=>{let t=new ga(rU);return t.effect_instruction_i1=e,t},BS=e=>{let t=new ga(tU);return t.effect_instruction_i1=e,t};var lU=u(2,(e,t)=>p(e,No(()=>t))),tre=u(3,(e,t,r)=>p(e,No(n=>p(t,Qn(o=>r(n,o))))));var zS="BackPressure",jS="Dropping",$S="Sliding";var GTe=u(2,(e,t)=>p(e,Qn(()=>t)));var KTe=e=>No(e,R);var VS=u(e=>Lo(e[0]),(e,t,r)=>r?.discard?p(BS(()=>e[Symbol.iterator]()),No(n=>{let o=fU(()=>{let s=n.next();return s.done?Bd:p(t(s.value),No(()=>o))});return o})):fU(()=>Ee(e).reduce((n,o)=>tre(n,t(o),(s,i)=>(s.push(i),s)),ft([]))));var nre=(e,t)=>Symbol.iterator in e?VS(e,R,t):t?.discard?VS(Object.values(e),R,t):Qn(VS(Object.entries(e),([r,n])=>Qn(n,o=>[r,o])),r=>{let n={};for(let[o,s]of r)n[o]=s;return n});var fU=e=>KTe(BS(e)),dU=u(2,(e,t)=>No(e,r=>GTe(t(r),r)));var Bd=ft(void 0);var QTe="effect/TRef",JTe=Symbol.for(QTe),ZTe={_A:e=>e},Bx=class{[JTe]=ZTe;todos;versioned;constructor(t){this.versioned=new qx(t),this.todos=new Map}modify(t){return gi(r=>{let n=xU(this,r),[o,s]=t(QL(n));return JL(n,s),o})}pipe(){return v(this,arguments)}},hU=e=>gi(t=>{let r=new Bx(e);return t.set(r,KL(r,!0)),r}),zT=e=>e.modify(t=>[t,t]),mU=u(2,(e,t)=>e.modify(()=>[void 0,t]));var xU=(e,t)=>{if(t.has(e))return t.get(e);let r=KL(e,!1);return t.set(e,r),r},je=u(2,(e,t)=>QL(xU(e,t))),Ge=u(3,(e,t,r)=>{let n=xU(e,r);JL(n,t)});var YTe="effect/TQueue/TEnqueue",jT=Symbol.for(YTe),XTe="effect/TQueue/TDequeue",$T=Symbol.for(XTe);var gU={_Out:e=>e},bU={_In:e=>e},ire=class{ref;requestedCapacity;strategy;[$T]=gU;[jT]=bU;constructor(t,r,n){this.ref=t,this.requestedCapacity=r,this.strategy=n}capacity(){return this.requestedCapacity}size=fn(t=>{let r=je(this.ref,t.journal);return r===void 0?Jn(t.fiberId):ft(r.length)});isFull=Qn(this.size,t=>t===this.requestedCapacity);isEmpty=Qn(this.size,t=>t===0);shutdown=fn(t=>(Ge(this.ref,void 0,t.journal),Bd));isShutdown=gi(t=>je(this.ref,t)===void 0);awaitShutdown=No(this.isShutdown,t=>t?Bd:is);offer(t){return fn(r=>{let n=p(this.ref,je(r.journal));if(n===void 0)return Jn(r.fiberId);if(n.length<this.requestedCapacity)return n.push(t),Ge(this.ref,n,r.journal),ft(!0);switch(this.strategy._tag){case zS:return is;case jS:return ft(!1);case $S:return n.length===0?ft(!0):(n.shift(),n.push(t),Ge(this.ref,n,r.journal),ft(!0))}})}offerAll(t){return fn(r=>{let n=Array.from(t),o=je(this.ref,r.journal);if(o===void 0)return Jn(r.fiberId);if(o.length+n.length<=this.requestedCapacity)return Ge(this.ref,[...o,...n],r.journal),ft(!0);switch(this.strategy._tag){case zS:return is;case jS:{let s=n.slice(0,this.requestedCapacity-o.length);return Ge(this.ref,[...o,...s],r.journal),ft(!1)}case $S:{let s=n.slice(0,this.requestedCapacity-o.length),i=o.length+s.length-this.requestedCapacity,a=o.slice(i);return Ge(this.ref,[...a,...s],r.journal),ft(!0)}}})}peek=fn(t=>{let r=je(this.ref,t.journal);return r===void 0?Jn(t.fiberId):r.length===0?is:ft(r[0])});peekOption=fn(t=>{let r=je(this.ref,t.journal);return r===void 0?Jn(t.fiberId):ft(br(r[0]))});take=fn(t=>{let r=je(this.ref,t.journal);if(r===void 0)return Jn(t.fiberId);if(r.length===0)return is;let n=r.shift();return Ge(this.ref,r,t.journal),ft(n)});takeAll=fn(t=>{let r=je(this.ref,t.journal);return r===void 0?Jn(t.fiberId):(Ge(this.ref,[],t.journal),ft(r))});takeUpTo(t){return fn(r=>{let n=je(this.ref,r.journal);if(n===void 0)return Jn(r.fiberId);let[o,s]=mf(Le(n),t);return Ge(this.ref,Array.from(s),r.journal),ft(Array.from(o))})}};var are=e=>e.isShutdown;var yU=e=>e.shutdown;var cre=e=>e.take;var eIe="effect/TPubSub",VT=Symbol.for(eIe),Ms=Symbol.for("effect/TPubSub/AbsentValue"),Eu=(e,t,r)=>({head:e,subscribers:t,tail:r}),pre=class{pubsubSize;publisherHead;publisherTail;requestedCapacity;strategy;subscriberCount;subscribers;[VT]={_A:t=>t};[jT]=bU;constructor(t,r,n,o,s,i,a){this.pubsubSize=t,this.publisherHead=r,this.publisherTail=n,this.requestedCapacity=o,this.strategy=s,this.subscriberCount=i,this.subscribers=a}isShutdown=gi(t=>je(this.publisherTail,t)===void 0);awaitShutdown=No(this.isShutdown,t=>t?Bd:is);capacity(){return this.requestedCapacity}size=fn(t=>je(this.publisherTail,t.journal)===void 0?Jn(t.fiberId):ft(je(this.pubsubSize,t.journal)));isEmpty=Qn(this.size,t=>t===0);isFull=Qn(this.size,t=>t===this.capacity());offer(t){return fn(r=>{let n=je(this.publisherTail,r.journal);if(n===void 0)return Jn(r.fiberId);let o=je(this.subscriberCount,r.journal);if(o===0)return ft(!0);let s=je(this.pubsubSize,r.journal);if(s<this.requestedCapacity){let i=new Bx(void 0),a=Eu(t,o,i);return Ge(n,a,r.journal),Ge(this.publisherTail,i,r.journal),Ge(this.pubsubSize,s+1,r.journal),ft(!0)}switch(this.strategy._tag){case zS:return is;case jS:return ft(!1);case $S:{if(this.requestedCapacity>0){let c=je(this.publisherHead,r.journal),l=!0;for(;l;){let f=je(c,r.journal);if(f===void 0)return is;let d=f.head,h=f.tail;if(d!==Ms){let m=Eu(Ms,f.subscribers,f.tail);Ge(c,m,r.journal),Ge(this.publisherHead,h,r.journal),l=!1}else c=h}}let i=new Bx(void 0),a=Eu(t,o,i);return Ge(n,a,r.journal),Ge(this.publisherTail,i,r.journal),ft(!0)}}})}offerAll(t){return Qn(VS(t,r=>this.offer(r)),Dz(R))}shutdown=gi(t=>{if(je(this.publisherTail,t)!==void 0){Ge(this.publisherTail,void 0,t);let n=je(this.subscribers,t);K4(n,o=>{Ge(o,void 0,t)}),Ge(this.subscribers,Zs(),t)}})},SU=class{pubsubSize;publisherHead;requestedCapacity;subscriberHead;subscriberCount;subscribers;[VT]=VT;[$T]=gU;constructor(t,r,n,o,s,i){this.pubsubSize=t,this.publisherHead=r,this.requestedCapacity=n,this.subscriberHead=o,this.subscriberCount=s,this.subscribers=i}isShutdown=gi(t=>je(this.subscriberHead,t)===void 0);awaitShutdown=No(this.isShutdown,t=>t?Bd:is);capacity(){return this.requestedCapacity}size=fn(t=>{let r=je(this.subscriberHead,t.journal);if(r===void 0)return Jn(t.fiberId);let n=!0,o=0;for(;n;){let s=je(r,t.journal);if(s===void 0)n=!1;else{let i=s.head,a=s.tail;i!==Ms&&(o=o+1,o>=Number.MAX_SAFE_INTEGER&&(n=!1)),r=a}}return ft(o)});isEmpty=Qn(this.size,t=>t===0);isFull=Qn(this.size,t=>t===this.capacity());peek=fn(t=>{let r=je(this.subscriberHead,t.journal);if(r===void 0)return Jn(t.fiberId);let n=Ms,o=!0;for(;o;){let s=je(r,t.journal);if(s===void 0)return is;let i=s.head,a=s.tail;i!==Ms?(n=i,o=!1):r=a}return ft(n)});peekOption=fn(t=>{let r=je(this.subscriberHead,t.journal);if(r===void 0)return Jn(t.fiberId);let n=g(),o=!0;for(;o;){let s=je(r,t.journal);if(s===void 0)n=g(),o=!1;else{let i=s.head,a=s.tail;i!==Ms?(n=x(i),o=!1):r=a}}return ft(n)});shutdown=gi(t=>{let r=je(this.subscriberHead,t);if(r!==void 0){Ge(this.subscriberHead,void 0,t);let n=!0;for(;n;){let s=je(r,t);if(s===void 0)n=!1;else{let i=s.head,a=s.tail;if(i!==Ms){let c=s.subscribers;if(c===1){let l=je(this.pubsubSize,t),f=Eu(Ms,0,a);Ge(r,f,t),Ge(this.publisherHead,a,t),Ge(this.pubsubSize,l-1,t)}else{let l=Eu(i,c-1,a);Ge(r,l,t)}}r=a}}let o=je(this.subscriberCount,t);Ge(this.subscriberCount,o-1,t),Ge(this.subscribers,Ef(je(this.subscribers,t),this.subscriberHead),t)}});take=fn(t=>{let r=je(this.subscriberHead,t.journal);if(r===void 0)return Jn(t.fiberId);let n=Ms,o=!0;for(;o;){let s=je(r,t.journal);if(s===void 0)return is;let i=s.head,a=s.tail;if(i!==Ms){let c=s.subscribers;if(c===1){let l=je(this.pubsubSize,t.journal),f=Eu(Ms,0,a);Ge(r,f,t.journal),Ge(this.publisherHead,a,t.journal),Ge(this.pubsubSize,l-1,t.journal)}else{let l=Eu(i,c-1,a);Ge(r,l,t.journal)}Ge(this.subscriberHead,a,t.journal),n=i,o=!1}else r=a}return ft(n)});takeAll=this.takeUpTo(Number.POSITIVE_INFINITY);takeUpTo(t){return fn(r=>{let n=je(this.subscriberHead,r.journal);if(n===void 0)return Jn(r.fiberId);let o=[],s=0;for(;s!==t;){let i=je(n,r.journal);if(i===void 0)s=t;else{let a=i.head,c=i.tail;if(a!==Ms){let l=i.subscribers;if(l===1){let f=je(this.pubsubSize,r.journal),d=Eu(Ms,0,c);Ge(n,d,r.journal),Ge(this.publisherHead,c,r.journal),Ge(this.pubsubSize,f-1,r.journal)}else{let f=Eu(a,l-1,c);Ge(n,f,r.journal)}o.push(a),s=s+1}n=c}}return Ge(this.subscriberHead,n,r.journal),ft(o)})}};var tIe=(e,t,r,n,o,s)=>p(zT(r),No(i=>p(nre([hU(i),zT(o),zT(s)]),dU(([a,c])=>p(o,mU(c+1))),dU(([a,c,l])=>p(s,mU(p(l,zi(a))))),Qn(([a])=>new SU(e,t,n,a,o,s)))));var lre=e=>tIe(e.pubsubSize,e.publisherHead,e.publisherTail,e.requestedCapacity,e.subscriberCount,e.subscribers),fre=e=>wr(lre(e),t=>yU(t));var dre=fre;var mre=are;var xre=cre;var zx=class{capacity;array;size=0;current=0;constructor(t){this.capacity=t,this.array=Array.from({length:t},ch)}head(){return br(this.array[this.current])}lastOrNull(){if(this.size===0)return;let t=this.current===0?this.array.length-1:this.current-1;return this.array[t]??void 0}put(t){this.array[this.current]=t,this.increment()}dropLast(){this.size>0&&(this.decrement(),this.array[this.current]=void 0)}toChunk(){let t=this.current-this.size,r=t<0?[...this.array.slice(this.capacity+t,this.capacity),...this.array.slice(0,this.current)]:this.array.slice(t,this.current);return pt(r)}increment(){this.size<this.capacity&&(this.size+=1),this.current=(this.current+1)%this.capacity}decrement(){this.size-=1,this.current>0?this.current-=1:this.current=this.capacity-1}};var EU="NotStarted",CU="Previous",wU="Current",bre={_tag:EU},yre=e=>({_tag:CU,fiber:e}),Sre=e=>({_tag:wU,fiber:e});var GT=e=>Object.assign(e,{chunk(r){return this(B(r))},die(r){return this(_d(r))},dieMessage(r){return this(il(r))},done(r){return this(Je(()=>Pw(r,{onFailure:x,onSuccess:V})))},end(){return this(Fo(g()))},fail(r){return this(Fo(x(r)))},fromEffect(r){return this(cS(r,{onFailure:x,onSuccess:V}))},fromEffectChunk(r){return this(p(r,mi(x)))},halt(r){return this(Wt(p(r,Is(x))))},single(r){return this(B(V(r)))}}),Ere=(e,t)=>{let r=!1,n=[],o=!1;function s(c){if(r)return!1;if(c.length<=5e4)n.push.apply(n,c);else for(let l=0;l<c.length;l++)n.push(c[0]);return o||(o=!0,t.scheduleTask(i,0)),!0}function i(){o=!1,n.length>0&&(e.unsafeOffer(n),n=[])}function a(c){r||(r=!0,c._tag==="Success"&&n.push(c.value),i(),e.unsafeOffer(c._tag==="Success"?Bp:c))}return{single(c){return r?!1:(n.push(c),o||(o=!0,t.scheduleTask(i,0)),!0)},array:s,chunk(c){return s(Zt(c))},done:a,end(){r||(r=!0,i(),e.unsafeOffer(Bp))},halt(c){return a(st(c))},fail(c){return a(At(c))},die(c){return a(zc(c))},dieMessage(c){return a(zc(new Error(c)))}}};var sIe=Symbol.for("effect/Stream/Handoff"),Cre="Empty",wre="Full",Ore=e=>({_tag:Cre,notifyConsumer:e}),iIe=(e,t)=>({_tag:wre,value:e,notifyProducer:t}),_re=(e,t)=>r=>{switch(r._tag){case Cre:return e(r.notifyConsumer);case wre:return t(r.value,r.notifyProducer)}},aIe={_A:e=>e},as=()=>p(wt(),P(e=>tr(Ore(e))),w(e=>({[sIe]:aIe,ref:e}))),Ht=u(2,(e,t)=>P(wt(),r=>po(Yo(e.ref,n=>p(n,_re(o=>[ue(Cr(o,void 0),He(r)),iIe(t,r)],(o,s)=>[P(He(s),()=>p(e,Ht(t))),n])))))),cs=e=>P(wt(),t=>po(Yo(e.ref,r=>p(r,_re(n=>[P(He(n),()=>cs(e)),r],(n,o)=>[Kt(Cr(o,void 0),n),Ore(t)])))));var jx="Emit",$x="Halt";var OU=e=>({_tag:jx,elements:e}),KT=e=>({_tag:$x,cause:e}),GS=e=>({_tag:"End",reason:e});var pIe="effect/Take",lIe=Symbol.for(pIe),fIe={_A:e=>e,_E:e=>e},Cl=class{exit;[lIe]=fIe;constructor(t){this.exit=t}pipe(){return v(this,arguments)}},Cu=e=>new Cl(xe(e));var Vx=e=>Je(()=>e.exit),ba=new Cl(At(g()));var wu=e=>new Cl(st(p(e,Is(x))));var QT=e=>uu(e,{onFailure:t=>j(Xm(t),{onNone:()=>ba,onSome:wu}),onSuccess:Cu});var Gx=u(2,(e,{onEnd:t,onFailure:r,onSuccess:n})=>qt(e.exit,{onFailure:o=>j(Xm(o),{onNone:t,onSome:r}),onSuccess:n}));var JT=e=>new Cl(xe(V(e)));var KS=()=>Fo(g());var ZT=e=>mi(Wt(e),x);var YT="ScheduleEnd",_U="UpstreamEnd",Kx={_tag:YT},kU={_tag:_U};var XT="DrainLeft",eI="DrainRight",tI="PullBoth",rI="PullLeft",nI="PullRight",wl={_tag:XT},Ol={_tag:eI},_l={_tag:tI},Ou=e=>({_tag:rI,rightChunk:e}),_u=e=>({_tag:nI,leftChunk:e});var TU="PullBoth",IU="PullLet",RU="PullRight",QS={_tag:TU},JS=e=>({_tag:IU,rightChunk:e}),ZS=e=>({_tag:RU,leftChunk:e});var gIe="effect/Stream",cI=Symbol.for(gIe),bIe={_R:e=>e,_E:e=>e,_A:e=>e},L=class{channel;[cI]=bIe;constructor(t){this.channel=t}pipe(){return v(this,arguments)}},us=e=>F(e,cI)||di(e),Qx=4096,Mre=e=>XS(MU(e)),MU=e=>{let t=r=>lt({onInput:n=>{let o=We(r,n);return k(A(o),()=>t(o))},onFailure:Ne,onDone:()=>re});return new L(pe(D(e),t(ee())))},vU=(e,t)=>Gd(wr(e,t)),vre=u(2,(e,t)=>uI(e,t,hte)),uI=u(3,(e,t,r)=>Tl(PU(e,t,r),n=>Xe(n,{onLeft:g,onRight:x}))),PU=u(3,(e,t,r)=>{let n=Po([as(),tr(Kx),tr(ee()),yl(r),tr(!1),tr(!1)]);return sr(n).pipe(hr(([o,s,i,a,c,l])=>{let f=Ae({onInput:y=>k(J(p(o,Ht(OU(y)),Cx(()=>Vt(y)))),()=>f),onFailure:y=>J(Ht(o,KT(y))),onDone:()=>J(Ht(o,GS(kU)))}),d=p(sd(i,ee()),P(y=>Vt(y)?p(Dr(c,!0),ue(B(p(A(y),k(()=>d))))):p(cs(o),w(T=>{switch(T._tag){case jx:return p(J(Dr(c,!0)),Fe(A(T.elements)),Fe(J(_t(l))),k(C=>C?re:d));case $x:return oe(T.cause);case"End":return T.reason._tag===YT?p(_t(c),w(C=>C?J(p(Dr(s,Kx),ue(Dr(l,!0)))):p(J(p(Dr(s,Kx),ue(Dr(l,!0)))),k(()=>d))),Ce):p(Dr(s,T.reason),ue(Dr(l,!0)),J)}}))),Ce),h=y=>a.next(y),m=(y,T,C)=>{let O=p(Dr(c,!1),ue(Dr(l,!1)),ue(p(d,or(Kn(t)),fu,RS,yt(C)))),U=(I,K,Q)=>p(Dr(i,bC(I)),ue(w(_t(s),z=>{switch(z._tag){case YT:return p(Po([_t(c),O,p(h(x(K)),yt(C))]),w(([te,ce,Ye])=>{let at=p(Q,j({onNone:()=>V(Z(K)),onSome:Ue=>fp(Z(K),$(Ue))}));return te?p(A(at),k(()=>m(ce,Ye,C))):m(ce,Ye,C)}),Ce);case _U:return p(_t(c),w(te=>te?A(V(Z(K))):re),Ce)}})),Ce);return Ce(ll(vo(y),vo(T),{onSelfDone:(I,K)=>p(_n(T),ue(p(Je(()=>I),w(([Q,z])=>U(Q,z,g()))))),onOtherDone:(I,K)=>zn(Je(()=>I),{onFailure:Q=>Xe(Xa(Q),{onLeft:()=>p(o,Ht(GS(Kx)),ul,ue(p(vo(y),w(([z,te])=>U(z,te,g()))))),onRight:z=>p(o,Ht(KT(z)),ul,ue(p(vo(y),w(([te,ce])=>U(te,ce,g())))))}),onSuccess:Q=>p(o,Ht(GS(Kx)),ul,ue(p(vo(y),w(([z,te])=>U(z,te,x(Q))))))})}))};return rg(y=>pe(D(e),f).pipe(RS,yt(y),ue(or(d,Kn(t)).pipe(fu,RS,yt(y),P(T=>h(g()).pipe(yt(y),w(C=>new L(m(T,C,y)))))))))}))}),Pre=u(2,(e,t)=>Or(e,()=>t)),FU=e=>{if(e==="unbounded")return hl();if(typeof e=="number"||e===void 0)return os(e??16);switch(e.strategy){case"dropping":return Ax(e.bufferSize??16);case"sliding":return Mx(e.bufferSize??16);default:return os(e.bufferSize??16)}},Fre=(e,t)=>wr(FU(t),r=>Pt(r)).pipe(P(r=>pu().pipe(P(n=>Ze(()=>{let o=PS(n);return e(GT(i=>QT(i).pipe(P(a=>Ve(r,a)),uo,o).then(a=>{if(Bc(a)&&!aa(a.cause))throw ex(a.cause)})))})),w(n=>{let o=$n(r).pipe(P(s=>Vx(s)),la({onFailure:s=>J(Pt(r)).pipe(Fe(j(s,{onNone:()=>re,onSome:i=>Ne(i)}))),onSuccess:s=>A(s).pipe(k(()=>o))}),Ce);return Xx(o).pipe(Tu(n??be))}))),vs),Nre=(e,t)=>p(wr(FU(t),r=>Pt(r)),P(r=>p(pu(),P(n=>p(e(GT(o=>p(QT(o),P(s=>Ve(r,s)),uo,PS(n)).then(s=>{if(Bc(s)&&!aa(s.cause))throw ex(s.cause)}))),w(()=>{let o=p($n(r),P(Vx),la({onFailure:s=>p(J(Pt(r)),Fe(j(s,{onNone:()=>re,onSome:Ne}))),onSuccess:s=>p(A(s),k(()=>o))}),Ce);return o}))))),gu,Xx),yIe=e=>{if(e?.bufferSize==="unbounded"||e?.bufferSize===void 0&&e?.strategy===void 0)return hl();switch(e?.strategy){case"sliding":return Mx(e.bufferSize??16);default:return Ax(e?.bufferSize??16)}},NU=(e,t)=>wr(yIe(t),Pt).pipe(pn(r=>GY(Ak,n=>e(Ere(r,n)))),w(r=>{let n=k($n(r),o=>Jb(o)?Yi(o)?re:oe(o.cause):Fe(A(Le(o)),n));return n}),gu,Xx),Dre=(e,t)=>p(wr(FU(t),r=>Pt(r)),P(r=>p(pu(),P(n=>p(e(GT(o=>p(QT(o),P(s=>Ve(r,s)),uo,PS(n)).then(s=>{if(Bc(s)&&!aa(s.cause))throw ex(s.cause)}))),ue(tr(!1)),P(o=>p(_t(o),w(s=>s?KS():p($n(r),P(Vx),pD(()=>p(Dr(o,!0),ue(Pt(r)))))))))))),Gd,hr(Au)),Lre=u(3,(e,t,r)=>kn(()=>{let n=s=>lt({onInput:i=>{if(s.length+i.length>=t){let[c,l]=p(i,mf(t-s.length));return o(p(s,We(c)),l)}return n(p(s,We(i)))},onFailure:Ne,onDone:()=>o(s,ee())}),o=(s,i)=>pe(Fe(A(i),As()),D(r(s)));return new L(p(D(e),or(n(ee()))))})),Ure=u(3,(e,t,r)=>p(e,LU(t,r),w(n=>n.map(o=>Ml(bi(o,{shutdown:!0})))))),DU=u(2,(e,t)=>w(kI(e,t),r=>Ml(o0(r)))),qre=u(2,(e,t)=>w(lte({acquire:DU(e,t),idleTimeToLive:t.idleTimeToLive}),r=>vs(fte(r)))),LU=u(3,(e,t,r)=>P(tse(r),n=>p(Po(Array.from({length:t},()=>rc(n))),pn(()=>cu(_I(e,n)))))),Wre=u(2,(e,t)=>w(kI(e,t),rc)),Hre=u(2,(e,t)=>{if(t.capacity==="unbounded")return OIe(e);if(t.strategy==="dropping")return CIe(e,t.capacity);if(t.strategy==="sliding")return wIe(e,t.capacity);let r=Hq(e,t);return new L(gu(w(r,n=>{let o=p(J($n(n)),k(qt({onFailure:s=>p(Xm(s),j({onNone:()=>re,onSome:oe})),onSuccess:s=>k(A(V(s)),()=>o)})));return o})))}),Bre=u(2,(e,t)=>{if(t.strategy==="dropping")return SIe(e,t.capacity);if(t.strategy==="sliding")return EIe(e,t.capacity);let r=TI(e,t);return new L(gu(w(r,n=>{let o=p(J($n(n)),k(Gx({onEnd:()=>re,onFailure:oe,onSuccess:s=>p(A(s),k(()=>o))})));return o})))}),SIe=u(2,(e,t)=>{let r=wr(Ax(t),n=>Pt(n));return new L(pI(r,D(e)))}),EIe=u(2,(e,t)=>{let r=wr(Mx(t),n=>Pt(n));return new L(pI(r,D(e)))}),CIe=u(2,(e,t)=>{let r=wr(Ax(t),n=>Pt(n));return new L(pI(r,D(p0(1)(e))))}),wIe=u(2,(e,t)=>{let r=wr(Mx(t),n=>Pt(n));return new L(pI(r,D(p(e,p0(1)))))}),OIe=e=>{let t=TI(e,{strategy:"unbounded"});return new L(gu(w(t,r=>{let n=p(J($n(r)),k(Gx({onEnd:()=>re,onFailure:oe,onSuccess:o=>k(A(o),()=>n)})));return n})))},pI=(e,t)=>{let r=(o,s)=>{let i=a=>p(_t(s),pn(He),ue(wt()),P(c=>p(Ve(o,[a,c]),ue(Dr(s,c)),ue(He(c)))),uo,J);return Ae({onInput:a=>p(wt(),P(c=>p(Ve(o,[Cu(a),c]),P(l=>p(Dr(s,c),Cx(()=>l))))),uo,J,k(()=>r(o,s))),onFailure:a=>i(wu(a)),onDone:()=>i(ba)})},n=o=>{let s=p(J($n(o)),k(([i,a])=>Fe(J(Cr(a,void 0)),Gx(i,{onEnd:()=>re,onFailure:oe,onSuccess:c=>p(A(c),k(()=>s))}))));return s};return gu(p(e,P(o=>p(wt(),pn(s=>Cr(s,void 0)),P(s=>p(tr(s),P(i=>p(t,pe(r(o,i)),AS,cu)),Kt(n(o))))))))},Iu=u(2,(e,t)=>Jx(e,r=>Xe(Xa(r),{onLeft:t,onRight:r0}))),Jx=u(2,(e,t)=>new L(p(D(e),SS(r=>D(t(r)))))),zre=u(2,(e,t)=>p(e,Iu(r=>p(t(r),_e(()=>ku(r)))))),UU=u(2,(e,t)=>p(e,Jx(r=>p(t(r),_e(()=>r0(r)))))),jre=u(3,(e,t,r)=>Iu(e,n=>"_tag"in n&&n._tag===t?r(n):ku(n))),$re=u(2,(e,t)=>Iu(e,r=>{let n=Object.keys(t);return"_tag"in r&&n.includes(r._tag)?t[r._tag](r):ku(r)})),Vre=e=>p(e,qU((t,r)=>N(r)(t))),qU=u(2,(e,t)=>{let r=n=>Ae({onInput:o=>{let[s,i]=xf(o,[n,ee()],([a,c],l)=>X(a)&&t(a.value,l)?[x(l),c]:[x(l),p(c,Pn(l))]);return k(A(i),()=>r(s))},onFailure:oe,onDone:()=>re});return new L(p(D(e),pe(r(g()))))}),Gre=u(2,(e,t)=>{let r=n=>Ae({onInput:o=>p(o,oS([n,ee()],([s,i],a)=>X(s)?p(t(s.value,a),w(c=>c?[x(a),i]:[x(a),p(i,Pn(a))])):B([x(a),p(i,Pn(a))])),J,k(([s,i])=>p(A(i),k(()=>r(s))))),onFailure:oe,onDone:()=>re});return new L(p(D(e),pe(r(g()))))}),XS=e=>p(e,$d(V)),Kre=u(2,(e,t)=>n0(t(XS(e)))),kl=e=>yx(cD(e),t=>t._tag==="None"?iS:Fo(t.value)),Qre=u(4,(e,t,r,n)=>{function o(s,i){return J(cs(i)).pipe(Fe(Ae({onInput:a=>k(J(Ht(s,xe(a))),()=>o(s,i)),onFailure:a=>J(Ht(s,st(p(a,Is(x))))),onDone:()=>k(J(Ht(s,At(g()))),()=>o(s,i))})))}return new L(xa(s=>Po([as(),as(),as(),as()]).pipe(pn(([i,a,c])=>D(e).pipe(ha(Gn),pe(o(i,c)),ss(s),yt(s))),pn(([,i,a,c])=>D(t).pipe(ha(Gn),pe(o(i,c)),ss(s),yt(s))),w(([i,a,c,l])=>{let f=Ht(c,void 0).pipe(ue(cs(i).pipe(P(R)))),d=Ht(l,void 0).pipe(ue(cs(a).pipe(P(R))));return D(AI(r,h=>P(n(h,f,d),kl)))}))))}),e0=u(4,(e,t,r,n)=>{let o=(s,i)=>Fe(J(cs(i)),Ae({onInput:a=>k(J(p(s,Ht(Cu(a)))),()=>o(s,i)),onFailure:a=>J(Ht(s,wu(a))),onDone:()=>J(Ht(s,ba))}));return new L(xa(s=>Po([as(),as(),as(),as()]).pipe(pn(([i,a,c])=>pe(D(e),o(i,c)).pipe(ss(s),yt(s))),pn(([i,a,c,l])=>pe(D(t),o(a,l)).pipe(ss(s),yt(s))),w(([i,a,c,l])=>{let f=Ht(c,void 0).pipe(ue(cs(i).pipe(P(Vx)))),d=Ht(l,void 0).pipe(ue(cs(a).pipe(P(Vx))));return D(h0(r,h=>P(n(h,f,d),kl)))}))))}),oc=u(2,(e,t)=>new L(p(D(e),Fe(D(t))))),Jre=e=>kn(()=>p(e,xf(Ru,(t,r)=>oc(r)(t)))),Zre=u(2,(e,t)=>p(e,fI(t,(r,n)=>[r,n]))),Yre=u(2,(e,t)=>p(e,fI(t,(r,n)=>r))),lI=u(2,(e,t)=>hr(e,()=>t)),fI=u(3,(e,t,r)=>p(e,hr(n=>p(t,Or(o=>r(n,o)))))),Xre=u(2,(e,t)=>rg(r=>ao(function*(){let n=yield*as();function o(a){return $a(t).pipe(Kt(a),yt(r),w(c=>i(yre(c))))}let s=Ae({onInput:a=>j(yC(a),{onNone:()=>s,onSome:c=>J(Ht(n,OU(V(c)))).pipe(k(()=>s))}),onFailure:a=>J(Ht(n,KT(a))),onDone:()=>J(Ht(n,GS(kU)))});function i(a){switch(a._tag){case EU:return Ce(cs(n).pipe(w(c=>{switch(c._tag){case jx:return Ce(o(c.elements));case $x:return oe(c.cause);case"End":return re}})));case CU:return Ce(cs(n).pipe(yt(r),P(c=>ll(vo(a.fiber),vo(c),{onSelfDone:(l,f)=>qt(l,{onFailure:d=>_n(f).pipe(Kt(oe(d))),onSuccess:d=>_n(f).pipe(ue(B(A(d).pipe(k(()=>i(Sre(c)))))))}),onOtherDone:(l,f)=>qt(l,{onFailure:d=>_n(f).pipe(Kt(oe(d))),onSuccess:d=>{switch(d._tag){case jx:return _n(f).pipe(ue(o(d.elements)));case $x:return _n(f).pipe(Kt(oe(d.cause)));case"End":return vo(f).pipe(w(h=>A(h).pipe(Fe(re))))}}})}))));case wU:return Ce(vo(a.fiber).pipe(w(c=>{switch(c._tag){case jx:return Ce(o(c.elements));case $x:return oe(c.cause);case"End":return re}})))}}return f0(a=>pe(D(e),s).pipe(ss(a),yt(a))).pipe(lI(new L(i(bre))))}))),dI=e=>sr(_d(e)),ene=e=>sr(iD(e)),tne=e=>sr(il(e)),WU=u(2,(e,t)=>p(wt(),P(r=>p(e,HU({maximumLag:t.maximumLag,decide:n=>P(He(r),o=>o(n))}),P(n=>p(Po(bt(SC(0,t.size-1),o=>w(n,([s,i])=>[[s,o],i]))),w(Le),P(o=>{let[s,i]=p4(o,[new Map,ee()],([a,c],[l,f])=>[a.set(l[0],l[1]),p(c,Et(f))]);return p(Cr(r,a=>w(t.decide(a),c=>l=>c(s.get(l)))),Kt(Array.from(i)))}))))))),Tre={ref:0},Ire=()=>{let e=Tre.ref;return Tre.ref=e+1,e},HU=u(2,(e,t)=>BU(e,t.maximumLag,t.decide,()=>be)),BU=u(4,(e,t,r,n)=>p(wr(tr(new Map),(o,s)=>p(_t(o),P(i=>p(i.values(),Br(Pt))))),P(o=>ao(function*(){let s=l=>p(r(l),P(f=>p(_t(o),P(d=>p(d.entries(),oS(ee(),(h,[m,y])=>f(m)?p(Ve(y,xe(l)),zn({onFailure:T=>aa(T)?B(p(h,Et(m))):Wt(T),onSuccess:()=>B(h)})):B(h)),P(h=>Vt(h)?Os(o,m=>{for(let y of h)m.delete(y);return m}):be))))),uo),i=yield*fl(1),a=yield*tr(p(os(t),P(l=>{let f=Ire();return p(Os(o,d=>d.set(f,l)),Kt([f,l]))}))),c=l=>i.withPermits(1)(p(Dr(a,p(os(1),pn(f=>Ve(f,l)),P(f=>{let d=Ire();return p(Os(o,h=>h.set(d,f)),Kt(CE(d,f)))}))),ue(p(_t(o),P(f=>p(pt(f.values()),Br(d=>p(Ve(d,l),kd(h=>aa(h)?x(be):g()))))))),ue(n(l)),uo));return yield*p(e,_q(s),zn({onFailure:l=>c(st(p(l,Is(x)))),onSuccess:()=>c(At(g()))}),cu),i.withPermits(1)(po(_t(a)))})))),Zx=e=>new L(ma(D(e))),rne=u(2,(e,t)=>sr(wt()).pipe(hr(r=>f0(n=>D(t).pipe(ma,ss(n),hi(o=>Zf(r,o)),yt(n))).pipe(lI(XU(e,r)))))),zU=u(2,(e,t)=>{let r=n=>lt({onInput:o=>{let s=p(o,$t(n)),i=Math.max(0,n-o.length);return le(o)||i>0?r(i):p(A(s),Fe(As()))},onFailure:Ne,onDone:()=>re});return new L(p(D(e),or(r(t))))}),nne=u(2,(e,t)=>t<=0?JU():kn(()=>{let r=new zx(t),n=lt({onInput:o=>{let s=p(o,Vh(i=>{let a=r.head();return r.put(i),a}));return p(A(s),k(()=>n))},onFailure:Ne,onDone:()=>re});return new L(p(D(e),or(n)))})),one=u(2,(e,t)=>zU(jU(e,r=>!t(r)),1)),sne=u(2,(e,t)=>{let r=lt({onInput:n=>p(Ck(n,t),w(Le),w(o=>le(o)?nr(()=>r):p(A(o),Fe(As()))),Ce),onFailure:Ne,onDone:()=>re});return new L(p(D(e),or(r)))}),jU=u(2,(e,t)=>{let r=lt({onInput:n=>{let o=eM(n,t);return le(o)?nr(()=>r):Fe(A(o),As())},onFailure:Ne,onDone:rr});return new L(or(D(e),r))}),ine=u(2,(e,t)=>{let r=lt({onInput:n=>p(wk(n,t),w(Le),w(o=>le(o)?nr(()=>r):Fe(A(o),As())),Ce),onFailure:Ne,onDone:()=>re});return new L(or(D(e),r))}),ane=e=>p(e,Or(Z),Iu(t=>Rl($(t)))),Ru=new L(re),Tu=u(2,(e,t)=>new L(p(D(e),IS(t)))),cne=u(2,(e,t)=>new L(Md(D(e),t))),t0=()=>sr(Sx()),une=e=>p(t0(),Or(e)),pne=e=>p(t0(),yi(e)),hI=e=>p(t0(),hr(e)),$U=e=>Zx(sr(e)),ku=e=>eg(Fo(x(e))),mI=e=>eg(_k(()=>x(e()))),r0=e=>sr(Wt(e)),lne=e=>sr(sD(e)),fne=u(2,(e,t)=>$d(e,Bi(t))),VU=u(2,(e,t)=>{let r=n=>{let o=n.next();return o.done?Ae({onInput:s=>r(s[Symbol.iterator]()),onFailure:oe,onDone:dr}):p(t(o.value),w(s=>s?p(A(V(o.value)),k(()=>r(n))):r(n)),Ce)};return new L(nr(()=>p(D(e),pe(r(ee()[Symbol.iterator]())))))}),Tl=u(2,(e,t)=>$d(e,Vh(t))),dne=u(2,(e,t)=>kn(()=>{let r=n=>{let o=n.next();return o.done?Ae({onInput:s=>r(s[Symbol.iterator]()),onFailure:oe,onDone:dr}):p(t(o.value),j({onNone:()=>Ze(()=>r(n)),onSome:w(s=>k(A(V(s)),()=>r(n)))}),Ce)};return new L(p(D(e),pe(r(ee()[Symbol.iterator]()))))})),hne=u(2,(e,t)=>{let r=lt({onInput:n=>{let o=c4(n,t);return o.length===n.length?p(A(o),k(()=>r)):A(o)},onFailure:Ne,onDone:dr});return new L(p(D(e),or(r)))}),mne=u(2,(e,t)=>kn(()=>{let r=n=>{let o=n.next();return o.done?Ae({onInput:s=>r(s[Symbol.iterator]()),onFailure:oe,onDone:dr}):Ce(j(t(o.value),{onNone:()=>B(re),onSome:w(s=>k(A(V(s)),()=>r(n)))}))};return new L(p(D(e),or(r(ee()[Symbol.iterator]()))))})),xne=e=>vU(be,()=>e),gne=u(2,(e,t)=>{let r=lt({onInput:n=>j(iM(n,t),{onNone:()=>r,onSome:o=>A(V(o))}),onFailure:Ne,onDone:()=>re});return new L(p(D(e),pe(r)))}),bne=u(2,(e,t)=>{let r=lt({onInput:n=>p(nD(n,t),w(j({onNone:()=>r,onSome:o=>A(V(o))})),Ce),onFailure:Ne,onDone:()=>re});return new L(p(D(e),pe(r)))}),hr=u(e=>us(e[0]),(e,t,r)=>{let n=r?.bufferSize??16;return r?.switch?YS(r?.concurrency,()=>Rre(e,1,n,t),o=>Rre(e,o,n,t)):YS(r?.concurrency,()=>new L(ha(D(e),o=>p(o,bt(s=>D(t(s))),xf(re,(s,i)=>p(s,Fe(i)))))),o=>new L(p(D(e),ha(Gn),TL(s=>D(t(s)),r))))}),YS=(e,t,r)=>{switch(e){case void 0:return t();case"unbounded":return r(Number.MAX_SAFE_INTEGER);default:return e>1?r(e):t()}},Rre=u(4,(e,t,r,n)=>new L(p(D(e),ha(Gn),TL(o=>D(n(o)),{concurrency:t,mergeStrategy:wee(),bufferSize:r})))),Yx=u(e=>us(e[0]),(e,t)=>hr(e,R,t)),n0=e=>{let t=Ae({onInput:r=>k(Gn(r),()=>t),onFailure:oe,onDone:()=>re});return new L(p(D(e),pe(t)))},yne=u(e=>us(e[0]),(e,t)=>t?.unordered?hr(e,r=>sr(r),{concurrency:t.concurrency}):YS(t?.concurrency,()=>yi(e,R),r=>new L(p(D(e),ha(Gn),kL(R,r),qd(V))))),jd=e=>{let t=(n,o)=>{let[s,i]=p(n,nM(c=>!Yi(c))),a=p(va(i),j({onNone:()=>o,onSome:qt({onFailure:c=>j(Xm(c),{onNone:()=>re,onSome:oe}),onSuccess:()=>re})}));return p(A(p(s,Vh(c=>Yi(c)?x(c.value):g()))),k(()=>a))},r=Ae({onInput:n=>t(n,r),onFailure:n=>oe(n),onDone:()=>re});return new L(p(D(e),pe(r)))},Sne=e=>p(e,Or(pt),n0),Ml=e=>n0(jd(p(e,Or(t=>t.exit)))),xI=e=>new L(TT(D(e))),Ene=(e,t)=>p(wr(Ze(()=>e[Symbol.asyncIterator]()),r=>r.return?sS(async()=>r.return()):be),w(r=>Al(p(aS({try:async()=>r.next(),catch:n=>x(t(n))}),P(n=>n.done?Fo(g()):B(n.value))))),vs),Xx=e=>new L(e),D=e=>{if("channel"in e)return e.channel;if(di(e))return D(sr(e));throw new TypeError("Expected a Stream.")},Il=e=>new L(le(e)?re:A(e)),Cne=(e,t)=>{if(t?.scoped){let n=w(rc(e),iI);return t.shutdown?w(n,Tu(Rx(e))):n}let r=hr(Gd(rc(e)),iI);return t?.shutdown?Tu(r,Rx(e)):r},iI=(e,t)=>p($n(e),hi(r=>p(xS(e),P(n=>n&&aa(r)?KS():ZT(r)))),Au,t?.shutdown?Tu(Pt(e)):R),wne=(...e)=>p(tg(e),hr(Il)),sr=e=>p(e,mi(x),eg),eg=e=>new L(Ce(la(e,{onFailure:j({onNone:()=>re,onSome:Ne}),onSuccess:t=>A(V(t))}))),o0=(e,t)=>{let r=t?.maxChunkSize??Qx;if(t?.scoped){let o=w(rc(e),s=>bi(s,{maxChunkSize:r,shutdown:!0}));return t.shutdown?w(o,Tu(Rx(e))):o}let n=hr(Gd(rc(e)),o=>bi(o,{maxChunkSize:r}));return t?.shutdown?Tu(n,Rx(e)):n},One=e=>vs(w(dre(e),t=>KU(t))),tg=e=>kn(()=>df(e)?Il(e):GU(e[Symbol.iterator]())),_ne=e=>p(e,w(tg),vl),GU=(e,t=Qx)=>p(Ze(()=>{let r=[],n=o=>p(Ze(()=>{let s=o.next();if(t===1)return s.done?re:p(A(V(s.value)),k(()=>n(o)));r=[];let i=0;for(;s.done===!1&&(r.push(s.value),i=i+1,!(i>=t));)s=o.next();return i>0?p(A(Le(r)),k(()=>n(o))):re}),Ce);return new L(n(e))}),vl),s0=e=>p(e,w(Au),vs),bi=(e,t)=>p(Gk(e,1,t?.maxChunkSize??Qx),hi(r=>p(xS(e),P(n=>n&&aa(r)?KS():ZT(r)))),Au,t?.shutdown?Tu(Pt(e)):R),KU=e=>p(xre(e),w(V),hi(t=>p(mre(e),P(r=>r&&aa(t)?KS():ZT(t)))),Au),kne=e=>p(yl(e),w(t=>Al(t.next(void 0))),vl),Tne=(...e)=>{let t=e.length===1?e[0].evaluate:e[0],r=e.length===1?e[0].onError:e[1],n=e.length===1?e[0].releaseLockOnEnd===!0:!1;return vs(w(wr(Ze(()=>t().getReader()),o=>n?Ze(()=>o.releaseLock()):sS(()=>o.cancel())),o=>Al(P(aS({try:()=>o.read(),catch:s=>x(r(s))}),({done:s,value:i})=>s?Fo(g()):B(i)))))},Ine=(...e)=>{let t=e.length===1?e[0].evaluate:e[0],r=e.length===1?e[0].onError:e[1],n=(e.length===1?e[0].bufferSize:e[2])??4096,o=e.length===1?e[0].releaseLockOnEnd===!0:!1;return vs(w(wr(Ze(()=>t().getReader({mode:"byob"})),s=>o?Ze(()=>s.releaseLock()):sS(()=>s.cancel())),s=>Iu(xI(_Ie(s,r,n)),i=>i===Rne?Ru:ku(i))))},Rne=Symbol.for("effect/Stream/EOF"),_Ie=(e,t,r)=>{let n=new ArrayBuffer(r);return iq(0,o=>P(aS({try:()=>e.read(new Uint8Array(n,o,n.byteLength-o)),catch:s=>t(s)}),({done:s,value:i})=>{if(s)return Fo(Rne);let a=o+i.byteLength;return B([i,a>=n.byteLength?g():x(a)])}))},Ane=u(2,(e,t)=>{let r=(o,s)=>{if(le(s))return[o,ee()];let i=[],a=0,c=0,l,f=ee();switch(o._tag){case"Some":{let m=o.value;l=m[0];let y=!0;for(;y&&c<s.length;){let T=dt(s,c),C=t(T);if(!N(l,C)){let O=m[1],U=Le(Array.from(s).slice(a,c)),I=We(O,U);i.push([l,I]),l=C,a=c,y=!1}c=c+1}y&&(f=m[1]);break}case"None":{l=t(dt(s,c)),c=c+1;break}}for(;c<s.length;){let m=dt(s,c),y=t(m);N(l,y)||(i.push([l,Le(Array.from(s).slice(a,c))]),l=y,a=c),c=c+1}let d=We(f,Le(Array.from(s).slice(a,c))),h=Le(i);return[x([l,d]),h]},n=o=>Ae({onInput:s=>{let[i,a]=r(o,s);return le(a)?n(i):k(A(a),()=>n(i))},onFailure:s=>j(o,{onNone:()=>oe(s),onSome:i=>k(A(V(i)),()=>oe(s))}),onDone:s=>j(o,{onNone:()=>rr(s),onSome:i=>k(A(V(i)),()=>rr(s))})});return new L(or(D(e),n(g())))}),Mne=u(2,(e,t)=>p(e,p0(t),XS)),vne=u(3,(e,t,r)=>uI(e,zee(t),$L(r))),QU=u(2,(e,t)=>{let r=n=>p(MJ(n),w(j({onNone:()=>lt({onInput:o=>k(A(o),()=>r(n)),onFailure:Ne,onDone:()=>re}),onSome:qt({onFailure:oe,onSuccess:()=>re})})),Ce);return new L(xa(n=>t.pipe(yt(n),w(o=>D(e).pipe(pe(r(o)))))))}),Pne=u(2,(e,t)=>p(e,QU($a(t)))),Fne=u(2,(e,t)=>{let r=p(X$(t),w(j({onNone:()=>lt({onInput:n=>p(A(n),k(()=>r)),onFailure:Ne,onDone:()=>re}),onSome:n=>Ce(la(n,{onFailure:Ne,onSuccess:()=>re}))})),Ce);return new L(p(D(e),pe(r)))}),JU=()=>new L(As()),Nne=u(2,(e,t)=>p(e,ZU(t,xI(Rl(!0,!1))))),ZU=u(3,(e,t,r)=>{let n=o=>Ae({onInput:s=>k(J(Ht(o,JT(s))),()=>n(o)),onFailure:s=>J(Ht(o,wu(s))),onDone:()=>J(Ht(o,ba))});return new L(xa(o=>p(as(),lo(as()),pn(([s])=>D(e).pipe(ha(Gn),pe(n(s)),ss(o),yt(o))),pn(([s,i])=>D(t).pipe(ha(Gn),pe(n(i)),ss(o),yt(o))),w(([s,i])=>{let a=(c,l)=>Ae({onInput:f=>f&&!c?p(J(cs(s)),k(Gx({onEnd:()=>l?re:a(!0,l),onFailure:oe,onSuccess:d=>p(A(d),k(()=>a(c,l)))}))):!f&&!l?p(J(cs(i)),k(Gx({onEnd:()=>c?re:a(c,!0),onFailure:oe,onSuccess:d=>p(A(d),k(()=>a(c,l)))}))):a(c,l),onFailure:oe,onDone:()=>re});return p(D(r),ha(Gn),pe(a(!1,!1)))}))))}),YU=u(2,(e,t)=>new L(p(D(e),or(nr(()=>{let r=n=>Ae({onInput:o=>{let s=[],i=n;for(let a of o)i?(i=!1,s.push(a)):(s.push(t),s.push(a));return p(A(Le(s)),k(()=>r(i)))},onFailure:oe,onDone:()=>re});return r(!0)}))))),Dne=u(2,(e,{end:t,middle:r,start:n})=>p(Rl(n),oc(p(e,YU(r))),oc(Rl(t)))),Lne=u(2,(e,t)=>p(e,gI($a(t)))),gI=u(2,(e,t)=>new L(p(D(e),wL(t)))),XU=u(2,(e,t)=>new L(p(D(e),Aee(t)))),Une=(e,t)=>Bq(e,r=>x([r,t(r)])),Rl=(...e)=>tg(e),Or=u(2,(e,t)=>new L(p(D(e),qd(bt(t))))),bI=u(3,(e,t,r)=>{let n=o=>lt({onInput:s=>{let[i,a]=rM(s,o,r);return k(A(a),()=>n(i))},onFailure:Ne,onDone:()=>re});return new L(p(D(e),pe(n(t))))}),yI=u(3,(e,t,r)=>kn(()=>{let n=o=>lt({onInput:s=>p(Je(()=>{let i=[],a=c=>Ze(()=>{i.push(c)});return p(s,oS(o,(c,l)=>p(r(c,l),P(([f,d])=>p(a(d),Kt(f))))),la({onFailure:c=>i.length!==0?Fe(A(Le(i)),Ne(c)):Ne(c),onSuccess:c=>k(A(Le(i)),()=>n(c))}))}),Ce),onFailure:Ne,onDone:()=>re});return new L(p(D(e),or(n(t))))})),qne=u(2,(e,t)=>p(e,SI(t.onFailure),Or(t.onSuccess))),$d=u(2,(e,t)=>new L(p(D(e),qd(t)))),Wne=u(2,(e,t)=>new L(p(D(e),kT(t)))),Hne=u(2,(e,t)=>p(e,i0(r=>pt(t(r))))),i0=u(2,(e,t)=>p(e,$d(tM(t)))),Bne=u(2,(e,t)=>p(e,yi(t),i0(R))),zne=u(2,(e,t)=>p(e,yi(r=>p(t(r),w(pt))),i0(R))),yi=u(2,(e,t)=>{let r=n=>{let o=n.next();if(o.done)return Ae({onInput:s=>r(s[Symbol.iterator]()),onFailure:oe,onDone:dr});{let s=o.value;return Ce(w(t(s),i=>k(A(V(i)),()=>r(n))))}};return new L(p(D(e),pe(nr(()=>r(ee()[Symbol.iterator]())))))}),jne=u(3,(e,t,r)=>new L(p(D(e),ha(Gn),kL(r,t),qd(V)))),SI=u(2,(e,t)=>new L(p(D(e),OL(t)))),$ne=u(2,(e,t)=>new L(p(D(e),_L(t)))),a0=u(e=>us(e[1]),(e,t,r)=>CI(e,t,{onSelf:R,onOther:R,haltStrategy:r?.haltStrategy})),EI=u(e=>Symbol.iterator in e[0],(e,t)=>Yx(tg(e),t)),Vne=u(2,(e,t)=>{let n=Object.keys(e).map(o=>e[o].pipe(Or(s=>({_tag:o,value:s}))));return EI(n,t)}),eq=u(2,(e,t)=>CI(e,t,{onSelf:$,onOther:Z})),Gne=u(2,(e,t)=>p(e,a0(Zx(t)))),Kne=u(2,(e,t)=>p(Zx(e),a0(t))),CI=u(3,(e,t,r)=>{let n=r.haltStrategy?GL(r.haltStrategy):Ote,o=s=>i=>s||!Yi(i)?ite(Je(()=>i)):ate(a=>Je(()=>a));return new L(Wd(D(Or(e,r.onSelf)),{other:D(Or(t,r.onOther)),onSelfDone:o(n._tag==="Either"||n._tag==="Left"),onOtherDone:o(n._tag==="Either"||n._tag==="Right")}))}),Qne=e=>fo(e,ste),Jne=sr(bx),Zne=u(2,(e,t)=>oc(e,Zx(sr(t)))),Yne=u(2,(e,t)=>p(e,Jx(r=>sr(p(t(r),ue(Wt(r))))))),Xne=u(2,(e,t)=>new L(p(D(e),Md(r=>Yi(r)?t():be)))),eoe=u(2,(e,t)=>vl(Kt(t,e))),toe=e=>p(e,tq(R)),tq=u(2,(e,t)=>new L(p(D(e),Mee(t)))),c0=u(2,(e,t)=>new L(p(D(e),IL(()=>D(t()))))),roe=u(2,(e,t)=>p(e,Or($),c0(()=>p(t(),Or(Z))))),noe=u(2,(e,t)=>p(e,c0(()=>mI(t)))),ooe=u(2,(e,t)=>p(e,rq(()=>V(t())))),rq=u(2,(e,t)=>p(e,nq(()=>new L(A(t()))))),nq=u(2,(e,t)=>{let r=lt({onInput:n=>le(n)?nr(()=>r):p(A(n),Fe(As())),onFailure:Ne,onDone:()=>nr(()=>D(t()))});return new L(p(D(e),pe(r)))}),soe=u(2,(e,t)=>p(e,c0(()=>Pq(t)))),ioe=(e,t)=>oq(e,r=>{let n=t(r);return[V(n[0]),n[1]]}),oq=(e,t)=>{let r=n=>{let o=t(n);return j(o[1],{onNone:()=>Fe(A(o[0]),re),onSome:s=>k(A(o[0]),()=>r(s))})};return new L(nr(()=>r(e)))},sq=(e,t)=>{let r=n=>Ce(w(t(n),([o,s])=>j(s,{onNone:()=>Fe(A(o),re),onSome:i=>k(A(o),()=>r(i))})));return new L(nr(()=>r(e)))},iq=(e,t)=>sq(e,r=>p(t(r),w(([n,o])=>[V(n),o]))),aoe=u(2,(e,t)=>{let r="Emit",n="Halt";return p(wt(),P(s=>p(as(),w(i=>{let a=NL($ee(t),{onFailure:l=>nte(HL(Z$(s,l)),FL(l)),onSuccess:([l,f])=>{let d=Ae({onInput:h=>k(J(Ht(i,{_tag:r,elements:h})),()=>d),onFailure:h=>Fe(J(Ht(i,{_tag:n,cause:h})),oe(h)),onDone:h=>Fe(J(Ht(i,{_tag:"End"})),re)});return WL(p(J(Cr(s,l)),Fe(J(p(i,Ht({_tag:r,elements:f})))),Fe(d)))}}),c=p(cs(i),w(l=>{switch(l._tag){case r:return p(A(l.elements),k(()=>c));case n:return oe(l.cause);case"End":return re}}),Ce);return p(e,Lq(l=>Zf(s,l)),fo(a),cu,ue(He(s)),w(l=>[l,new L(c)]))}))),po)}),coe=u(e=>typeof e[1]=="function",(e,t,r)=>aq(e,n=>B(t(n)?Z(n):$(n)),r)),aq=u(e=>typeof e[1]=="function",(e,t,r)=>p(yi(e,t),WU({size:2,maximumLag:r?.bufferSize??16,decide:Xe({onLeft:()=>B(n=>n===0),onRight:()=>B(n=>n===1)})}),P(([n,o])=>B([Tl(jd(bi(n,{shutdown:!0})),s=>Xe(s,{onLeft:x,onRight:g})),Tl(jd(bi(o,{shutdown:!0})),s=>Xe(s,{onLeft:g,onRight:x}))])))),uoe=u(2,(e,t)=>new L(p(D(e),or(Kn(t))))),cq=u(2,(e,t)=>new L(pe(D(e),t))),poe=u(2,(e,t)=>new L(p(D(e),or(t)))),loe=u(2,(e,t)=>new L(Fe(A(t),D(e)))),wI=u(2,(e,t)=>new L(p(D(e),vd(t)))),uq=u(2,(e,t)=>OI(e,_o(t))),pq=u(2,(e,t)=>new L(xa(r=>OD(t,r).pipe(w(n=>p(D(e),vd(n))))))),foe=u(3,(e,t,r)=>u0(e,t,B(r))),u0=u(3,(e,t,r)=>lq(e,t,sr(r))),lq=u(3,(e,t,r)=>hI(n=>hr(r,o=>p(e,wI(qe(n,t,o)))))),OI=u(2,(e,t)=>hI(r=>p(e,wI(t(r))))),fq=u(2,(e,t)=>p(e,pq(p(vk(),_D(t))))),doe=(e,t,r=Qx)=>kn(()=>{if(e>t)return Ru;let n=(o,s,i)=>{let a=s-o+1;return a>i?p(A(SC(o,o+i-1)),k(()=>n(o+i,s,i))):A(SC(o,o+a-1))};return new L(n(e,t,r))}),hoe=u(2,(e,t)=>dq(e,t)),dq=(...e)=>wt().pipe(w(t=>{let r=null;return EI(e.map((n,o)=>n.pipe(Fq(()=>r===null?(r=o,e8(t,Bp),!0):r===o),gI(He(t).pipe(P(()=>r===o?bx:be))))),{concurrency:e.length})}),vl),p0=u(2,(e,t)=>kn(()=>{let r=Math.max(t,1),n=sI(new AU(r),r);return new L(p(D(e),pe(n)))})),sI=(e,t)=>Ae({onInput:r=>{if(r.length===t&&e.isEmpty())return k(A(r),()=>sI(e,t));if(r.length>0){let n=[],o,s=0;for(;s<r.length;){for(;s<r.length&&o===void 0;)o=e.write(p(r,dt(s))),s=s+1;o!==void 0&&(n.push(o),o=void 0)}return k(Lee(...n),()=>sI(e,t))}return nr(()=>sI(e,t))},onFailure:r=>Fe(e.emitIfNotEmpty(),oe(r)),onDone:()=>e.emitIfNotEmpty()}),AU=class{n;builder=[];pos=0;constructor(t){this.n=t}isEmpty(){return this.pos===0}write(t){if(this.builder.push(t),this.pos+=1,this.pos===this.n){let r=Le(this.builder);return this.builder=[],this.pos=0,r}}emitIfNotEmpty(){return this.pos!==0?A(Le(this.builder)):re}},moe=u(2,(e,t)=>p(e,hq(t,R))),hq=u(3,(e,t,r)=>new L(Ld(D(e),n=>j(t(n),{onNone:()=>oe(Bn(r(n))),onSome:Ne})))),xoe=u(2,(e,t)=>Tl(mq(e,t),r=>Xe(r,{onLeft:g,onRight:x}))),goe=e=>Al(p(e,mi(x))),boe=e=>Au(p(e,mi(x))),Au=e=>h0(e,t=>p(w(t,r=>x([r,t])),yx(j({onNone:()=>B(g()),onSome:Fo})))),Al=e=>Au(p(e,w(V))),mq=u(2,(e,t)=>gq(e,t,{onElement:r=>Z(r),onSchedule:$})),yoe=u(2,(e,t)=>Tl(xq(e,t,{onElement:r=>x(r),onSchedule:g}),R)),xq=u(3,(e,t,r)=>{let n=p(yl(t),w(o=>{let s=c=>j(va(c),{onNone:()=>a,onSome:l=>Fe(A(V(r.onElement(l))),i(p(c,$t(1)),l))}),i=(c,l)=>{let f=p(o.next(l),Kt(p(A(V(r.onElement(l))),k(()=>i(c,l))))),d=p(o.last,Ik,P(h=>p(o.reset,w(()=>p(A(V(r.onSchedule(h))),Fe(s(c)))))));return p(f,SD(()=>d),Ce)},a=lt({onInput:s,onFailure:Ne,onDone:()=>re});return a}),Ce);return new L(p(D(e),pe(n)))}),Soe=e=>new L(TT(A(V(e)))),gq=u(3,(e,t,r)=>p(yl(t),w(n=>{let o=u0(vT,_t(n.iterationMeta)),s=p(e,o,Or(r.onElement),D),i=Ce(la(n.next(void 0),{onFailure:()=>re,onSuccess:a=>k(s,()=>Fe(A(V(r.onSchedule(a))),i))}));return new L(Fe(s,i))}),vl)),kIe=(e,t)=>bq(B(e),t),bq=(e,t)=>hr(sr(lo(e,yl(t))),([r,n])=>{let o=gD(vT,_t(n.iterationMeta));return oc(d0(r),AI(r,s=>jn(n.next(s),{onFailure:B,onSuccess:()=>w(o(e),i=>x([i,i]))})))}),aI=u(2,(e,t)=>yl(t).pipe(w(r=>{let n=u0(vT,_t(r.iterationMeta)),o=D(n(e)).pipe(kT(s=>Kt(r.reset,s)),Ld(s=>r.next(s).pipe(la({onFailure:()=>Ne(s),onSuccess:()=>o}),Ce)));return o}),Ce,Xx)),Eoe=u(e=>us(e[0]),(e,t,r)=>kn(()=>{let n=r?.preventFallbackOnPartialStream??!1,o=0,s=g(),i=kn(()=>{let a=t.steps[o++];if(!a)return ku(vg(s));let c=ob(a.provide)?uq(e,a.provide):fq(e,a.provide),l=!1;if(X(s)){let f=s.value,d=!1,h=c;c=kn(()=>d?h:(d=!0,ku(f))),c=Are(aI(c,rS(a,!1)))}else{let f=rS(a,!0);c=f?Are(aI(c,f)):c}return Iu(n?$d(c,f=>(l=!0,f)):c,f=>n&&l?ku(f):(s=x(f),i))});return i})),Are=e=>Jx(e,t=>r0(JN(t))),fo=u(2,(e,t)=>D(e).pipe(or(Kn(t)),vee)),Coe=e=>fo(e,Hee()),woe=e=>fo(e,ote),Ooe=e=>fo(e,Vee),_oe=u(3,(e,t,r)=>yq(e,t,zr,r)),koe=u(3,(e,t,r)=>Sq(e,t,zr,r)),Toe=u(3,(e,t,r)=>p(e,Eq(t,zr,r))),Ioe=u(3,(e,t,r)=>p(e,Cq(t,zr,r))),yq=u(4,(e,t,r,n)=>fo(e,IT(t,r,n))),Sq=u(4,(e,t,r,n)=>fo(e,DL(t,r,n))),Eq=u(4,(e,t,r,n)=>p(e,Vd(IT(t,r,n)))),Cq=u(4,(e,t,r,n)=>p(e,Vd(DL(t,r,n)))),wq=u(2,(e,t)=>fo(e,LL(t))),Oq=u(2,(e,t)=>fo(e,UL(t))),Roe=u(2,(e,t)=>p(e,Vd(UL(t)))),_q=u(2,(e,t)=>p(e,Vd(LL(t)))),Aoe=u(2,(e,t)=>fo(e,qL(t))),Moe=u(2,(e,t)=>p(e,Vd(qL(t)))),voe=e=>fo(e,Xee()),Poe=u(2,(e,t)=>p(e,kq(t))),_I=u(2,(e,t)=>p(e,l0(t))),kq=u(2,(e,t)=>p(e,l0(t),fD)),Tq=u(2,(e,t)=>{let r=Ae({onInput:n=>k(J(ZD(t,bt(n,xe))),()=>r),onFailure:n=>J(Ve(t,st(Is(n,x)))),onDone:()=>J(Ve(t,At(g())))});return p(pe(D(e),r),ma,AS,uo)}),l0=u(2,(e,t)=>{let r=Ae({onInput:n=>k(A(Cu(n)),()=>r),onFailure:n=>A(wu(n)),onDone:()=>A(ba)});return p(pe(D(e),r),kT(n=>Ve(t,n)),ma,AS,uo)}),Foe=e=>fo(e,ete()),Vd=u(2,(e,t)=>p(D(e),or(Kn(t)),ma,AS)),Noe=e=>fo(e,rte),Doe=u(3,(e,t,r)=>p(e,Aq(t,(n,o)=>B(r(n,o))))),Loe=u(2,(e,t)=>p(e,Iq((r,n)=>B(t(r,n))))),Iq=u(2,(e,t)=>p(e,yI(g(),(r,n)=>{switch(r._tag){case"None":return B([x(n),n]);case"Some":return p(t(r.value,n),w(o=>[x(o),o]))}}))),Uoe=u(2,(e,t)=>Tl(Rq(e,t,{onElement:x,onSchedule:g}),R)),Rq=u(3,(e,t,r)=>{let n=(o,s)=>{let i=s.next();return i.done?Ae({onInput:a=>n(o,a[Symbol.iterator]()),onFailure:oe,onDone:rr}):Ce(jn(o.next(i.value),{onFailure:()=>p(o.last,Ik,w(a=>p(A(fp(r.onElement(i.value),r.onSchedule(a))),k(()=>n(o,s)))),dl(o.reset)),onSuccess:()=>B(p(A(V(r.onElement(i.value))),k(()=>n(o,s))))}))};return new L(p(J(yl(t)),k(o=>p(D(e),pe(n(o,ee()[Symbol.iterator]()))))))}),Aq=u(3,(e,t,r)=>new L(p(A(V(t)),k(()=>D(p(e,yI(t,(n,o)=>p(r(n,o),w(s=>[s,s]))))))))),Gd=e=>new L(IS(RL(p(e,w(V))),be)),f0=e=>new L(AL(t=>e(t).pipe(w(V)))),qoe=e=>p(e,SI(x),Mq(()=>g())),Woe=u(2,(e,t)=>p(e,Or(_e(t)))),Mq=u(2,(e,t)=>yi(e,j({onNone:()=>_k(t),onSome:B}))),Hoe=u(2,(e,t)=>vq(e,t,1)),vq=u(3,(e,t,r)=>t<=0||r<=0?dI(new Sd("Invalid bounds - `chunkSize` and `stepSize` must be greater than zero")):new L(nr(()=>{let n=new zx(t),o=(i,a)=>{if(i<t){let h=n.toChunk(),m=le(h)?ee():V(h);return p(A(m),k(()=>a))}let c=i-(i-t)%r;if(c===i)return a;let l=i-(c-t+r),f=p(n.toChunk(),u4(l)),d=le(f)?ee():V(f);return p(A(d),k(()=>a))},s=i=>Ae({onInput:a=>k(A(Vh(a,(c,l)=>{n.put(c);let f=i+l+1;return f<t||(f-t)%r>0?g():x(n.toChunk())})),()=>s(i+a.length)),onFailure:a=>o(i,oe(a)),onDone:()=>o(i,re)});return p(D(e),pe(s(0)))}))),Boe=u(2,(e,t)=>{let r=(o,s)=>{let[i,a]=p(o,We(s),nM(t));return le(i)||le(a)?n(p(i,We(p(a,$t(1))))):p(A(V(i)),k(()=>r(ee(),p(a,$t(1)))))},n=o=>lt({onInput:s=>r(o,s),onFailure:Ne,onDone:()=>le(o)?re:ge(p(o,iM(t)))?Fe(A(V(o)),re):Fe(r(ee(),o),re)});return new L(p(D(e),pe(n(ee()))))}),zoe=u(2,(e,t)=>{let r=(n,o)=>Ae({onInput:s=>{let i,[a,c]=p(s,xf([p(n,_e(()=>ee())),o],([f,d],h)=>{let m=p(f,Pn(h));return d<t.length&&N(h,p(t,dt(d)))?d+1===t.length?(i===void 0&&(i=[]),i.push(p(m,bs(m.length-t.length))),[ee(),0]):[m,d+1]:[m,N(h,p(t,dt(0)))?1:0]})),l=i===void 0?ee():Le(i);return k(A(l),()=>r(Vt(a)?x(a):g(),c))},onFailure:s=>j(n,{onNone:()=>oe(s),onSome:i=>Fe(A(V(i)),oe(s))}),onDone:s=>j(n,{onNone:()=>dr(s),onSome:i=>Fe(A(V(i)),dr(s))})});return new L(p(D(e),pe(r(g(),0))))}),joe=e=>cq(e,Pee()),d0=e=>Il(V(e)),Pq=e=>kn(()=>Il(V(e()))),kn=e=>new L(nr(()=>D(e()))),$oe=u(2,(e,t)=>{if(!Number.isInteger(t))return dI(new Sd(`${t} must be an integer`));let r=n=>lt({onInput:o=>{let s=p(o,bs(Math.min(n,Number.POSITIVE_INFINITY))),i=Math.max(0,n-s.length);return i>0?p(A(s),k(()=>r(i))):A(s)},onFailure:Ne,onDone:dr});return new L(p(D(e),or(0<t?r(t):re)))}),Voe=u(2,(e,t)=>t<=0?Ru:new L(p(B(new zx(t)),w(r=>{let n=lt({onInput:o=>{for(let s of o)r.put(s);return n},onFailure:Ne,onDone:()=>p(A(r.toChunk()),Fe(re))});return p(D(e),pe(n))}),Ce))),Goe=u(2,(e,t)=>{let r=lt({onInput:n=>{let o=p(n,oM(i=>!t(i))),s=p(n,$t(o.length),bs(1));return le(s)?p(A(o),k(()=>r)):A(p(o,We(s)))},onFailure:Ne,onDone:dr});return new L(p(D(e),or(r)))}),Koe=u(2,(e,t)=>{let r=n=>{let o=n.next();return o.done?Ae({onInput:s=>r(s[Symbol.iterator]()),onFailure:oe,onDone:dr}):p(t(o.value),w(s=>s?A(V(o.value)):p(A(V(o.value)),k(()=>r(n)))),Ce)};return new L(p(D(e),pe(r(ee()[Symbol.iterator]()))))}),Fq=u(2,(e,t)=>{let r=lt({onInput:n=>{let o=p(n,oM(t));return o.length===n.length?p(A(o),k(()=>r)):A(o)},onFailure:Ne,onDone:dr});return new L(p(D(e),or(r)))}),Nq=u(2,(e,t)=>yi(e,r=>Kt(t(r),r))),Qoe=u(2,(e,t)=>p(e,Dq(t.onFailure),Nq(t.onSuccess))),Dq=u(2,(e,t)=>Iu(e,r=>sr(ue(t(r),Fo(r))))),Lq=u(2,(e,t)=>{let r=Ae({onInput:n=>k(A(n),()=>r),onFailure:n=>J(ue(t(n),Wt(n))),onDone:rr});return new L(p(D(e),pe(r)))}),Joe=u(2,(e,t)=>p(sr(Po([os(1),wt()])),hr(([r,n])=>{let o=Ml(bi(r,{maxChunkSize:1})),s=Ae({onInput:i=>p(J(Ve(r,Cu(i))),Fx({onFailure:()=>k(A(i),()=>As()),onSuccess:()=>k(A(i),()=>s)})),onFailure:i=>p(J(Ve(r,wu(i))),Fx({onFailure:()=>oe(i),onSuccess:()=>oe(i)})),onDone:()=>p(J(Ve(r,ba)),Fx({onFailure:()=>re,onSuccess:()=>re}))});return p(new L(p(pe(D(e),s),IS(ue(ul(Ve(r,ba)),He(n))))),a0($U(p(fo(o,t),pa(ue(Pt(r),Cr(n,void 0)))))))}))),Zoe=u(2,(e,t)=>Uq(e,{...t,cost:r=>B(t.cost(r))})),Uq=u(2,(e,t)=>t.strategy==="enforce"?TIe(e,t.cost,t.units,t.duration,t.burst??0):IIe(e,t.cost,t.units,t.duration,t.burst??0)),TIe=(e,t,r,n,o)=>{let s=(a,c)=>Ae({onInput:l=>p(t(l),lo(ea),w(([f,d])=>{let m=(d-c)/Kr(n),y=a+m*r,T=r+o<0?Number.POSITIVE_INFINITY:r+o,C=y<0?T:Math.min(y,T);return f<=C?p(A(l),k(()=>s(C-f,d))):s(a,c)}),Ce),onFailure:oe,onDone:()=>re}),i=p(ea,w(a=>s(r,a)),Ce);return new L(p(D(e),or(i)))},IIe=(e,t,r,n,o)=>{let s=(a,c)=>Ae({onInput:l=>p(t(l),lo(ea),w(([f,d])=>{let m=(d-c)/Kr(n),y=a+m*r,T=r+o<0?Number.POSITIVE_INFINITY:r+o,O=(y<0?T:Math.min(y,T))-f,U=O>=0?0:-O/r,I=wn(Math.max(0,U*Kr(n)));return OC(I,Pa)?p(J($a(I)),Fe(A(l)),k(()=>s(O,d))):k(A(l),()=>s(O,d))}),Ce),onFailure:oe,onDone:()=>re}),i=p(ea,w(a=>s(r,a)),Ce);return new L(p(D(e),or(i)))},Yoe=e=>kIe(void 0,$L(e)),Xoe=u(2,(e,t)=>p(zd(e),w(mD({onTimeout:()=>g(),duration:t})),s0)),ese=u(3,(e,t,r)=>p(e,Wq(r,mI(t)))),qq=u(3,(e,t,r)=>p(zd(e),w(xD({onTimeout:()=>Is(t(),x),duration:r})),s0)),Wq=u(3,(e,t,r)=>{let n=new M_("Stream Timeout");return p(e,qq(()=>Bn(n),t),UU(o=>R_(o)&&FQ(o.defect)&&o.defect.message!==void 0&&o.defect.message==="Stream Timeout"?x(r):g()))}),tse=e=>{if(typeof e=="number")return mS(e);if(e.capacity==="unbounded")return jk({replay:e.replay});switch(e.strategy){case"dropping":return HX(e);case"sliding":return BX(e);default:return mS(e)}},kI=u(2,(e,t)=>p(wr(tse(t),r=>Rx(r)),pn(r=>p(e,_I(r),cu)))),zd=e=>w(Nee(D(e)),t=>p(t,mi(x),P(Xe({onLeft:()=>Fo(g()),onRight:B})))),TI=u(e=>us(e[0]),(e,t)=>pn(wr(t?.strategy==="unbounded"?hl():t?.strategy==="dropping"?Ax(t.capacity??2):t?.strategy==="sliding"?Mx(t.capacity??2):os(t?.capacity??2),r=>Pt(r)),r=>cu(l0(e,r)))),Hq=u(e=>us(e[0]),(e,t)=>pn(wr(os(t?.capacity??2),r=>Pt(r)),r=>cu(Tq(e,r)))),rse=u(e=>us(e[0]),(e,t)=>II(e,MT,t)),nse=u(e=>us(e[0]),(e,t)=>w(pu(),r=>II(e,r,t))),II=u(e=>us(e[0]),(e,t,r)=>{let n=AT(t),o,s,i=Rk(!1);return new ReadableStream({start(a){s=n(Oq(e,c=>c.length===0?be:i.whenOpen(Ze(()=>{i.unsafeClose();for(let l of c)a.enqueue(l);o(),o=void 0})))),s.addObserver(c=>{try{c._tag==="Failure"?a.error(ex(c.cause)):a.close()}catch{}})},pull(){return new Promise(a=>{o=a,Ox(i.open)})},cancel(){if(s)return lu(uo(_n(s)))}},r?.strategy)}),ose=u(2,(e,t)=>{let r=nr(()=>{let n={ref:ee()},o={ref:!1},s=nr(()=>{let l=n.ref;return le(l)?lt({onInput:f=>p(A(f),k(()=>s)),onFailure:Ne,onDone:rr}):(n.ref=ee(),p(Gn(l),k(()=>s)))}),i=l=>{let f=n.ref,d=We(f,Bi(l,h=>h.length!==0));return n.ref=d,d},a=lt({onInput:l=>k(A(l),()=>a),onFailure:Ne,onDone:l=>Fe(du(()=>{o.ref=!0}),rr(l))}),c=p(t,Kn,fu,k(([l,f])=>p(dr([o.ref,i(l)]),k(([d,h])=>{let m=d&&le(h)?re:c;return p(A(V(f)),k(()=>m))}))));return p(D(e),pe(a),pe(s),or(c))});return new L(r)}),RI=u(e=>us(e[0]),(e,t)=>{let r=AT(t);return{[Symbol.asyncIterator](){let n,o,s,i=Rk(!1),a=!1;return{next(){return s||(s=r(wq(e,c=>i.whenOpen(Ze(()=>{i.unsafeClose(),n({done:!1,value:c}),n=o=void 0})))),s.addObserver(c=>{a||(s=Td(i.whenOpen(Ze(()=>{c._tag==="Failure"?o(ex(c.cause)):n({done:!0,value:void 0}),n=o=void 0}))))})),new Promise((c,l)=>{n=c,o=l,i.unsafeOpen()})},return(){return a=!0,s?lu(Kt(_n(s),{done:!0,value:void 0})):Promise.resolve({done:!0,value:void 0})}}}}}),sse=e=>RI(e,MT),ise=e=>w(pu(),t=>RI(e,t)),Bq=(e,t)=>zq(e,r=>p(t(r),ct(([n,o])=>[V(n),o]))),zq=(e,t)=>{let r=n=>j(t(n),{onNone:()=>re,onSome:([o,s])=>k(A(o),()=>r(s))});return new L(nr(()=>r(e)))},h0=(e,t)=>kn(()=>{let r=n=>Ce(w(t(n),j({onNone:()=>re,onSome:([o,s])=>k(A(o),()=>r(s))})));return new L(r(e))}),AI=(e,t)=>h0(e,r=>p(t(r),w(ct(([n,o])=>[V(n),o])))),ase=d0(void 0);var vl=e=>Yx(sr(e)),vs=e=>Yx(Gd(e)),rg=e=>Yx(f0(t=>e(t))),cse=u(3,(e,t,r)=>p(e,OI(n=>p(n,qe(t,r(p(n,vn(t)))))))),use=u(2,(e,t)=>p(e,$q(Ze(t)))),pse=(e,t)=>jq(t)(Ze(e)),jq=u(2,(e,t)=>p(sr(e),hr(r=>p(t(r),_e(()=>Ru))))),$q=u(2,(e,t)=>p(sr(t),hr(r=>r?e:Ru))),lse=function(){let e=typeof arguments[0]!="string",t=e?arguments[1]:arguments[0],r=Un(e?arguments[2]:arguments[1]);if(e){let n=arguments[0];return new L(ML(D(n),t,r))}return n=>new L(ML(D(n),t,r))},fse=u(2,(e,t)=>p(e,vI(t,(r,n)=>[r,n]))),dse=u(2,(e,t)=>p(e,vI(t,(r,n)=>[...r,n]))),hse=u(2,(e,t)=>x0(e,{other:t.other,onSelf:r=>[r,t.defaultOther],onOther:r=>[t.defaultSelf,r],onBoth:(r,n)=>[r,n]})),mse=u(3,(e,t,r)=>x0(e,{other:t,onSelf:R,onOther:()=>r,onBoth:n=>n})),xse=u(3,(e,t,r)=>x0(e,{other:t,onSelf:()=>r,onOther:R,onBoth:(n,o)=>o})),gse=u(2,(e,t)=>m0(e,{other:t.other,onSelf:r=>[r,t.defaultOther],onOther:r=>[t.defaultSelf,r],onBoth:(r,n)=>[r,n],order:t.order})),bse=u(2,(e,t)=>m0(e,{other:t.other,onSelf:R,onOther:()=>t.defaultSelf,onBoth:r=>r,order:t.order})),yse=u(2,(e,t)=>m0(e,{other:t.other,onSelf:()=>t.defaultOther,onOther:R,onBoth:(r,n)=>n,order:t.order})),m0=u(2,(e,t)=>{let r=(o,s,i)=>{switch(o._tag){case XT:return p(s,la({onFailure:At,onSuccess:a=>xe([bt(a,([c,l])=>[c,t.onSelf(l)]),wl])}));case eI:return p(i,la({onFailure:At,onSuccess:a=>xe([bt(a,([c,l])=>[c,t.onOther(l)]),Ol])}));case tI:return p(kl(s),lo(kl(i),{concurrent:!0}),jn({onFailure:a=>B(At(x(a))),onSuccess:([a,c])=>X(a)&&X(c)?le(a.value)&&le(c.value)?r(_l,s,i):le(a.value)?r(Ou(c.value),s,i):le(c.value)?r(_u(a.value),s,i):B(xe(n(a.value,c.value))):X(a)&&ge(c)?le(a.value)?r(wl,s,i):B(xe([p(a.value,bt(([l,f])=>[l,t.onSelf(f)])),wl])):ge(a)&&X(c)?le(c.value)?r(Ol,s,i):B(xe([p(c.value,bt(([l,f])=>[l,t.onOther(f)])),Ol])):B(At(g()))}));case rI:return jn(s,{onFailure:j({onNone:()=>B(xe([p(o.rightChunk,bt(([a,c])=>[a,t.onOther(c)])),Ol])),onSome:a=>B(At(x(a)))}),onSuccess:a=>le(a)?r(Ou(o.rightChunk),s,i):B(xe(n(a,o.rightChunk)))});case nI:return jn(i,{onFailure:j({onNone:()=>B(xe([bt(o.leftChunk,([a,c])=>[a,t.onSelf(c)]),wl])),onSome:a=>B(At(x(a)))}),onSuccess:a=>le(a)?r(_u(o.leftChunk),s,i):B(xe(n(o.leftChunk,a)))})}},n=(o,s)=>{let i=(U,I)=>I<U.length-1,a=[],c,l=0,f=0,d=p(o,dt(l)),h=p(s,dt(f)),m=d[0],y=d[1],T=h[0],C=h[1],O=!0;for(;O;){let U=t.order(m,T);if(U===0)a.push([m,t.onBoth(y,C)]),i(o,l)&&i(s,f)?(l=l+1,f=f+1,d=p(o,dt(l)),h=p(s,dt(f)),m=d[0],y=d[1],T=h[0],C=h[1]):i(o,l)?(c=_u(p(o,$t(l+1))),O=!1):i(s,f)?(c=Ou(p(s,$t(f+1))),O=!1):(c=_l,O=!1);else if(U<0)if(a.push([m,t.onSelf(y)]),i(o,l))l=l+1,d=p(o,dt(l)),m=d[0],y=d[1];else{let I=[];for(I.push(h);i(s,f);)f=f+1,h=p(s,dt(f)),I.push(h);c=Ou(Le(I)),O=!1}else if(a.push([T,t.onOther(C)]),i(s,f))f=f+1,h=p(s,dt(f)),T=h[0],C=h[1];else{let I=[];for(I.push(d);i(o,l);)l=l+1,d=p(o,dt(l)),I.push(d);c=_u(Le(I)),O=!1}}return[Le(a),c]};return e0(e,t.other,_l,r)}),x0=u(2,(e,t)=>{let r=(o,s,i)=>{switch(o._tag){case XT:return jn(s,{onFailure:a=>B(At(a)),onSuccess:a=>B(xe([bt(a,t.onSelf),wl]))});case eI:return jn(i,{onFailure:a=>B(At(a)),onSuccess:a=>B(xe([bt(a,t.onOther),Ol]))});case tI:return p(kl(s),lo(kl(i),{concurrent:!0}),jn({onFailure:a=>B(At(x(a))),onSuccess:([a,c])=>X(a)&&X(c)?le(a.value)&&le(c.value)?r(_l,s,i):le(a.value)?r(Ou(c.value),s,i):le(c.value)?r(_u(a.value),s,i):B(xe(n(a.value,c.value,t.onBoth))):X(a)&&ge(c)?B(xe([bt(a.value,t.onSelf),wl])):ge(a)&&X(c)?B(xe([bt(c.value,t.onOther),Ol])):B(At(g()))}));case rI:return jn(s,{onFailure:j({onNone:()=>B(xe([bt(o.rightChunk,t.onOther),Ol])),onSome:a=>B(At(x(a)))}),onSuccess:a=>le(a)?r(Ou(o.rightChunk),s,i):le(o.rightChunk)?r(_u(a),s,i):B(xe(n(a,o.rightChunk,t.onBoth)))});case nI:return jn(i,{onFailure:j({onNone:()=>B(xe([bt(o.leftChunk,t.onSelf),wl])),onSome:a=>B(At(x(a)))}),onSuccess:a=>le(a)?r(_u(o.leftChunk),s,i):le(o.leftChunk)?r(Ou(a),s,i):B(xe(n(o.leftChunk,a,t.onBoth)))})}},n=(o,s,i)=>{let[a,c]=Ose(o,s,i);switch(c._tag){case"Left":return le(c.left)?[a,_l]:[a,_u(c.left)];case"Right":return le(c.right)?[a,_l]:[a,Ou(c.right)]}};return e0(e,t.other,_l,r)}),Sse=u(2,(e,t)=>p(e,MI(t,(r,n)=>[r,n]))),Vq=(...e)=>{if(e.length===0)return Ru;if(e.length===1)return Or(e[0],n=>[n]);let[t,...r]=e;return MI(t,Vq(...r),(n,o)=>[n,...o])},MI=u(3,(e,t,r)=>{let n=o=>p(o,P(s=>le(s)?n(o):B(s)));return p(zd(e),w(n),lo(p(zd(t),w(n))),P(([o,s])=>p(eg(ll(o,s,{onSelfDone:(i,a)=>p(Je(()=>i),fa(vo(a),(c,l)=>[c,l,!0])),onOtherDone:(i,a)=>p(Je(()=>i),fa(vo(a),(c,l)=>[l,c,!1]))})),hr(([i,a,c])=>p(sr(tr([hf(i),hf(a)])),hr(l=>p(Il(c?p(a,bt(f=>r(hf(i),f))):p(i,bt(f=>r(f,hf(a))))),oc(p(Al(o),eq(Al(s)),yi(Xe({onLeft:f=>Yo(l,([d,h])=>[p(f,bt(m=>r(m,h))),[hf(f),h]]),onRight:f=>Yo(l,([d,h])=>[p(f,bt(m=>r(d,m))),[d,hf(f)]])})),hr(Il))))))),zd)),s0)}),Ese=u(2,(e,t)=>p(e,g0(t,(r,n)=>r.length>n.length?[p(r,bs(n.length)),$(p(r,bs(n.length)))]:[r,Z(p(n,$t(r.length)))]))),Cse=u(2,(e,t)=>p(e,g0(t,(r,n)=>r.length>n.length?[n,$(p(r,bs(n.length)))]:[p(n,bs(r.length)),Z(p(n,$t(r.length)))]))),vI=u(3,(e,t,r)=>p(e,g0(t,(n,o)=>Ose(n,o,r)))),g0=u(3,(e,t,r)=>{let n=(s,i,a)=>{switch(s._tag){case TU:return p(kl(i),lo(kl(a),{concurrent:!0}),jn({onFailure:c=>B(At(x(c))),onSuccess:([c,l])=>X(c)&&X(l)?le(c.value)&&le(l.value)?n(QS,i,a):le(c.value)?n(JS(l.value),i,a):le(l.value)?n(ZS(c.value),i,a):B(xe(o(c.value,l.value))):B(At(g()))}));case IU:return jn(i,{onFailure:c=>B(At(c)),onSuccess:c=>le(c)?n(JS(s.rightChunk),i,a):le(s.rightChunk)?n(ZS(c),i,a):B(xe(o(c,s.rightChunk)))});case RU:return jn(a,{onFailure:c=>B(At(c)),onSuccess:c=>le(c)?n(ZS(s.leftChunk),i,a):le(s.leftChunk)?n(JS(c),i,a):B(xe(o(s.leftChunk,c)))})}},o=(s,i)=>{let[a,c]=r(s,i);switch(c._tag){case"Left":return le(c.left)?[a,QS]:[a,ZS(c.left)];case"Right":return le(c.right)?[a,QS]:[a,JS(c.right)]}};return p(e,e0(t,QS,n))}),Gq=e=>p(e,bI(0,(t,r)=>[t+1,[r,t]])),Kq=e=>{let t=r=>Ae({onInput:n=>{let[o,s]=rM(n,r,(a,c)=>[x(c),p(a,ct(l=>[l,c]))]),i=Vh(s,a=>X(a)?x([a.value[0],x(a.value[1])]):g());return k(A(i),()=>t(o))},onFailure:oe,onDone:()=>j(r,{onNone:()=>re,onSome:n=>Fe(A(V([n,g()])),re)})});return new L(p(D(e),or(t(g()))))},Qq=e=>p(e,bI(g(),(t,r)=>[x(r),[t,r]])),wse=e=>p(Kq(Qq(e)),Or(([[t,r],n])=>[t,r,p(n,ct(o=>o[1]))])),Ose=(e,t,r)=>e.length>t.length?[p(e,bs(t.length),sM(t,r)),$(p(e,$t(t.length)))]:[p(e,sM(p(t,bs(e.length)),r)),Z(p(t,$t(e.length)))],_se=d0({}),kse=u(e=>typeof e[0]!="string",(e,t,r,n)=>hr(e,o=>Or(r(o),s=>({...o,[t]:s})),n)),Tse=ph(Or),Ise=uh(Or);var Rse=u(e=>us(e[0]),(e,t="utf-8")=>kn(()=>{let r=new TextDecoder(t);return Or(e,n=>r.decode(n))})),Ase=e=>kn(()=>{let t=new TextEncoder;return Or(e,r=>t.encode(r))}),Mse=(e,t,r)=>NU(n=>wr(Ze(()=>e.addEventListener(t,n.single,r)),()=>Ze(()=>e.removeEventListener(t,n.single,r))),{bufferSize:typeof r=="object"?r.bufferSize:void 0});var vse=Zv;var Fse="effect/Redacted",ng=ne("effect/Redacted/redactedRegistry",()=>new WeakMap),Zq=Symbol.for(Fse),RIe={[Zq]:{_A:e=>e},pipe(){return v(this,arguments)},toString(){return"<redacted>"},toJSON(){return"<redacted>"},[he](){return"<redacted>"},[H](){return p(M(Fse),G(M(ng.get(this))),se(this))},[W](e){return Yq(e)&&N(ng.get(this),ng.get(e))}},Yq=e=>F(e,Zq),Nse=e=>{let t=Object.create(RIe);return ng.set(t,e),t},Dse=e=>{if(ng.has(e))return ng.get(e);throw new Error("Unable to get redacted value")};var MIe="effect/Config",Lse=Symbol.for(MIe),vIe={_A:e=>e},Xq={...ki,[Lse]:vIe,commit(){return U8(this)}};var Use=u(2,(e,t)=>{let r=Object.create(Xq);return r._tag=jw,r.original=e,r.mapOrFail=t,r}),qse=u(2,(e,t)=>{let r=Object.create(Xq);return r._tag=$w,r.name=t,r.config=e,r});var Wse=(e,t)=>{let r=Object.create(Xq);return r._tag=Vw,r.description=e,r.parse=t,r};var Hse=e=>{let t=Wse("a text property",Z);return e===void 0?t:qse(t,e)};var Bse=Use;var zse=Hse;var eW=hx;var $se=KZ,Vse=QZ,Gse=JZ,Kse=RN,tW=ZZ;var Qse=dx,Jse=AN,Zse=MN;var Yse=YZ;var rW=vN,nW=Zy;var Xse=PN,eie=eY;var tie=Yy;var rie=DN;var nie=rY;var oie=UN;var oW=Symbol.for("effect/Encoding/errors/Decode"),Si=(e,t)=>{let r={_tag:"DecodeException",[oW]:oW,input:e};return cr(t)&&(r.message=t),r};var sW=Symbol.for("effect/Encoding/errors/Encode"),iie=(e,t)=>{let r={_tag:"EncodeException",[sW]:sW,input:e};return cr(t)&&(r.message=t),r};var PI=new TextEncoder,FI=new TextDecoder;var b0=e=>{let t=e.length,r="",n;for(n=2;n<t;n+=3)r+=Mu[e[n-2]>>2],r+=Mu[(e[n-2]&3)<<4|e[n-1]>>4],r+=Mu[(e[n-1]&15)<<2|e[n]>>6],r+=Mu[e[n]&63];return n===t+1&&(r+=Mu[e[n-2]>>2],r+=Mu[(e[n-2]&3)<<4],r+="=="),n===t&&(r+=Mu[e[n-2]>>2],r+=Mu[(e[n-2]&3)<<4|e[n-1]>>4],r+=Mu[(e[n-1]&15)<<2],r+="="),r},DI=e=>{let t=iW(e),r=t.length;if(r%4!==0)return $(Si(t,`Length must be a multiple of 4, but is ${r}`));let n=t.indexOf("=");if(n!==-1&&(n<r-2||n===r-2&&t[r-1]!=="="))return $(Si(t,"Found a '=' character, but it is not at the end"));try{let o=t.endsWith("==")?2:t.endsWith("=")?1:0,s=new Uint8Array(3*(r/4)-o);for(let i=0,a=0;i<r;i+=4,a+=3){let c=NI(t.charCodeAt(i))<<18|NI(t.charCodeAt(i+1))<<12|NI(t.charCodeAt(i+2))<<6|NI(t.charCodeAt(i+3));s[a]=c>>16,s[a+1]=c>>8&255,s[a+2]=c&255}return Z(s)}catch(o){return $(Si(t,o instanceof Error?o.message:"Invalid input"))}},iW=e=>e.replace(/[\n\r]/g,"");function NI(e){if(e>=aie.length)throw new TypeError(`Invalid character ${String.fromCharCode(e)}`);let t=aie[e];if(t===255)throw new TypeError(`Invalid character ${String.fromCharCode(e)}`);return t}var Mu=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],aie=[255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,62,255,255,255,63,52,53,54,55,56,57,58,59,60,61,255,255,255,0,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];var aW=e=>b0(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),uie=e=>{let t=iW(e),r=t.length;if(r%4===1)return $(Si(t,`Length should be a multiple of 4, but is ${r}`));if(!/^[-_A-Z0-9]*?={0,2}$/i.test(t))return $(Si(t,"Invalid input"));let n=r%4===2?`${t}==`:r%4===3?`${t}=`:t;return n=n.replace(/-/g,"+").replace(/_/g,"/"),DI(n)};var cW=e=>{let t="";for(let r=0;r<e.length;++r)t+=DIe[e[r]];return t},lie=e=>{let t=new TextEncoder().encode(e);if(t.length%2!==0)return $(Si(e,`Length must be a multiple of 2, but is ${t.length}`));try{let r=t.length/2,n=new Uint8Array(r);for(let o=0;o<r;o++){let s=pie(t[o*2]),i=pie(t[o*2+1]);n[o]=s<<4|i}return Z(n)}catch(r){return $(Si(e,r instanceof Error?r.message:"Invalid input"))}},DIe=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],pie=e=>{if(48<=e&&e<=57)return e-48;if(97<=e&&e<=102)return e-97+10;if(65<=e&&e<=70)return e-65+10;throw new TypeError("Invalid input")};var uW=e=>typeof e=="string"?b0(PI.encode(e)):b0(e),pW=e=>DI(e),fie=e=>Eh(pW(e),t=>FI.decode(t)),lW=e=>typeof e=="string"?aW(PI.encode(e)):aW(e),fW=e=>uie(e),die=e=>Eh(fW(e),t=>FI.decode(t)),dW=e=>typeof e=="string"?cW(PI.encode(e)):cW(e),hW=e=>lie(e),hie=e=>Eh(hW(e),t=>FI.decode(t)),mie=e=>Sh({try:()=>encodeURIComponent(e),catch:t=>qIe(e,t instanceof Error?t.message:"Invalid input")}),xie=e=>Sh({try:()=>decodeURIComponent(e),catch:t=>UIe(e,t instanceof Error?t.message:"Invalid input")});var UIe=Si;var qIe=iie;var WIe="effect/GroupBy",bie=Symbol.for(WIe),HIe={_R:e=>e,_E:e=>e,_K:e=>e,_V:e=>e},BIe=e=>F(e,bie),zIe=u(e=>BIe(e[0]),(e,t,r)=>hr(e.grouped,([n,o])=>t(n,Ml(bi(o,{shutdown:!0}))),{concurrency:"unbounded",bufferSize:r?.bufferSize??16}));var yie=e=>({[bie]:HIe,pipe(){return v(this,arguments)},grouped:e}),Sie=u(e=>us(e[0]),(e,t,r)=>yie(vs(ao(function*(){let n=yield*wt(),o=yield*wr(os(r?.bufferSize??16),a=>Pt(a)),s=yield*tr(new Map),i=yield*p(yi(e,t),BU(r?.bufferSize??16,([a,c])=>P(He(n),l=>l(a,c)),a=>Ve(o,a)));return yield*Cr(n,(a,c)=>p(_t(s),w(l=>br(l.get(a))),P(j({onNone:()=>P(i,([l,f])=>ue(Os(s,d=>d.set(a,l)),p(Ve(o,xe([a,jIe(f,d=>new Cl(p(d,bm(h=>V(h[1])))))])),Kt(d=>d===l)))),onSome:l=>B(f=>f===l)})))),jd(bi(o,{shutdown:!0}))})))),xW=u(e=>typeof e[0]!="function",(e,t,r)=>r?.key?zIe(gW(e,r.key,{bufferSize:r.bufferSize}),(n,o)=>yi(o,t)):YS(r?.concurrency,()=>yi(e,t),n=>r?.unordered?hr(e,o=>sr(t(o)),{concurrency:n}):jne(e,n,t))),Eie=u(e=>typeof e[0]!="string",(e,t,r,n)=>xW(e,o=>w(r(o),s=>({...o,[t]:s})),n)),jIe=(e,t)=>new mW(e,t),mW=class extends cn{dequeue;f;[zX]={_Out:t=>t};constructor(t,r){super(),this.dequeue=t,this.f=r}capacity(){return jX(this.dequeue)}get size(){return Vk(this.dequeue)}unsafeSize(){return this.dequeue.unsafeSize()}get awaitShutdown(){return GX(this.dequeue)}isActive(){return this.dequeue.isActive()}get isShutdown(){return xS(this.dequeue)}get shutdown(){return Pt(this.dequeue)}get isFull(){return VX(this.dequeue)}get isEmpty(){return $X(this.dequeue)}get take(){return p($n(this.dequeue),w(t=>this.f(t)))}get takeAll(){return p(QX(this.dequeue),w(bt(t=>this.f(t))))}takeUpTo(t){return p(JX(this.dequeue,t),w(bt(r=>this.f(r))))}takeBetween(t,r){return p(Gk(this.dequeue,t,r),w(bt(n=>this.f(n))))}takeN(t){return p(ZX(this.dequeue,t),w(bt(r=>this.f(r))))}poll(){return p(KX(this.dequeue),w(ct(t=>this.f(t))))}pipe(){return v(this,arguments)}commit(){return this.take}},gW=u(e=>typeof e[0]!="function",(e,t,r)=>{let n=(o,s)=>Ae({onInput:i=>k(J(Br($Ie(i,t),([a,c])=>{let l=o.get(a);return l===void 0?p(os(r?.bufferSize??16),P(f=>p(Ze(()=>{o.set(a,f)}),ue(Ve(s,JT([a,f]))),ue(p(Ve(f,Cu(c)),kd(d=>A_(d)?x(be):g())))))):kd(Ve(l,Cu(c)),f=>A_(f)?x(be):g())},{discard:!0})),()=>n(o,s)),onFailure:i=>J(Ve(s,wu(i))),onDone:()=>J(p(Br(o.entries(),([i,a])=>p(Ve(a,ba),kd(c=>A_(c)?x(be):g())),{discard:!0}),ue(Ve(s,ba))))});return yie(rg(o=>ao(function*(){let s=new Map,i=yield*hl();return yield*su(o,Pt(i)),yield*D(e).pipe(pe(n(s,i)),ma,ss(o),yt(o),Kt(Ml(bi(i,{shutdown:!0}))))})))}),$Ie=u(2,(e,t)=>{let r=[],n=e[Symbol.iterator](),o=new Map,s;for(;(s=n.next())&&!s.done;){let i=s.value,a=t(i);if(o.has(a))o.get(a).push(i);else{let c=[i];r.push([a,c]),o.set(a,c)}}return Le(r.map(i=>[i[0],Le(i[1])]))});var tn=class{path;actual;issue;_tag="Pointer";constructor(t,r,n){this.path=t,this.actual=r,this.issue=n}},UI=class{actual;message;_tag="Unexpected";constructor(t,r){this.actual=t,this.message=r}},Qd=class{ast;message;_tag="Missing";actual=void 0;constructor(t,r){this.ast=t,this.message=r}},mr=class{ast;actual;issues;output;_tag="Composite";constructor(t,r,n,o){this.ast=t,this.actual=r,this.issues=n,this.output=o}},E0=class{ast;actual;kind;issue;_tag="Refinement";constructor(t,r,n,o){this.ast=t,this.actual=r,this.kind=n,this.issue=o}},C0=class{ast;actual;kind;issue;_tag="Transformation";constructor(t,r,n,o){this.ast=t,this.actual=r,this.kind=n,this.issue=o}},Oe=class{ast;actual;message;_tag="Type";constructor(t,r,n){this.ast=t,this.actual=r,this.message=n}},qI=class{ast;actual;message;_tag="Forbidden";constructor(t,r,n){this.ast=t,this.actual=r,this.message=n}},Cie=Symbol.for("effect/Schema/ParseErrorTypeId");var SW=class extends zZ("ParseError"){[Cie]=Cie;get message(){return this.toString()}toString(){return ig.formatIssueSync(this.issue)}toJSON(){return{_id:"ParseError",message:this.toString()}}[he](){return this.toJSON()}},vu=e=>new SW({issue:e}),it=Z,xr=$,ag=Sh;var O0=W1,ho=xE,Fs=u(2,(e,t)=>ho(e)?Xe(e,{onLeft:$,onRight:t}):P(e,t)),Tn=u(2,(e,t)=>ho(e)?Eh(e,t):w(e,t)),Jd=u(2,(e,t)=>ho(e)?Ws(e,t):mi(e,t));var _ie=u(2,(e,t)=>ho(e)?mz(e,{onLeft:t.onFailure,onRight:t.onSuccess}):cS(e,t)),kie=u(2,(e,t)=>ho(e)?Xe(e,{onLeft:t,onRight:Z}):yx(e,t)),_0=(e,t)=>t===void 0||go(t)?e:e===void 0?t:{...e,...t},k0=(e,t,r)=>{let n=dn(e,t);return(o,s)=>n(o,_0(r,s))},CW=(e,t,r)=>{let n=k0(e,t,r);return(o,s)=>H1(n(o,s),vu)},wW=(e,t,r)=>{let n=k0(e,t,r);return(o,s)=>j1(n(o,s))},OW=(e,t,r)=>{let n=dn(e,t);return(o,s)=>n(o,{..._0(r,s),isEffectAllowed:!0})},_W=(e,t)=>CW(e.ast,!0,t),kW=(e,t)=>wW(e.ast,!0,t),TW=(e,t)=>k0(e.ast,!0,t);var hn=(e,t)=>OW(e.ast,!0,t),IW=(e,t)=>CW(e.ast,!1,t),RW=(e,t)=>wW(e.ast,!1,t),Tie=(e,t)=>k0(e.ast,!1,t);var mn=(e,t)=>OW(e.ast,!1,t),Iie=_W,Rie=kW;var Zd=(e,t)=>CW(gt(e.ast),!0,t),Aie=(e,t)=>wW(gt(e.ast),!0,t),Mie=(e,t)=>k0(gt(e.ast),!0,t);var vie=(e,t)=>OW(gt(e.ast),!0,t),T0=(e,t)=>{let r=dn(gt(e.ast),!0);return(n,o)=>Ho(r(n,{exact:!0,..._0(t,o)}))},Pie=(e,t)=>{let r=dn(gt(e.ast),!0);return(n,o)=>{let s=r(n,{exact:!0,..._0(t,o)});if(kt(s))throw vu(s.left)}},Fie=IW,Nie=RW;var GIe=ne(Symbol.for("effect/ParseResult/decodeMemoMap"),()=>new WeakMap),KIe=ne(Symbol.for("effect/ParseResult/encodeMemoMap"),()=>new WeakMap),dn=(e,t)=>{let r=t?GIe:KIe,n=r.get(e);if(n)return n;let o=QIe(e,t),s=ej(e),i=X(s)?(l,f)=>o(l,_0(f,s.value)):o,a=tj(e),c=t&&X(a)?(l,f)=>S0(kie(i(l,f),a.value),e,l,f):i;return r.set(e,c),c},bW=e=>yr(Z6(e)),yW=e=>yr(Y6(e)),QIe=(e,t)=>{switch(e._tag){case"Refinement":if(t){let r=dn(e.from,!0);return(n,o)=>{o=o??lC;let s=o?.errors==="all",i=Fs(kie(r(n,o),a=>{let c=new E0(e,n,"From",a);return s&&TA(e)&&qie(a)?j(e.filter(n,o,e),{onNone:()=>$(c),onSome:l=>$(new mr(e,n,[c,new E0(e,n,"Predicate",l)]))}):$(c)}),a=>j(e.filter(a,o,e),{onNone:()=>Z(a),onSome:c=>$(new E0(e,n,"Predicate",c))}));return S0(i,e,n,o)}}else{let r=dn(gt(e),!0),n=dn(Die(e.from),!1);return(o,s)=>S0(Fs(r(o,s),i=>n(i,s)),e,o,s)}case"Transformation":{let r=ZIe(e.transformation,t),n=t?dn(e.from,!0):dn(e.to,!1),o=t?dn(e.to,!0):dn(e.from,!1);return(s,i)=>S0(Fs(Jd(n(s,i),a=>new C0(e,s,t?"Encoded":"Type",a)),a=>Fs(Jd(r(a,i??lC,e,s),c=>new C0(e,s,"Transformation",c)),c=>Jd(o(c,i),l=>new C0(e,s,t?"Type":"Encoded",l)))),e,s,i)}case"Declaration":{let r=t?e.decodeUnknown(...e.typeParameters):e.encodeUnknown(...e.typeParameters);return(n,o)=>S0(r(n,o??lC,e),e,n,o)}case"Literal":return Ps(e,r=>r===e.literal);case"UniqueSymbol":return Ps(e,r=>r===e.symbol);case"UndefinedKeyword":return Ps(e,$B);case"NeverKeyword":return Ps(e,GB);case"UnknownKeyword":case"AnyKeyword":case"VoidKeyword":return Z;case"StringKeyword":return Ps(e,cr);case"NumberKeyword":return Ps(e,go);case"BooleanKeyword":return Ps(e,Oi);case"BigIntKeyword":return Ps(e,Bu);case"SymbolKeyword":return Ps(e,Oa);case"ObjectKeyword":return Ps(e,jr);case"Enums":return Ps(e,r=>e.enums.some(([n,o])=>o===r));case"TemplateLiteral":{let r=FA(e);return Ps(e,n=>cr(n)&&r.test(n))}case"TupleType":{let r=e.elements.map(l=>dn(l.type,t)),n=e.rest.map(l=>dn(l.type,t)),o=e.elements.filter(l=>!l.isOptional);e.rest.length>0&&(o=o.concat(e.rest.slice(1)));let s=o.length,i=e.elements.length>0?e.elements.map((l,f)=>f).join(" | "):"never",a=bW(e),c=yW(e);return(l,f)=>{if(!eR(l))return $(new Oe(e,l));let d=f?.errors==="all",h=[],m=0,y=[],T=l.length;for(let I=T;I<=s-1;I++){let K=new tn(I,l,new Qd(o[I-T]));if(d){h.push([m++,K]);continue}else return $(new mr(e,l,K,y))}if(e.rest.length===0)for(let I=e.elements.length;I<=T-1;I++){let K=new tn(I,l,new UI(l[I],`is unexpected, expected: ${i}`));if(d){h.push([m++,K]);continue}else return $(new mr(e,l,K,y))}let C=0,O;for(;C<r.length;C++)if(T<C+1){if(e.elements[C].isOptional)continue}else{let I=r[C],K=I(l[C],f);if(ho(K)){if(kt(K)){let Q=new tn(C,l,K.left);if(d){h.push([m++,Q]);continue}else return $(new mr(e,l,Q,ya(y)))}y.push([m++,K.right])}else{let Q=m++,z=C;O||(O=[]),O.push(({es:te,output:ce})=>P(pl(K),Ye=>{if(kt(Ye)){let at=new tn(z,l,Ye.left);return d?(te.push([Q,at]),be):$(new mr(e,l,at,ya(ce)))}return ce.push([Q,Ye.right]),be}))}}if(ut(n)){let[I,...K]=n;for(;C<T-K.length;C++){let Q=I(l[C],f);if(ho(Q))if(kt(Q)){let z=new tn(C,l,Q.left);if(d){h.push([m++,z]);continue}else return $(new mr(e,l,z,ya(y)))}else y.push([m++,Q.right]);else{let z=m++,te=C;O||(O=[]),O.push(({es:ce,output:Ye})=>P(pl(Q),at=>{if(kt(at)){let Ue=new tn(te,l,at.left);return d?(ce.push([z,Ue]),be):$(new mr(e,l,Ue,ya(Ye)))}else return Ye.push([z,at.right]),be}))}}for(let Q=0;Q<K.length;Q++)if(C+=Q,!(T<C+1)){let z=K[Q](l[C],f);if(ho(z)){if(kt(z)){let te=new tn(C,l,z.left);if(d){h.push([m++,te]);continue}else return $(new mr(e,l,te,ya(y)))}y.push([m++,z.right])}else{let te=m++,ce=C;O||(O=[]),O.push(({es:Ye,output:at})=>P(pl(z),Ue=>{if(kt(Ue)){let _r=new tn(ce,l,Ue.left);return d?(Ye.push([te,_r]),be):$(new mr(e,l,_r,ya(at)))}return at.push([te,Ue.right]),be}))}}}let U=({es:I,output:K})=>Ii(I)?$(new mr(e,l,ya(I),ya(K))):Z(ya(K));if(O&&O.length>0){let I=O;return Je(()=>{let K={es:Ih(h),output:Ih(y)};return P(Br(I,Q=>Q(K),{concurrency:a,batching:c,discard:!0}),()=>U(K))})}return U({output:y,es:h})}}case"TypeLiteral":{if(e.propertySignatures.length===0&&e.indexSignatures.length===0)return Ps(e,KB);let r=[],n={},o=[];for(let f of e.propertySignatures)r.push([dn(f.type,t),f]),n[f.name]=null,o.push(f.name);let s=e.indexSignatures.map(f=>[dn(f.parameter,t),dn(f.type,t),f.parameter]),i=Qt.make(e.indexSignatures.map(f=>f.parameter).concat(o.map(f=>Oa(f)?new pf(f):new Li(f)))),a=dn(i,t),c=bW(e),l=yW(e);return(f,d)=>{if(!yg(f))return $(new Oe(e,f));let h=d?.errors==="all",m=[],y=0,T=d?.onExcessProperty==="error",C=d?.onExcessProperty==="preserve",O={},U;if(T||C){U=Reflect.ownKeys(f);for(let z of U){let te=a(z,d);if(ho(te)&&kt(te))if(T){let ce=new tn(z,f,new UI(f[z],`is unexpected, expected: ${String(i)}`));if(h){m.push([y++,ce]);continue}else return $(new mr(e,f,ce,O))}else O[z]=f[z]}}let I,K=d?.exact===!0;for(let z=0;z<r.length;z++){let te=r[z][1],ce=te.name,Ye=Object.prototype.hasOwnProperty.call(f,ce);if(!Ye){if(te.isOptional)continue;if(K){let _r=new tn(ce,f,new Qd(te));if(h){m.push([y++,_r]);continue}else return $(new mr(e,f,_r,O))}}let at=r[z][0],Ue=at(f[ce],d);if(ho(Ue)){if(kt(Ue)){let _r=new tn(ce,f,Ye?Ue.left:new Qd(te));if(h){m.push([y++,_r]);continue}else return $(new mr(e,f,_r,O))}O[ce]=Ue.right}else{let _r=y++,Ns=ce;I||(I=[]),I.push(({es:Ds,output:wi})=>P(pl(Ue),Zn=>{if(kt(Zn)){let In=new tn(Ns,f,Ye?Zn.left:new Qd(te));return h?(Ds.push([_r,In]),be):$(new mr(e,f,In,wi))}return wi[Ns]=Zn.right,be}))}}for(let z=0;z<s.length;z++){let te=s[z],ce=te[0],Ye=te[1],at=$R(f,te[2]);for(let Ue of at){let _r=ce(Ue,d);if(ho(_r)&&Ho(_r)){let Ns=Ye(f[Ue],d);if(ho(Ns))if(kt(Ns)){let Ds=new tn(Ue,f,Ns.left);if(h){m.push([y++,Ds]);continue}else return $(new mr(e,f,Ds,O))}else Object.prototype.hasOwnProperty.call(n,Ue)||(O[Ue]=Ns.right);else{let Ds=y++,wi=Ue;I||(I=[]),I.push(({es:Zn,output:In})=>P(pl(Ns),Ls=>{if(kt(Ls)){let ih=new tn(wi,f,Ls.left);return h?(Zn.push([Ds,ih]),be):$(new mr(e,f,ih,In))}else return Object.prototype.hasOwnProperty.call(n,Ue)||(In[Ue]=Ls.right),be}))}}}}let Q=({es:z,output:te})=>{if(Ii(z))return $(new mr(e,f,ya(z),te));if(d?.propertyOrder==="original"){let ce=U||Reflect.ownKeys(f);for(let at of o)ce.indexOf(at)===-1&&ce.push(at);let Ye={};for(let at of ce)Object.prototype.hasOwnProperty.call(te,at)&&(Ye[at]=te[at]);return Z(Ye)}return Z(te)};if(I&&I.length>0){let z=I;return Je(()=>{let te={es:Ih(m),output:Object.assign({},O)};return P(Br(z,ce=>ce(te),{concurrency:c,batching:l,discard:!0}),()=>Q(te))})}return Q({es:m,output:O})}}case"Union":{let r=AW(e.types,t),n=Reflect.ownKeys(r.keys),o=n.length,s=e.types.length,i=new Map;for(let l=0;l<s;l++)i.set(e.types[l],dn(e.types[l],t));let a=bW(e)??1,c=yW(e);return(l,f)=>{let d=[],h=0,m=[];if(o>0)if(lh(l))for(let C=0;C<o;C++){let O=n[C],U=r.keys[O].buckets;if(Object.prototype.hasOwnProperty.call(l,O)){let I=String(l[O]);if(Object.prototype.hasOwnProperty.call(U,I))m=m.concat(U[I]);else{let{candidates:K,literals:Q}=r.keys[O],z=Qt.make(Q),te=K.length===s?new rn([new It(O,z,!1,!0)],[]):Qt.make(K);d.push([h++,new mr(te,l,new tn(O,l,new Oe(z,l[O])))])}}else{let{candidates:I,literals:K}=r.keys[O],Q=new It(O,Qt.make(K),!1,!0),z=I.length===s?new rn([Q],[]):Qt.make(I);d.push([h++,new mr(z,l,new tn(O,l,new Qd(Q)))])}}else{let C=r.candidates.length===s?e:Qt.make(r.candidates);d.push([h++,new Oe(C,l)])}r.otherwise.length>0&&(m=m.concat(r.otherwise));let y;for(let C=0;C<m.length;C++){let O=m[C],U=i.get(O)(l,f);if(ho(U)&&(!y||y.length===0)){if(Ho(U))return U;d.push([h++,U.left])}else{let I=h++;y||(y=[]),y.push(K=>Je(()=>"finalResult"in K?be:P(pl(U),Q=>(Ho(Q)?K.finalResult=Q:K.es.push([I,Q.left]),be))))}}let T=C=>Ii(C)?C.length===1&&C[0][1]._tag==="Type"?$(C[0][1]):$(new mr(e,l,ya(C))):$(new Oe(e,l));if(y&&y.length>0){let C=y;return Je(()=>{let O={es:Ih(d)};return P(Br(C,U=>U(O),{concurrency:a,batching:c,discard:!0}),()=>"finalResult"in O?O.finalResult:T(O.es))})}return T(d)}}case"Suspend":{let r=Dh(()=>dn(e.f(),t));return(n,o)=>r()(n,o)}}},Ps=(e,t)=>r=>t(r)?Z(r):$(new Oe(e,r)),y0=(e,t)=>{switch(e._tag){case"Declaration":{let r=up(e);if(X(r))return y0(r.value,t);break}case"TypeLiteral":{let r=[];for(let n=0;n<e.propertySignatures.length;n++){let o=e.propertySignatures[n],s=t?rb(o.type):gt(o.type);Ma(s)&&!o.isOptional&&r.push([o.name,s])}return r}case"TupleType":{let r=[];for(let n=0;n<e.elements.length;n++){let o=e.elements[n],s=t?rb(o.type):gt(o.type);Ma(s)&&!o.isOptional&&r.push([n,s])}return r}case"Refinement":return y0(e.from,t);case"Suspend":return y0(e.f(),t);case"Transformation":return y0(t?e.from:e.to,t)}return[]},AW=(e,t)=>{let r={},n=[],o=[];for(let s=0;s<e.length;s++){let i=e[s],a=y0(i,t);if(a.length>0){o.push(i);for(let c=0;c<a.length;c++){let[l,f]=a[c],d=String(f.literal);r[l]=r[l]||{buckets:{},literals:[],candidates:[]};let h=r[l].buckets;if(Object.prototype.hasOwnProperty.call(h,d)){if(c<a.length-1)continue;h[d].push(i),r[l].literals.push(f),r[l].candidates.push(i)}else{h[d]=[i],r[l].literals.push(f),r[l].candidates.push(i);break}}}else n.push(i)}return{keys:r,otherwise:n,candidates:o}},Die=e=>pp(e)?Die(e.from):e,S0=(e,t,r,n)=>{if(n?.isEffectAllowed===!0||ho(e))return e;let o=new Zp,s=Td(e,{scheduler:o});o.flush();let i=s.unsafePoll();if(i){if(Yi(i))return Z(i.value);let a=i.cause;return MQ(a)?$(a.error):$(new qI(t,r,Ny(a)))}return $(new qI(t,r,"cannot be be resolved synchronously, this is caused by using runSync on an effect that performs async work"))},JIe=([e],[t])=>e>t?1:e<t?-1:0;function ya(e){return e.sort(JIe).map(t=>t[1])}var ZIe=(e,t)=>{switch(e._tag){case"FinalTransformation":return t?e.decode:e.encode;case"ComposeTransformation":return Z;case"TypeLiteralTransformation":return r=>{let n=Z(r);for(let o of e.propertySignatureTransformations){let[s,i]=t?[o.from,o.to]:[o.to,o.from],a=t?o.decode:o.encode;n=Tn(n,l=>{let f=a(Object.prototype.hasOwnProperty.call(l,s)?x(l[s]):g());return delete l[s],X(f)&&(l[i]=f.value),l})}return n}}},Do=(e,t=[])=>({value:e,forest:t}),ig={formatIssue:e=>Tn(og(e),YIe),formatIssueSync:e=>{let t=ig.formatIssue(e);return ho(t)?B1(t):Ox(t)},formatError:e=>ig.formatIssue(e.issue),formatErrorSync:e=>ig.formatIssueSync(e.issue)},YIe=e=>e.value+Lie(`
`,e.forest),Lie=(e,t)=>{let r="",n=t.length,o;for(let s=0;s<n;s++){o=t[s];let i=s===n-1;r+=e+(i?"\u2514":"\u251C")+"\u2500 "+o.value,r+=Lie(e+(n>1&&!i?"\u2502  ":"   "),o.forest)}return r},XIe=e=>{switch(e){case"Encoded":return"Encoded side transformation failure";case"Transformation":return"Transformation process failure";case"Type":return"Type side transformation failure"}},e1e=e=>{switch(e){case"From":return"From side refinement failure";case"Predicate":return"Predicate refinement failure"}},Uie=e=>"ast"in e?x(e.ast):g(),EW=Z(void 0),t1e=e=>Uie(e).pipe(kr(Q6),j({onNone:()=>EW,onSome:t=>{let r=t(e);return cr(r)?Z({message:r,override:!1}):di(r)?w(r,n=>({message:n,override:!1})):cr(r.message)?Z({message:r.message,override:r.override}):w(r.message,n=>({message:n,override:r.override}))}})),MW=e=>t=>t._tag===e,qie=MW("Composite"),wie=MW("Refinement"),Oie=MW("Transformation"),Pl=e=>Fs(t1e(e),t=>t!==void 0?!t.override&&(qie(e)||wie(e)&&e.kind==="From"||Oie(e)&&e.kind!=="Transformation")?Oie(e)||wie(e)?Pl(e.issue):EW:Z(t.message):EW),Wie=e=>Uie(e).pipe(kr(X6),V1(t=>t(e)),yr);function r1e(e){return kA(e).pipe(yo(()=>OA(e)),yo(()=>_A(e)),yo(()=>Jg(e)),_e(()=>`{ ${e.from} | filter }`))}function n1e(e){return e.message!==void 0?e.message:`Expected ${pp(e.ast)?r1e(e.ast):String(e.ast)}, actual ${Wo(e.actual)}`}var Hie=e=>Tn(Pl(e),t=>t??Wie(e)??n1e(e)),LI=e=>Wie(e)??String(e.ast),Bie=e=>e.message??"is forbidden",zie=e=>e.message??"is unexpected",jie=e=>{let t=J6(e.ast);if(X(t)){let r=t.value();return cr(r)?Z(r):r}return Z(e.message??"is missing")},og=e=>{switch(e._tag){case"Type":return Tn(Hie(e),Do);case"Forbidden":return Z(Do(LI(e),[Do(Bie(e))]));case"Unexpected":return Z(Do(zie(e)));case"Missing":return Tn(jie(e),Do);case"Transformation":return Fs(Pl(e),t=>t!==void 0?Z(Do(t)):Tn(og(e.issue),r=>Do(LI(e),[Do(XIe(e.kind),[r])])));case"Refinement":return Fs(Pl(e),t=>t!==void 0?Z(Do(t)):Tn(og(e.issue),r=>Do(LI(e),[Do(e1e(e.kind),[r])])));case"Pointer":return Tn(og(e.issue),t=>Do(JE(e.path),[t]));case"Composite":return Fs(Pl(e),t=>{if(t!==void 0)return Z(Do(t));let r=LI(e);return QE(e.issues)?Tn(Br(e.issues,og),n=>Do(r,n)):Tn(og(e.issues),n=>Do(r,[n]))})}},Kd=(e,t,r)=>({_tag:e,path:t,message:r}),w0={formatIssue:e=>sg(e,void 0,[]),formatIssueSync:e=>{let t=w0.formatIssue(e);return ho(t)?B1(t):Ox(t)},formatError:e=>w0.formatIssue(e.issue),formatErrorSync:e=>w0.formatIssueSync(e.issue)},sg=(e,t,r)=>{let n=e._tag;switch(n){case"Type":return Tn(Hie(e),o=>[Kd(t??n,r,o)]);case"Forbidden":return Z([Kd(n,r,Bie(e))]);case"Unexpected":return Z([Kd(n,r,zie(e))]);case"Missing":return Tn(jie(e),o=>[Kd(n,r,o)]);case"Pointer":return sg(e.issue,void 0,r.concat(e.path));case"Composite":return Fs(Pl(e),o=>o!==void 0?Z([Kd(n,r,o)]):QE(e.issues)?Tn(Br(e.issues,s=>sg(s,void 0,r)),Rh):sg(e.issues,void 0,r));case"Refinement":return Fs(Pl(e),o=>o!==void 0?Z([Kd(n,r,o)]):sg(e.issue,e.kind==="Predicate"?n:void 0,r));case"Transformation":return Fs(Pl(e),o=>o!==void 0?Z([Kd(n,r,o)]):sg(e.issue,e.kind==="Transformation"?n:void 0,r))}};var Pu={};Yn(Pu,{LoggerTypeId:()=>s1e,add:()=>a1e,addEffect:()=>c1e,addScoped:()=>u1e,batched:()=>h1e,defaultLogger:()=>M1e,filterLogLevel:()=>f1e,isLogger:()=>j1e,json:()=>q1e,jsonLogger:()=>v1e,logFmt:()=>W1e,logfmtLogger:()=>P1e,make:()=>i1e,map:()=>d1e,mapInput:()=>p1e,mapInputOptions:()=>l1e,minimumLogLevel:()=>z1e,none:()=>b1e,pretty:()=>H1e,prettyLogger:()=>N1e,prettyLoggerDefault:()=>D1e,remove:()=>y1e,replace:()=>I0,replaceEffect:()=>S1e,replaceScoped:()=>E1e,simple:()=>C1e,stringLogger:()=>F1e,structured:()=>B1e,structuredLogger:()=>L1e,succeed:()=>w1e,sync:()=>O1e,test:()=>_1e,tracerLogger:()=>U1e,withConsoleError:()=>g1e,withConsoleLog:()=>m1e,withLeveledConsole:()=>x1e,withMinimumLogLevel:()=>k1e,withSpanAnnotations:()=>T1e,zip:()=>I1e,zipLeft:()=>R1e,zipRight:()=>A1e});var Vie=u(2,(e,t)=>e.log({fiberId:Cf,logLevel:um,message:t,cause:I_,context:Yw(),spans:Ys(),annotations:Pc(),date:new Date}));var s1e=Um,i1e=On,a1e=fS,c1e=CD,u1e=wD,p1e=VG,l1e=e_,f1e=GG,d1e=Sy,h1e=QK,m1e=Jm,x1e=BK,g1e=zK,b1e=KG,y1e=dS,I0=XY,S1e=eX,E1e=tX,C1e=t_,w1e=QG,O1e=JG,_1e=Vie,k1e=YY,T1e=KK,I1e=r_,R1e=ZG,A1e=YG,M1e=bd,v1e=s_,P1e=o_,F1e=n_,N1e=dF,D1e=i_,L1e=Ey,U1e=S2,q1e=I0(bd,jK),W1e=I0(bd,$K),H1e=I0(bd,VK),B1e=I0(bd,GK),z1e=ZY,j1e=e7;var R0={};Yn(R0,{MetricTypeId:()=>$1e,counter:()=>Q1e,fiberActive:()=>NRe,fiberFailures:()=>PRe,fiberLifetimes:()=>FRe,fiberStarted:()=>MRe,fiberSuccesses:()=>vRe,frequency:()=>J1e,fromMetricKey:()=>Y1e,gauge:()=>X1e,globalMetricRegistry:()=>V1e,histogram:()=>eRe,increment:()=>tRe,incrementBy:()=>rRe,make:()=>G1e,map:()=>nRe,mapInput:()=>K1e,mapType:()=>oRe,modify:()=>sRe,set:()=>iRe,snapshot:()=>aRe,succeed:()=>cRe,summary:()=>pRe,summaryTimestamp:()=>lRe,sync:()=>uRe,tagged:()=>fRe,taggedWithLabels:()=>hRe,taggedWithLabelsInput:()=>dRe,timer:()=>mRe,timerWithBoundaries:()=>xRe,trackAll:()=>gRe,trackDefect:()=>bRe,trackDefectWith:()=>yRe,trackDuration:()=>SRe,trackDurationWith:()=>ERe,trackError:()=>CRe,trackErrorWith:()=>wRe,trackSuccess:()=>ORe,trackSuccessWith:()=>_Re,unsafeSnapshot:()=>ARe,update:()=>kRe,value:()=>TRe,withConstantInput:()=>Z1e,withNow:()=>IRe,zip:()=>RRe});var $1e=zF,V1e=Ty,G1e=na,K1e=Wm,Q1e=hd,J1e=B7,Z1e=z7,Y1e=md,X1e=j7,eRe=Hm,tRe=$7,rRe=V7,nRe=jF,oRe=G7,sRe=c_,iRe=K7,aRe=cK,cRe=Q7,uRe=J7,pRe=Z7,lRe=$F,fRe=Bm,dRe=Y7,hRe=VF,mRe=X7,xRe=eK,gRe=tK,bRe=rK,yRe=GF,SRe=nK,ERe=KF,CRe=oK,wRe=QF,ORe=sK,_Re=JF,kRe=ui,TRe=iK,IRe=ZF,RRe=aK,ARe=YF,MRe=x2,vRe=g2,PRe=b2,FRe=y2,NRe=x_;var Gie=Yq,WI=Nse,A0=Dse;var Kie=e=>ar((t,r)=>e(A0(t),A0(r)));var Ca={};Yn(Ca,{Any:()=>DW,Array:()=>Nt,ArrayEnsure:()=>iAe,ArrayFormatterIssue:()=>sB,BetweenBigDecimalSchemaId:()=>ZH,BetweenBigIntSchemaId:()=>mH,BetweenDateSchemaId:()=>RH,BetweenDurationSchemaId:()=>CH,BetweenSchemaId:()=>bce,BigDecimal:()=>$H,BigDecimalFromNumber:()=>VH,BigDecimalFromSelf:()=>qu,BigInt:()=>Ll,BigIntFromNumber:()=>xH,BigIntFromSelf:()=>Du,Boolean:()=>rh,BooleanFromString:()=>rB,BooleanFromUnknown:()=>tB,BrandSchemaId:()=>PW,Capitalize:()=>QW,Capitalized:()=>QI,CapitalizedSchemaId:()=>ece,Cause:()=>Pve,CauseFromSelf:()=>u1,Char:()=>VW,Chunk:()=>dve,ChunkFromSelf:()=>aue,Class:()=>Eve,Config:()=>ePe,Data:()=>yve,DataFromSelf:()=>uue,Date:()=>vH,DateFromNumber:()=>PH,DateFromSelf:()=>nh,DateFromSelfSchemaId:()=>AH,DateFromString:()=>r1,DateTimeUtc:()=>DH,DateTimeUtcFromDate:()=>NH,DateTimeUtcFromNumber:()=>FH,DateTimeUtcFromSelf:()=>dg,DateTimeZoned:()=>WH,DateTimeZonedFromSelf:()=>o1,Defect:()=>Q0,Duration:()=>yH,DurationFromMillis:()=>bH,DurationFromNanos:()=>gH,DurationFromSelf:()=>fg,Either:()=>WMe,EitherFromSelf:()=>IB,EitherFromUnion:()=>HMe,EndsWithSchemaId:()=>jW,Enums:()=>ZRe,Exit:()=>eB,ExitFromSelf:()=>mue,FiberId:()=>XH,FiberIdFromSelf:()=>a1,Finite:()=>nH,FiniteSchemaId:()=>ace,FromPropertySignature:()=>Uu,GreaterThanBigDecimalSchemaId:()=>GH,GreaterThanBigIntSchemaId:()=>lH,GreaterThanDateSchemaId:()=>TH,GreaterThanDurationSchemaId:()=>SH,GreaterThanOrEqualToBigDecimalSchemaId:()=>KH,GreaterThanOrEqualToBigIntSchemaId:()=>fH,GreaterThanOrEqualToDateSchemaId:()=>IH,GreaterThanOrEqualToDurationSchemaId:()=>EH,GreaterThanOrEqualToSchemaId:()=>pce,GreaterThanSchemaId:()=>cce,HashMap:()=>Vve,HashMapFromSelf:()=>gue,HashSet:()=>Bve,HashSetFromSelf:()=>xue,IncludesSchemaId:()=>$W,InstanceOfSchemaId:()=>FW,Int:()=>B0,IntSchemaId:()=>dce,ItemsCountSchemaId:()=>Hce,JsonNumber:()=>cH,JsonNumberSchemaId:()=>kce,LengthSchemaId:()=>HW,LessThanBigDecimalSchemaId:()=>QH,LessThanBigIntSchemaId:()=>dH,LessThanDateSchemaId:()=>_H,LessThanDurationSchemaId:()=>j0,LessThanOrEqualToBigDecimalSchemaId:()=>JH,LessThanOrEqualToBigIntSchemaId:()=>hH,LessThanOrEqualToDateSchemaId:()=>kH,LessThanOrEqualToDurationSchemaId:()=>nMe,LessThanOrEqualToSchemaId:()=>xce,LessThanSchemaId:()=>hce,List:()=>Jve,ListFromSelf:()=>bue,Literal:()=>Bt,Lowercase:()=>GW,Lowercased:()=>GI,LowercasedSchemaId:()=>Jae,Map:()=>VMe,MapFromRecord:()=>KMe,MapFromSelf:()=>AB,MaxItemsSchemaId:()=>Wce,MaxLengthSchemaId:()=>Vae,MinItemsSchemaId:()=>qce,MinLengthSchemaId:()=>Gae,MultipleOfSchemaId:()=>fce,Negative:()=>iH,NegativeBigDecimalFromSelf:()=>cve,NegativeBigDecimalSchemaId:()=>rue,NegativeBigInt:()=>zAe,NegativeBigIntFromSelf:()=>BAe,Never:()=>L0,NonEmptyArray:()=>lg,NonEmptyArrayEnsure:()=>aAe,NonEmptyChunk:()=>xve,NonEmptyChunkFromSelf:()=>cue,NonEmptyString:()=>XW,NonEmptyTrimmedString:()=>ZI,NonNaN:()=>oH,NonNaNSchemaId:()=>yce,NonNegative:()=>z0,NonNegativeBigDecimalFromSelf:()=>ave,NonNegativeBigDecimalSchemaId:()=>eue,NonNegativeBigInt:()=>VAe,NonNegativeBigIntFromSelf:()=>Pce,NonNegativeInt:()=>e1,NonPositive:()=>aH,NonPositiveBigDecimalFromSelf:()=>uve,NonPositiveBigDecimalSchemaId:()=>oue,NonPositiveBigInt:()=>$Ae,NonPositiveBigIntFromSelf:()=>jAe,Not:()=>uH,Null:()=>D0,NullOr:()=>P0,NullishOr:()=>F0,Number:()=>gn,NumberFromString:()=>XI,Object:()=>LW,Option:()=>PMe,OptionFromNonEmptyTrimmedString:()=>BH,OptionFromNullOr:()=>FMe,OptionFromNullishOr:()=>NMe,OptionFromSelf:()=>sh,OptionFromUndefinedOr:()=>DMe,PatternSchemaId:()=>BW,Positive:()=>sH,PositiveBigDecimalFromSelf:()=>ive,PositiveBigDecimalSchemaId:()=>Yce,PositiveBigInt:()=>HAe,PositiveBigIntFromSelf:()=>WAe,PropertyKey:()=>p1,PropertySignatureDeclaration:()=>Lu,PropertySignatureTransformation:()=>Ci,PropertySignatureTypeId:()=>cB,ReadonlyMap:()=>$Me,ReadonlyMapFromRecord:()=>GMe,ReadonlyMapFromSelf:()=>RB,ReadonlySet:()=>YMe,ReadonlySetFromSelf:()=>Jce,Record:()=>pB,Redacted:()=>KAe,RedactedFromSelf:()=>Fce,RefineSchemaId:()=>fB,Set:()=>XMe,SetFromSelf:()=>Zce,SortedSet:()=>Xve,SortedSetFromSelf:()=>yue,StartsWithSchemaId:()=>zW,String:()=>$e,StringFromBase64:()=>pMe,StringFromBase64Url:()=>lMe,StringFromHex:()=>fMe,StringFromUriComponent:()=>dMe,Struct:()=>zt,Symbol:()=>pH,SymbolFromSelf:()=>U0,TaggedClass:()=>Cve,TaggedError:()=>wve,TaggedRequest:()=>dPe,TaggedStruct:()=>J0,TemplateLiteral:()=>Rae,TemplateLiteralParser:()=>YRe,TimeZone:()=>qH,TimeZoneFromSelf:()=>n1,TimeZoneNamed:()=>UH,TimeZoneNamedFromSelf:()=>G0,TimeZoneOffset:()=>LH,TimeZoneOffsetFromSelf:()=>V0,ToPropertySignature:()=>Ea,Trim:()=>ZW,Trimmed:()=>H0,TrimmedSchemaId:()=>jae,Tuple:()=>Ei,TypeId:()=>Dl,ULID:()=>tH,ULIDSchemaId:()=>ice,URL:()=>rH,URLFromSelf:()=>YI,UUID:()=>eH,UUIDSchemaId:()=>sce,Uint8:()=>t1,Uint8Array:()=>wH,Uint8ArrayFromBase64:()=>aMe,Uint8ArrayFromBase64Url:()=>cMe,Uint8ArrayFromHex:()=>uMe,Uint8ArrayFromSelf:()=>$0,Uncapitalize:()=>JW,Uncapitalized:()=>JI,UncapitalizedSchemaId:()=>rce,Undefined:()=>N0,UndefinedOr:()=>Xd,Union:()=>bn,UniqueSymbolFromSelf:()=>Tae,Unknown:()=>th,Uppercase:()=>KW,Uppercased:()=>KI,UppercasedSchemaId:()=>Yae,ValidDateFromSelf:()=>MH,ValidDateSchemaId:()=>OH,Void:()=>NW,annotations:()=>IAe,asSchema:()=>WRe,asSerializable:()=>tPe,asSerializableWithResult:()=>fPe,asWithResult:()=>sPe,asserts:()=>Pie,attachPropertySignature:()=>TAe,between:()=>bB,betweenBigDecimal:()=>iue,betweenBigInt:()=>yB,betweenDate:()=>OMe,betweenDuration:()=>Uce,brand:()=>yAe,capitalized:()=>tce,clamp:()=>UAe,clampBigDecimal:()=>pve,clampBigInt:()=>qAe,clampDuration:()=>tMe,compose:()=>$I,declare:()=>ir,decode:()=>zRe,decodeEither:()=>jRe,decodeOption:()=>Rie,decodePromise:()=>$Re,decodeSync:()=>Iie,decodeUnknown:()=>oh,decodeUnknownEither:()=>wae,decodeUnknownOption:()=>kW,decodeUnknownPromise:()=>Oae,decodeUnknownSync:()=>_W,deserialize:()=>oPe,deserializeExit:()=>lPe,deserializeFailure:()=>aPe,deserializeSuccess:()=>uPe,element:()=>UW,encode:()=>d1,encodeEither:()=>HRe,encodeOption:()=>Nie,encodePromise:()=>BRe,encodeSync:()=>Fie,encodeUnknown:()=>f1,encodeUnknownEither:()=>Eae,encodeUnknownOption:()=>RW,encodeUnknownPromise:()=>Cae,encodeUnknownSync:()=>IW,encodedBoundSchema:()=>iB,encodedSchema:()=>l1,endsWith:()=>vAe,equivalence:()=>hPe,exitSchema:()=>PB,extend:()=>Z0,failureSchema:()=>nB,filter:()=>Se,filterEffect:()=>_Ae,finite:()=>xB,format:()=>Ft,fromBrand:()=>tAe,fromKey:()=>pAe,getClassTag:()=>b1,getNumberIndexedAccess:()=>m1,greaterThan:()=>uce,greaterThanBigDecimal:()=>rve,greaterThanBigInt:()=>Rce,greaterThanDate:()=>CMe,greaterThanDuration:()=>sMe,greaterThanOrEqualTo:()=>lce,greaterThanOrEqualToBigDecimal:()=>nve,greaterThanOrEqualToBigInt:()=>Ace,greaterThanOrEqualToDate:()=>wMe,greaterThanOrEqualToDuration:()=>iMe,head:()=>gMe,headNonEmpty:()=>bMe,headOrElse:()=>yMe,includes:()=>PAe,instanceOf:()=>Mae,int:()=>gB,is:()=>T0,isPropertySignature:()=>h1,isSchema:()=>xn,itemsCount:()=>xMe,keyof:()=>nAe,length:()=>Qae,lessThan:()=>mce,lessThanBigDecimal:()=>ove,lessThanBigInt:()=>Mce,lessThanDate:()=>SMe,lessThanDuration:()=>rMe,lessThanOrEqualTo:()=>gce,lessThanOrEqualToBigDecimal:()=>sve,lessThanOrEqualToBigInt:()=>vce,lessThanOrEqualToDate:()=>EMe,lessThanOrEqualToDuration:()=>oMe,lowercased:()=>Zae,make:()=>Te,makePropertySignature:()=>sc,maxItems:()=>mMe,maxLength:()=>AAe,minItems:()=>hMe,minLength:()=>Kae,multipleOf:()=>LAe,mutable:()=>wAe,negative:()=>Cce,negativeBigDecimal:()=>nue,negativeBigInt:()=>EB,nonEmptyString:()=>mB,nonNaN:()=>Sce,nonNegative:()=>Oce,nonNegativeBigDecimal:()=>tue,nonNegativeBigInt:()=>CB,nonPositive:()=>wce,nonPositiveBigDecimal:()=>sue,nonPositiveBigInt:()=>wB,omit:()=>gAe,optional:()=>dAe,optionalElement:()=>oAe,optionalToOptional:()=>WW,optionalToRequired:()=>Fu,optionalWith:()=>hAe,parseJson:()=>oce,parseNumber:()=>_ce,partial:()=>SAe,partialWith:()=>EAe,pattern:()=>hB,pick:()=>Wae,pickLiteral:()=>QRe,pluck:()=>bAe,positive:()=>Ece,positiveBigDecimal:()=>Xce,positiveBigInt:()=>SB,propertySignature:()=>ug,rename:()=>RAe,required:()=>CAe,requiredToOptional:()=>lAe,serializableSchema:()=>rPe,serialize:()=>nPe,serializeExit:()=>pPe,serializeFailure:()=>iPe,serializeSuccess:()=>cPe,split:()=>FAe,standardSchemaV1:()=>qRe,startsWith:()=>MAe,successSchema:()=>oB,suspend:()=>VI,symbolSerializable:()=>Y0,symbolWithResult:()=>Hu,tag:()=>Uae,transform:()=>me,transformLiteral:()=>zae,transformLiterals:()=>kAe,transformOrFail:()=>gr,trimmed:()=>$ae,typeSchema:()=>ye,uncapitalized:()=>nce,uppercased:()=>Xae,validDate:()=>kB,validate:()=>_ae,validateEither:()=>VRe,validateOption:()=>Aie,validatePromise:()=>GRe,validateSync:()=>Zd,withConstructorDefault:()=>Fl,withDecodingDefault:()=>Dae,withDefaults:()=>uAe});var Jie=u(e=>jr(e[0]),(e,...t)=>{let r={};for(let n of t)n in e&&(r[n]=e[n]);return r}),Zie=u(e=>jr(e[0]),(e,...t)=>{let r={...e};for(let n of t)delete r[n];return r});var Dl=Symbol.for("effect/Schema");function Te(e){return class{[Dl]=vW;static ast=e;static annotations(r){return Te(ps(this.ast,r))}static pipe(){return v(this,arguments)}static toString(){return String(e)}static Type;static Encoded;static Context;static[Dl]=vW}}var vW={_A:e=>e,_I:e=>e,_R:e=>e},Xie=e=>Yi(e)?e.value:LRe(Ny(e.cause)),LRe=e=>({issues:[{message:e}]}),URe=e=>w(w0.formatIssue(e),t=>({issues:t.map(r=>({path:r.path,message:r.message}))})),qRe=(e,t)=>{let r=hn(e,{errors:"all"});return class extends Te(e.ast){static"~standard"={version:1,vendor:"effect",validate(o){let s=new Zp,i=Td(jn(r(o,t),{onFailure:URe,onSuccess:c=>B({value:c})}),{scheduler:s});s.flush();let a=i.unsafePoll();return a?Xie(a):new Promise(c=>{i.addObserver(l=>{c(Xie(l))})})}}}},eae={schemaId:G6,message:fA,missingMessage:rC,identifier:Gg,title:Bo,description:Ic,examples:dA,default:hA,documentation:K6,jsonSchema:mA,arbitrary:xA,pretty:gA,equivalence:nC,concurrency:bA,batching:yA,parseIssueTitle:SA,parseOptions:EA,decodingFallback:CA},Wu=e=>{if(!e)return{};let t={...e};for(let r in eae)if(r in e){let n=eae[r];t[n]=e[r],delete t[r]}return t},ps=(e,t)=>tb(e,Wu(t));function WRe(e){return e}var Ft=e=>String(e.ast),l1=e=>Te(rb(e.ast)),iB=e=>Te(Cj(e.ast)),ye=e=>Te(gt(e.ast)),f1=(e,t)=>{let r=mn(e,t);return(n,o)=>Jd(r(n,o),vu)},Eae=(e,t)=>{let r=Tie(e,t);return(n,o)=>Ws(r(n,o),vu)},Cae=(e,t)=>{let r=f1(e,t);return(n,o)=>lu(r(n,o))},d1=f1,HRe=Eae,BRe=Cae,oh=(e,t)=>{let r=hn(e,t);return(n,o)=>Jd(r(n,o),vu)},wae=(e,t)=>{let r=TW(e,t);return(n,o)=>Ws(r(n,o),vu)},Oae=(e,t)=>{let r=oh(e,t);return(n,o)=>lu(r(n,o))},zRe=oh,jRe=wae,$Re=Oae,_ae=(e,t)=>{let r=vie(e,t);return(n,o)=>Jd(r(n,o),vu)},VRe=(e,t)=>{let r=Mie(e,t);return(n,o)=>Ws(r(n,o),vu)},GRe=(e,t)=>{let r=_ae(e,t);return(n,o)=>lu(r(n,o))},xn=e=>F(e,Dl)&&jr(e[Dl]);function KRe(e){return pC(e)?Qt.make(dj(e,t=>new Li(t))):new Li(e[0])}function kae(e,t=KRe(e)){return class extends Te(t){static annotations(n){return kae(this.literals,ps(this.ast,n))}static literals=[...e]}}function Bt(...e){return ut(e)?kae(e):L0}var QRe=(...e)=>t=>Bt(...e),Tae=e=>Te(new pf(e)),JRe=e=>new tC(Object.keys(e).filter(t=>typeof e[e[t]]!="number").map(t=>[t,e[t]])),Iae=(e,t=JRe(e))=>class extends Te(t){static annotations(n){return Iae(this.enums,ps(this.ast,n))}static enums={...e}},ZRe=e=>Iae(e),Rae=(...[e,...t])=>{let r=[],n="",o=t;xn(e)?Ma(e.ast)?n=String(e.ast.literal):o=[e,...o]:n=String(e);for(let s=0;s<o.length;s++){let i=o[s];if(xn(i)){if(s<o.length-1){let a=o[s+1];if(xn(a)){if(Ma(a.ast)){r.push(new ip(i.ast,String(a.ast.literal))),s++;continue}}else{r.push(new ip(i.ast,String(a))),s++;continue}}r.push(new ip(i.ast,""))}else r.push(new ip(new Li(i),""))}return Ii(r)?Te(new $g(n,r)):Te(new $g("",[new ip(new Li(n),"")]))};function Aae(e,t){let r=e.ast;switch(r._tag){case"Literal":{let n=r.literal;if(!cr(n)){let o=String(n);return me(Bt(o),t,{strict:!0,decode:()=>n,encode:()=>o})}break}case"NumberKeyword":return $I(XI,t);case"Union":{let n=[],o=!1;for(let s of r.types){let i=Te(s),a=l1(i),c=Aae(a,i);c&&(o=!0),n.push(c??i)}return o?$I(bn(...n),t):t}}}var YRe=(...e)=>{let t=[],r=[],n=[],o=!1;for(let c=0;c<e.length;c++){let l=e[c],f=xn(l)?l:Bt(l);n.push(f);let d=l1(f);t.push(d);let h=Aae(d,f);h?(r.push(h),o=!0):r.push(f)}let s=Rae(...t),i=bj(s.ast),a=Ei(...r);return o&&(a=a.annotations({[cp]:Ft(Ei(...n))})),class extends gr(s,a,{strict:!1,decode:(l,f,d)=>{let h=i.exec(l);return h?it(h.slice(1,e.length+1)):xr(new Oe(d,l,`${i.source}: no match for ${JSON.stringify(l)}`))},encode:l=>it(l.join(""))}){static params=e.slice()}},XRe=(e,t,r)=>aB(e,new uf(e.map(n=>n.ast),(...n)=>t.decode(...n.map(Te)),(...n)=>t.encode(...n.map(Te)),Wu(r))),eAe=(e,t)=>{let r=()=>(o,s,i)=>e(o)?it(o):xr(new Oe(i,o)),n=r;return aB([],new uf([],r,n,Wu(t)))};function aB(e,t){return class extends Te(t){static annotations(n){return aB(this.typeParameters,ps(this.ast,n))}static typeParameters=[...e]}}var ir=function(){if(Array.isArray(arguments[0])){let r=arguments[0],n=arguments[1],o=arguments[2];return XRe(r,n,o)}let e=arguments[0],t=arguments[1];return eAe(e,t)},PW=Symbol.for("effect/SchemaId/Brand"),tAe=(e,t)=>r=>lB(r,new _c(r.ast,function(s,i,a){let c=e.either(s);return kt(c)?x(new Oe(a,s,c.left.map(l=>l.message).join(", "))):g()},Wu({schemaId:PW,[PW]:{constructor:e},...t}))),FW=Symbol.for("effect/SchemaId/InstanceOf"),Mae=(e,t)=>ir(r=>r instanceof e,{title:e.name,description:`an instance of ${e.name}`,pretty:()=>String,schemaId:FW,[FW]:{constructor:e},...t}),N0=class extends Te(lf){},NW=class extends Te(oj){},D0=class extends Te(nj){},L0=class extends Te(Zg){},th=class extends Te(IA){},DW=class extends Te(RA){},Du=class extends Te(sj){},U0=class extends Te(ij){},$e=class extends Te(sC){},gn=class extends Te(iC){},rh=class extends Te(aC){},LW=class extends Te(aj){};var rAe=e=>Qt.make(e.map(t=>t.ast));function vae(e,t=rAe(e)){return class extends Te(t){static annotations(n){return vae(this.members,ps(this.ast,n))}static members=[...e]}}function bn(...e){return pC(e)?vae(e):ut(e)?e[0]:L0}var P0=e=>bn(e,D0),Xd=e=>bn(e,N0),F0=e=>bn(e,D0,N0),nAe=e=>Te(xj(e.ast)),UW=e=>new HI(new wo(e.ast,!1),e),oAe=e=>new HI(new wo(e.ast,!0),e),HI=class e{ast;from;[Dl];_Token;constructor(t,r){this.ast=t,this.from=r}annotations(t){return new e(new wo(this.ast.type,this.ast.isOptional,{...this.ast.annotations,...Wu(t)}),this.from)}toString(){return`${this.ast.type}${this.ast.isOptional?"?":""}`}},sAe=(e,t)=>new wc(e.map(r=>xn(r)?new wo(r.ast,!1):r.ast),t.map(r=>xn(r)?new ap(r.ast):r.ast),!0);function q0(e,t,r=sAe(e,t)){return class extends Te(r){static annotations(o){return q0(this.elements,this.rest,ps(this.ast,o))}static elements=[...e];static rest=[...t]}}function Ei(...e){return Array.isArray(e[0])?q0(e[0],e.slice(1)):q0(e,[])}function Pae(e,t){return class extends q0([],[e],t){static annotations(n){return Pae(this.value,ps(this.ast,n))}static value=e}}var Nt=e=>Pae(e);function Fae(e,t){return class extends q0([e],[e],t){static annotations(n){return Fae(this.value,ps(this.ast,n))}static value=e}}var lg=e=>Fae(e);function iAe(e){return me(bn(e,Nt(e)),Nt(ye(e)),{strict:!0,decode:t=>Kl(t),encode:t=>t.length===1?t[0]:t})}function aAe(e){return me(bn(e,lg(e)),lg(ye(e)),{strict:!0,decode:t=>ut(t)?t:Vr(t),encode:t=>t.length===1?t[0]:t})}var qW=e=>e?'"?:"':'":"',Lu=class extends wo{isReadonly;defaultValue;_tag="PropertySignatureDeclaration";constructor(t,r,n,o,s){super(t,r,o),this.isReadonly=n,this.defaultValue=s}toString(){let t=qW(this.isOptional),r=String(this.type);return`PropertySignature<${t}, ${r}, never, ${t}, ${r}>`}},Uu=class extends wo{isReadonly;fromKey;constructor(t,r,n,o,s){super(t,r,o),this.isReadonly=n,this.fromKey=s}},Ea=class extends wo{isReadonly;defaultValue;constructor(t,r,n,o,s){super(t,r,o),this.isReadonly=n,this.defaultValue=s}},cAe=e=>e===void 0?"never":cr(e)?JSON.stringify(e):String(e),Ci=class{from;to;decode;encode;_tag="PropertySignatureTransformation";constructor(t,r,n,o){this.from=t,this.to=r,this.decode=n,this.encode=o}toString(){return`PropertySignature<${qW(this.to.isOptional)}, ${this.to.type}, ${cAe(this.from.fromKey)}, ${qW(this.from.isOptional)}, ${this.from.type}>`}},Nae=(e,t)=>{switch(e._tag){case"PropertySignatureDeclaration":return new Lu(e.type,e.isOptional,e.isReadonly,{...e.annotations,...t},e.defaultValue);case"PropertySignatureTransformation":return new Ci(e.from,new Ea(e.to.type,e.to.isOptional,e.to.isReadonly,{...e.to.annotations,...t},e.to.defaultValue),e.decode,e.encode)}},cB=Symbol.for("effect/PropertySignature"),h1=e=>F(e,cB),BI=class e{ast;[Dl];[cB]=null;_TypeToken;_Key;_EncodedToken;_HasDefault;constructor(t){this.ast=t}pipe(){return v(this,arguments)}annotations(t){return new e(Nae(this.ast,Wu(t)))}toString(){return String(this.ast)}},sc=e=>new BI(e),W0=class e extends BI{from;constructor(t,r){super(t),this.from=r}annotations(t){return new e(Nae(this.ast,Wu(t)),this.from)}},ug=e=>new W0(new Lu(e.ast,!1,!0,{},void 0),e),Fl=u(2,(e,t)=>{let r=e.ast;switch(r._tag){case"PropertySignatureDeclaration":return sc(new Lu(r.type,r.isOptional,r.isReadonly,r.annotations,t));case"PropertySignatureTransformation":return sc(new Ci(r.from,new Ea(r.to.type,r.to.isOptional,r.to.isReadonly,r.to.annotations,t),r.decode,r.encode))}}),tae=(e,t)=>j(e,{onNone:()=>x(t()),onSome:r=>x(r===void 0?t():r)}),zI=e=>Oj(e,zI,t=>{let r=zI(t.to);if(r)return new Sn(t.from,r,t.transformation)}),Dae=u(2,(e,t)=>{let r=e.ast;switch(r._tag){case"PropertySignatureDeclaration":{let n=gt(r.type);return sc(new Ci(new Uu(r.type,r.isOptional,r.isReadonly,r.annotations),new Ea(zI(n)??n,!1,!0,{},r.defaultValue),o=>tae(o,t),R))}case"PropertySignatureTransformation":{let n=r.to.type;return sc(new Ci(r.from,new Ea(zI(n)??n,!1,r.to.isReadonly,r.to.annotations,r.to.defaultValue),o=>tae(r.decode(o),t),r.encode))}}}),uAe=u(2,(e,t)=>e.pipe(Dae(t.decoding),Fl(t.constructor))),pAe=u(2,(e,t)=>{let r=e.ast;switch(r._tag){case"PropertySignatureDeclaration":return sc(new Ci(new Uu(r.type,r.isOptional,r.isReadonly,r.annotations,t),new Ea(gt(r.type),r.isOptional,r.isReadonly,{},r.defaultValue),R,R));case"PropertySignatureTransformation":return sc(new Ci(new Uu(r.from.type,r.from.isOptional,r.from.isReadonly,r.from.annotations,t),r.to,r.decode,r.encode))}}),Fu=(e,t,r)=>sc(new Ci(new Uu(e.ast,!0,!0,{},void 0),new Ea(t.ast,!1,!0,{},void 0),n=>x(r.decode(n)),kr(r.encode))),lAe=(e,t,r)=>sc(new Ci(new Uu(e.ast,!1,!0,{},void 0),new Ea(t.ast,!0,!0,{},void 0),kr(r.decode),n=>x(r.encode(n)))),WW=(e,t,r)=>sc(new Ci(new Uu(e.ast,!0,!0,{},void 0),new Ea(t.ast,!0,!0,{},void 0),r.decode,r.encode)),fAe=(e,t)=>{let r=t?.exact,n=t?.default,o=t?.nullable,s=t?.as=="Option",i=t?.onNoneEncoding?yo(t.onNoneEncoding):R;if(r){if(n)return o?Fl(Fu(P0(e),ye(e),{decode:j({onNone:n,onSome:a=>a===null?n():a}),encode:x}),n).ast:Fl(Fu(e,ye(e),{decode:j({onNone:n,onSome:R}),encode:x}),n).ast;if(s){let a=HH(ye(e));return o?Fu(P0(e),a,{decode:Qu(sE),encode:i}).ast:Fu(e,a,{decode:R,encode:R}).ast}else return o?WW(P0(e),ye(e),{decode:Qu(sE),encode:R}).ast:new Lu(e.ast,!0,!0,{},void 0)}else{if(n)return o?Fl(Fu(F0(e),ye(e),{decode:j({onNone:n,onSome:a=>a??n()}),encode:x}),n).ast:Fl(Fu(Xd(e),ye(e),{decode:j({onNone:n,onSome:a=>a===void 0?n():a}),encode:x}),n).ast;if(s){let a=HH(ye(e));return o?Fu(F0(e),a,{decode:Qu(c=>c!=null),encode:i}).ast:Fu(Xd(e),a,{decode:Qu(VB),encode:i}).ast}else return o?WW(F0(e),Xd(ye(e)),{decode:Qu(sE),encode:R}).ast:new Lu(Xd(e).ast,!0,!0,{},void 0)}},dAe=e=>{let t=e.ast===lf||e.ast===Zg?lf:Xd(e).ast;return new W0(new Lu(t,!0,!0,{},void 0),e)},hAe=u(e=>xn(e[0]),(e,t)=>new W0(fAe(e,t),e)),mAe=DA([rC]),xAe=(e,t)=>{let r=Reflect.ownKeys(e),n=[];if(r.length>0){let s=[],i=[],a=[];for(let c=0;c<r.length;c++){let l=r[c],f=e[l];if(h1(f)){let d=f.ast;switch(d._tag){case"PropertySignatureDeclaration":{let h=d.type,m=d.isOptional,y=d.annotations;s.push(new It(l,h,m,!0,mAe(d))),i.push(new It(l,gt(h),m,!0,y)),n.push(new It(l,h,m,!0,y));break}case"PropertySignatureTransformation":{let h=d.from.fromKey??l;s.push(new It(h,d.from.type,d.from.isOptional,!0,d.from.annotations)),i.push(new It(l,d.to.type,d.to.isOptional,!0,d.to.annotations)),a.push(new Hh(h,l,d.decode,d.encode));break}}}else s.push(new It(l,f.ast,!1,!0)),i.push(new It(l,gt(f.ast),!1,!0)),n.push(new It(l,f.ast,!1,!0))}if(ut(a)){let c=[],l=[];for(let f of t){let{indexSignatures:d,propertySignatures:h}=NA(f.key.ast,f.value.ast);h.forEach(m=>{s.push(m),i.push(new It(m.name,gt(m.type),m.isOptional,m.isReadonly,m.annotations))}),d.forEach(m=>{c.push(m),l.push(new Oc(m.parameter,gt(m.type),m.isReadonly))})}return new Sn(new rn(s,c,{[cp]:"Struct (Encoded side)"}),new rn(i,l,{[cp]:"Struct (Type side)"}),new kc(a))}}let o=[];for(let s of t){let{indexSignatures:i,propertySignatures:a}=NA(s.key.ast,s.value.ast);a.forEach(c=>n.push(c)),i.forEach(c=>o.push(c))}return new rn(n,o)},Lae=(e,t)=>{let r=Reflect.ownKeys(e);for(let n of r){let o=e[n];if(t[n]===void 0&&h1(o)){let s=o.ast,i=s._tag==="PropertySignatureDeclaration"?s.defaultValue:s.to.defaultValue;i!==void 0&&(t[n]=i())}}return t};function uB(e,t,r=xAe(e,t)){return class extends Te(r){static annotations(o){return uB(this.fields,this.records,ps(this.ast,o))}static fields={...e};static records=[...t];static make=(o,s)=>{let i=Lae(e,{...o});return y1(s)?i:Zd(this)(i)};static pick(...o){return zt(Jie(e,...o))}static omit(...o){return zt(Zie(e,...o))}}}function zt(e,...t){return uB(e,t)}var Uae=e=>Bt(e).pipe(ug,Fl(()=>e)),J0=(e,t)=>zt({_tag:Uae(e),...t});function qae(e,t,r){return class extends uB({},[{key:e,value:t}],r){static annotations(o){return qae(e,t,ps(this.ast,o))}static key=e;static value=t}}var pB=e=>qae(e.key,e.value),Wae=(...e)=>t=>Te(Di(t.ast,e)),gAe=(...e)=>t=>Te(Sj(t.ast,e)),bAe=u(2,(e,t)=>{let r=af(gt(e.ast),t),n=Te(r.isOptional?zg(r.type):r.type);return me(e.pipe(Wae(t)),n,{strict:!0,decode:s=>s[t],encode:s=>r.isOptional&&s===void 0?{}:{[t]:s}})});function lB(e,t){return class extends Te(t){static annotations(n){return lB(this.from,ps(this.ast,n))}static make=(n,o)=>y1(o)?n:Zd(this)(n);static from=e}}var yAe=(e,t)=>r=>{let n=j(wA(r.ast),{onNone:()=>[e],onSome:s=>[...s,e]}),o=tb(r.ast,Wu({[lA]:n,...t}));return lB(r,o)},SAe=e=>Te(cf(e.ast)),EAe=u(e=>xn(e[0]),(e,t)=>Te(cf(e.ast,t))),CAe=e=>Te(Wh(e.ast)),wAe=e=>Te(sf(e.ast)),M0=(e,t,r)=>{if(vA(e)&&vA(t)){let n=[...e.propertySignatures];for(let o of t.propertySignatures){let s=o.name,i=n.findIndex(a=>a.name===s);if(i===-1)n.push(o);else{let{isOptional:a,type:c}=n[i];n[i]=new It(s,jI(c,o.type,r.concat(s)),a,!0)}}return new rn(n,e.indexSignatures.concat(t.indexSignatures))}throw new Error(GR(e,t,r))},OAe=Ej([Gg]),v0=(e,t)=>t.map(r=>new _c(r,e.filter,OAe(e))),jI=(e,t,r)=>Qt.make(Nu([e],[t],r)),Yd=e=>Xg(e)?e.types:[e],Nu=(e,t,r)=>Ql(e,n=>Ql(t,o=>{switch(o._tag){case"Literal":{if(cr(o.literal)&&Yg(n)||go(o.literal)&&AA(n)||Oi(o.literal)&&MA(n))return[o];break}case"StringKeyword":{if(o===sC){if(Yg(n)||Ma(n)&&cr(n.literal))return[n];if(pp(n))return v0(n,Nu(Yd(n.from),[o],r))}else if(n===sC)return[o];break}case"NumberKeyword":{if(o===iC){if(AA(n)||Ma(n)&&go(n.literal))return[n];if(pp(n))return v0(n,Nu(Yd(n.from),[o],r))}else if(n===iC)return[o];break}case"BooleanKeyword":{if(o===aC){if(MA(n)||Ma(n)&&Oi(n.literal))return[n];if(pp(n))return v0(n,Nu(Yd(n.from),[o],r))}else if(n===aC)return[o];break}case"Union":return Nu(Yd(n),o.types,r);case"Suspend":return[new js(()=>jI(n,o.f(),r))];case"Refinement":return v0(o,Nu(Yd(n),Yd(o.from),r));case"TypeLiteral":{switch(n._tag){case"Union":return Nu(n.types,[o],r);case"Suspend":return[new js(()=>jI(n.f(),o,r))];case"Refinement":return v0(n,Nu(Yd(n.from),[o],r));case"TypeLiteral":return[M0(n,o,r)];case"Transformation":{let s=n.transformation,i=M0(n.from,o,r),a=M0(n.to,gt(o),r);switch(s._tag){case"TypeLiteralTransformation":return[new Sn(i,a,new kc(s.propertySignatureTransformations))];case"ComposeTransformation":return[new Sn(i,a,fC)];case"FinalTransformation":return[new Sn(i,a,new Vg((c,l,f,d)=>Tn(s.decode(c,l,f,d),h=>({...c,...h})),(c,l,f,d)=>Tn(s.encode(c,l,f,d),h=>({...c,...h}))))]}}}break}case"Transformation":{if(hj(n)){if(eb(o.transformation)&&eb(n.transformation))return[new Sn(M0(n.from,o.from,r),M0(n.to,o.to,r),new kc(o.transformation.propertySignatureTransformations.concat(n.transformation.propertySignatureTransformations)))]}else return Nu([o],[n],r);break}}throw new Error(GR(n,o,r))})),Z0=u(2,(e,t)=>Te(jI(e.ast,t.ast,[]))),$I=u(e=>xn(e[1]),(e,t)=>dB(e,t,UA(e.ast,t.ast))),VI=e=>Te(new js(()=>e().ast)),fB=Symbol.for("effect/SchemaId/Refine");function Hae(e,t,r){return class extends Te(r){static annotations(o){return Hae(this.from,this.filter,ps(this.ast,o))}static[fB]=e;static from=e;static filter=t;static make=(o,s)=>y1(s)?o:Zd(this)(o)}}var rae=(e,t,r)=>{if(Oi(e))return e?g():x(new Oe(t,r));if(cr(e))return x(new Oe(t,r,e));if(e!==void 0){if("_tag"in e)return x(e);let n=new Oe(t,r,e.message);return x(ut(e.path)?new tn(e.path,r,n):n)}return g()},Bae=(e,t,r)=>{if(f6(e))return rae(e,t,r);if(ut(e)){let n=hc(e,o=>rae(o,t,r));if(ut(n))return x(n.length===1?n[0]:new mr(t,r,n))}return g()};function Se(e,t){return r=>{function n(s,i,a){return Bae(e(s,i,a),a,s)}let o=new _c(r.ast,n,Wu(t));return Hae(r,n,o)}}var _Ae=u(2,(e,t)=>gr(e,ye(e),{strict:!0,decode:(r,n,o)=>Fs(t(r,n,o),s=>j(Bae(s,o,r),{onNone:()=>it(r),onSome:xr})),encode:r=>it(r)}));function dB(e,t,r){return class extends Te(r){static annotations(o){return dB(this.from,this.to,ps(this.ast,o))}static from=e;static to=t}}var gr=u(e=>xn(e[0])&&xn(e[1]),(e,t,r)=>dB(e,t,new Sn(e.ast,t.ast,new Vg(r.decode,r.encode)))),me=u(e=>xn(e[0])&&xn(e[1]),(e,t,r)=>gr(e,t,{strict:!0,decode:(n,o,s,i)=>it(r.decode(n,i)),encode:(n,o,s,i)=>it(r.encode(n,i))}));function zae(e,t){return me(Bt(e),Bt(t),{strict:!0,decode:()=>t,encode:()=>e})}function kAe(...e){return bn(...e.map(([t,r])=>zae(t,r)))}var TAe=u(e=>xn(e[0]),(e,t,r,n)=>{let o=Z0(ye(e),zt({[t]:Oa(r)?Tae(r):Bt(r)})).ast;return Te(new Sn(e.ast,n?ps(o,n):o,new kc([new Hh(t,t,()=>x(r),()=>g())])))}),IAe=u(2,(e,t)=>e.annotations(t)),RAe=u(2,(e,t)=>Te(jg(e.ast,t))),jae=Symbol.for("effect/SchemaId/Trimmed"),$ae=e=>t=>t.pipe(Se(r=>r===r.trim(),{schemaId:jae,title:"trimmed",description:"a string with no leading or trailing whitespace",jsonSchema:{pattern:"^\\S[\\s\\S]*\\S$|^\\S$|^$"},...e})),Vae=L6,AAe=(e,t)=>r=>r.pipe(Se(n=>n.length<=e,{schemaId:Vae,title:`maxLength(${e})`,description:`a string at most ${e} character(s) long`,jsonSchema:{maxLength:e},...t})),Gae=D6,Kae=(e,t)=>r=>r.pipe(Se(n=>n.length>=e,{schemaId:Gae,title:`minLength(${e})`,description:`a string at least ${e} character(s) long`,jsonSchema:{minLength:e},...t})),HW=U6,Qae=(e,t)=>r=>{let n=jr(e)?Math.max(0,Math.floor(e.min)):Math.max(0,Math.floor(e)),o=jr(e)?Math.max(n,Math.floor(e.max)):n;return n!==o?r.pipe(Se(s=>s.length>=n&&s.length<=o,{schemaId:HW,title:`length({ min: ${n}, max: ${o})`,description:`a string at least ${n} character(s) and at most ${o} character(s) long`,jsonSchema:{minLength:n,maxLength:o},...t})):r.pipe(Se(s=>s.length===n,{schemaId:HW,title:`length(${n})`,description:n===1?"a single character":`a string ${n} character(s) long`,jsonSchema:{minLength:n,maxLength:n},...t}))},BW=Symbol.for("effect/SchemaId/Pattern"),hB=(e,t)=>r=>{let n=e.source;return r.pipe(Se(o=>(e.lastIndex=0,e.test(o)),{schemaId:BW,[BW]:{regex:e},description:`a string matching the pattern ${n}`,jsonSchema:{pattern:n},...t}))},zW=Symbol.for("effect/SchemaId/StartsWith"),MAe=(e,t)=>r=>{let n=JSON.stringify(e);return r.pipe(Se(o=>o.startsWith(e),{schemaId:zW,[zW]:{startsWith:e},title:`startsWith(${n})`,description:`a string starting with ${n}`,jsonSchema:{pattern:`^${e}`},...t}))},jW=Symbol.for("effect/SchemaId/EndsWith"),vAe=(e,t)=>r=>{let n=JSON.stringify(e);return r.pipe(Se(o=>o.endsWith(e),{schemaId:jW,[jW]:{endsWith:e},title:`endsWith(${n})`,description:`a string ending with ${n}`,jsonSchema:{pattern:`^.*${e}$`},...t}))},$W=Symbol.for("effect/SchemaId/Includes"),PAe=(e,t)=>r=>{let n=JSON.stringify(e);return r.pipe(Se(o=>o.includes(e),{schemaId:$W,[$W]:{includes:e},title:`includes(${n})`,description:`a string including ${n}`,jsonSchema:{pattern:`.*${e}.*`},...t}))},Jae=Symbol.for("effect/SchemaId/Lowercased"),Zae=e=>t=>t.pipe(Se(r=>r===r.toLowerCase(),{schemaId:Jae,title:"lowercased",description:"a lowercase string",jsonSchema:{pattern:"^[^A-Z]*$"},...e})),GI=class extends $e.pipe(Zae({identifier:"Lowercased"})){},Yae=Symbol.for("effect/SchemaId/Uppercased"),Xae=e=>t=>t.pipe(Se(r=>r===r.toUpperCase(),{schemaId:Yae,title:"uppercased",description:"an uppercase string",jsonSchema:{pattern:"^[^a-z]*$"},...e})),KI=class extends $e.pipe(Xae({identifier:"Uppercased"})){},ece=Symbol.for("effect/SchemaId/Capitalized"),tce=e=>t=>t.pipe(Se(r=>r[0]?.toUpperCase()===r[0],{schemaId:ece,title:"capitalized",description:"a capitalized string",jsonSchema:{pattern:"^[^a-z]?.*$"},...e})),QI=class extends $e.pipe(tce({identifier:"Capitalized"})){},rce=Symbol.for("effect/SchemaId/Uncapitalized"),nce=e=>t=>t.pipe(Se(r=>r[0]?.toLowerCase()===r[0],{schemaId:rce,title:"uncapitalized",description:"a uncapitalized string",jsonSchema:{pattern:"^[^A-Z]?.*$"},...e})),JI=class extends $e.pipe(nce({identifier:"Uncapitalized"})){},VW=class extends $e.pipe(Qae(1,{identifier:"Char"})){},mB=e=>Kae(1,{title:"nonEmptyString",description:"a non empty string",...e}),GW=class extends me($e.annotations({description:"a string that will be converted to lowercase"}),GI,{strict:!0,decode:t=>t.toLowerCase(),encode:R}).annotations({identifier:"Lowercase"}){},KW=class extends me($e.annotations({description:"a string that will be converted to uppercase"}),KI,{strict:!0,decode:t=>t.toUpperCase(),encode:R}).annotations({identifier:"Uppercase"}){},QW=class extends me($e.annotations({description:"a string that will be converted to a capitalized format"}),QI,{strict:!0,decode:t=>nY(t),encode:R}).annotations({identifier:"Capitalize"}){},JW=class extends me($e.annotations({description:"a string that will be converted to an uncapitalized format"}),JI,{strict:!0,decode:t=>oY(t),encode:R}).annotations({identifier:"Uncapitalize"}){},H0=class extends $e.pipe($ae({identifier:"Trimmed"})){},ZI=class extends H0.pipe(mB({identifier:"NonEmptyTrimmedString"})){},ZW=class extends me($e.annotations({description:"a string that will be trimmed"}),H0,{strict:!0,decode:t=>t.trim(),encode:R}).annotations({identifier:"Trim"}){},FAe=e=>me($e.annotations({description:"a string that will be split"}),Nt($e),{strict:!0,decode:t=>t.split(e),encode:t=>t.join(e)}),YW=e=>e instanceof Error?e.message:String(e),NAe=e=>gr($e.annotations({description:"a string to be decoded into JSON"}),th,{strict:!0,decode:(t,r,n)=>ag({try:()=>JSON.parse(t,e?.reviver),catch:o=>new Oe(n,t,YW(o))}),encode:(t,r,n)=>ag({try:()=>JSON.stringify(t,e?.replacer,e?.space),catch:o=>new Oe(n,t,YW(o))})}).annotations({title:"parseJson",schemaId:rj}),oce=(e,t)=>xn(e)?$I(oce(t),e):NAe(e),XW=class extends $e.pipe(mB({identifier:"NonEmptyString"})){},sce=Symbol.for("effect/SchemaId/UUID"),nae=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i,eH=class extends $e.pipe(hB(nae,{schemaId:sce,identifier:"UUID",jsonSchema:{format:"uuid",pattern:nae.source},description:"a Universally Unique Identifier",arbitrary:()=>t=>t.uuid()})){},ice=Symbol.for("effect/SchemaId/ULID"),DAe=/^[0-7][0-9A-HJKMNP-TV-Z]{25}$/i,tH=class extends $e.pipe(hB(DAe,{schemaId:ice,identifier:"ULID",description:"a Universally Unique Lexicographically Sortable Identifier",arbitrary:()=>t=>t.ulid()})){},YI=class extends Mae(URL,{identifier:"URLFromSelf",arbitrary:()=>t=>t.webUrl().map(r=>new URL(r)),pretty:()=>t=>t.toString()}){},rH=class extends gr($e.annotations({description:"a string to be decoded into a URL"}),YI,{strict:!0,decode:(t,r,n)=>ag({try:()=>new URL(t),catch:o=>new Oe(n,t,`Unable to decode ${JSON.stringify(t)} into a URL. ${YW(o)}`)}),encode:t=>it(t.toString())}).annotations({identifier:"URL",pretty:()=>t=>t.toString()}){};var ace=I6,xB=e=>t=>t.pipe(Se(Number.isFinite,{schemaId:ace,title:"finite",description:"a finite number",jsonSchema:{},...e})),cce=C6,uce=(e,t)=>r=>r.pipe(Se(n=>n>e,{schemaId:cce,title:`greaterThan(${e})`,description:e===0?"a positive number":`a number greater than ${e}`,jsonSchema:{exclusiveMinimum:e},...t})),pce=w6,lce=(e,t)=>r=>r.pipe(Se(n=>n>=e,{schemaId:pce,title:`greaterThanOrEqualTo(${e})`,description:e===0?"a non-negative number":`a number greater than or equal to ${e}`,jsonSchema:{minimum:e},...t})),fce=Symbol.for("effect/SchemaId/MultipleOf"),LAe=(e,t)=>r=>{let n=Math.abs(e);return r.pipe(Se(o=>z6(o,e)===0,{schemaId:fce,title:`multipleOf(${n})`,description:`a number divisible by ${n}`,jsonSchema:{multipleOf:n},...t}))},dce=k6,gB=e=>t=>t.pipe(Se(r=>Number.isSafeInteger(r),{schemaId:dce,title:"int",description:"an integer",jsonSchema:{type:"integer"},...e})),hce=O6,mce=(e,t)=>r=>r.pipe(Se(n=>n<e,{schemaId:hce,title:`lessThan(${e})`,description:e===0?"a negative number":`a number less than ${e}`,jsonSchema:{exclusiveMaximum:e},...t})),xce=_6,gce=(e,t)=>r=>r.pipe(Se(n=>n<=e,{schemaId:xce,title:`lessThanOrEqualTo(${e})`,description:e===0?"a non-positive number":`a number less than or equal to ${e}`,jsonSchema:{maximum:e},...t})),bce=A6,bB=(e,t,r)=>n=>n.pipe(Se(o=>o>=e&&o<=t,{schemaId:bce,title:`between(${e}, ${t})`,description:`a number between ${e} and ${t}`,jsonSchema:{minimum:e,maximum:t},...r})),yce=T6,Sce=e=>t=>t.pipe(Se(r=>!Number.isNaN(r),{schemaId:yce,title:"nonNaN",description:"a number excluding NaN",...e})),Ece=e=>uce(0,{title:"positive",...e}),Cce=e=>mce(0,{title:"negative",...e}),wce=e=>gce(0,{title:"nonPositive",...e}),Oce=e=>lce(0,{title:"nonNegative",...e}),UAe=(e,t)=>r=>me(r,ye(r).pipe(bB(e,t)),{strict:!1,decode:n=>B6(n,{minimum:e,maximum:t}),encode:R});function _ce(e){return gr(e,gn,{strict:!1,decode:(t,r,n)=>O0($6(t),()=>new Oe(n,t,`Unable to decode ${JSON.stringify(t)} into a number`)),encode:t=>it(String(t))})}var XI=class extends _ce($e.annotations({description:"a string to be decoded into a number"})).annotations({identifier:"NumberFromString"}){},nH=class extends gn.pipe(xB({identifier:"Finite"})){},B0=class extends gn.pipe(gB({identifier:"Int"})){},oH=class extends gn.pipe(Sce({identifier:"NonNaN"})){},sH=class extends gn.pipe(Ece({identifier:"Positive"})){},iH=class extends gn.pipe(Cce({identifier:"Negative"})){},aH=class extends gn.pipe(wce({identifier:"NonPositive"})){},z0=class extends gn.pipe(Oce({identifier:"NonNegative"})){},kce=R6,cH=class extends gn.pipe(xB({schemaId:kce,identifier:"JsonNumber"})){},uH=class extends me(rh.annotations({description:"a boolean that will be negated"}),rh,{strict:!0,decode:t=>nb(t),encode:t=>nb(t)}){},Tce=(e,t)=>{let r=Symbol.keyFor(e);return r===void 0?xr(new Oe(t,e,`Unable to encode a unique symbol ${String(e)} into a string`)):it(r)},Ice=e=>it(Symbol.for(e)),pH=class extends gr($e.annotations({description:"a string to be decoded into a globally shared symbol"}),U0,{strict:!1,decode:t=>Ice(t),encode:(t,r,n)=>Tce(t,n)}).annotations({identifier:"Symbol"}){};var lH=M6,Rce=(e,t)=>r=>r.pipe(Se(n=>n>e,{schemaId:lH,[lH]:{min:e},title:`greaterThanBigInt(${e})`,description:e===0n?"a positive bigint":`a bigint greater than ${e}n`,...t})),fH=v6,Ace=(e,t)=>r=>r.pipe(Se(n=>n>=e,{schemaId:fH,[fH]:{min:e},title:`greaterThanOrEqualToBigInt(${e})`,description:e===0n?"a non-negative bigint":`a bigint greater than or equal to ${e}n`,...t})),dH=P6,Mce=(e,t)=>r=>r.pipe(Se(n=>n<e,{schemaId:dH,[dH]:{max:e},title:`lessThanBigInt(${e})`,description:e===0n?"a negative bigint":`a bigint less than ${e}n`,...t})),hH=F6,vce=(e,t)=>r=>r.pipe(Se(n=>n<=e,{schemaId:hH,[hH]:{max:e},title:`lessThanOrEqualToBigInt(${e})`,description:e===0n?"a non-positive bigint":`a bigint less than or equal to ${e}n`,...t})),mH=N6,yB=(e,t,r)=>n=>n.pipe(Se(o=>o>=e&&o<=t,{schemaId:mH,[mH]:{min:e,max:t},title:`betweenBigInt(${e}, ${t})`,description:`a bigint between ${e}n and ${t}n`,...r})),SB=e=>Rce(0n,{title:"positiveBigInt",...e}),EB=e=>Mce(0n,{title:"negativeBigInt",...e}),CB=e=>Ace(0n,{title:"nonNegativeBigInt",...e}),wB=e=>vce(0n,{title:"nonPositiveBigInt",...e}),qAe=(e,t)=>r=>me(r,r.pipe(ye,yB(e,t)),{strict:!1,decode:n=>qj(n,{minimum:e,maximum:t}),encode:R}),Ll=class extends gr($e.annotations({description:"a string to be decoded into a bigint"}),Du,{strict:!0,decode:(t,r,n)=>O0(Hj(t),()=>new Oe(n,t,`Unable to decode ${JSON.stringify(t)} into a bigint`)),encode:t=>it(String(t))}).annotations({identifier:"BigInt"}){};var WAe=Du.pipe(SB({identifier:"PositiveBigintFromSelf"})),HAe=Ll.pipe(SB({identifier:"PositiveBigint"})),BAe=Du.pipe(EB({identifier:"NegativeBigintFromSelf"})),zAe=Ll.pipe(EB({identifier:"NegativeBigint"})),jAe=Du.pipe(wB({identifier:"NonPositiveBigintFromSelf"})),$Ae=Ll.pipe(wB({identifier:"NonPositiveBigint"})),Pce=Du.pipe(CB({identifier:"NonNegativeBigintFromSelf"})),VAe=Ll.pipe(CB({identifier:"NonNegativeBigint"})),xH=class extends gr(gn.annotations({description:"a number to be decoded into a bigint"}),Du.pipe(yB(BigInt(Number.MIN_SAFE_INTEGER),BigInt(Number.MAX_SAFE_INTEGER))),{strict:!0,decode:(t,r,n)=>O0(Bj(t),()=>new Oe(n,t,`Unable to decode ${t} into a bigint`)),encode:(t,r,n)=>O0(Wj(t),()=>new Oe(n,t,`Unable to encode ${t}n into a number`))}).annotations({identifier:"BigIntFromNumber"}){},GAe=e=>t=>e(t).map(WI),mo=(e,t,r,n)=>_ie(e,{onFailure:o=>new mr(r,n,o),onSuccess:t}),oae=e=>(t,r,n)=>Gie(t)?mo(e(A0(t),r),WI,n,t):xr(new Oe(n,t)),Fce=e=>ir([e],{decode:t=>oae(hn(t)),encode:t=>oae(mn(t))},{description:"Redacted(<redacted>)",pretty:()=>()=>"Redacted(<redacted>)",arbitrary:GAe,equivalence:Kie});function KAe(e){return me(e,Fce(ye(e)),{strict:!0,decode:t=>WI(t),encode:t=>A0(t)})}var fg=class extends ir(CC,{identifier:"DurationFromSelf",pretty:()=>String,arbitrary:()=>t=>t.oneof(t.constant(ab),t.bigInt({min:0n}).map(r=>Ks(r)),t.maxSafeNat().map(r=>wn(r))),equivalence:()=>pM}){},gH=class extends gr(Pce.annotations({description:"a bigint to be decoded into a Duration"}),fg.pipe(Se(t=>x4(t),{description:"a finite duration"})),{strict:!0,decode:t=>it(Ks(t)),encode:(t,r,n)=>j(g4(t),{onNone:()=>xr(new Oe(n,t,`Unable to encode ${t} into a bigint`)),onSome:o=>it(o)})}).annotations({identifier:"DurationFromNanos"}){},e1=z0.pipe(gB()).annotations({identifier:"NonNegativeInt"}),bH=class extends me(z0.annotations({description:"a non-negative number to be decoded into a Duration"}),fg,{strict:!0,decode:t=>wn(t),encode:t=>Kr(t)}).annotations({identifier:"DurationFromMillis"}){},Nce=J0("Millis",{millis:e1}),Dce=J0("Nanos",{nanos:Ll}),Lce=J0("Infinity",{}),QAe=Lce.make({}),JAe=bn(Nce,Dce,Lce).annotations({identifier:"DurationValue",description:"an JSON-compatible tagged union to be decoded into a Duration"}),ZAe=Ei(UW(e1).annotations({title:"seconds"}),UW(e1).annotations({title:"nanos"})).annotations({identifier:"FiniteHRTime"}),YAe=Ei(Bt(-1),Bt(0)).annotations({identifier:"InfiniteHRTime"}),XAe=bn(ZAe,YAe).annotations({identifier:"HRTime",description:"a tuple of seconds and nanos to be decoded into a Duration"}),eMe=e=>typeof e=="object",yH=class extends me(bn(JAe,XAe),fg,{strict:!0,decode:t=>{if(eMe(t))switch(t._tag){case"Millis":return wn(t.millis);case"Nanos":return Ks(t.nanos);case"Infinity":return ab}let[r,n]=t;return r===-1?ab:Ks(BigInt(r)*BigInt(1e9)+BigInt(n))},encode:t=>{switch(t.value._tag){case"Millis":return Nce.make({millis:t.value.millis});case"Nanos":return Dce.make({nanos:t.value.nanos});case"Infinity":return QAe}}}).annotations({identifier:"Duration"}){},tMe=(e,t)=>r=>me(r,r.pipe(ye,Uce(e,t)),{strict:!1,decode:n=>S4(n,{minimum:e,maximum:t}),encode:R}),j0=Symbol.for("effect/SchemaId/LessThanDuration"),rMe=(e,t)=>r=>r.pipe(Se(n=>lM(n,e),{schemaId:j0,[j0]:{max:e},title:`lessThanDuration(${e})`,description:`a Duration less than ${Qe(e)}`,...t})),nMe=Symbol.for("effect/schema/LessThanOrEqualToDuration"),oMe=(e,t)=>r=>r.pipe(Se(n=>wC(n,e),{schemaId:j0,[j0]:{max:e},title:`lessThanOrEqualToDuration(${e})`,description:`a Duration less than or equal to ${Qe(e)}`,...t})),SH=Symbol.for("effect/SchemaId/GreaterThanDuration"),sMe=(e,t)=>r=>r.pipe(Se(n=>OC(n,e),{schemaId:SH,[SH]:{min:e},title:`greaterThanDuration(${e})`,description:`a Duration greater than ${Qe(e)}`,...t})),EH=Symbol.for("effect/schema/GreaterThanOrEqualToDuration"),iMe=(e,t)=>r=>r.pipe(Se(n=>cb(n,e),{schemaId:EH,[EH]:{min:e},title:`greaterThanOrEqualToDuration(${e})`,description:`a Duration greater than or equal to ${Qe(e)}`,...t})),CH=Symbol.for("effect/SchemaId/BetweenDuration"),Uce=(e,t,r)=>n=>n.pipe(Se(o=>y4(o,{minimum:e,maximum:t}),{schemaId:CH,[CH]:{maximum:t,minimum:e},title:`betweenDuration(${e}, ${t})`,description:`a Duration between ${Qe(e)} and ${Qe(t)}`,...r})),$0=class extends ir(QB,{identifier:"Uint8ArrayFromSelf",pretty:()=>t=>`new Uint8Array(${JSON.stringify(Array.from(t))})`,arbitrary:()=>t=>t.uint8Array(),equivalence:()=>An(N)}){},t1=class extends gn.pipe(bB(0,255,{identifier:"Uint8",description:"a 8-bit unsigned integer"})){},wH=class extends me(Nt(t1).annotations({description:"an array of 8-bit unsigned integers to be decoded into a Uint8Array"}),$0,{strict:!0,decode:t=>Uint8Array.from(t),encode:t=>Array.from(t)}).annotations({identifier:"Uint8Array"}){};var OB=(e,t,r)=>gr($e.annotations({description:"a string to be decoded into a Uint8Array"}),$0,{strict:!0,decode:(n,o,s)=>Ws(t(n),i=>new Oe(s,n,i.message)),encode:n=>it(r(n))}).annotations({identifier:e}),aMe=OB("Uint8ArrayFromBase64",pW,uW),cMe=OB("Uint8ArrayFromBase64Url",fW,lW),uMe=OB("Uint8ArrayFromHex",hW,dW),_B=(e,t,r)=>gr($e.annotations({description:`A string that is interpreted as being ${e}-encoded and will be decoded into a UTF-8 string`}),$e,{strict:!0,decode:(n,o,s)=>Ws(t(n),i=>new Oe(s,n,i.message)),encode:n=>it(r(n))}).annotations({identifier:`StringFrom${e}`}),pMe=_B("Base64",fie,uW),lMe=_B("Base64Url",die,lW),fMe=_B("Hex",hie,dW),dMe=gr($e.annotations({description:"A string that is interpreted as being UriComponent-encoded and will be decoded into a UTF-8 string"}),$e,{strict:!0,decode:(e,t,r)=>Ws(xie(e),n=>new Oe(r,e,n.message)),encode:(e,t,r)=>Ws(mie(e),n=>new Oe(r,e,n.message))}).annotations({identifier:"StringFromUriComponent"}),qce=q6,hMe=(e,t)=>r=>{let n=Math.floor(e);if(n<1)throw new Error(YE(`Expected an integer greater than or equal to 1, actual ${e}`));return r.pipe(Se(o=>o.length>=n,{schemaId:qce,title:`minItems(${n})`,description:`an array of at least ${n} item(s)`,jsonSchema:{minItems:n},[Qg]:!0,...t}))},Wce=W6,mMe=(e,t)=>r=>{let n=Math.floor(e);if(n<1)throw new Error(YE(`Expected an integer greater than or equal to 1, actual ${e}`));return r.pipe(Se(o=>o.length<=n,{schemaId:Wce,title:`maxItems(${n})`,description:`an array of at most ${n} item(s)`,jsonSchema:{maxItems:n},[Qg]:!0,...t}))},Hce=H6,xMe=(e,t)=>r=>{let n=Math.floor(e);if(n<0)throw new Error(YE(`Expected an integer greater than or equal to 0, actual ${e}`));return r.pipe(Se(o=>o.length===n,{schemaId:Hce,title:`itemsCount(${n})`,description:`an array of exactly ${n} item(s)`,jsonSchema:{minItems:n,maxItems:n},[Qg]:!0,...t}))},m1=e=>Te(Bg(e.ast));function gMe(e){return me(e,sh(m1(ye(e))),{strict:!1,decode:t=>Ia(t),encode:t=>j(t,{onNone:()=>[],onSome:Vr})})}function bMe(e){return me(e,m1(ye(e)),{strict:!1,decode:t=>Lr(t),encode:t=>Vr(t)})}var yMe=u(e=>xn(e[0]),(e,t)=>gr(e,m1(ye(e)),{strict:!0,decode:(r,n,o)=>r.length>0?it(r[0]):t?it(t()):xr(new Oe(o,r,"Unable to retrieve the first element of an empty array")),encode:r=>it(Vr(r))})),OH=Symbol.for("effect/SchemaId/ValidDate"),kB=e=>t=>t.pipe(Se(r=>!Number.isNaN(r.getTime()),{schemaId:OH,[OH]:{noInvalidDate:!0},title:"validDate",description:"a valid Date",...e})),_H=Symbol.for("effect/SchemaId/LessThanDate"),SMe=(e,t)=>r=>r.pipe(Se(n=>n<e,{schemaId:_H,[_H]:{max:e},title:`lessThanDate(${bo(e)})`,description:`a date before ${bo(e)}`,...t})),kH=Symbol.for("effect/schema/LessThanOrEqualToDate"),EMe=(e,t)=>r=>r.pipe(Se(n=>n<=e,{schemaId:kH,[kH]:{max:e},title:`lessThanOrEqualToDate(${bo(e)})`,description:`a date before or equal to ${bo(e)}`,...t})),TH=Symbol.for("effect/SchemaId/GreaterThanDate"),CMe=(e,t)=>r=>r.pipe(Se(n=>n>e,{schemaId:TH,[TH]:{min:e},title:`greaterThanDate(${bo(e)})`,description:`a date after ${bo(e)}`,...t})),IH=Symbol.for("effect/schema/GreaterThanOrEqualToDate"),wMe=(e,t)=>r=>r.pipe(Se(n=>n>=e,{schemaId:IH,[IH]:{min:e},title:`greaterThanOrEqualToDate(${bo(e)})`,description:`a date after or equal to ${bo(e)}`,...t})),RH=Symbol.for("effect/SchemaId/BetweenDate"),OMe=(e,t,r)=>n=>n.pipe(Se(o=>o<=t&&o>=e,{schemaId:RH,[RH]:{max:t,min:e},title:`betweenDate(${bo(e)}, ${bo(t)})`,description:`a date between ${bo(e)} and ${bo(t)}`,...r})),AH=E6,nh=class extends ir(iE,{identifier:"DateFromSelf",schemaId:AH,[AH]:{noInvalidDate:!1},description:"a potentially invalid Date instance",pretty:()=>t=>`new Date(${JSON.stringify(t)})`,arbitrary:()=>t=>t.date({noInvalidDate:!1}),equivalence:()=>qB}){},MH=class extends nh.pipe(kB({identifier:"ValidDateFromSelf",description:"a valid Date instance"})){},r1=class extends me($e.annotations({description:"a string to be decoded into a Date"}),nh,{strict:!0,decode:t=>new Date(t),encode:t=>bo(t)}).annotations({identifier:"DateFromString"}){},vH=class extends r1.pipe(kB({identifier:"Date"})){};var PH=class extends me(gn.annotations({description:"a number to be decoded into a Date"}),nh,{strict:!0,decode:t=>new Date(t),encode:t=>t.getTime()}).annotations({identifier:"DateFromNumber"}){},dg=class extends ir(t=>eW(t)&&Gse(t),{identifier:"DateTimeUtcFromSelf",description:"a DateTime.Utc instance",pretty:()=>t=>t.toString(),arbitrary:()=>t=>t.date({noInvalidDate:!0}).map(r=>Qse(r)),equivalence:()=>tW}){},TB=(e,t)=>ag({try:()=>Jse(e),catch:()=>new Oe(t,e,`Unable to decode ${Wo(e)} into a DateTime.Utc`)}),FH=class extends gr(gn.annotations({description:"a number to be decoded into a DateTime.Utc"}),dg,{strict:!0,decode:(t,r,n)=>TB(t,n),encode:t=>it(rie(t))}).annotations({identifier:"DateTimeUtcFromNumber"}){},NH=class extends gr(nh.annotations({description:"a Date to be decoded into a DateTime.Utc"}),dg,{strict:!0,decode:(t,r,n)=>TB(t,n),encode:t=>it(tie(t))}).annotations({identifier:"DateTimeUtcFromDate"}){},DH=class extends gr($e.annotations({description:"a string to be decoded into a DateTime.Utc"}),dg,{strict:!0,decode:(t,r,n)=>TB(t,n),encode:t=>it(nie(t))}).annotations({identifier:"DateTimeUtc"}){},Bce=()=>e=>e.integer({min:-720*60*1e3,max:840*60*1e3}).map(nW),V0=class extends ir($se,{identifier:"TimeZoneOffsetFromSelf",description:"a TimeZone.Offset instance",pretty:()=>t=>t.toString(),arbitrary:Bce}){},LH=class extends me(gn.annotations({description:"a number to be decoded into a TimeZone.Offset"}),V0,{strict:!0,decode:t=>nW(t),encode:t=>t.offset}).annotations({identifier:"TimeZoneOffset"}){},zce=()=>e=>e.constantFrom(...Intl.supportedValuesOf("timeZone")).map(rW),G0=class extends ir(Vse,{identifier:"TimeZoneNamedFromSelf",description:"a TimeZone.Named instance",pretty:()=>t=>t.toString(),arbitrary:zce}){},UH=class extends gr($e.annotations({description:"a string to be decoded into a TimeZone.Named"}),G0,{strict:!0,decode:(t,r,n)=>ag({try:()=>rW(t),catch:()=>new Oe(n,t,`Unable to decode ${JSON.stringify(t)} into a TimeZone.Named`)}),encode:t=>it(t.id)}).annotations({identifier:"TimeZoneNamed"}){},n1=class extends bn(V0,G0){},qH=class extends gr($e.annotations({description:"a string to be decoded into a TimeZone"}),n1,{strict:!0,decode:(t,r,n)=>j(Xse(t),{onNone:()=>xr(new Oe(n,t,`Unable to decode ${JSON.stringify(t)} into a TimeZone`)),onSome:it}),encode:t=>it(eie(t))}).annotations({identifier:"TimeZone"}){},_Me=e=>e.oneof(Bce()(e),zce()(e)),o1=class extends ir(t=>eW(t)&&Kse(t),{identifier:"DateTimeZonedFromSelf",description:"a DateTime.Zoned instance",pretty:()=>t=>t.toString(),arbitrary:()=>t=>t.tuple(t.integer({min:-31536e9,max:31536e9}),_Me(t)).map(([r,n])=>Zse(r,{timeZone:n})),equivalence:()=>tW}){},WH=class extends gr($e.annotations({description:"a string to be decoded into a DateTime.Zoned"}),o1,{strict:!0,decode:(t,r,n)=>j(Yse(t),{onNone:()=>xr(new Oe(n,t,`Unable to decode ${JSON.stringify(t)} into a DateTime.Zoned`)),onSome:it}),encode:t=>it(oie(t))}).annotations({identifier:"DateTimeZoned"}){},kMe=zt({_tag:Bt("None")}).annotations({description:"NoneEncoded"}),TMe=e=>zt({_tag:Bt("Some"),value:e}).annotations({description:`SomeEncoded<${Ft(e)}>`}),IMe=e=>bn(kMe,TMe(e)).annotations({description:`OptionEncoded<${Ft(e)}>`}),jce=e=>e._tag==="None"?g():x(e.value),RMe=(e,t)=>r=>r.oneof(t,r.record({_tag:r.constant("None")}),r.record({_tag:r.constant("Some"),value:e(r)})).map(jce),AMe=e=>j({onNone:()=>"none()",onSome:t=>`some(${e(t)})`}),sae=e=>(t,r,n)=>yE(t)?ge(t)?it(g()):mo(e(t.value,r),x,n,t):xr(new Oe(n,t)),HH=e=>ir([e],{decode:t=>sae(hn(t)),encode:t=>sae(mn(t))},{pretty:AMe,arbitrary:RMe,equivalence:K1}),sh=e=>HH(e).annotations({description:`Option<${Ft(e)}>`}),MMe={_tag:"None"},vMe=e=>({_tag:"Some",value:e});function PMe(e){let t=e;return me(IMe(t),sh(ye(t)),{strict:!0,decode:n=>jce(n),encode:n=>j(n,{onNone:()=>MMe,onSome:vMe})})}function FMe(e){return me(P0(e),sh(ye(e)),{strict:!0,decode:t=>br(t),encode:t=>SE(t)})}function NMe(e,t){return me(F0(e),sh(ye(e)),{strict:!0,decode:r=>br(r),encode:t===null?r=>SE(r):r=>yr(r)})}function DMe(e){return me(Xd(e),sh(ye(e)),{strict:!0,decode:t=>br(t),encode:t=>yr(t)})}var BH=class extends me($e,sh(ZI),{strict:!0,decode:t=>Qu(x(t.trim()),sY),encode:t=>_e(t,()=>"")}){},$ce=e=>zt({_tag:Bt("Right"),right:e}).annotations({description:`RightEncoded<${Ft(e)}>`}),Vce=e=>zt({_tag:Bt("Left"),left:e}).annotations({description:`LeftEncoded<${Ft(e)}>`}),LMe=(e,t)=>bn($ce(e),Vce(t)).annotations({description:`EitherEncoded<${Ft(t)}, ${Ft(e)}>`}),Gce=e=>e._tag==="Left"?$(e.left):Z(e.right),UMe=(e,t)=>r=>r.oneof(r.record({_tag:r.constant("Left"),left:t(r)}),r.record({_tag:r.constant("Right"),right:e(r)})).map(Gce),qMe=(e,t)=>Xe({onLeft:r=>`left(${t(r)})`,onRight:r=>`right(${e(r)})`}),iae=(e,t)=>(r,n,o)=>xE(r)?Xe(r,{onLeft:s=>mo(t(s,n),$,o,r),onRight:s=>mo(e(s,n),Z,o,r)}):xr(new Oe(o,r)),IB=({left:e,right:t})=>ir([t,e],{decode:(r,n)=>iae(hn(r),hn(n)),encode:(r,n)=>iae(mn(r),mn(n))},{description:`Either<${Ft(t)}, ${Ft(e)}>`,pretty:qMe,arbitrary:UMe,equivalence:(r,n)=>hz({left:n,right:r})}),zH=e=>({_tag:"Left",left:e}),jH=e=>({_tag:"Right",right:e}),WMe=({left:e,right:t})=>{let r=t,n=e;return me(LMe(r,n),IB({left:ye(n),right:ye(r)}),{strict:!0,decode:s=>Gce(s),encode:s=>Xe(s,{onLeft:zH,onRight:jH})})},HMe=({left:e,right:t})=>{let r=t,n=e,o=ye(r),s=ye(n),i=me(r,$ce(o),{strict:!0,decode:l=>jH(l),encode:l=>l.right}),a=me(n,Vce(s),{strict:!0,decode:l=>zH(l),encode:l=>l.left});return me(bn(i,a),IB({left:s,right:o}),{strict:!0,decode:l=>l._tag==="Left"?$(l.left):Z(l.right),encode:l=>Xe(l,{onLeft:zH,onRight:jH})})},BMe=(e,t,r)=>n=>{let o=n.array(n.tuple(e(n),t(n)));return(r.depthIdentifier!==void 0?n.oneof(r,n.constant([]),o):o).map(s=>new Map(s))},zMe=(e,t)=>r=>`new Map([${Array.from(r.entries()).map(([n,o])=>`[${e(n)}, ${t(o)}]`).join(", ")}])`,jMe=(e,t)=>{let r=An(ar(([n,o],[s,i])=>e(n,s)&&t(o,i)));return ar((n,o)=>r(Array.from(n.entries()),Array.from(o.entries())))},aae=e=>(t,r,n)=>jB(t)?mo(e(Array.from(t.entries()),r),o=>new Map(o),n,t):xr(new Oe(n,t)),Kce=(e,t,r)=>ir([e,t],{decode:(n,o)=>aae(hn(Nt(Ei(n,o)))),encode:(n,o)=>aae(mn(Nt(Ei(n,o))))},{description:r,pretty:zMe,arbitrary:BMe,equivalence:jMe}),RB=({key:e,value:t})=>Kce(e,t,`ReadonlyMap<${Ft(e)}, ${Ft(t)}>`),AB=({key:e,value:t})=>Kce(e,t,`Map<${Ft(e)}, ${Ft(t)}>`);function $Me({key:e,value:t}){return me(Nt(Ei(e,t)),RB({key:ye(e),value:ye(t)}),{strict:!0,decode:r=>new Map(r),encode:r=>Array.from(r.entries())})}function VMe({key:e,value:t}){return me(Nt(Ei(e,t)),AB({key:ye(e),value:ye(t)}),{strict:!0,decode:r=>new Map(r),encode:r=>Array.from(r.entries())})}var GMe=({key:e,value:t})=>me(pB({key:iB(e),value:t}).annotations({description:"a record to be decoded into a ReadonlyMap"}),RB({key:e,value:ye(t)}),{strict:!0,decode:r=>new Map(Object.entries(r)),encode:r=>Object.fromEntries(r)}),KMe=({key:e,value:t})=>me(pB({key:iB(e),value:t}).annotations({description:"a record to be decoded into a Map"}),AB({key:e,value:ye(t)}),{strict:!0,decode:r=>new Map(Object.entries(r)),encode:r=>Object.fromEntries(r)}),QMe=(e,t)=>r=>{let n=r.array(e(r));return(t.depthIdentifier!==void 0?r.oneof(t,r.constant([]),n):n).map(o=>new Set(o))},JMe=e=>t=>`new Set([${Array.from(t.values()).map(r=>e(r)).join(", ")}])`,ZMe=e=>{let t=An(e);return ar((r,n)=>t(Array.from(r.values()),Array.from(n.values())))},cae=e=>(t,r,n)=>zB(t)?mo(e(Array.from(t.values()),r),o=>new Set(o),n,t):xr(new Oe(n,t)),Qce=(e,t)=>ir([e],{decode:r=>cae(hn(Nt(r))),encode:r=>cae(mn(Nt(r)))},{description:t,pretty:JMe,arbitrary:QMe,equivalence:ZMe}),Jce=e=>Qce(e,`ReadonlySet<${Ft(e)}>`),Zce=e=>Qce(e,`Set<${Ft(e)}>`);function YMe(e){return me(Nt(e),Jce(ye(e)),{strict:!0,decode:t=>new Set(t),encode:t=>Array.from(t)})}function XMe(e){return me(Nt(e),Zce(ye(e)),{strict:!0,decode:t=>new Set(t),encode:t=>Array.from(t)})}var eve=()=>e=>`BigDecimal(${Wi(ff(e))})`,tve=()=>e=>e.tuple(e.bigInt(),e.integer({min:0,max:18})).map(([t,r])=>lp(t,r)),qu=class extends ir(BA,{identifier:"BigDecimalFromSelf",pretty:eve,arbitrary:tve,equivalence:()=>zA}){},$H=class extends gr($e.annotations({description:"a string to be decoded into a BigDecimal"}),qu,{strict:!0,decode:(t,r,n)=>jA(t).pipe(j({onNone:()=>xr(new Oe(n,t,`Unable to decode ${JSON.stringify(t)} into a BigDecimal`)),onSome:o=>it(ff(o))})),encode:t=>it(Wi(ff(t)))}).annotations({identifier:"BigDecimal"}){},VH=class extends me(gn.annotations({description:"a number to be decoded into a BigDecimal"}),qu,{strict:!0,decode:t=>Nj(t),encode:t=>Dj(t)}).annotations({identifier:"BigDecimalFromNumber"}){},GH=Symbol.for("effect/SchemaId/GreaterThanBigDecimal"),rve=(e,t)=>r=>{let n=Wi(e);return r.pipe(Se(o=>Mj(o,e),{schemaId:GH,[GH]:{min:e},title:`greaterThanBigDecimal(${n})`,description:`a BigDecimal greater than ${n}`,...t}))},KH=Symbol.for("effect/schema/GreaterThanOrEqualToBigDecimal"),nve=(e,t)=>r=>{let n=Wi(e);return r.pipe(Se(o=>vj(o,e),{schemaId:KH,[KH]:{min:e},title:`greaterThanOrEqualToBigDecimal(${n})`,description:`a BigDecimal greater than or equal to ${n}`,...t}))},QH=Symbol.for("effect/SchemaId/LessThanBigDecimal"),ove=(e,t)=>r=>{let n=Wi(e);return r.pipe(Se(o=>Rj(o,e),{schemaId:QH,[QH]:{max:e},title:`lessThanBigDecimal(${n})`,description:`a BigDecimal less than ${n}`,...t}))},JH=Symbol.for("effect/schema/LessThanOrEqualToBigDecimal"),sve=(e,t)=>r=>{let n=Wi(e);return r.pipe(Se(o=>Aj(o,e),{schemaId:JH,[JH]:{max:e},title:`lessThanOrEqualToBigDecimal(${n})`,description:`a BigDecimal less than or equal to ${n}`,...t}))},Yce=Symbol.for("effect/schema/PositiveBigDecimal"),Xce=e=>t=>t.pipe(Se(r=>Lj(r),{schemaId:Yce,title:"positiveBigDecimal",description:"a positive BigDecimal",...e})),ive=qu.pipe(Xce({identifier:"PositiveBigDecimalFromSelf"})),eue=Symbol.for("effect/schema/NonNegativeBigDecimal"),tue=e=>t=>t.pipe(Se(r=>r.value>=0n,{schemaId:eue,title:"nonNegativeBigDecimal",description:"a non-negative BigDecimal",...e})),ave=qu.pipe(tue({identifier:"NonNegativeBigDecimalFromSelf"})),rue=Symbol.for("effect/schema/NegativeBigDecimal"),nue=e=>t=>t.pipe(Se(r=>$A(r),{schemaId:rue,title:"negativeBigDecimal",description:"a negative BigDecimal",...e})),cve=qu.pipe(nue({identifier:"NegativeBigDecimalFromSelf"})),oue=Symbol.for("effect/schema/NonPositiveBigDecimal"),sue=e=>t=>t.pipe(Se(r=>r.value<=0n,{schemaId:oue,title:"nonPositiveBigDecimal",description:"a non-positive BigDecimal",...e})),uve=qu.pipe(sue({identifier:"NonPositiveBigDecimalFromSelf"})),ZH=Symbol.for("effect/SchemaId/BetweenBigDecimal"),iue=(e,t,r)=>n=>{let o=Wi(e),s=Wi(t);return n.pipe(Se(i=>Pj(i,{minimum:e,maximum:t}),{schemaId:ZH,[ZH]:{maximum:t,minimum:e},title:`betweenBigDecimal(${o}, ${s})`,description:`a BigDecimal between ${o} and ${s}`,...r}))},pve=(e,t)=>r=>me(r,r.pipe(ye,iue(e,t)),{strict:!1,decode:n=>Fj(n,{minimum:e,maximum:t}),encode:R}),lve=(e,t)=>r=>{let n=r.array(e(r));return(t.depthIdentifier!==void 0?r.oneof(t,r.constant([]),n):n).map(pt)},fve=e=>t=>`Chunk(${Zt(t).map(e).join(", ")})`,uae=e=>(t,r,n)=>df(t)?le(t)?it(ee()):mo(e(Zt(t),r),pt,n,t):xr(new Oe(n,t)),aue=e=>ir([e],{decode:t=>uae(hn(Nt(t))),encode:t=>uae(mn(Nt(t)))},{description:`Chunk<${Ft(e)}>`,pretty:fve,arbitrary:lve,equivalence:gC});function dve(e){return me(Nt(e),aue(ye(e)),{strict:!0,decode:t=>t.length===0?ee():pt(t),encode:t=>Zt(t)})}var hve=e=>t=>Ur(e(t),{minLength:1}).map(r=>sb(r)),mve=e=>t=>`NonEmptyChunk(${Zt(t).map(e).join(", ")})`,pae=e=>(t,r,n)=>df(t)&&Vt(t)?mo(e(Zt(t),r),sb,n,t):xr(new Oe(n,t)),cue=e=>ir([e],{decode:t=>pae(hn(lg(t))),encode:t=>pae(mn(lg(t)))},{description:`NonEmptyChunk<${Ft(e)}>`,pretty:mve,arbitrary:hve,equivalence:gC});function xve(e){return me(lg(e),cue(ye(e)),{strict:!0,decode:t=>sb(t),encode:t=>Zt(t)})}var MB=e=>Array.isArray(e)?BZ(e):HZ(e),gve=e=>t=>e(t).map(MB),bve=e=>t=>`Data(${e(t)})`,lae=e=>(t,r,n)=>ju(t)?mo(e(t,r),MB,n,t):xr(new Oe(n,t)),uue=e=>ir([e],{decode:t=>lae(hn(t)),encode:t=>lae(mn(t))},{description:`Data<${Ft(e)}>`,pretty:bve,arbitrary:gve}),yve=e=>me(e,uue(ye(e)),{strict:!1,decode:t=>MB(t),encode:t=>Array.isArray(t)?Array.from(t):Object.assign({},t)}),Sve=e=>xn(e)||h1(e),pue=e=>Reflect.ownKeys(e).every(t=>Sve(e[t])),vB=e=>"fields"in e?e.fields:vB(e[fB]),x1=e=>pue(e)?zt(e):xn(e)?e:zt(vB(e)),g1=e=>pue(e)?e:vB(e),Eve=e=>(t,r)=>eh({kind:"Class",identifier:e,schema:x1(t),fields:g1(t),Base:_N,annotations:r}),b1=e=>Fl(ug(Bt(e)),()=>e),Cve=e=>(t,r,n)=>{let o=g1(r),s=x1(r),i={_tag:b1(t)},a=pg(i,o);return class extends eh({kind:"TaggedClass",identifier:e??t,schema:Z0(s,zt(i)),fields:a,Base:_N,annotations:n}){static _tag=t}},wve=e=>(t,r,n)=>{class o extends kN{}o.prototype.name=t;let s=g1(r),i=x1(r),a={_tag:b1(t)},c=pg(a,s),l="message"in c;class f extends eh({kind:"TaggedError",identifier:e??t,schema:Z0(i,zt(a)),fields:c,Base:o,annotations:n,disableToString:!0}){static _tag=t}return l||Object.defineProperty(f.prototype,"message",{get(){return`{ ${Reflect.ownKeys(s).map(d=>`${$u(d)}: ${Wo(this[d])}`).join(", ")} }`},enumerable:!1,configurable:!0}),f},pg=(e,t)=>{let r={...e};for(let n of Reflect.ownKeys(t)){if(n in e)throw new Error(XE(n));r[n]=t[n]}return r};function y1(e){return Oi(e)?e:e?.disableValidation??!1}var fae=ne("effect/Schema/astCache",()=>new WeakMap),Ove=e=>e===void 0?[]:Array.isArray(e)?e:[e],eh=({Base:e,annotations:t,disableToString:r,fields:n,identifier:o,kind:s,schema:i})=>{let a=Symbol.for(`effect/Schema/${s}/${o}`),[c,l,f]=Ove(t),d=ye(i),h=d.annotations({identifier:o,...c}),m=d.annotations({[cp]:`${o} (Type side)`,...c}),y=i.annotations({[cp]:`${o} (Constructor)`,...c}),T=i.annotations({[cp]:`${o} (Encoded side)`,...f}),C=i.annotations({...f,...c,...l}),O=I=>F(I,a)&&T0(m)(I),U=class extends e{constructor(I={},K=!1){I={...I},s!=="Class"&&delete I._tag,I=Lae(n,I),y1(K)||(I=Zd(y)(I)),super(I,!0)}static[Dl]=vW;static get ast(){let I=fae.get(this);if(I)return I;let K=ir([i],{decode:()=>(Q,z,te)=>Q instanceof this||O(Q)?it(Q):xr(new Oe(te,Q)),encode:()=>(Q,z)=>Q instanceof this?it(Q):Tn(mn(m)(Q,z),te=>new this(te,!0))},{identifier:o,pretty:Q=>z=>`${o}(${Q(z)})`,arbitrary:Q=>z=>Q(z).map(te=>new this(te)),equivalence:R,[Kg]:h.ast,...c});return I=me(T,K,{strict:!0,decode:Q=>new this(Q,!0),encode:R}).annotations({[Kg]:C.ast,...l}).ast,fae.set(this,I),I}static pipe(){return v(this,arguments)}static annotations(I){return Te(this.ast).annotations(I)}static toString(){return`(${String(T)} <-> ${o})`}static make(...I){return new this(...I)}static fields={...n};static identifier=o;static extend(I){return(K,Q)=>{let z=g1(K),te=x1(K),ce=pg(n,z);return eh({kind:s,identifier:I,schema:Z0(i,te),fields:ce,Base:this,annotations:Q})}}static transformOrFail(I){return(K,Q,z)=>{let te=pg(n,K);return eh({kind:s,identifier:I,schema:gr(i,ye(zt(te)),Q),fields:te,Base:this,annotations:z})}}static transformOrFailFrom(I){return(K,Q,z)=>{let te=pg(n,K);return eh({kind:s,identifier:I,schema:gr(l1(i),zt(te),Q),fields:te,Base:this,annotations:z})}}get[a](){return a}};return r!==!0&&Object.defineProperty(U.prototype,"toString",{value(){return`${o}({ ${Reflect.ownKeys(n).map(I=>`${$u(I)}: ${Wo(this[I])}`).join(", ")} })`},configurable:!0,writable:!0}),U},_ve=zt({_tag:Bt("None")}).annotations({identifier:"FiberIdNoneEncoded"}),kve=zt({_tag:Bt("Runtime"),id:B0,startTimeMillis:B0}).annotations({identifier:"FiberIdRuntimeEncoded"}),Tve=zt({_tag:Bt("Composite"),left:VI(()=>s1),right:VI(()=>s1)}).annotations({identifier:"FiberIdCompositeEncoded"}),s1=bn(_ve,kve,Tve).annotations({identifier:"FiberIdEncoded"}),lue=e=>e.letrec(t=>({None:e.record({_tag:e.constant("None")}),Runtime:e.record({_tag:e.constant("Runtime"),id:e.integer(),startTimeMillis:e.integer()}),Composite:e.record({_tag:e.constant("Composite"),left:t("FiberId"),right:t("FiberId")}),FiberId:e.oneof(t("None"),t("Runtime"),t("Composite"))})).FiberId.map(K0),i1=e=>{switch(e._tag){case"None":return"FiberId.none";case"Runtime":return`FiberId.runtime(${e.id}, ${e.startTimeMillis})`;case"Composite":return`FiberId.composite(${i1(e.right)}, ${i1(e.left)})`}},a1=class extends ir(n5,{identifier:"FiberIdFromSelf",pretty:()=>i1,arbitrary:()=>lue}){},K0=e=>{switch(e._tag){case"None":return Nn;case"Runtime":return t5(e.id,e.startTimeMillis);case"Composite":return r5(K0(e.left),K0(e.right))}},YH=e=>{switch(e._tag){case"None":return{_tag:"None"};case"Runtime":return{_tag:"Runtime",id:e.id,startTimeMillis:e.startTimeMillis};case"Composite":return{_tag:"Composite",left:YH(e.left),right:YH(e.right)}}},XH=class extends me(s1,a1,{strict:!0,decode:t=>K0(t),encode:t=>YH(t)}).annotations({identifier:"FiberId"}){},Ive=e=>zt({_tag:Bt("Die"),defect:e}),Rve=zt({_tag:Bt("Empty")}),Ave=e=>zt({_tag:Bt("Fail"),error:e}),Mve=zt({_tag:Bt("Interrupt"),fiberId:s1}),vve=0,c1=(e,t)=>{let r=e,n=t,o=VI(()=>s),s=bn(Rve,Ave(r),Ive(n),Mve,zt({_tag:Bt("Sequential"),left:o,right:o}),zt({_tag:Bt("Parallel"),left:o,right:o})).annotations({title:`CauseEncoded<${Ft(e)}>`,[oC]:`CauseEncoded${vve++}`});return s},fue=(e,t)=>r=>r.letrec(n=>({Empty:r.record({_tag:r.constant("Empty")}),Fail:r.record({_tag:r.constant("Fail"),error:e(r)}),Die:r.record({_tag:r.constant("Die"),defect:t(r)}),Interrupt:r.record({_tag:r.constant("Interrupt"),fiberId:lue(r)}),Sequential:r.record({_tag:r.constant("Sequential"),left:n("Cause"),right:n("Cause")}),Parallel:r.record({_tag:r.constant("Parallel"),left:n("Cause"),right:n("Cause")}),Cause:r.oneof(n("Empty"),n("Fail"),n("Die"),n("Interrupt"),n("Sequential"),n("Parallel"))})).Cause.map(Nl),due=e=>t=>{let r=n=>{switch(n._tag){case"Empty":return"Cause.empty";case"Fail":return`Cause.fail(${e(n.error)})`;case"Die":return`Cause.die(${Ny(n)})`;case"Interrupt":return`Cause.interrupt(${i1(n.fiberId)})`;case"Sequential":return`Cause.sequential(${r(n.left)}, ${r(n.right)})`;case"Parallel":return`Cause.parallel(${r(n.left)}, ${r(n.right)})`}};return r(t)},dae=e=>(t,r,n)=>AQ(t)?mo(e(cg(t),r),Nl,n,t):xr(new Oe(n,t)),u1=({defect:e,error:t})=>ir([t,e],{decode:(r,n)=>dae(hn(c1(r,n))),encode:(r,n)=>dae(mn(c1(r,n)))},{title:`Cause<${t.ast}>`,pretty:due,arbitrary:fue});function Nl(e){switch(e._tag){case"Empty":return I_;case"Fail":return Ya(e.error);case"Die":return Bn(e.defect);case"Interrupt":return yd(K0(e.fiberId));case"Sequential":return RQ(Nl(e.left),Nl(e.right));case"Parallel":return IQ(Nl(e.left),Nl(e.right))}}function cg(e){switch(e._tag){case"Empty":return{_tag:"Empty"};case"Fail":return{_tag:"Fail",error:e.error};case"Die":return{_tag:"Die",defect:e.defect};case"Interrupt":return{_tag:"Interrupt",fiberId:e.fiberId};case"Sequential":return{_tag:"Sequential",left:cg(e.left),right:cg(e.right)};case"Parallel":return{_tag:"Parallel",left:cg(e.left),right:cg(e.right)}}}var Pve=({defect:e,error:t})=>{let r=t,n=e;return me(c1(r,n),u1({error:ye(r),defect:ye(n)}),{strict:!1,decode:s=>Nl(s),encode:s=>cg(s)})},Q0=class extends me(th,th,{strict:!0,decode:t=>{if(jr(t)&&"message"in t&&typeof t.message=="string"){let r=new Error(t.message,{cause:t});return"name"in t&&typeof t.name=="string"&&(r.name=t.name),r.stack="stack"in t&&typeof t.stack=="string"?t.stack:"",r}return pw(t)},encode:t=>t instanceof Error?{name:t.name,message:t.message}:pw(t)}).annotations({identifier:"Defect"}){},Fve=(e,t)=>zt({_tag:Bt("Failure"),cause:c1(e,t)}),Nve=e=>zt({_tag:Bt("Success"),value:e}),Dve=(e,t,r)=>bn(Fve(t,r),Nve(e)).annotations({title:`ExitEncoded<${Ft(e)}, ${Ft(t)}, ${Ft(r)}>`}),hue=e=>{switch(e._tag){case"Failure":return st(Nl(e.cause));case"Success":return xe(e.value)}},Lve=(e,t,r)=>n=>n.oneof(n.record({_tag:n.constant("Failure"),cause:fue(t,r)(n)}),n.record({_tag:n.constant("Success"),value:e(n)})).map(hue),Uve=(e,t)=>r=>r._tag==="Failure"?`Exit.failCause(${due(t)(r.cause)})`:`Exit.succeed(${e(r.value)})`,hae=(e,t)=>(r,n,o)=>Jb(r)?qt(r,{onFailure:s=>mo(t(s,n),st,o,r),onSuccess:s=>mo(e(s,n),xe,o,r)}):xr(new Oe(o,r)),mue=({defect:e,failure:t,success:r})=>ir([r,t,e],{decode:(n,o,s)=>hae(hn(n),hn(u1({error:o,defect:s}))),encode:(n,o,s)=>hae(mn(n),mn(u1({error:o,defect:s})))},{title:`Exit<${r.ast}, ${t.ast}>`,pretty:Uve,arbitrary:Lve}),eB=({defect:e,failure:t,success:r})=>{let n=r,o=t,s=e;return me(Dve(n,o,s),mue({failure:ye(o),success:ye(n),defect:ye(s)}),{strict:!1,decode:a=>hue(a),encode:a=>a._tag==="Failure"?{_tag:"Failure",cause:a.cause}:{_tag:"Success",value:a.value}})},qve=(e,t)=>r=>{let n=r.array(e(r));return(t.depthIdentifier!==void 0?r.oneof(t,r.constant([]),n):n).map(mp)},Wve=e=>t=>`HashSet(${Array.from(t).map(r=>e(r)).join(", ")})`,Hve=e=>{let t=An(e);return ar((r,n)=>t(Array.from(r),Array.from(n)))},mae=e=>(t,r,n)=>V4(t)?mo(e(Array.from(t),r),mp,n,t):xr(new Oe(n,t)),xue=e=>ir([e],{decode:t=>mae(hn(Nt(t))),encode:t=>mae(mn(Nt(t)))},{description:`HashSet<${Ft(e)}>`,pretty:Wve,arbitrary:qve,equivalence:Hve});function Bve(e){return me(Nt(e),xue(ye(e)),{strict:!0,decode:t=>mp(t),encode:t=>Array.from(t)})}var zve=(e,t,r)=>n=>{let o=n.array(n.tuple(e(n),t(n)));return(r.depthIdentifier!==void 0?n.oneof(r,n.constant([]),o):o).map(em)},jve=(e,t)=>r=>`HashMap([${Array.from(r).map(([n,o])=>`[${e(n)}, ${t(o)}]`).join(", ")}])`,$ve=(e,t)=>{let r=An(ar(([n,o],[s,i])=>e(n,s)&&t(o,i)));return ar((n,o)=>r(Array.from(n),Array.from(o)))},xae=e=>(t,r,n)=>i5(t)?mo(e(Array.from(t),r),em,n,t):xr(new Oe(n,t)),gue=({key:e,value:t})=>ir([e,t],{decode:(r,n)=>xae(hn(Nt(Ei(r,n)))),encode:(r,n)=>xae(mn(Nt(Ei(r,n))))},{description:`HashMap<${Ft(e)}, ${Ft(t)}>`,pretty:jve,arbitrary:zve,equivalence:$ve}),Vve=({key:e,value:t})=>me(Nt(Ei(e,t)),gue({key:ye(e),value:ye(t)}),{strict:!0,decode:r=>em(r),encode:r=>Array.from(r)}),Gve=(e,t)=>r=>{let n=r.array(e(r));return(t.depthIdentifier!==void 0?r.oneof(t,r.constant([]),n):n).map(VC)},Kve=e=>t=>`List(${Array.from(t).map(r=>e(r)).join(", ")})`,Qve=e=>{let t=An(e);return ar((r,n)=>t(Array.from(r),Array.from(n)))},gae=e=>(t,r,n)=>$C(t)?mo(e(Array.from(t),r),VC,n,t):xr(new Oe(n,t)),bue=e=>ir([e],{decode:t=>gae(hn(Nt(t))),encode:t=>gae(mn(Nt(t)))},{description:`List<${Ft(e)}>`,pretty:Kve,arbitrary:Gve,equivalence:Qve});function Jve(e){return me(Nt(e),bue(ye(e)),{strict:!0,decode:t=>VC(t),encode:t=>Array.from(t)})}var Zve=(e,t,r)=>n=>{let o=n.array(e(n));return(r.depthIdentifier!==void 0?n.oneof(r,n.constant([]),o):o).map(s=>p_(s,t))},Yve=e=>t=>`new SortedSet([${Array.from(l_(t)).map(r=>e(r)).join(", ")}])`,bae=(e,t)=>(r,n,o)=>u2(r)?mo(e(Array.from(l_(r)),n),s=>p_(s,t),o,r):xr(new Oe(o,r)),yue=(e,t,r)=>ir([e],{decode:n=>bae(hn(Nt(n)),t),encode:n=>bae(mn(Nt(n)),r)},{description:`SortedSet<${Ft(e)}>`,pretty:Yve,arbitrary:(n,o)=>Zve(n,t,o),equivalence:()=>TK()});function Xve(e,t){let r=ye(e);return me(Nt(e),yue(r,t,t),{strict:!0,decode:n=>p_(n,t),encode:n=>Array.from(l_(n))})}var tB=class extends me(th,rh,{strict:!0,decode:t=>BB(t),encode:R}).annotations({identifier:"BooleanFromUnknown"}){},rB=class extends me(Bt("true","false").annotations({description:"a string to be decoded into a boolean"}),rh,{strict:!0,decode:t=>t==="true",encode:t=>t?"true":"false"}).annotations({identifier:"BooleanFromString"}){},ePe=(e,t)=>{let r=TW(t);return zse(e).pipe(Bse(n=>r(n).pipe(Ws(o=>vse([],ig.formatIssueSync(o))))))},Y0=Symbol.for("effect/Schema/Serializable/symbol"),tPe=e=>e,rPe=e=>e[Y0],nPe=e=>f1(e[Y0])(e),oPe=u(2,(e,t)=>oh(e[Y0])(t)),Hu=Symbol.for("effect/Schema/Serializable/symbolResult"),sPe=e=>e,nB=e=>e[Hu].failure,oB=e=>e[Hu].success,yae=ne("effect/Schema/Serializable/exitSchemaCache",()=>new WeakMap),PB=e=>{let t=Object.getPrototypeOf(e);if(!(Hu in t))return eB({failure:nB(e),success:oB(e),defect:Q0});let r=yae.get(t);return r===void 0&&(r=eB({failure:nB(e),success:oB(e),defect:Q0}),yae.set(t,r)),r},iPe=u(2,(e,t)=>d1(e[Hu].failure)(t)),aPe=u(2,(e,t)=>oh(e[Hu].failure)(t)),cPe=u(2,(e,t)=>d1(e[Hu].success)(t)),uPe=u(2,(e,t)=>oh(e[Hu].success)(t)),pPe=u(2,(e,t)=>d1(PB(e))(t)),lPe=u(2,(e,t)=>oh(PB(e))(t)),fPe=e=>e,dPe=e=>(t,r,n)=>{let o=pg({_tag:b1(t)},r.payload);return class extends eh({kind:"TaggedRequest",identifier:e??t,schema:zt(o),fields:o,Base:LY,annotations:n}){static _tag=t;static success=r.success;static failure=r.failure;get[Y0](){return this.constructor}get[Hu](){return{failure:r.failure,success:r.success}}}},hPe=e=>Sa(e.ast,[]),mPe=Mn(nC),Sa=(e,t)=>{let r=mPe(e);if(X(r))switch(e._tag){case"Declaration":return r.value(...e.typeParameters.map(n=>Sa(n,t)));case"Refinement":return r.value(Sa(e.from,t));default:return r.value()}switch(e._tag){case"NeverKeyword":throw new Error(d6(e,t));case"Transformation":return Sa(e.to,t);case"Declaration":case"Literal":case"StringKeyword":case"TemplateLiteral":case"UniqueSymbol":case"SymbolKeyword":case"UnknownKeyword":case"AnyKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"UndefinedKeyword":case"VoidKeyword":case"Enums":case"ObjectKeyword":return N;case"Refinement":return Sa(e.from,t);case"Suspend":{let n=Dh(()=>Sa(e.f(),t));return(o,s)=>n()(o,s)}case"TupleType":{let n=e.elements.map((s,i)=>Sa(s.type,t.concat(i))),o=e.rest.map(s=>Sa(s.type,t));return ar((s,i)=>{if(!Array.isArray(s)||!Array.isArray(i))return!1;let a=s.length;if(a!==i.length)return!1;let c=0;for(;c<Math.min(a,e.elements.length);c++)if(!n[c](s[c],i[c]))return!1;if(ut(o)){let[l,...f]=o;for(;c<a-f.length;c++)if(!l(s[c],i[c]))return!1;for(let d=0;d<f.length;d++)if(c+=d,!f[d](s[c],i[c]))return!1}return!0})}case"TypeLiteral":{if(e.propertySignatures.length===0&&e.indexSignatures.length===0)return N;let n=e.propertySignatures.map(s=>Sa(s.type,t.concat(s.name))),o=e.indexSignatures.map(s=>Sa(s.type,t));return ar((s,i)=>{if(!yg(s)||!yg(i))return!1;let a=Object.keys(s),c=Object.getOwnPropertySymbols(s);for(let d=0;d<n.length;d++){let h=e.propertySignatures[d],m=h.name,y=Object.prototype.hasOwnProperty.call(s,m),T=Object.prototype.hasOwnProperty.call(i,m);if(h.isOptional&&y!==T||y&&T&&!n[d](s[m],i[m]))return!1}let l,f;for(let d=0;d<o.length;d++){let h=e.indexSignatures[d],m=Tc(h.parameter),y=cC(m);if(y){if(l=l||Object.getOwnPropertySymbols(i),c.length!==l.length)return!1}else if(f=f||Object.keys(i),a.length!==f.length)return!1;let T=y?c:a;for(let C=0;C<T.length;C++){let O=T[C];if(!Object.prototype.hasOwnProperty.call(i,O)||!o[d](s[O],i[O]))return!1}}return!0})}case"Union":{let n=AW(e.types,!0),o=Reflect.ownKeys(n.keys),s=o.length;return ar((i,a)=>{let c=[];if(s>0&&lh(i))for(let f=0;f<s;f++){let d=o[f],h=n.keys[d].buckets;if(Object.prototype.hasOwnProperty.call(i,d)){let m=String(i[d]);Object.prototype.hasOwnProperty.call(h,m)&&(c=c.concat(h[m]))}}n.otherwise.length>0&&(c=c.concat(n.otherwise));let l=c.map(f=>[Sa(f,t),T0({ast:f})]);for(let f=0;f<l.length;f++){let[d,h]=l[f];if(h(i)&&h(a)&&d(i,a))return!0}return!1})}}},Sae=J0("symbol",{key:$e}).annotations({description:"an object to be decoded into a globally shared symbol"}),xPe=gr(Sae,U0,{strict:!0,decode:e=>Ice(e.key),encode:(e,t,r)=>Tn(Tce(e,r),n=>Sae.make({key:n}))}),p1=class extends bn($e,gn,xPe).annotations({identifier:"PropertyKey"}){};var sB=class extends zt({_tag:ug(Bt("Pointer","Unexpected","Missing","Composite","Refinement","Transformation","Type","Forbidden")).annotations({description:"The tag identifying the type of parse issue"}),path:ug(Nt(p1)).annotations({description:"The path to the property where the issue occurred"}),message:ug($e).annotations({description:"A descriptive message explaining the issue"})}).annotations({identifier:"ArrayFormatterIssue",description:"Represents an issue returned by the ArrayFormatter formatter"}){};var S1={};Yn(S1,{DefaultChunkSize:()=>bPe,Do:()=>ZLe,StreamTypeId:()=>gPe,accumulate:()=>yPe,accumulateChunks:()=>SPe,acquireRelease:()=>EPe,aggregate:()=>CPe,aggregateWithin:()=>wPe,aggregateWithinEither:()=>OPe,as:()=>_Pe,async:()=>kPe,asyncEffect:()=>TPe,asyncPush:()=>IPe,asyncScoped:()=>RPe,bind:()=>YLe,bindEffect:()=>XLe,bindTo:()=>eUe,branchAfter:()=>APe,broadcast:()=>MPe,broadcastDynamic:()=>PPe,broadcastedQueues:()=>FPe,broadcastedQueuesDynamic:()=>NPe,buffer:()=>DPe,bufferChunks:()=>LPe,catchAll:()=>UPe,catchAllCause:()=>qPe,catchSome:()=>WPe,catchSomeCause:()=>zPe,catchTag:()=>HPe,catchTags:()=>BPe,changes:()=>jPe,changesWith:()=>$Pe,changesWithEffect:()=>VPe,chunks:()=>GPe,chunksWith:()=>KPe,combine:()=>QPe,combineChunks:()=>JPe,concat:()=>ZPe,concatAll:()=>YPe,context:()=>EFe,contextWith:()=>CFe,contextWithEffect:()=>wFe,contextWithStream:()=>OFe,cross:()=>XPe,crossLeft:()=>eFe,crossRight:()=>tFe,crossWith:()=>rFe,debounce:()=>nFe,decodeText:()=>rUe,die:()=>oFe,dieMessage:()=>iFe,dieSync:()=>sFe,distributedWith:()=>aFe,distributedWithDynamic:()=>cFe,drain:()=>uFe,drainFork:()=>pFe,drop:()=>lFe,dropRight:()=>fFe,dropUntil:()=>dFe,dropUntilEffect:()=>hFe,dropWhile:()=>mFe,dropWhileEffect:()=>xFe,either:()=>gFe,empty:()=>bFe,encodeText:()=>nUe,ensuring:()=>yFe,ensuringWith:()=>SFe,execute:()=>_Fe,fail:()=>kFe,failCause:()=>IFe,failCauseSync:()=>RFe,failSync:()=>TFe,filter:()=>AFe,filterEffect:()=>MFe,filterMap:()=>vFe,filterMapEffect:()=>PFe,filterMapWhile:()=>FFe,filterMapWhileEffect:()=>NFe,finalizer:()=>DFe,find:()=>LFe,findEffect:()=>UFe,flatMap:()=>qFe,flatten:()=>WFe,flattenChunks:()=>HFe,flattenEffect:()=>BFe,flattenExitOption:()=>zFe,flattenIterables:()=>jFe,flattenTake:()=>$Fe,forever:()=>VFe,fromAsyncIterable:()=>GFe,fromChannel:()=>KFe,fromChunk:()=>JFe,fromChunkPubSub:()=>ZFe,fromChunkQueue:()=>YFe,fromChunks:()=>XFe,fromEffect:()=>e2e,fromEffectOption:()=>t2e,fromEventListener:()=>oUe,fromIterable:()=>o2e,fromIterableEffect:()=>s2e,fromIteratorSucceed:()=>i2e,fromPubSub:()=>r2e,fromPull:()=>a2e,fromQueue:()=>c2e,fromReadableStream:()=>p2e,fromReadableStreamByob:()=>l2e,fromSchedule:()=>f2e,fromTPubSub:()=>n2e,fromTQueue:()=>u2e,groupAdjacentBy:()=>d2e,groupBy:()=>h2e,groupByKey:()=>m2e,grouped:()=>x2e,groupedWithin:()=>g2e,haltAfter:()=>b2e,haltWhen:()=>y2e,haltWhenDeferred:()=>S2e,identity:()=>E2e,interleave:()=>C2e,interleaveWith:()=>w2e,interruptAfter:()=>k2e,interruptWhen:()=>T2e,interruptWhenDeferred:()=>I2e,intersperse:()=>O2e,intersperseAffixes:()=>_2e,iterate:()=>R2e,let:()=>tUe,make:()=>A2e,map:()=>M2e,mapAccum:()=>v2e,mapAccumEffect:()=>P2e,mapBoth:()=>F2e,mapChunks:()=>N2e,mapChunksEffect:()=>D2e,mapConcat:()=>L2e,mapConcatChunk:()=>U2e,mapConcatChunkEffect:()=>q2e,mapConcatEffect:()=>W2e,mapEffect:()=>H2e,mapError:()=>B2e,mapErrorCause:()=>z2e,mapInputContext:()=>RNe,merge:()=>j2e,mergeAll:()=>$2e,mergeEither:()=>K2e,mergeLeft:()=>Q2e,mergeRight:()=>J2e,mergeWith:()=>G2e,mergeWithTag:()=>V2e,mkString:()=>Z2e,never:()=>Y2e,onDone:()=>tNe,onEnd:()=>X2e,onError:()=>eNe,onStart:()=>rNe,orDie:()=>nNe,orDieWith:()=>oNe,orElse:()=>sNe,orElseEither:()=>iNe,orElseFail:()=>aNe,orElseIfEmpty:()=>cNe,orElseIfEmptyChunk:()=>uNe,orElseIfEmptyStream:()=>pNe,orElseSucceed:()=>lNe,paginate:()=>fNe,paginateChunk:()=>dNe,paginateChunkEffect:()=>hNe,paginateEffect:()=>mNe,partition:()=>xNe,partitionEither:()=>gNe,peel:()=>bNe,pipeThrough:()=>yNe,pipeThroughChannel:()=>SNe,pipeThroughChannelOrFail:()=>ENe,prepend:()=>CNe,provideContext:()=>wNe,provideLayer:()=>_Ne,provideService:()=>kNe,provideServiceEffect:()=>TNe,provideServiceStream:()=>INe,provideSomeContext:()=>ONe,provideSomeLayer:()=>ANe,race:()=>MNe,raceAll:()=>vNe,range:()=>PNe,rechunk:()=>FNe,refineOrDie:()=>NNe,refineOrDieWith:()=>DNe,repeat:()=>LNe,repeatEffect:()=>UNe,repeatEffectChunk:()=>qNe,repeatEffectChunkOption:()=>WNe,repeatEffectOption:()=>HNe,repeatEffectWithSchedule:()=>BNe,repeatEither:()=>zNe,repeatElements:()=>jNe,repeatElementsWith:()=>$Ne,repeatValue:()=>VNe,repeatWith:()=>GNe,retry:()=>KNe,run:()=>JNe,runCollect:()=>ZNe,runCount:()=>YNe,runDrain:()=>XNe,runFold:()=>eDe,runFoldEffect:()=>tDe,runFoldScoped:()=>rDe,runFoldScopedEffect:()=>nDe,runFoldWhile:()=>oDe,runFoldWhileEffect:()=>sDe,runFoldWhileScoped:()=>iDe,runFoldWhileScopedEffect:()=>aDe,runForEach:()=>cDe,runForEachChunk:()=>uDe,runForEachChunkScoped:()=>pDe,runForEachScoped:()=>lDe,runForEachWhile:()=>fDe,runForEachWhileScoped:()=>dDe,runHead:()=>hDe,runIntoPubSub:()=>mDe,runIntoPubSubScoped:()=>xDe,runIntoQueue:()=>gDe,runIntoQueueElementsScoped:()=>bDe,runIntoQueueScoped:()=>yDe,runLast:()=>SDe,runScoped:()=>EDe,runSum:()=>CDe,scan:()=>wDe,scanEffect:()=>ODe,scanReduce:()=>_De,scanReduceEffect:()=>kDe,schedule:()=>TDe,scheduleWith:()=>IDe,scoped:()=>RDe,scopedWith:()=>ADe,share:()=>vPe,sliding:()=>MDe,slidingSize:()=>vDe,some:()=>PDe,someOrElse:()=>FDe,someOrFail:()=>NDe,split:()=>DDe,splitLines:()=>UDe,splitOnChunk:()=>LDe,succeed:()=>qDe,suspend:()=>HDe,sync:()=>WDe,take:()=>BDe,takeRight:()=>zDe,takeUntil:()=>jDe,takeUntilEffect:()=>$De,takeWhile:()=>VDe,tap:()=>GDe,tapBoth:()=>KDe,tapError:()=>QDe,tapErrorCause:()=>JDe,tapSink:()=>ZDe,throttle:()=>YDe,throttleEffect:()=>XDe,tick:()=>eLe,timeout:()=>tLe,timeoutFail:()=>rLe,timeoutFailCause:()=>nLe,timeoutTo:()=>oLe,toAsyncIterable:()=>hLe,toAsyncIterableEffect:()=>dLe,toAsyncIterableRuntime:()=>fLe,toChannel:()=>QFe,toPubSub:()=>sLe,toPull:()=>iLe,toQueue:()=>aLe,toQueueOfElements:()=>cLe,toReadableStream:()=>uLe,toReadableStreamEffect:()=>pLe,toReadableStreamRuntime:()=>lLe,transduce:()=>mLe,unfold:()=>xLe,unfoldChunk:()=>gLe,unfoldChunkEffect:()=>bLe,unfoldEffect:()=>yLe,unwrap:()=>ELe,unwrapScoped:()=>CLe,unwrapScopedWith:()=>wLe,updateService:()=>OLe,void:()=>SLe,when:()=>_Le,whenCase:()=>kLe,whenCaseEffect:()=>TLe,whenEffect:()=>ILe,withExecutionPlan:()=>QNe,withSpan:()=>RLe,zip:()=>ALe,zipAll:()=>vLe,zipAllLeft:()=>PLe,zipAllRight:()=>FLe,zipAllSortedByKey:()=>NLe,zipAllSortedByKeyLeft:()=>DLe,zipAllSortedByKeyRight:()=>LLe,zipAllSortedByKeyWith:()=>ULe,zipAllWith:()=>qLe,zipFlatten:()=>MLe,zipLatest:()=>WLe,zipLatestAll:()=>HLe,zipLatestWith:()=>BLe,zipLeft:()=>zLe,zipRight:()=>jLe,zipWith:()=>$Le,zipWithChunks:()=>VLe,zipWithIndex:()=>JLe,zipWithNext:()=>GLe,zipWithPrevious:()=>KLe,zipWithPreviousAndNext:()=>QLe});var gPe=cI,bPe=Qx,yPe=Mre,SPe=MU,EPe=vU,CPe=vre,wPe=uI,OPe=PU,_Pe=Pre,kPe=Fre;var TPe=Nre,IPe=NU,RPe=Dre,APe=Lre,MPe=Ure,vPe=qre,PPe=DU,FPe=LU,NPe=Wre,DPe=Hre,LPe=Bre,UPe=Iu,qPe=Jx,WPe=zre,HPe=jre,BPe=$re,zPe=UU,jPe=Vre,$Pe=qU,VPe=Gre,GPe=XS,KPe=Kre,QPe=Qre,JPe=e0,ZPe=oc,YPe=Jre,XPe=Zre,eFe=Yre,tFe=lI,rFe=fI,nFe=Xre,oFe=dI,sFe=ene,iFe=tne,aFe=WU,cFe=HU,uFe=Zx,pFe=rne,lFe=zU,fFe=nne,dFe=one,hFe=sne,mFe=jU,xFe=ine,gFe=ane,bFe=Ru,yFe=Tu,SFe=cne,EFe=t0,CFe=une,wFe=pne,OFe=hI,_Fe=$U,kFe=ku,TFe=mI,IFe=r0,RFe=lne,AFe=fne,MFe=VU,vFe=Tl,PFe=dne,FFe=hne,NFe=mne,DFe=xne,LFe=gne,UFe=bne,qFe=hr,WFe=Yx,HFe=n0,BFe=yne,zFe=jd,jFe=Sne,$Fe=Ml,VFe=xI,GFe=Ene,KFe=Xx,QFe=D,JFe=Il,ZFe=Cne,YFe=iI,XFe=wne,e2e=sr,t2e=eg,r2e=o0,n2e=One,o2e=tg,s2e=_ne,i2e=GU,a2e=s0,c2e=bi,u2e=KU,p2e=Tne,l2e=Ine,f2e=kne,d2e=Ane,h2e=Sie,m2e=gW,x2e=Mne,g2e=vne,b2e=Pne,y2e=QU,S2e=Fne,E2e=JU,C2e=Nne,w2e=ZU,O2e=YU,_2e=Dne,k2e=Lne,T2e=gI,I2e=XU,R2e=Une,A2e=Rl,M2e=Or,v2e=bI,P2e=yI,F2e=qne,N2e=$d,D2e=Wne,L2e=Hne,U2e=i0,q2e=Bne,W2e=zne,H2e=xW,B2e=SI,z2e=$ne,j2e=a0,$2e=EI,V2e=Vne,G2e=CI,K2e=eq,Q2e=Gne,J2e=Kne,Z2e=Qne,Y2e=Jne,X2e=Zne,eNe=Yne,tNe=Xne,rNe=eoe,nNe=toe,oNe=tq,sNe=c0,iNe=roe,aNe=noe,cNe=ooe,uNe=rq,pNe=nq,lNe=soe,fNe=ioe,dNe=oq,hNe=sq,mNe=iq,xNe=coe,gNe=aq,bNe=aoe,yNe=uoe,SNe=cq,ENe=poe,CNe=loe,wNe=wI,ONe=uq,_Ne=pq,kNe=foe,TNe=u0,INe=lq,RNe=OI,ANe=fq,MNe=hoe,vNe=dq,PNe=doe,FNe=p0,NNe=moe,DNe=hq,LNe=xoe,UNe=goe,qNe=boe,WNe=Au,HNe=Al,BNe=bq,zNe=mq,jNe=yoe,$Ne=xq,VNe=Soe,GNe=gq,KNe=aI,QNe=Eoe,JNe=fo,ZNe=Coe,YNe=woe,XNe=Ooe,eDe=_oe,tDe=koe,rDe=Toe,nDe=Ioe,oDe=yq,sDe=Sq,iDe=Eq,aDe=Cq,cDe=wq,uDe=Oq,pDe=Roe,lDe=_q,fDe=Aoe,dDe=Moe,hDe=voe,mDe=Poe,xDe=_I,gDe=kq,bDe=Tq,yDe=l0,SDe=Foe,EDe=Vd,CDe=Noe,wDe=Doe,ODe=Aq,_De=Loe,kDe=Iq,TDe=Uoe,IDe=Rq,RDe=Gd,ADe=f0,MDe=Hoe,vDe=vq,PDe=qoe,FDe=Woe,NDe=Mq,DDe=Boe,LDe=zoe,UDe=joe,qDe=d0,WDe=Pq,HDe=kn,BDe=$oe,zDe=Voe,jDe=Goe,$De=Koe,VDe=Fq,GDe=Nq,KDe=Qoe,QDe=Dq,JDe=Lq,ZDe=Joe,YDe=Zoe,XDe=Uq,eLe=Yoe,tLe=Xoe,rLe=ese,nLe=qq,oLe=Wq,sLe=kI,iLe=zd,aLe=TI,cLe=Hq,uLe=rse,pLe=nse,lLe=II,fLe=RI,dLe=ise,hLe=sse,mLe=ose,xLe=Bq,gLe=zq,bLe=h0,yLe=AI,SLe=ase;var ELe=vl,CLe=vs,wLe=rg,OLe=cse,_Le=use,kLe=pse,TLe=jq,ILe=$q,RLe=lse,ALe=fse,MLe=dse,vLe=hse,PLe=mse,FLe=xse,NLe=gse,DLe=bse,LLe=yse,ULe=m0,qLe=x0,WLe=Sse,HLe=Vq,BLe=MI,zLe=Ese,jLe=Cse,$Le=vI,VLe=g0,GLe=Kq,KLe=Qq,QLe=wse,JLe=Gq,ZLe=_se,YLe=kse,XLe=Eie,eUe=Tse,tUe=Ise;var rUe=Rse,nUe=Ase,oUe=Mse;var X0=Symbol.for("effect/Subscribable");var pht={[qn]:qn,[X0]:X0,pipe(){return v(this,arguments)}};var eE={};Yn(eE,{SubscriptionRefTypeId:()=>cUe,get:()=>uUe,getAndSet:()=>pUe,getAndUpdate:()=>lUe,getAndUpdateEffect:()=>fUe,getAndUpdateSome:()=>dUe,getAndUpdateSomeEffect:()=>hUe,make:()=>mUe,modify:()=>xUe,modifyEffect:()=>gUe,modifySome:()=>bUe,modifySomeEffect:()=>yUe,set:()=>SUe,setAndGet:()=>EUe,update:()=>CUe,updateAndGet:()=>OUe,updateAndGetEffect:()=>_Ue,updateEffect:()=>wUe,updateSome:()=>kUe,updateSomeAndGet:()=>IUe,updateSomeAndGetEffect:()=>RUe,updateSomeEffect:()=>TUe});var Eue=tN;var Cue=GJ;var wue=KJ;var Oue=QJ;var _ue=JJ;var kue=ZJ;var Tue=YJ;var Iue=nN;var sUe="effect/SubscriptionRef",DB=Symbol.for(sUe),iUe={_A:e=>e},NB=class extends cn{ref;pubsub;semaphore;[qn]=qn;[X0]=X0;[yP]=sy;[Eue]=rN;[DB]=iUe;constructor(t,r,n){super(),this.ref=t,this.pubsub=r,this.semaphore=n,this.get=_t(this.ref)}commit(){return this.get}get;get changes(){return p(_t(this.ref),P(t=>w(o0(this.pubsub,{scoped:!0}),r=>oc(Rl(t),r))),this.semaphore.withPermits(1),vs)}modify(t){return this.modifyEffect(r=>B(t(r)))}modifyEffect(t){return p(_t(this.ref),P(t),P(([r,n])=>p(Dr(this.ref,n),Kt(r),dl(JD(this.pubsub,n)))),this.semaphore.withPermits(1))}},Rue=e=>_t(e.ref),Aue=e=>p(Po([jk(),tr(e),fl(1)]),w(([t,r,n])=>new NB(r,t,n))),Mue=u(2,(e,t)=>e.modify(t)),vue=u(2,(e,t)=>e.modifyEffect(t)),Pue=u(2,(e,t)=>p(Dr(e.ref,t),dl(JD(e.pubsub,t)),e.semaphore.withPermits(1)));var cUe=DB,uUe=Rue,pUe=sd,lUe=SP,fUe=Cue,dUe=EP,hUe=wue,mUe=Aue,xUe=Mue,gUe=vue,bUe=CP,yUe=Oue,SUe=Pue,EUe=wP,CUe=Os,wUe=_ue,OUe=OP,_Ue=kue,kUe=_P,TUe=Tue,IUe=kP,RUe=Iue;var Fue=gg(require("vscode")),AUe=(e,t,r)=>Ca.decodeUnknown(e)(t).pipe(Y.catchAll(n=>Y.logWarning(n).pipe(Y.andThen(Y.succeed(r))))),MUe=e=>(t,r,n)=>Y.gen(function*(){let o=e.get(t);return yield*AUe(r,o,n)}),tE=Y.gen(function*(){let e=Fue.workspace.getConfiguration("effect-decorate.extension"),t=MUe(e),r=yield*t("areDecorationsActive",Ca.Boolean,!0),n=yield*t("isDebugActive",Ca.Boolean,!0),o=yield*t("isNamespaceDecorationActive",Ca.Boolean,!0),s=yield*t("isYieldDecorationActive",Ca.Boolean,!0),i=yield*t("yieldableColor",Ca.Literal("none","default","custom"),"default"),a=yield*t("yieldableCustomColor",Ca.String,"#ffffff"),c=yield*t("yieldableTextDecoration",Ca.Literal("none","underline"),"underline");return{areDecorationsActive:r,isDebugActive:n,isNamespaceDecorationActive:o,isYieldDecorationActive:s,yieldableColor:i,yieldableCustomColor:a,yieldableTextDecoration:c}});var Nue=gg(require("vscode")),vUe=()=>Y.runSync(tE),Due=e=>Pu.replaceScoped(Pu.defaultLogger,Y.gen(function*(){let t=yield*Y.acquireRelease(Y.sync(()=>Nue.window.createOutputChannel(e)),r=>Y.sync(()=>r.dispose()));return Pu.make(r=>{let n=vUe();if(!(r.logLevel===$p.Debug?n.isDebugActive:!0))return;let s=Pu.logfmtLogger.log(r);t.appendLine(s)})}));var Lue=gg(require("vscode")),hg=class extends Jt.Tag("vscode/ExtensionContext")(){},Uue=e=>Y.gen(function*(){let t=yield*ca.make();(yield*hg).subscriptions.push({dispose(){Y.runFork(ca.close(t,en.void))}}),yield*xi.buildWithScope(e,t)}).pipe(Y.catchAllCause(Y.logFatal)),que=(e,t)=>Y.gen(function*(){let r=yield*hg,n=yield*Y.runtime(),o=Ux.runFork(n);r.subscriptions.push(Lue.commands.registerCommand(e,(...s)=>t(...s).pipe(Y.scoped,Y.catchAllCause(Y.logWarning),Y.annotateLogs({command:e}),o)))}),PUe=(e,t)=>Y.flatMap(Y.runtime(),r=>Y.async(()=>{let n=Ux.runFork(r),o=e(s=>n(t(s).pipe(Y.scoped,Y.catchAllCause(i=>Y.logWarning("unhandled defect in event listener: ",i)))));return Y.sync(()=>{o.dispose()})})),LB=(e,t)=>Y.forkScoped(PUe(e,t));var xo=gg(require("vscode"));var Wue=e=>t=>e?ie.some(t):ie.none(),FUe=()=>xo.window.visibleTextEditors.filter(e=>e.document.uri.scheme==="file"&&e.document.languageId==="typescript"),Hue=e=>{let{document:t,text:r,regexp:n}=e,o=[];for(let s of r.matchAll(n)){if(!s[0])continue;let i=s.index,a=t.positionAt(i),c=t.positionAt(i+s[0].length);o.push(new xo.Range(a,c))}return o},mg=(e,t)=>{for(let r of t)if(e.intersection(r))return!0;return!1},NUe=/\/\/.*/g,DUe=/\/\*[\s\S]*?\*\//g,LUe=/yield\*\s(\w+)/g,UUe=(e,t)=>{let r=Hue({document:e,text:t,regexp:NUe}),n=Hue({document:e,text:t,regexp:DUe});return[...r,...n]},qUe=e=>{let{document:t,text:r,commentRanges:n}=e,o=[],s=[],i;for(;(i=LUe.exec(r))!==null;){let a=t.positionAt(i.index),c=t.positionAt(i.index+i[0].length),l=new xo.Range(a,c);if(mg(l,n))continue;let f=t.positionAt(i.index+i[0].length-i[1].length),d=new xo.Range(a,f),h=f,m=new xo.Range(h,c);o.push(d),s.push(m)}return{yieldables:s,yields:o}},WUe=e=>{let{document:t,text:r,commentRanges:n}=e,o=[],s=[],i=/\b([A-Z]\w*)\.([A-Z]\w*)\b/g,a;for(;(a=i.exec(r))!==null;){if(a[1]!==a[2])continue;let c=t.positionAt(a.index),l=t.positionAt(a.index+a[0].length),f=new xo.Range(c,l);if(mg(f,n))continue;let d=t.positionAt(a.index+a[1].length+1),h=new xo.Range(c,d),m=d,y=new xo.Range(m,l);o.push(h),s.push(y)}return{namespaces:o,types:s}},E1=xo.window.createTextEditorDecorationType,Bue={opacity:"0",letterSpacing:"-0.6em"},zue=e=>{let t=Wue(e.isYieldDecorationActive)(E1(Bue)),n=(()=>{if(e.isYieldDecorationActive){let s=e.yieldableColor!=="none",i=e.yieldableColor==="default"?new xo.ThemeColor("editorInfo.foreground"):e.yieldableCustomColor;return s?ie.some(E1({color:i,textDecoration:e.yieldableTextDecoration})):ie.some(E1({textDecoration:e.yieldableTextDecoration}))}else return ie.none()})(),o=Wue(e.isNamespaceDecorationActive)(E1(Bue));return{yieldableDecoration:n,yieldDecoration:t,namespaceDecoration:o}},jue=xi.scopedDiscard(Y.gen(function*(){let e=yield*tE.pipe(Y.andThen(eE.make));yield*LB(xo.workspace.onDidChangeConfiguration,()=>tE.pipe(Y.andThen(d=>eE.set(e,d))));let t=yield*p(e.get,Y.andThen(zue),Y.andThen(Hr.make)),r=yield*Hr.make(new Map),n=yield*Hr.make(new Map),o=yield*Hr.make(new Map),s=(d,h)=>Y.gen(function*(){let m=yield*r,y=d.document.uri.path,T=d.document.version,C=m.get(y);if(C&&C.version===T)return C.ranges;let O=UUe(d.document,h);return yield*Hr.update(r,U=>new Map(U).set(y,{version:T,ranges:O})),O}),i=(d,h,m)=>Y.gen(function*(){let y=yield*o,T=d.document.uri.path,C=d.document.version,O=y.get(T),U=yield*s(d,h),I=O&&O.version===C?{yields:O.yields,yieldables:O.yieldables}:qUe({document:d.document,text:h,commentRanges:U});yield*Hr.update(o,z=>new Map(z).set(T,{version:C,yields:I.yields,yieldables:I.yieldables}));let K=[],Q=[];for(let z=0;z<I.yields.length;z++){let te=I.yields[z],ce=I.yieldables[z];if(!te||!ce)continue;mg(ce,m)||mg(te,m)||(K.push(te),Q.push(ce))}return{yields:K,yieldables:Q}}),a=(d,h,m)=>Y.gen(function*(){let y=yield*n,T=d.document.uri.path,C=d.document.version,O=y.get(T),U=yield*s(d,h),I=O&&O.version===C?{namespaces:O.namespaces,types:O.types}:WUe({document:d.document,text:h,commentRanges:U});yield*Hr.update(n,z=>new Map(z).set(T,{version:C,namespaces:I.namespaces,types:I.types}));let K=[],Q=[];for(let z=0;z<I.namespaces.length;z++){let te=I.namespaces[z],ce=I.types[z];if(!te||!ce)continue;mg(te,m)||mg(ce,m)||(K.push(te),Q.push(ce))}return{namespaces:K,types:Q}}),c=d=>Y.gen(function*(){let h=yield*t;ie.isSome(h.namespaceDecoration)&&d.setDecorations(h.namespaceDecoration.value,[]),ie.isSome(h.yieldableDecoration)&&d.setDecorations(h.yieldableDecoration.value,[]),ie.isSome(h.namespaceDecoration)&&d.setDecorations(h.namespaceDecoration.value,[])}),l=R0.counter("decorate_count",{description:"Counts how many times `decorate` has run",incremental:!0}),f=Y.gen(function*(){if(!(yield*e).areDecorationsActive)return;let h=FUe();if(h.length===0)return;let m=yield*R0.value(l);yield*l(Y.succeed(1));let{yieldDecoration:y,yieldableDecoration:T,namespaceDecoration:C}=yield*t;for(let O of h){yield*c(O);let U=O.selections,I=O.document.getText(),K=yield*i(O,I,U),Q=yield*a(O,I,U);ie.isSome(y)&&O.setDecorations(y.value,K.yields),ie.isSome(T)&&O.setDecorations(T.value,K.yieldables),ie.isSome(C)&&O.setDecorations(C.value,Q.namespaces)}yield*Y.logTrace(`count: ${m.count})`)}).pipe(Y.withLogSpan("decorate"));yield*Y.forkScoped(e.changes.pipe(S1.runForEach(d=>Y.gen(function*(){let h=yield*Hr.get(t);ie.isSome(h.yieldDecoration)&&h.yieldDecoration.value.dispose(),ie.isSome(h.yieldableDecoration)&&h.yieldableDecoration.value.dispose(),ie.isSome(h.namespaceDecoration)&&h.namespaceDecoration.value.dispose(),yield*Hr.set(t,zue(d)),yield*f.pipe(Y.annotateLogs({trigger:"configChange"}))})))),yield*LB(xo.window.onDidChangeTextEditorSelection,d=>d.textEditor.document.languageId==="typescript"?f.pipe(Y.annotateLogs({trigger:"selectionChange"})):Y.void),yield*f}));var $ue=gg(require("vscode"));var Vue=xi.scopedDiscard(que("effect-decorate.openSettings",()=>Y.sync(()=>$ue.commands.executeCommand("workbench.action.openSettings","@ext:dearhumandev.effect-decorate"))));var HUe=xi.mergeAll(Due("effect-decorate"),Pu.minimumLogLevel($p.Trace)),BUe=xi.mergeAll(jue,Vue,HUe),zUe=Uue(BUe).pipe(Y.andThen(Y.logInfo("\u{1F680} Initializing effect-decorate extension. ")));function jUe(e){Y.runFork(zUe.pipe(Y.provideService(hg,e)))}0&&(module.exports={activate});
