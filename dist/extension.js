"use strict";var Gue=Object.create;var nE=Object.defineProperty;var Kue=Object.getOwnPropertyDescriptor;var Que=Object.getOwnPropertyNames;var Jue=Object.getPrototypeOf,Zue=Object.prototype.hasOwnProperty;var Xn=(e,t)=>{for(var r in t)nE(e,r,{get:t[r],enumerable:!0})},qB=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Que(t))!Zue.call(e,o)&&o!==r&&nE(e,o,{get:()=>t[o],enumerable:!(n=Kue(t,o))||n.enumerable});return e};var gg=(e,t,r)=>(r=e!=null?Gue(Jue(e)):{},qB(t||!e||!e.__esModule?nE(r,"default",{value:e,enumerable:!0}):r,e)),Yue=e=>qB(nE({},"__esModule",{value:!0}),e);var VUe={};Xn(VUe,{activate:()=>$Ue});module.exports=Yue(VUe);var oE=e=>typeof e=="function",u=function(e,t){if(typeof e=="function")return function(){return e(arguments)?t.apply(this,arguments):r=>t(r,...arguments)};switch(e){case 0:case 1:throw new RangeError(`Invalid arity ${e}`);case 2:return function(r,n){return arguments.length>=2?t(r,n):function(o){return t(o,r)}};case 3:return function(r,n,o){return arguments.length>=3?t(r,n,o):function(s){return t(s,r,n)}};case 4:return function(r,n,o,s){return arguments.length>=4?t(r,n,o,s):function(i){return t(i,r,n,o)}};case 5:return function(r,n,o,s,i){return arguments.length>=5?t(r,n,o,s,i):function(a){return t(a,r,n,o,s)}};default:return function(){if(arguments.length>=e)return t.apply(this,arguments);let r=arguments;return function(n){return t(n,...r)}}}};var R=e=>e;var uh=e=>()=>e,jr=uh(!0),ls=uh(!1),O1=uh(null),ph=uh(void 0),Mr=ph;function p(e,t,r,n,o,s,i,a,c){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return r(t(e));case 4:return n(r(t(e)));case 5:return o(n(r(t(e))));case 6:return s(o(n(r(t(e)))));case 7:return i(s(o(n(r(t(e))))));case 8:return a(i(s(o(n(r(t(e)))))));case 9:return c(a(i(s(o(n(r(t(e))))))));default:{let l=arguments[0];for(let f=1;f<arguments.length;f++)l=arguments[f](l);return l}}}var ar=e=>(t,r)=>t===r||e(t,r),Xue=(e,t)=>e===t,epe=()=>Xue;var tpe=epe();var _1=u(2,(e,t)=>ar((r,n)=>e(t(r),t(n)))),HB=_1(tpe,e=>e.getTime());var WB=e=>ar((t,r)=>{if(t.length!==r.length)return!1;for(let n=0;n<t.length;n++)if(!e(t[n],r[n]))return!1;return!0});var lh=e=>u(3,(t,r,n)=>e(t,o=>({...o,[r]:n(o)}))),fh=e=>u(2,(t,r)=>e(t,n=>({[r]:n}))),sE=(e,t)=>u(3,(r,n,o)=>t(r,s=>e(o(s),i=>({...s,[n]:i}))));var BB="effect/GlobalValue",bg,ne=(e,t)=>(bg||(globalThis[BB]??=new Map,bg=globalThis[BB]),bg.has(e)||bg.set(e,t()),bg.get(e));var zB=e=>!!e,jB=e=>e instanceof Set,$B=e=>e instanceof Map,cr=e=>typeof e=="string",go=e=>typeof e=="number",_i=e=>typeof e=="boolean",Bu=e=>typeof e=="bigint",Oa=e=>typeof e=="symbol";var ki=oE,VB=e=>e===void 0,GB=e=>e!==void 0;var iE=e=>e!==null,KB=e=>!1;var dh=e=>typeof e=="object"&&e!==null,$r=e=>dh(e)||ki(e),F=u(2,(e,t)=>$r(e)&&t in e),_a=u(2,(e,t)=>F(e,"_tag")&&e._tag===t),Ul=e=>e==null,QB=e=>e!=null;var JB=e=>e instanceof Uint8Array,aE=e=>e instanceof Date,Lo=e=>typeof e=="string"||F(e,Symbol.iterator),yg=e=>dh(e)&&!Array.isArray(e);var T1=e=>F(e,"then")&&ki(e.then);var ql=e=>`BUG: ${e} - please report an issue at https://github.com/Effect-TS/effect/issues`;var I1=Symbol.for("effect/Gen/GenKind"),YB=e=>$r(e)&&I1 in e,R1=class{value;constructor(t){this.value=t}get _F(){return R}get _R(){return t=>t}get _O(){return t=>t}get _E(){return t=>t}[I1]=I1;[Symbol.iterator](){return new Hl(this)}},Hl=class e{self;called=!1;constructor(t){this.self=t}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new e(this.self)}};var XB=()=>function(){let e=arguments[0];for(let t=1;t<arguments.length;t++)e=arguments[t](e);return new R1(e)},npe=335903614,ope=4150755663,spe=1481765933,ipe=1284865837,ape=9007199254740992,cpe=134217728,cE=class{_state;constructor(t,r,n,o){return Ul(r)&&Ul(t)?(r=Math.random()*4294967295>>>0,t=0):Ul(r)&&(r=t,t=0),Ul(o)&&Ul(n)?(o=this._state?this._state[3]:ope,n=this._state?this._state[2]:npe):Ul(o)&&(o=n,n=0),this._state=new Int32Array([0,0,n>>>0,((o||0)|1)>>>0]),this._next(),ZB(this._state,this._state[0],this._state[1],t>>>0,r>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(t){this._state[0]=t[0],this._state[1]=t[1],this._state[2]=t[2],this._state[3]=t[3]|1}integer(t){return Math.round(this.number()*Number.MAX_SAFE_INTEGER)%t}number(){let t=(this._next()&67108863)*1,r=(this._next()&134217727)*1;return(t*cpe+r)/ape}_next(){let t=this._state[0]>>>0,r=this._state[1]>>>0;upe(this._state,t,r,spe,ipe),ZB(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let n=t>>>18,o=(r>>>18|t<<14)>>>0;n=(n^t)>>>0,o=(o^r)>>>0;let s=(o>>>27|n<<5)>>>0,i=t>>>27,a=(-i>>>0&31)>>>0;return(s>>>i|s<<a)>>>0}};function upe(e,t,r,n,o){let s=(r>>>16)*(o&65535)>>>0,i=(r&65535)*(o>>>16)>>>0,a=(r&65535)*(o&65535)>>>0,c=(r>>>16)*(o>>>16)+((i>>>16)+(s>>>16))>>>0;i=i<<16>>>0,a=a+i>>>0,a>>>0<i>>>0&&(c=c+1>>>0),s=s<<16>>>0,a=a+s>>>0,a>>>0<s>>>0&&(c=c+1>>>0),c=c+Math.imul(r,n)>>>0,c=c+Math.imul(t,o)>>>0,e[0]=c,e[1]=a}function ZB(e,t,r,n,o){let s=t+n>>>0,i=r+o>>>0;i>>>0<r>>>0&&(s=s+1|0),e[0]=s,e[1]=i}var A1=Symbol.for("effect/Utils/YieldWrap"),qs=class{#e;constructor(t){this.#e=t}[A1](){return this.#e}};function Sg(e){if(typeof e=="object"&&e!==null&&A1 in e)return e[A1]();throw new Error(ql("yieldWrapGet"))}var Uo=ne("effect/Utils/isStructuralRegion",()=>({enabled:!1,tester:void 0}));var ez={effect_internal_function:e=>e()},ppe={effect_internal_function:e=>{try{return e()}finally{}}},lpe=ez.effect_internal_function(()=>new Error().stack)?.includes("effect_internal_function")===!0,rt=lpe?ez.effect_internal_function:ppe.effect_internal_function,fpe=function*(){}.constructor,tz=e=>$r(e)&&e.constructor===fpe;var v1=ne(Symbol.for("effect/Hash/randomHashCache"),()=>new WeakMap),W=Symbol.for("effect/Hash"),M=e=>{if(Uo.enabled===!0)return 0;switch(typeof e){case"number":return ac(e);case"bigint":return Ke(e.toString(10));case"boolean":return Ke(String(e));case"symbol":return Ke(String(e));case"string":return Ke(e);case"undefined":return Ke("undefined");case"function":case"object":return e===null?Ke("null"):e instanceof Date?M(e.toISOString()):e instanceof URL?M(e.href):dpe(e)?e[W]():zu(e);default:throw new Error(`BUG: unhandled typeof ${typeof e} - please report an issue at https://github.com/Effect-TS/effect/issues`)}},zu=e=>(v1.has(e)||v1.set(e,ac(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER))),v1.get(e)),K=e=>t=>t*53^e,uE=e=>e&3221225471|e>>>1&1073741824,dpe=e=>F(e,W),ac=e=>{if(e!==e||e===1/0)return 0;let t=e|0;for(t!==e&&(t^=e*4294967295);e>4294967295;)t^=e/=4294967295;return uE(t)},Ke=e=>{let t=5381,r=e.length;for(;r;)t=t*33^e.charCodeAt(--r);return uE(t)},hpe=(e,t)=>{let r=12289;for(let n=0;n<t.length;n++)r^=p(Ke(t[n]),K(M(e[t[n]])));return uE(r)},pE=e=>hpe(e,Object.keys(e)),qo=e=>{let t=6151;for(let r=0;r<e.length;r++)t=p(t,K(M(e[r])));return uE(t)},ie=function(){if(arguments.length===1){let r=arguments[0];return function(n){return Object.defineProperty(r,W,{value(){return n},enumerable:!1}),n}}let e=arguments[0],t=arguments[1];return Object.defineProperty(e,W,{value(){return t},enumerable:!1}),t};var H=Symbol.for("effect/Equal");function N(){return arguments.length===1?e=>lE(e,arguments[0]):lE(arguments[0],arguments[1])}function lE(e,t){if(e===t)return!0;let r=typeof e;if(r!==typeof t)return!1;if(r==="object"||r==="function"){if(e!==null&&t!==null){if(ju(e)&&ju(t))return M(e)===M(t)&&e[H](t)?!0:Uo.enabled&&Uo.tester?Uo.tester(e,t):!1;if(e instanceof Date&&t instanceof Date)return e.toISOString()===t.toISOString();if(e instanceof URL&&t instanceof URL)return e.href===t.href}if(Uo.enabled){if(Array.isArray(e)&&Array.isArray(t))return e.length===t.length&&e.every((n,o)=>lE(n,t[o]));if(Object.getPrototypeOf(e)===Object.prototype&&Object.getPrototypeOf(e)===Object.prototype){let n=Object.keys(e),o=Object.keys(t);if(n.length===o.length){for(let s of n)if(!(s in t&&lE(e[s],t[s])))return Uo.tester?Uo.tester(e,t):!1;return!0}}return Uo.tester?Uo.tester(e,t):!1}}return Uo.enabled&&Uo.tester?Uo.tester(e,t):!1}var ju=e=>F(e,H),Eg=()=>N;var he=Symbol.for("nodejs.util.inspect.custom"),ve=e=>{try{if(F(e,"toJSON")&&ki(e.toJSON)&&e.toJSON.length===0)return e.toJSON();if(Array.isArray(e))return e.map(ve)}catch{return{}}return hh(e)},P1="[Circular]";function bo(e){try{return e.toISOString()}catch{return"Invalid Date"}}function mpe(e){try{let t=e.toString();return typeof t=="string"?t:String(t)}catch{return"[toString threw]"}}function $u(e){return cr(e)?JSON.stringify(e):String(e)}function Ho(e,t){let r=t?.space??0,n=new WeakSet,o=r?go(r)?" ".repeat(r):r:"",s=l=>o.repeat(l),i=(l,f)=>{let d=l?.constructor;return d&&d!==Object.prototype.constructor&&d.name?`${d.name}(${f})`:f},a=l=>{try{return Reflect.ownKeys(l)}catch{return["[ownKeys threw]"]}};function c(l,f=0){if(Array.isArray(l)){if(n.has(l))return P1;if(n.add(l),!o||l.length<=1)return`[${l.map(h=>c(h,f)).join(",")}]`;let d=l.map(h=>c(h,f+1)).join(`,
`+s(f+1));return`[
${s(f+1)}${d}
${s(f)}]`}if(aE(l))return bo(l);if(!t?.ignoreToString&&F(l,"toString")&&ki(l.toString)&&l.toString!==Object.prototype.toString&&l.toString!==Array.prototype.toString){let d=mpe(l);return l instanceof Error&&l.cause?`${d} (cause: ${c(l.cause,f)})`:d}if(cr(l))return JSON.stringify(l);if(go(l)||l==null||_i(l)||Oa(l))return String(l);if(Bu(l))return String(l)+"n";if(l instanceof Set||l instanceof Map)return n.has(l)?P1:(n.add(l),`${l.constructor.name}(${c(Array.from(l),f)})`);if($r(l)){if(n.has(l))return P1;n.add(l);let d=a(l);if(!o||d.length<=1){let m=`{${d.map(y=>`${$u(y)}:${c(l[y],f)}`).join(",")}}`;return i(l,m)}let h=`{
${d.map(m=>`${s(f+1)}${$u(m)}: ${c(l[m],f+1)}`).join(`,
`)}
${s(f)}}`;return i(l,h)}return String(l)}return c(e,0)}var De=e=>JSON.stringify(e,null,2),uqe={toJSON(){return ve(this)},[he](){return this.toJSON()},toString(){return De(this.toJSON())}},rz=class{[he](){return this.toJSON()}toString(){return De(this.toJSON())}},cc=(e,t=2)=>{if(typeof e=="string")return e;try{return typeof e=="object"?Cg(e,t):String(e)}catch{return String(e)}},Cg=(e,t)=>{let r=[],n=JSON.stringify(e,(o,s)=>typeof s=="object"&&s!==null?r.includes(s)?void 0:r.push(s)&&(Wl.fiberRefs!==void 0&&nz(s)?s[F1](Wl.fiberRefs):s):s,t);return r=void 0,n},F1=Symbol.for("effect/Inspectable/Redactable"),nz=e=>typeof e=="object"&&e!==null&&F1 in e,Wl=ne("effect/Inspectable/redactableState",()=>({fiberRefs:void 0})),oz=(e,t)=>{let r=Wl.fiberRefs;Wl.fiberRefs=e;try{return t()}finally{Wl.fiberRefs=r}},hh=e=>nz(e)&&Wl.fiberRefs!==void 0?e[F1](Wl.fiberRefs):e;var v=(e,t)=>{switch(t.length){case 0:return e;case 1:return t[0](e);case 2:return t[1](t[0](e));case 3:return t[2](t[1](t[0](e)));case 4:return t[3](t[2](t[1](t[0](e))));case 5:return t[4](t[3](t[2](t[1](t[0](e)))));case 6:return t[5](t[4](t[3](t[2](t[1](t[0](e))))));case 7:return t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))));case 8:return t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e))))))));case 9:return t[8](t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))))));default:{let r=e;for(let n=0,o=t.length;n<o;n++)r=t[n](r);return r}}};var Bl="Async",uc="Commit",mt="Failure",mh="OnFailure",xh="OnSuccess",gh="OnSuccessAndFailure",xt="Success",fE="Sync";var pc="UpdateRuntimeFlags",bh="While",zl="Iterator",dE="WithRuntime",yh="Yield",wg="RevertFlags";var gpe="3.19.3",_g=()=>gpe;var iz=Symbol.for("effect/Effect"),kg=Symbol.for("effect/Stream"),az=Symbol.for("effect/Sink"),cz=Symbol.for("effect/Channel"),Ta={_R:e=>e,_E:e=>e,_A:e=>e,_V:_g()},bpe={_A:e=>e,_In:e=>e,_L:e=>e,_E:e=>e,_R:e=>e},ype={_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutElem:e=>e,_OutDone:e=>e},lc={[iz]:Ta,[kg]:Ta,[az]:bpe,[cz]:ype,[H](e){return this===e},[W](){return ie(this,zu(this))},[Symbol.iterator](){return new Hl(new qs(this))},pipe(){return v(this,arguments)}},Sh={[W](){return ie(this,pE(this))},[H](e){let t=Object.keys(this),r=Object.keys(e);if(t.length!==r.length)return!1;for(let n of t)if(!(n in e&&N(this[n],e[n])))return!1;return!0}},Ti={...lc,_op:uc},N1={...Ti,...Sh},uz=(function(){function e(){}return e.prototype=Ti,e})();var pz=Symbol.for("effect/Option"),lz={...lc,[pz]:{_A:e=>e},[he](){return this.toJSON()},toString(){return De(this.toJSON())}},Spe=Object.assign(Object.create(lz),{_tag:"Some",_op:"Some",[H](e){return hE(e)&&L1(e)&&N(this.value,e.value)},[W](){return ie(this,K(M(this._tag))(M(this.value)))},toJSON(){return{_id:"Option",_tag:this._tag,value:ve(this.value)}}}),Epe=M("None"),Cpe=Object.assign(Object.create(lz),{_tag:"None",_op:"None",[H](e){return hE(e)&&Vu(e)},[W](){return Epe},toJSON(){return{_id:"Option",_tag:this._tag}}}),hE=e=>F(e,pz),Vu=e=>e._tag==="None",L1=e=>e._tag==="Some",Ii=Object.create(Cpe),An=e=>{let t=Object.create(Spe);return t.value=e,t};var U1=Symbol.for("effect/Either"),fz={...lc,[U1]:{_R:e=>e},[he](){return this.toJSON()},toString(){return De(this.toJSON())}},wpe=Object.assign(Object.create(fz),{_tag:"Right",_op:"Right",[H](e){return mE(e)&&xE(e)&&N(this.right,e.right)},[W](){return K(M(this._tag))(M(this.right))},toJSON(){return{_id:"Either",_tag:this._tag,right:ve(this.right)}}}),Ope=Object.assign(Object.create(fz),{_tag:"Left",_op:"Left",[H](e){return mE(e)&&Eh(e)&&N(this.left,e.left)},[W](){return K(M(this._tag))(M(this.left))},toJSON(){return{_id:"Either",_tag:this._tag,left:ve(this.left)}}}),mE=e=>F(e,U1),Eh=e=>e._tag==="Left",xE=e=>e._tag==="Right",Ig=e=>{let t=Object.create(Ope);return t.left=e,t},Rg=e=>{let t=Object.create(wpe);return t.right=e,t},q1=e=>xE(e)?Ii:An(e.left),H1=e=>Eh(e)?Ii:An(e.right),dz=u(2,(e,t)=>Vu(e)?Ig(t()):Rg(e.value));var Y=Rg;var V=Ig;var W1=dz,Ch=e=>{if(ki(e))try{return Y(e())}catch(t){return V(t)}else try{return Y(e.try())}catch(t){return V(e.catch(t))}};var gE=mE,kt=Eh,Wo=xE;var mz=({left:e,right:t})=>ar((r,n)=>kt(r)?kt(n)&&e(r.left,n.left):Wo(n)&&t(r.right,n.right)),xz=u(2,(e,{onLeft:t,onRight:r})=>kt(e)?V(t(e.left)):Y(r(e.right))),Hs=u(2,(e,t)=>kt(e)?V(t(e.left)):Y(e.right)),wh=u(2,(e,t)=>Wo(e)?Y(t(e.right)):V(e.left)),Xe=u(2,(e,{onLeft:t,onRight:r})=>kt(e)?t(e.left):r(e.right));var bE=Xe({onLeft:R,onRight:R});var B1=u(2,(e,t)=>{if(Wo(e))return e.right;throw t(e.left)}),z1=B1(()=>new Error("getOrThrow called on a Left"));var j1=e=>e.length>0;var oe={};Xn(oe,{Do:()=>Zpe,TypeId:()=>kpe,all:()=>Sz,andThen:()=>Npe,ap:()=>Wpe,as:()=>gz,asVoid:()=>Ppe,bind:()=>Jpe,bindTo:()=>Kpe,composeK:()=>qpe,contains:()=>J1,containsWith:()=>wz,exists:()=>Z1,filter:()=>Qu,filterMap:()=>Cz,firstSomeOf:()=>Mpe,flatMap:()=>kr,flatMapNullable:()=>G1,flatten:()=>Dpe,fromIterable:()=>Ipe,fromNullable:()=>br,gen:()=>Xpe,getEquivalence:()=>Q1,getLeft:()=>Rpe,getOrElse:()=>_e,getOrNull:()=>EE,getOrThrow:()=>vg,getOrThrowWith:()=>CE,getOrUndefined:()=>yr,getOrder:()=>jpe,getRight:()=>$1,isNone:()=>ge,isOption:()=>SE,isSome:()=>X,let:()=>Qpe,lift2:()=>$pe,liftNullable:()=>vpe,liftPredicate:()=>Vpe,liftThrowable:()=>Vl,map:()=>ct,match:()=>$,mergeWith:()=>Ju,none:()=>g,orElse:()=>yo,orElseEither:()=>Ape,orElseSome:()=>V1,partitionMap:()=>zpe,product:()=>yz,productMany:()=>Hpe,reduceCompact:()=>Bpe,some:()=>x,tap:()=>bz,toArray:()=>Ez,toRefinement:()=>Tpe,void:()=>Fpe,zipLeft:()=>Upe,zipRight:()=>Lpe,zipWith:()=>K1});var fc=e=>(t,r)=>t===r?0:e(t,r);var yE=fc((e,t)=>e<t?-1:1);var Oh=fc((e,t)=>e<t?-1:1);var _h=u(2,(e,t)=>fc((r,n)=>e(t(r),t(n))));var jl=e=>u(2,(t,r)=>e(t,r)===-1),$l=e=>u(2,(t,r)=>e(t,r)===1),kh=e=>u(2,(t,r)=>e(t,r)!==1),Th=e=>u(2,(t,r)=>e(t,r)!==-1),Ag=e=>u(2,(t,r)=>t===r||e(t,r)<1?t:r),Mg=e=>u(2,(t,r)=>t===r||e(t,r)>-1?t:r),Gu=e=>u(2,(t,r)=>Ag(e)(r.maximum,Mg(e)(r.minimum,t))),Ih=e=>u(2,(t,r)=>!jl(e)(t,r.minimum)&&!$l(e)(t,r.maximum));var kpe=Symbol.for("effect/Option"),g=()=>Ii,x=An,SE=hE,ge=Vu,X=L1,$=u(2,(e,{onNone:t,onSome:r})=>ge(e)?t():r(e.value)),Tpe=e=>t=>X(e(t)),Ipe=e=>{for(let t of e)return x(t);return g()},$1=H1,Rpe=q1,_e=u(2,(e,t)=>ge(e)?t():e.value),yo=u(2,(e,t)=>ge(e)?t():e),V1=u(2,(e,t)=>ge(e)?x(t()):e),Ape=u(2,(e,t)=>ge(e)?ct(t(),Rg):ct(e,Ig)),Mpe=e=>{let t=g();for(t of e)if(X(t))return t;return t},br=e=>e==null?g():x(e),vpe=e=>(...t)=>br(e(...t)),EE=_e(O1),yr=_e(ph),Vl=e=>(...t)=>{try{return x(e(...t))}catch{return g()}},CE=u(2,(e,t)=>{if(X(e))return e.value;throw t()}),vg=CE(()=>new Error("getOrThrow called on a None")),ct=u(2,(e,t)=>ge(e)?g():x(t(e.value))),gz=u(2,(e,t)=>ct(e,()=>t)),Ppe=gz(void 0),Fpe=x(void 0);var kr=u(2,(e,t)=>ge(e)?g():t(e.value)),Npe=u(2,(e,t)=>kr(e,r=>{let n=oE(t)?t(r):t;return SE(n)?n:x(n)})),G1=u(2,(e,t)=>ge(e)?g():br(t(e.value))),Dpe=kr(R),Lpe=u(2,(e,t)=>kr(e,()=>t)),Upe=u(2,(e,t)=>bz(e,()=>t)),qpe=u(2,(e,t)=>r=>kr(e(r),t)),bz=u(2,(e,t)=>kr(e,r=>ct(t(r),()=>r))),yz=(e,t)=>X(e)&&X(t)?x([e.value,t.value]):g(),Hpe=(e,t)=>{if(ge(e))return g();let r=[e.value];for(let n of t){if(ge(n))return g();r.push(n.value)}return x(r)},Sz=e=>{if(Symbol.iterator in e){let r=[];for(let n of e){if(ge(n))return g();r.push(n.value)}return x(r)}let t={};for(let r of Object.keys(e)){let n=e[r];if(ge(n))return g();t[r]=n.value}return x(t)},K1=u(3,(e,t,r)=>ct(yz(e,t),([n,o])=>r(n,o))),Wpe=u(2,(e,t)=>K1(e,t,(r,n)=>r(n))),Bpe=u(3,(e,t,r)=>{let n=t;for(let o of e)X(o)&&(n=r(n,o.value));return n}),Ez=e=>ge(e)?[]:[e.value],zpe=u(2,(e,t)=>{if(ge(e))return[g(),g()];let r=t(e.value);return Eh(r)?[x(r.left),g()]:[g(),x(r.right)]}),Cz=kr,Qu=u(2,(e,t)=>Cz(e,r=>t(r)?An(r):Ii)),Q1=e=>ar((t,r)=>ge(t)?ge(r):ge(r)?!1:e(t.value,r.value)),jpe=e=>fc((t,r)=>X(t)?X(r)?e(t.value,r.value):1:-1),$pe=e=>u(2,(t,r)=>K1(t,r,e)),Vpe=u(2,(e,t)=>t(e)?x(e):g()),wz=e=>u(2,(t,r)=>ge(t)?!1:e(t.value,r)),Gpe=Eg(),J1=wz(Gpe),Z1=u(2,(e,t)=>ge(e)?!1:t(e.value)),Kpe=fh(ct),Qpe=lh(ct);var Jpe=sE(ct,kr),Zpe=x({}),Ype=XB(),Xpe=(...e)=>{let r=(e.length===1?e[0]:e[1].bind(e[0]))(Ype),n=r.next();for(;!n.done;){let o=YB(n.value)?n.value.value:Sg(n.value);if(ge(o))return o;n=r.next(o.value)}return x(n.value)},Ju=e=>(t,r)=>ge(t)?r:ge(r)?t:x(e(t.value,r.value));var wE=(...e)=>e;var Oz=u(2,(e,t)=>{let r=0;for(let n of e){let o=t(n,r);if(_i(o)){if(o)return x(n)}else if(X(o))return o;r++}return g()});var Gl=e=>new Array(e),OE=u(2,(e,t)=>{let r=Math.max(1,Math.floor(e)),n=new Array(r);for(let o=0;o<r;o++)n[o]=t(o);return n});var Ee=e=>Array.isArray(e)?e:Array.from(e),Kl=e=>Array.isArray(e)?e:[e];var X1=u(2,(e,{onEmpty:t,onNonEmpty:r})=>ut(e)?r(e):t()),kz=u(2,(e,{onEmpty:t,onNonEmpty:r})=>ut(e)?r(Ur(e),Ai(e)):t());var Rh=u(2,(e,t)=>[t,...e]);var Tz=u(2,(e,t)=>[...e,t]),eR=u(2,(e,t)=>Ee(e).concat(Ee(t)));var tR=Array.isArray,ele=e=>e.length===0,Iz=ele,Ri=j1,ut=j1;var Rz=(e,t)=>e<0||e>=t.length,tle=(e,t)=>Math.floor(Math.min(Math.max(0,e),t.length)),rle=u(2,(e,t)=>{let r=Math.floor(t);return Rz(r,e)?g():x(e[r])}),rR=u(2,(e,t)=>{let r=Math.floor(t);if(Rz(r,e))throw new Error(`Index ${r} out of bounds`);return e[r]});var Ia=rle(0),Ur=rR(0),_E=e=>ut(e)?x(nR(e)):g(),nR=e=>e[e.length-1];var Ai=e=>e.slice(1);var nle=(e,t)=>{let r=0;for(let n of e){if(!t(n,r))break;r++}return r},Az=u(2,(e,t)=>aR(e,nle(e,t))),Mz=u(2,(e,t)=>{let r=Ee(e);return r.slice(tle(t,r),r.length)});var kE=Oz;var oR=e=>Array.from(e).reverse(),dc=u(2,(e,t)=>{let r=Array.from(e);return r.sort(t),r});var sR=u(2,(e,t)=>iR(e,t,wE)),iR=u(3,(e,t,r)=>{let n=Ee(e),o=Ee(t);if(ut(n)&&ut(o)){let s=[r(Ur(n),Ur(o))],i=Math.min(n.length,o.length);for(let a=1;a<i;a++)s[a]=r(n[a],o[a]);return s}return[]});var vz=e=>u(2,(t,r)=>{for(let n of t)if(e(r,n))return!0;return!1}),Pz=Eg();var aR=u(2,(e,t)=>{let r=Array.from(e),n=Math.floor(t);return ut(r)?n>=1?ole(r,n):[[],r]:[r,[]]}),ole=u(2,(e,t)=>{let r=Math.max(1,Math.floor(t));return r>=e.length?[Ah(e),[]]:[Rh(e.slice(1,r),Ur(e)),e.slice(r)]});var Ah=e=>e.slice();var sle=u(3,(e,t,r)=>{let n=Ee(e),o=Ee(t);return ut(n)?ut(o)?Uz(r)(eR(n,o)):n:o}),fs=u(2,(e,t)=>sle(e,t,Pz)),cR=e=>{let t=vz(e);return u(2,(r,n)=>Ee(r).filter(o=>t(n,o)))},uR=cR(Pz);var ds=()=>[],Gr=e=>[e],Mi=u(2,(e,t)=>e.map(t)),Ql=u(2,(e,t)=>{if(Iz(e))return[];let r=[];for(let n=0;n<e.length;n++){let o=t(e[n],n);for(let s=0;s<o.length;s++)r.push(o[s])}return r}),Mh=Ql(R),hc=u(2,(e,t)=>{let r=Ee(e),n=[];for(let o=0;o<r.length;o++){let s=t(r[o],o);X(s)&&n.push(s.value)}return n}),Fz=u(2,(e,t)=>{let r=0,n=[];for(let o of e){let s=t(o,r);if(X(s))n.push(s.value);else break;r++}return n}),pR=u(2,(e,t)=>{let r=[],n=[],o=Ee(e);for(let s=0;s<o.length;s++){let i=t(o[s],s);kt(i)?r.push(i.left):n.push(i.right)}return[r,n]}),Nz=hc(R);var Dz=u(2,(e,t)=>{let r=Ee(e),n=[];for(let o=0;o<r.length;o++)t(r[o],o)&&n.push(r[o]);return n});var mc=u(3,(e,t,r)=>Ee(e).reduce((n,o,s)=>r(n,o,s),t)),Pg=u(3,(e,t,r)=>Ee(e).reduceRight((n,o,s)=>r(n,o,s),t));var Lz=u(2,(e,t)=>e.every(t));var lR=(e,t)=>{let r=[],n=e,o;for(;X(o=t(n));){let[s,i]=o.value;r.push(s),n=i}return r};var Mn=WB;var Uz=u(2,(e,t)=>{let r=Ee(e);if(ut(r)){let n=[Ur(r)],o=Ai(r);for(let s of o)n.every(i=>!t(s,i))&&n.push(s);return n}return[]}),fR=e=>Uz(e,Eg());var xc=u(2,(e,t)=>Ee(e).join(t)),qz=u(3,(e,t,r)=>{let n=0,o=t,s=[];for(let i of e){let a=r(o,i,n);o=a[0],s.push(a[1]),n++}return[o,s]});var Ws=class e extends Error{constructor(t=!1){super(),this.interruptExecution=t,this.footprint=e.SharedFootPrint}static isFailure(t){return t!=null&&t.footprint===e.SharedFootPrint}};Ws.SharedFootPrint=Symbol.for("fast-check/PreconditionFailure");var Fg=class{[Symbol.iterator](){return this}next(t){return{value:t,done:!0}}};Fg.nil=new Fg;function Hz(){return Fg.nil}function*Wz(e,t){for(let r of e)yield t(r)}function*Bz(e,t){for(let r of e)yield*t(r)}function*zz(e,t){for(let r of e)t(r)&&(yield r)}function*jz(e,t){for(let r=0;r<t;++r){let n=e.next();if(n.done)break;yield n.value}}function*$z(e,t){let r=e.next();for(;!r.done&&t(r.value);)yield r.value,r=e.next()}function*Vz(e,t){for(let r=e.next();!r.done;r=e.next())yield r.value;for(let r of t)for(let n=r.next();!n.done;n=r.next())yield n.value}var ile=Symbol.iterator,ot=class e{static nil(){return new e(Hz())}static of(...t){return new e(t[ile]())}constructor(t){this.g=t}next(){return this.g.next()}[Symbol.iterator](){return this.g}map(t){return new e(Wz(this.g,t))}flatMap(t){return new e(Bz(this.g,t))}dropWhile(t){let r=!1;function*n(o){(r||!t(o))&&(r=!0,yield o)}return this.flatMap(n)}drop(t){if(t<=0)return this;let r=0;function n(){return r++<t}return this.dropWhile(n)}takeWhile(t){return new e($z(this.g,t))}take(t){return new e(jz(this.g,t))}filter(t){return new e(zz(this.g,t))}every(t){for(let r of this.g)if(!t(r))return!1;return!0}has(t){for(let r of this.g)if(t(r))return[!0,r];return[!1,null]}join(...t){return new e(Vz(this.g,t))}getNthOrLast(t){let r=t,n=null;for(let o of this.g){if(r--===0)return o;n=o}return n}};function Zu(e){return new ot(e)}var Sr=Symbol.for("fast-check/cloneMethod");function gc(e){return e!==null&&(typeof e=="object"||typeof e=="function")&&Sr in e&&typeof e[Sr]=="function"}function Jl(e){return gc(e)?e[Sr]():e}var ale=Object.defineProperty,Pe=class{constructor(t,r,n=void 0){this.value_=t,this.context=r,this.hasToBeCloned=n!==void 0||gc(t),this.readOnce=!1,this.hasToBeCloned?ale(this,"value",{get:n!==void 0?n:this.getValue}):this.value=t}getValue(){return this.hasToBeCloned?this.readOnce?this.value_[Sr]():(this.readOnce=!0,this.value_):this.value_}};var Gz=Object.assign,Tt=class{filter(t){return new mR(this,t)}map(t,r){return new hR(this,t,r)}chain(t){return new dR(this,t)}noShrink(){return new xR(this)}noBias(){return new gR(this)}},dR=class extends Tt{constructor(t,r){super(),this.arb=t,this.chainer=r}generate(t,r){let n=t.clone(),o=this.arb.generate(t,r);return this.valueChainer(o,t,n,r)}canShrinkWithoutContext(t){return!1}shrink(t,r){return this.isSafeContext(r)?(r.stoppedForOriginal?ot.nil():this.arb.shrink(r.originalValue,r.originalContext).map(n=>this.valueChainer(n,r.clonedMrng.clone(),r.clonedMrng,r.originalBias))).join(r.chainedArbitrary.shrink(t,r.chainedContext).map(n=>{let o=Gz(Gz({},r),{chainedContext:n.context,stoppedForOriginal:!0});return new Pe(n.value_,o)})):ot.nil()}valueChainer(t,r,n,o){let s=this.chainer(t.value_),i=s.generate(r,o),a={originalBias:o,originalValue:t.value_,originalContext:t.context,stoppedForOriginal:!1,chainedArbitrary:s,chainedContext:i.context,clonedMrng:n};return new Pe(i.value_,a)}isSafeContext(t){return t!=null&&typeof t=="object"&&"originalBias"in t&&"originalValue"in t&&"originalContext"in t&&"stoppedForOriginal"in t&&"chainedArbitrary"in t&&"chainedContext"in t&&"clonedMrng"in t}},hR=class extends Tt{constructor(t,r,n){super(),this.arb=t,this.mapper=r,this.unmapper=n,this.bindValueMapper=o=>this.valueMapper(o)}generate(t,r){let n=this.arb.generate(t,r);return this.valueMapper(n)}canShrinkWithoutContext(t){if(this.unmapper!==void 0)try{let r=this.unmapper(t);return this.arb.canShrinkWithoutContext(r)}catch{return!1}return!1}shrink(t,r){if(this.isSafeContext(r))return this.arb.shrink(r.originalValue,r.originalContext).map(this.bindValueMapper);if(this.unmapper!==void 0){let n=this.unmapper(t);return this.arb.shrink(n,void 0).map(this.bindValueMapper)}return ot.nil()}mapperWithCloneIfNeeded(t){let r=t.value,n=this.mapper(r);return t.hasToBeCloned&&(typeof n=="object"&&n!==null||typeof n=="function")&&Object.isExtensible(n)&&!gc(n)&&Object.defineProperty(n,Sr,{get:()=>()=>this.mapperWithCloneIfNeeded(t)[0]}),[n,r]}valueMapper(t){let[r,n]=this.mapperWithCloneIfNeeded(t),o={originalValue:n,originalContext:t.context};return new Pe(r,o)}isSafeContext(t){return t!=null&&typeof t=="object"&&"originalValue"in t&&"originalContext"in t}},mR=class extends Tt{constructor(t,r){super(),this.arb=t,this.refinement=r,this.bindRefinementOnValue=n=>this.refinementOnValue(n)}generate(t,r){for(;;){let n=this.arb.generate(t,r);if(this.refinementOnValue(n))return n}}canShrinkWithoutContext(t){return this.arb.canShrinkWithoutContext(t)&&this.refinement(t)}shrink(t,r){return this.arb.shrink(t,r).filter(this.bindRefinementOnValue)}refinementOnValue(t){return this.refinement(t.value)}},xR=class extends Tt{constructor(t){super(),this.arb=t}generate(t,r){return this.arb.generate(t,r)}canShrinkWithoutContext(t){return this.arb.canShrinkWithoutContext(t)}shrink(t,r){return ot.nil()}noShrink(){return this}},gR=class extends Tt{constructor(t){super(),this.arb=t}generate(t,r){return this.arb.generate(t,void 0)}canShrinkWithoutContext(t){return this.arb.canShrinkWithoutContext(t)}shrink(t,r){return this.arb.shrink(t,r)}noBias(){return this}};var Kz=Function.prototype.apply,bR=Symbol("apply");function cle(e){try{return e.apply}catch{return}}function ule(e,t,r){let n=e;n[bR]=Kz;let o=n[bR](t,r);return delete n[bR],o}function So(e,t,r){return cle(e)===Kz?e.apply(t,r):ule(e,t,r)}var c3=typeof Array<"u"?Array:void 0;var vr=typeof Error<"u"?Error:void 0;var vi=typeof String<"u"?String:void 0;var u3=typeof encodeURIComponent<"u"?encodeURIComponent:void 0;var TE=Symbol;var Wqe=Array.prototype.forEach,Qz=Array.prototype.indexOf,Jz=Array.prototype.join,Zz=Array.prototype.map,Yz=Array.prototype.filter,Xz=Array.prototype.push,Bqe=Array.prototype.pop,zqe=Array.prototype.splice,e3=Array.prototype.slice,jqe=Array.prototype.sort,$qe=Array.prototype.every;function ple(e){try{return e.indexOf}catch{return}}function lle(e){try{return e.join}catch{return}}function fle(e){try{return e.map}catch{return}}function dle(e){try{return e.filter}catch{return}}function hle(e){try{return e.push}catch{return}}function mle(e){try{return e.slice}catch{return}}function Yu(e,...t){return ple(e)===Qz?e.indexOf(...t):So(Qz,e,t)}function Sn(e,...t){return lle(e)===Jz?e.join(...t):So(Jz,e,t)}function Er(e,t){return fle(e)===Zz?e.map(t):So(Zz,e,[t])}function p3(e,t){return dle(e)===Yz?e.filter(t):So(Yz,e,[t])}function St(e,...t){return hle(e)===Xz?e.push(...t):So(Xz,e,t)}function eo(e,...t){return mle(e)===e3?e.slice(...t):So(e3,e,t)}var t3=Date.prototype.getTime,r3=Date.prototype.toISOString;function xle(e){try{return e.getTime}catch{return}}function gle(e){try{return e.toISOString}catch{return}}function IE(e){return xle(e)===t3?e.getTime():So(t3,e,[])}function l3(e){return gle(e)===r3?e.toISOString():So(r3,e,[])}var Vqe=Set.prototype.add,Gqe=Set.prototype.has;var Kqe=WeakMap.prototype.set,Qqe=WeakMap.prototype.get;var n3=Map.prototype.set,o3=Map.prototype.get;function ble(e){try{return e.set}catch{return}}function yle(e){try{return e.get}catch{return}}function vh(e,t,r){return ble(e)===n3?e.set(t,r):So(n3,e,[t,r])}function Zl(e,t){return yle(e)===o3?e.get(t):So(o3,e,[t])}var s3=String.prototype.split,Jqe=String.prototype.startsWith,Zqe=String.prototype.endsWith,Yqe=String.prototype.substring,Xqe=String.prototype.toLowerCase,eHe=String.prototype.toUpperCase,tHe=String.prototype.padStart,i3=String.prototype.charCodeAt,rHe=String.prototype.normalize,nHe=String.prototype.replace;function Sle(e){try{return e.split}catch{return}}function Ele(e){try{return e.charCodeAt}catch{return}}function Pi(e,...t){return Sle(e)===s3?e.split(...t):So(s3,e,t)}function Yl(e,t){return Ele(e)===i3?e.charCodeAt(t):So(i3,e,[t])}var a3=Number.prototype.toString;function Cle(e){try{return e.toString}catch{return}}function RE(e,...t){return Cle(e)===a3?e.toString(...t):So(a3,e,t)}var wle=Object.prototype.toString;function yR(e){return So(wle,e,[])}var SR=class{constructor(t){this.producer=t}[Symbol.iterator](){return this.it===void 0&&(this.it=this.producer()),this.it}next(){return this.it===void 0&&(this.it=this.producer()),this.it.next()}};function Xu(e){return new SR(e)}var Ole=Math.log;function AE(e){return 2+~~(Ole(e+1)*.4342944819032518)}var _le={};function bc(){return _le}var Xl=Symbol("UndefinedContextPlaceholder");function ef(e){return e.context!==void 0?e:e.hasToBeCloned?new Pe(e.value_,Xl,()=>e.value):new Pe(e.value_,Xl)}var ME=class e{constructor(t,r){this.arb=t,this.predicate=r;let{asyncBeforeEach:n,asyncAfterEach:o,beforeEach:s,afterEach:i}=bc()||{};if(n!==void 0&&s!==void 0)throw vr(`Global "asyncBeforeEach" and "beforeEach" parameters can't be set at the same time when running async properties`);if(o!==void 0&&i!==void 0)throw vr(`Global "asyncAfterEach" and "afterEach" parameters can't be set at the same time when running async properties`);this.beforeEachHook=n||s||e.dummyHook,this.afterEachHook=o||i||e.dummyHook}isAsync(){return!0}generate(t,r){let n=this.arb.generate(t,r!=null?AE(r):void 0);return ef(n)}shrink(t){if(t.context===void 0&&!this.arb.canShrinkWithoutContext(t.value_))return ot.nil();let r=t.context!==Xl?t.context:void 0;return this.arb.shrink(t.value_,r).map(ef)}async runBeforeEach(){await this.beforeEachHook()}async runAfterEach(){await this.afterEachHook()}async run(t,r){r||await this.beforeEachHook();try{let n=await this.predicate(t);return n==null||n===!0?null:{error:new vr("Property failed by returning false"),errorMessage:"Error: Property failed by returning false"}}catch(n){return Ws.isFailure(n)?n:n instanceof vr&&n.stack?{error:n,errorMessage:n.stack}:{error:n,errorMessage:vi(n)}}finally{r||await this.afterEachHook()}}beforeEach(t){let r=this.beforeEachHook;return this.beforeEachHook=()=>t(r),this}afterEach(t){let r=this.afterEachHook;return this.afterEachHook=()=>t(r),this}};ME.dummyHook=()=>{};var Ng=class e{constructor(t,r){this.arb=t,this.predicate=r;let{beforeEach:n=e.dummyHook,afterEach:o=e.dummyHook,asyncBeforeEach:s,asyncAfterEach:i}=bc()||{};if(s!==void 0)throw vr(`"asyncBeforeEach" can't be set when running synchronous properties`);if(i!==void 0)throw vr(`"asyncAfterEach" can't be set when running synchronous properties`);this.beforeEachHook=n,this.afterEachHook=o}isAsync(){return!1}generate(t,r){let n=this.arb.generate(t,r!=null?AE(r):void 0);return ef(n)}shrink(t){if(t.context===void 0&&!this.arb.canShrinkWithoutContext(t.value_))return ot.nil();let r=t.context!==Xl?t.context:void 0;return this.arb.shrink(t.value_,r).map(ef)}runBeforeEach(){this.beforeEachHook()}runAfterEach(){this.afterEachHook()}run(t,r){r||this.beforeEachHook();try{let n=this.predicate(t);return n==null||n===!0?null:{error:new vr("Property failed by returning false"),errorMessage:"Error: Property failed by returning false"}}catch(n){return Ws.isFailure(n)?n:n instanceof vr&&n.stack?{error:n,errorMessage:n.stack}:{error:n,errorMessage:vi(n)}}finally{r||this.afterEachHook()}}beforeEach(t){let r=this.beforeEachHook;return this.beforeEachHook=()=>t(r),this}afterEach(t){let r=this.afterEachHook;return this.afterEachHook=()=>t(r),this}};Ng.dummyHook=()=>{};var IR={};Xn(IR,{__commitHash:()=>Vle,__type:()=>jle,__version:()=>$le,congruential32:()=>h3,generateN:()=>f3,mersenne:()=>x3,skipN:()=>CR,uniformArrayIntDistribution:()=>w3,uniformBigIntDistribution:()=>O3,uniformIntDistribution:()=>k3,unsafeGenerateN:()=>ER,unsafeSkipN:()=>Dg,unsafeUniformArrayIntDistribution:()=>tf,unsafeUniformBigIntDistribution:()=>rf,unsafeUniformIntDistribution:()=>yc,xoroshiro128plus:()=>S3,xorshift128plus:()=>b3});function ER(e,t){for(var r=[],n=0;n!=t;++n)r.push(e.unsafeNext());return r}function f3(e,t){var r=e.clone(),n=ER(r,t);return[n,r]}function Dg(e,t){for(var r=0;r!=t;++r)e.unsafeNext()}function CR(e,t){var r=e.clone();return Dg(r,t),r}var Rle=214013,Ale=2531011,Mle=4294967295,vle=(1<<31)-1,wR=function(e){return e*Rle+Ale&Mle},OR=function(e){return(e&vle)>>16},d3=(function(){function e(t){this.seed=t}return e.prototype.clone=function(){return new e(this.seed)},e.prototype.next=function(){var t=new e(this.seed),r=t.unsafeNext();return[r,t]},e.prototype.unsafeNext=function(){var t=wR(this.seed),r=OR(t),n=wR(t),o=OR(n);this.seed=wR(n);var s=OR(this.seed),i=s+(o+(r<<15)<<15);return i|0},e.prototype.getState=function(){return[this.seed]},e})();function Ple(e){var t=e.length===1;if(!t)throw new Error("The state must have been produced by a congruential32 RandomGenerator");return new d3(e[0])}var h3=Object.assign(function(e){return new d3(e)},{fromState:Ple});var Fle=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,s=[],i;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(a){i={error:a}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(i)throw i.error}}return s},Nle=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,s;n<o;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))},m3=(function(){function e(t,r){this.states=t,this.index=r}return e.twist=function(t){for(var r=t.slice(),n=0;n!==e.N-e.M;++n){var o=(r[n]&e.MASK_UPPER)+(r[n+1]&e.MASK_LOWER);r[n]=r[n+e.M]^o>>>1^-(o&1)&e.A}for(var n=e.N-e.M;n!==e.N-1;++n){var s=(r[n]&e.MASK_UPPER)+(r[n+1]&e.MASK_LOWER);r[n]=r[n+e.M-e.N]^s>>>1^-(s&1)&e.A}var i=(r[e.N-1]&e.MASK_UPPER)+(r[0]&e.MASK_LOWER);return r[e.N-1]=r[e.M-1]^i>>>1^-(i&1)&e.A,r},e.seeded=function(t){var r=Array(e.N);r[0]=t;for(var n=1;n!==e.N;++n){var o=r[n-1]^r[n-1]>>>30;r[n]=Math.imul(e.F,o)+n|0}return r},e.from=function(t){return new e(e.twist(e.seeded(t)),0)},e.prototype.clone=function(){return new e(this.states,this.index)},e.prototype.next=function(){var t=new e(this.states,this.index),r=t.unsafeNext();return[r,t]},e.prototype.unsafeNext=function(){var t=this.states[this.index];return t^=this.states[this.index]>>>e.U,t^=t<<e.S&e.B,t^=t<<e.T&e.C,t^=t>>>e.L,++this.index>=e.N&&(this.states=e.twist(this.states),this.index=0),t},e.prototype.getState=function(){return Nle([this.index],Fle(this.states),!1)},e.fromState=function(t){var r=t.length===e.N+1&&t[0]>=0&&t[0]<e.N;if(!r)throw new Error("The state must have been produced by a mersenne RandomGenerator");return new e(t.slice(1),t[0])},e.N=624,e.M=397,e.R=31,e.A=2567483615,e.F=1812433253,e.U=11,e.S=7,e.B=2636928640,e.T=15,e.C=4022730752,e.L=18,e.MASK_LOWER=Math.pow(2,e.R)-1,e.MASK_UPPER=Math.pow(2,e.R),e})();function Dle(e){return m3.fromState(e)}var x3=Object.assign(function(e){return m3.from(e)},{fromState:Dle});var g3=(function(){function e(t,r,n,o){this.s01=t,this.s00=r,this.s11=n,this.s10=o}return e.prototype.clone=function(){return new e(this.s01,this.s00,this.s11,this.s10)},e.prototype.next=function(){var t=new e(this.s01,this.s00,this.s11,this.s10),r=t.unsafeNext();return[r,t]},e.prototype.unsafeNext=function(){var t=this.s00^this.s00<<23,r=this.s01^(this.s01<<23|this.s00>>>9),n=t^this.s10^(t>>>18|r<<14)^(this.s10>>>5|this.s11<<27),o=r^this.s11^r>>>18^this.s11>>>5,s=this.s00+this.s10|0;return this.s01=this.s11,this.s00=this.s10,this.s11=o,this.s10=n,s},e.prototype.jump=function(){var t=new e(this.s01,this.s00,this.s11,this.s10);return t.unsafeJump(),t},e.prototype.unsafeJump=function(){for(var t=0,r=0,n=0,o=0,s=[1667051007,2321340297,1548169110,304075285],i=0;i!==4;++i)for(var a=1;a;a<<=1)s[i]&a&&(t^=this.s01,r^=this.s00,n^=this.s11,o^=this.s10),this.unsafeNext();this.s01=t,this.s00=r,this.s11=n,this.s10=o},e.prototype.getState=function(){return[this.s01,this.s00,this.s11,this.s10]},e})();function Lle(e){var t=e.length===4;if(!t)throw new Error("The state must have been produced by a xorshift128plus RandomGenerator");return new g3(e[0],e[1],e[2],e[3])}var b3=Object.assign(function(e){return new g3(-1,~e,e|0,0)},{fromState:Lle});var y3=(function(){function e(t,r,n,o){this.s01=t,this.s00=r,this.s11=n,this.s10=o}return e.prototype.clone=function(){return new e(this.s01,this.s00,this.s11,this.s10)},e.prototype.next=function(){var t=new e(this.s01,this.s00,this.s11,this.s10),r=t.unsafeNext();return[r,t]},e.prototype.unsafeNext=function(){var t=this.s00+this.s10|0,r=this.s10^this.s00,n=this.s11^this.s01,o=this.s00,s=this.s01;return this.s00=o<<24^s>>>8^r^r<<16,this.s01=s<<24^o>>>8^n^(n<<16|r>>>16),this.s10=n<<5^r>>>27,this.s11=r<<5^n>>>27,t},e.prototype.jump=function(){var t=new e(this.s01,this.s00,this.s11,this.s10);return t.unsafeJump(),t},e.prototype.unsafeJump=function(){for(var t=0,r=0,n=0,o=0,s=[3639956645,3750757012,1261568508,386426335],i=0;i!==4;++i)for(var a=1;a;a<<=1)s[i]&a&&(t^=this.s01,r^=this.s00,n^=this.s11,o^=this.s10),this.unsafeNext();this.s01=t,this.s00=r,this.s11=n,this.s10=o},e.prototype.getState=function(){return[this.s01,this.s00,this.s11,this.s10]},e})();function Ule(e){var t=e.length===4;if(!t)throw new Error("The state must have been produced by a xoroshiro128plus RandomGenerator");return new y3(e[0],e[1],e[2],e[3])}var S3=Object.assign(function(e){return new y3(-1,~e,e|0,0)},{fromState:Ule});function _R(e,t){if(e.sign!==t.sign)return vE(e,{sign:-t.sign,data:t.data});for(var r=[],n=0,o=e.data,s=t.data,i=o.length-1,a=s.length-1;i>=0||a>=0;--i,--a){var c=i>=0?o[i]:0,l=a>=0?s[a]:0,f=c+l+n;r.push(f>>>0),n=~~(f/4294967296)}return n!==0&&r.push(n),{sign:e.sign,data:r.reverse()}}function E3(e){e.sign=1;for(var t=e.data,r=t.length-1;r>=0;--r)if(t[r]===4294967295)t[r]=0;else return t[r]+=1,e;return t.unshift(1),e}function qle(e,t){for(var r=Math.max(e.length,t.length),n=0;n<r;++n){var o=n+e.length-r,s=n+t.length-r,i=o>=0?e[o]:0,a=s>=0?t[s]:0;if(i<a)return!0;if(i>a)return!1}return!1}function vE(e,t){if(e.sign!==t.sign)return _R(e,{sign:-t.sign,data:t.data});var r=e.data,n=t.data;if(qle(r,n)){var o=vE(t,e);return o.sign=-o.sign,o}for(var s=[],i=0,a=r.length-1,c=n.length-1;a>=0||c>=0;--a,--c){var l=a>=0?r[a]:0,f=c>=0?n[c]:0,d=l-f-i;s.push(d>>>0),i=d<0?1:0}return{sign:e.sign,data:s.reverse()}}function kR(e){for(var t=e.data,r=0;r!==t.length&&t[r]===0;++r);return r===t.length?(e.sign=1,e.data=[0],e):(t.splice(0,r),e)}function PE(e,t){if(t<0){var r=-t;e.sign=-1,e.data[0]=~~(r/4294967296),e.data[1]=r>>>0}else e.sign=1,e.data[0]=~~(t/4294967296),e.data[1]=t>>>0;return e}function C3(e,t,r){var n=t.data[1],o=t.data[0],s=t.sign,i=r.data[1],a=r.data[0],c=r.sign;if(e.sign=1,s===1&&c===-1){var l=n+i,f=o+a+(l>4294967295?1:0);return e.data[0]=f>>>0,e.data[1]=l>>>0,e}var d=n,h=o,m=i,y=a;s===-1&&(d=i,h=a,m=n,y=o);var _=0,C=d-m;return C<0&&(_=1,C=C>>>0),e.data[0]=h-y-_,e.data[1]=C,e}function FE(e,t){for(var r=e>2?~~(4294967296/e)*e:4294967296,n=t.unsafeNext()+2147483648;n>=r;)n=t.unsafeNext()+2147483648;return n%e}function NE(e,t,r){for(var n=t.length;;){for(var o=0;o!==n;++o){var s=o===0?t[0]+1:4294967296,i=FE(s,r);e[o]=i}for(var o=0;o!==n;++o){var a=e[o],c=t[o];if(a<c)return e;if(a>c)break}}}function tf(e,t,r){var n=kR(E3(vE(t,e))),o=n.data.slice(0),s=NE(o,n.data,r);return kR(_R({sign:1,data:s},e))}function w3(e,t,r){if(r!=null){var n=r.clone();return[tf(e,t,n),n]}return function(o){var s=o.clone();return[tf(e,t,s),s]}}var Lg=typeof BigInt<"u"?BigInt:void 0;function rf(e,t,r){for(var n=t-e+Lg(1),o=Lg(-2147483648),s=Lg(4294967296),i=s,a=1;i<n;)i*=s,++a;for(var c=i-i%n;;){for(var l=Lg(0),f=0;f!==a;++f){var d=r.unsafeNext();l=s*l+(Lg(d)-o)}if(l<c){var h=l%n;return h+e}}}function O3(e,t,r){if(r!=null){var n=r.clone();return[rf(e,t,n),n]}return function(o){var s=o.clone();return[rf(e,t,s),s]}}var Hle=Number.MAX_SAFE_INTEGER,Wle={sign:1,data:[0,0]},Ble={sign:1,data:[0,0]},_3={sign:1,data:[0,0]},TR=[0,0];function zle(e,t,r,n){var o=r<=Hle?PE(_3,r):C3(_3,PE(Wle,t),PE(Ble,e));return o.data[1]===4294967295?(o.data[0]+=1,o.data[1]=0):o.data[1]+=1,NE(TR,o.data,n),TR[0]*4294967296+TR[1]+e}function yc(e,t,r){var n=t-e;if(n<=4294967295){var o=FE(n+1,r);return o+e}return zle(e,t,n,r)}function k3(e,t,r){if(r!=null){var n=r.clone();return[yc(e,t,n),n]}return function(o){var s=o.clone();return[yc(e,t,s),s]}}var jle="module",$le="6.1.0",Vle="a413dd2b721516be2ef29adffb515c5ae67bfbad";var Ph=IR;var to;(function(e){e[e.None=0]="None",e[e.Verbose=1]="Verbose",e[e.VeryVerbose=2]="VeryVerbose"})(to||(to={}));var Gle=Date.now,Kle=Math.min,Qle=Math.random,Eo=class e{constructor(t){let r=t||{};this.seed=e.readSeed(r),this.randomType=e.readRandomType(r),this.numRuns=e.readNumRuns(r),this.verbose=e.readVerbose(r),this.maxSkipsPerRun=e.readOrDefault(r,"maxSkipsPerRun",100),this.timeout=e.safeTimeout(e.readOrDefault(r,"timeout",null)),this.skipAllAfterTimeLimit=e.safeTimeout(e.readOrDefault(r,"skipAllAfterTimeLimit",null)),this.interruptAfterTimeLimit=e.safeTimeout(e.readOrDefault(r,"interruptAfterTimeLimit",null)),this.markInterruptAsFailure=e.readBoolean(r,"markInterruptAsFailure"),this.skipEqualValues=e.readBoolean(r,"skipEqualValues"),this.ignoreEqualValues=e.readBoolean(r,"ignoreEqualValues"),this.logger=e.readOrDefault(r,"logger",n=>{console.log(n)}),this.path=e.readOrDefault(r,"path",""),this.unbiased=e.readBoolean(r,"unbiased"),this.examples=e.readOrDefault(r,"examples",[]),this.endOnFailure=e.readBoolean(r,"endOnFailure"),this.reporter=e.readOrDefault(r,"reporter",null),this.asyncReporter=e.readOrDefault(r,"asyncReporter",null),this.errorWithCause=e.readBoolean(r,"errorWithCause")}toParameters(){let t=n=>n!==null?n:void 0;return{seed:this.seed,randomType:this.randomType,numRuns:this.numRuns,maxSkipsPerRun:this.maxSkipsPerRun,timeout:t(this.timeout),skipAllAfterTimeLimit:t(this.skipAllAfterTimeLimit),interruptAfterTimeLimit:t(this.interruptAfterTimeLimit),markInterruptAsFailure:this.markInterruptAsFailure,skipEqualValues:this.skipEqualValues,ignoreEqualValues:this.ignoreEqualValues,path:this.path,logger:this.logger,unbiased:this.unbiased,verbose:this.verbose,examples:this.examples,endOnFailure:this.endOnFailure,reporter:t(this.reporter),asyncReporter:t(this.asyncReporter),errorWithCause:this.errorWithCause}}static read(t){return new e(t)}};Eo.createQualifiedRandomGenerator=e=>t=>{let r=e(t);return r.unsafeJump===void 0&&(r.unsafeJump=()=>Dg(r,42)),r};Eo.readSeed=e=>{if(e.seed==null)return Gle()^Qle()*4294967296;let t=e.seed|0;if(e.seed===t)return t;let r=e.seed-t;return t^r*4294967296};Eo.readRandomType=e=>{if(e.randomType==null)return Ph.xorshift128plus;if(typeof e.randomType=="string")switch(e.randomType){case"mersenne":return Eo.createQualifiedRandomGenerator(Ph.mersenne);case"congruential":case"congruential32":return Eo.createQualifiedRandomGenerator(Ph.congruential32);case"xorshift128plus":return Ph.xorshift128plus;case"xoroshiro128plus":return Ph.xoroshiro128plus;default:throw new Error(`Invalid random specified: '${e.randomType}'`)}let t=e.randomType(0);if("min"in t&&t.min!==-2147483648)throw new Error(`Invalid random number generator: min must equal -0x80000000, got ${String(t.min)}`);if("max"in t&&t.max!==2147483647)throw new Error(`Invalid random number generator: max must equal 0x7fffffff, got ${String(t.max)}`);return"unsafeJump"in t?e.randomType:Eo.createQualifiedRandomGenerator(e.randomType)};Eo.readNumRuns=e=>e.numRuns!=null?e.numRuns:e.num_runs!=null?e.num_runs:100;Eo.readVerbose=e=>e.verbose==null?to.None:typeof e.verbose=="boolean"?e.verbose===!0?to.Verbose:to.None:e.verbose<=to.None?to.None:e.verbose>=to.VeryVerbose?to.VeryVerbose:e.verbose|0;Eo.readBoolean=(e,t)=>e[t]===!0;Eo.readOrDefault=(e,t,r)=>{let n=e[t];return n??r};Eo.safeTimeout=e=>e===null?null:Kle(e,2147483647);var T3=Array.from,I3=typeof Buffer<"u"?Buffer.isBuffer:void 0,Fh=JSON.stringify,R3=Number.isNaN,Jle=Object.keys,Zle=Object.getOwnPropertySymbols,Yle=Object.getOwnPropertyDescriptor,A3=Object.getPrototypeOf,M3=Number.NEGATIVE_INFINITY,Xle=Number.POSITIVE_INFINITY,ep=Symbol.for("fast-check/toStringMethod");function RR(e){return e!==null&&(typeof e=="object"||typeof e=="function")&&ep in e&&typeof e[ep]=="function"}var Nh=Symbol.for("fast-check/asyncToStringMethod");function AR(e){return e!==null&&(typeof e=="object"||typeof e=="function")&&Nh in e&&typeof e[Nh]=="function"}var efe=/^Symbol\((.*)\)$/;function tfe(e){if(e.description!==void 0)return e.description;let t=efe.exec(vi(e));return t&&t[1].length?t[1]:null}function v3(e){switch(e){case 0:return 1/e===M3?"-0":"0";case M3:return"Number.NEGATIVE_INFINITY";case Xle:return"Number.POSITIVE_INFINITY";default:return e===e?vi(e):"Number.NaN"}}function rfe(e){let t=-1;for(let r in e){let n=Number(r);if(n!==t+1)return!0;t=n}return t+1!==e.length}function Bs(e,t,r){let n=[...t,e];if(typeof e=="object"&&Yu(t,e)!==-1)return"[cyclic]";if(AR(e)){let o=r(e);if(o.state==="fulfilled")return o.value}if(RR(e))try{return e[ep]()}catch{}switch(yR(e)){case"[object Array]":{let o=e;if(o.length>=50&&rfe(o)){let i=[];for(let a in o)R3(Number(a))||St(i,`${a}:${Bs(o[a],n,r)}`);return i.length!==0?`Object.assign(Array(${o.length}),{${Sn(i,",")}})`:`Array(${o.length})`}let s=Sn(Er(o,i=>Bs(i,n,r)),",");return o.length===0||o.length-1 in o?`[${s}]`:`[${s},]`}case"[object BigInt]":return`${e}n`;case"[object Boolean]":{let o=e==!0?"true":"false";return typeof e=="boolean"?o:`new Boolean(${o})`}case"[object Date]":{let o=e;return R3(IE(o))?"new Date(NaN)":`new Date(${Fh(l3(o))})`}case"[object Map]":return`new Map(${Bs(Array.from(e),n,r)})`;case"[object Null]":return"null";case"[object Number]":return typeof e=="number"?v3(e):`new Number(${v3(Number(e))})`;case"[object Object]":{try{let a=e.toString;if(typeof a=="function"&&a!==Object.prototype.toString)return e.toString()}catch{return"[object Object]"}let o=a=>`${a==="__proto__"?'["__proto__"]':typeof a=="symbol"?`[${Bs(a,n,r)}]`:Fh(a)}:${Bs(e[a],n,r)}`,s=[...Er(Jle(e),o),...Er(p3(Zle(e),a=>{let c=Yle(e,a);return c&&c.enumerable}),o)],i="{"+Sn(s,",")+"}";return A3(e)===null?i==="{}"?"Object.create(null)":`Object.assign(Object.create(null),${i})`:i}case"[object Set]":return`new Set(${Bs(Array.from(e),n,r)})`;case"[object String]":return typeof e=="string"?Fh(e):`new String(${Fh(e)})`;case"[object Symbol]":{let o=e;if(TE.keyFor(o)!==void 0)return`Symbol.for(${Fh(TE.keyFor(o))})`;let s=tfe(o);if(s===null)return"Symbol()";let i=s.startsWith("Symbol.")&&TE[s.substring(7)];return o===i?s:`Symbol(${Fh(s)})`}case"[object Promise]":{let o=r(e);switch(o.state){case"fulfilled":return`Promise.resolve(${Bs(o.value,n,r)})`;case"rejected":return`Promise.reject(${Bs(o.value,n,r)})`;case"pending":return"new Promise(() => {/*pending*/})";case"unknown":default:return"new Promise(() => {/*unknown*/})"}}case"[object Error]":if(e instanceof Error)return`new Error(${Bs(e.message,n,r)})`;break;case"[object Undefined]":return"undefined";case"[object Int8Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Int16Array]":case"[object Uint16Array]":case"[object Int32Array]":case"[object Uint32Array]":case"[object Float32Array]":case"[object Float64Array]":case"[object BigInt64Array]":case"[object BigUint64Array]":{if(typeof I3=="function"&&I3(e))return`Buffer.from(${Bs(T3(e.values()),n,r)})`;let o=A3(e),s=o&&o.constructor&&o.constructor.name;if(typeof s=="string"){let a=e.values();return`${s}.from(${Bs(T3(a),n,r)})`}break}}try{return e.toString()}catch{return yR(e)}}function hs(e){return Bs(e,[],()=>({state:"unknown",value:void 0}))}var XWe=Date.now;var Sc;(function(e){e[e.Success=0]="Success",e[e.Skipped=-1]="Skipped",e[e.Failure=1]="Failure"})(Sc||(Sc={}));var LE=class e{constructor(t,r){this.verbosity=t,this.interruptedAsFailure=r,this.isSuccess=()=>this.pathToFailure==null,this.firstFailure=()=>this.pathToFailure?+Pi(this.pathToFailure,":")[0]:-1,this.numShrinks=()=>this.pathToFailure?Pi(this.pathToFailure,":").length-1:0,this.rootExecutionTrees=[],this.currentLevelExecutionTrees=this.rootExecutionTrees,this.failure=null,this.numSkips=0,this.numSuccesses=0,this.interrupted=!1}appendExecutionTree(t,r){let n={status:t,value:r,children:[]};return this.currentLevelExecutionTrees.push(n),n}fail(t,r,n){if(this.verbosity>=to.Verbose){let o=this.appendExecutionTree(Sc.Failure,t);this.currentLevelExecutionTrees=o.children}this.pathToFailure==null?this.pathToFailure=`${r}`:this.pathToFailure+=`:${r}`,this.value=t,this.failure=n}skip(t){this.verbosity>=to.VeryVerbose&&this.appendExecutionTree(Sc.Skipped,t),this.pathToFailure==null&&++this.numSkips}success(t){this.verbosity>=to.VeryVerbose&&this.appendExecutionTree(Sc.Success,t),this.pathToFailure==null&&++this.numSuccesses}interrupt(){this.interrupted=!0}extractFailures(){if(this.isSuccess())return[];let t=[],r=this.rootExecutionTrees;for(;r.length>0&&r[r.length-1].status===Sc.Failure;){let n=r[r.length-1];t.push(n.value),r=n.children}return t}toRunDetails(t,r,n,o){if(!this.isSuccess())return{failed:!0,interrupted:this.interrupted,numRuns:this.firstFailure()+1-this.numSkips,numSkips:this.numSkips,numShrinks:this.numShrinks(),seed:t,counterexample:this.value,counterexamplePath:e.mergePaths(r,this.pathToFailure),error:this.failure.errorMessage,errorInstance:this.failure.error,failures:this.extractFailures(),executionSummary:this.rootExecutionTrees,verbose:this.verbosity,runConfiguration:o.toParameters()};let s=this.interruptedAsFailure||this.numSuccesses===0;return{failed:this.numSkips>n||this.interrupted&&s,interrupted:this.interrupted,numRuns:this.numSuccesses,numSkips:this.numSkips,numShrinks:0,seed:t,counterexample:null,counterexamplePath:null,error:null,errorInstance:null,failures:[],executionSummary:this.rootExecutionTrees,verbose:this.verbosity,runConfiguration:o.toParameters()}}};LE.mergePaths=(e,t)=>{if(e.length===0)return t;let r=e.split(":"),n=t.split(":"),o=+r[r.length-1]+ +n[0];return[...r.slice(0,r.length-1),`${o}`,...n.slice(1)].join(":")};var tp=class e{constructor(t){this.internalRng=t.clone()}clone(){return new e(this.internalRng)}next(t){return yc(0,(1<<t)-1,this.internalRng)}nextBoolean(){return yc(0,1,this.internalRng)==1}nextInt(t,r){return yc(t??e.MIN_INT,r??e.MAX_INT,this.internalRng)}nextBigInt(t,r){return rf(t,r,this.internalRng)}nextArrayInt(t,r){return tf(t,r,this.internalRng)}nextDouble(){let t=this.next(26),r=this.next(27);return(t*e.DBL_FACTOR+r)*e.DBL_DIVISOR}getState(){if("getState"in this.internalRng&&typeof this.internalRng.getState=="function")return this.internalRng.getState()}};tp.MIN_INT=-2147483648;tp.MAX_INT=2147483647;tp.DBL_FACTOR=Math.pow(2,27);tp.DBL_DIVISOR=Math.pow(2,-53);var afe=Math.floor,P3=Math.log;function F3(e){return afe(P3(e)/P3(2))}function MR(e,t,r){if(e===t)return[{min:e,max:t}];if(e<0&&t>0){let i=r(-e),a=r(t);return[{min:-i,max:a},{min:t-a,max:t},{min:e,max:e+i}]}let n=r(t-e),o={min:e,max:e+n},s={min:t-n,max:t};return e<0?[s,o]:[o,s]}var cfe=Math.ceil,ufe=Math.floor;function N3(e){return ufe(e/2)}function D3(e){return cfe(e/2)}function vR(e,t,r){let n=e-t;function*o(){let i=r?void 0:t,a=r?n:N3(n);for(let c=a;c>0;c=N3(c)){let l=c===n?t:e-c;yield new Pe(l,i),i=l}}function*s(){let i=r?void 0:t,a=r?n:D3(n);for(let c=a;c<0;c=D3(c)){let l=c===n?t:e-c;yield new Pe(l,i),i=l}}return n>0?Zu(o()):Zu(s())}var L3=Math.sign,pfe=Number.isInteger,lfe=Object.is,rp=class e extends Tt{constructor(t,r){super(),this.min=t,this.max=r}generate(t,r){let n=this.computeGenerateRange(t,r);return new Pe(t.nextInt(n.min,n.max),void 0)}canShrinkWithoutContext(t){return typeof t=="number"&&pfe(t)&&!lfe(t,-0)&&this.min<=t&&t<=this.max}shrink(t,r){if(!e.isValidContext(t,r)){let n=this.defaultTarget();return vR(t,n,!0)}return this.isLastChanceTry(t,r)?ot.of(new Pe(r,void 0)):vR(t,r,!1)}defaultTarget(){return this.min<=0&&this.max>=0?0:this.min<0?this.max:this.min}computeGenerateRange(t,r){if(r===void 0||t.nextInt(1,r)!==1)return{min:this.min,max:this.max};let n=MR(this.min,this.max,F3);if(n.length===1)return n[0];let o=t.nextInt(-2*(n.length-1),n.length-2);return o<0?n[0]:n[o+1]}isLastChanceTry(t,r){return t>0?t===r+1&&t>this.min:t<0?t===r-1&&t<this.max:!1}static isValidContext(t,r){if(r===void 0)return!1;if(typeof r!="number")throw new Error("Invalid context type passed to IntegerArbitrary (#1)");if(r!==0&&L3(t)!==L3(r))throw new Error("Invalid context value passed to IntegerArbitrary (#2)");return!0}};var U3=Number.isInteger;function ffe(e){let t=e.min!==void 0?e.min:-2147483648,r=e.max!==void 0?e.max:2147483647;return{min:t,max:r}}function Pr(e={}){let t=ffe(e);if(t.min>t.max)throw new Error("fc.integer maximum value should be equal or greater than the minimum one");if(!U3(t.min))throw new Error("fc.integer minimum value should be an integer");if(!U3(t.max))throw new Error("fc.integer maximum value should be an integer");return new rp(t.min,t.max)}var q3=new Map;function UE(e){if(e===void 0)return{depth:0};if(typeof e!="string")return e;let t=Zl(q3,e);if(t!==void 0)return t;let r={depth:0};return vh(q3,e,r),r}var qE=class{constructor(t,r,n){this.arb=t,this.mrng=r,this.biasFactor=n}attemptExact(){}next(){return this.arb.generate(this.mrng,this.biasFactor)}};var dfe=Math.min,hfe=Math.max,HE=class{constructor(t,r,n,o){this.arb=t,this.mrng=r,this.slices=n,this.biasFactor=o,this.activeSliceIndex=0,this.nextIndexInSlice=0,this.lastIndexInSlice=-1}attemptExact(t){if(t!==0&&this.mrng.nextInt(1,this.biasFactor)===1){let r=[];for(let n=0;n!==this.slices.length;++n)this.slices[n].length===t&&St(r,n);if(r.length===0)return;this.activeSliceIndex=r[this.mrng.nextInt(0,r.length-1)],this.nextIndexInSlice=0,this.lastIndexInSlice=t-1}}next(){if(this.nextIndexInSlice<=this.lastIndexInSlice)return new Pe(this.slices[this.activeSliceIndex][this.nextIndexInSlice++],void 0);if(this.mrng.nextInt(1,this.biasFactor)!==1)return this.arb.generate(this.mrng,this.biasFactor);this.activeSliceIndex=this.mrng.nextInt(0,this.slices.length-1);let t=this.slices[this.activeSliceIndex];if(this.mrng.nextInt(1,this.biasFactor)!==1)return this.nextIndexInSlice=1,this.lastIndexInSlice=t.length-1,new Pe(t[0],void 0);let r=this.mrng.nextInt(0,t.length-1),n=this.mrng.nextInt(0,t.length-1);return this.nextIndexInSlice=dfe(r,n),this.lastIndexInSlice=hfe(r,n),new Pe(t[this.nextIndexInSlice++],void 0)}};function PR(e,t,r,n){return n===void 0||r.length===0||t.nextInt(1,n)!==1?new qE(e,t,n):new HE(e,t,r,n)}var mfe=Math.floor,H3=Math.log,W3=Math.max,xfe=Array.isArray;function FR(e,t){return e===t?e:e+mfe(H3(t-e)/H3(2))}var Ug=class e extends Tt{constructor(t,r,n,o,s,i,a){super(),this.arb=t,this.minLength=r,this.maxGeneratedLength=n,this.maxLength=o,this.setBuilder=i,this.customSlices=a,this.lengthArb=Pr({min:r,max:n}),this.depthContext=UE(s)}preFilter(t){if(this.setBuilder===void 0)return t;let r=this.setBuilder();for(let n=0;n!==t.length;++n)r.tryAdd(t[n]);return r.getData()}static makeItCloneable(t,r){return t[Sr]=()=>{let n=[];for(let o=0;o!==r.length;++o)St(n,r[o].value);return this.makeItCloneable(n,r),n},t}generateNItemsNoDuplicates(t,r,n,o){let s=0,i=t(),a=PR(this.arb,n,this.customSlices,o);for(;i.size()<r&&s<this.maxGeneratedLength;){let c=a.next();i.tryAdd(c)?s=0:s+=1}return i.getData()}safeGenerateNItemsNoDuplicates(t,r,n,o){let s=W3(0,r-FR(this.minLength,this.maxGeneratedLength));this.depthContext.depth+=s;try{return this.generateNItemsNoDuplicates(t,r,n,o)}finally{this.depthContext.depth-=s}}generateNItems(t,r,n){let o=[],s=PR(this.arb,r,this.customSlices,n);s.attemptExact(t);for(let i=0;i!==t;++i){let a=s.next();St(o,a)}return o}safeGenerateNItems(t,r,n){let o=W3(0,t-FR(this.minLength,this.maxGeneratedLength));this.depthContext.depth+=o;try{return this.generateNItems(t,r,n)}finally{this.depthContext.depth-=o}}wrapper(t,r,n,o){let s=r?this.preFilter(t):t,i=!1,a=[],c=[];for(let f=0;f!==s.length;++f){let d=s[f];i=i||d.hasToBeCloned,St(a,d.value),St(c,d.context)}i&&e.makeItCloneable(a,s);let l={shrunkOnce:r,lengthContext:t.length===s.length&&n!==void 0?n:void 0,itemsContexts:c,startIndex:o};return new Pe(a,l)}generate(t,r){let n=this.applyBias(t,r),o=n.size,s=this.setBuilder!==void 0?this.safeGenerateNItemsNoDuplicates(this.setBuilder,o,t,n.biasFactorItems):this.safeGenerateNItems(o,t,n.biasFactorItems);return this.wrapper(s,!1,void 0,0)}applyBias(t,r){if(r===void 0)return{size:this.lengthArb.generate(t,void 0).value};if(this.minLength===this.maxGeneratedLength)return{size:this.lengthArb.generate(t,void 0).value,biasFactorItems:r};if(t.nextInt(1,r)!==1)return{size:this.lengthArb.generate(t,void 0).value};if(t.nextInt(1,r)!==1||this.minLength===this.maxGeneratedLength)return{size:this.lengthArb.generate(t,void 0).value,biasFactorItems:r};let n=FR(this.minLength,this.maxGeneratedLength);return{size:Pr({min:this.minLength,max:n}).generate(t,void 0).value,biasFactorItems:r}}canShrinkWithoutContext(t){if(!xfe(t)||this.minLength>t.length||t.length>this.maxLength)return!1;for(let n=0;n!==t.length;++n)if(!(n in t)||!this.arb.canShrinkWithoutContext(t[n]))return!1;return this.preFilter(Er(t,n=>new Pe(n,void 0))).length===t.length}shrinkItemByItem(t,r,n){let o=[];for(let s=r.startIndex;s<n;++s)St(o,Xu(()=>this.arb.shrink(t[s],r.itemsContexts[s]).map(i=>{let a=Er(eo(t,0,s),(l,f)=>new Pe(Jl(l),r.itemsContexts[f])),c=Er(eo(t,s+1),(l,f)=>new Pe(Jl(l),r.itemsContexts[f+s+1]));return[[...a,i,...c],void 0,s]})));return ot.nil().join(...o)}shrinkImpl(t,r){if(t.length===0)return ot.nil();let n=r!==void 0?r:{shrunkOnce:!1,lengthContext:void 0,itemsContexts:[],startIndex:0};return this.lengthArb.shrink(t.length,n.lengthContext).drop(n.shrunkOnce&&n.lengthContext===void 0&&t.length>this.minLength+1?1:0).map(o=>{let s=t.length-o.value;return[Er(eo(t,s),(i,a)=>new Pe(Jl(i),n.itemsContexts[a+s])),o.context,0]}).join(Xu(()=>t.length>this.minLength?this.shrinkItemByItem(t,n,1):this.shrinkItemByItem(t,n,t.length))).join(t.length>this.minLength?Xu(()=>{let o={shrunkOnce:!1,lengthContext:void 0,itemsContexts:eo(n.itemsContexts,1),startIndex:0};return this.shrinkImpl(eo(t,1),o).filter(s=>this.minLength<=s[0].length+1).map(s=>[[new Pe(Jl(t[0]),n.itemsContexts[0]),...s[0]],void 0,0])}):ot.nil())}shrink(t,r){return this.shrinkImpl(t,r).map(n=>this.wrapper(n[0],!0,n[1],n[2]))}};var gfe=Math.floor,bfe=Math.min,np=2147483647,Dh=["xsmall","small","medium","large","xlarge"],yfe=["-4","-3","-2","-1","=","+1","+2","+3","+4"],Sfe="small";function Efe(e,t){switch(t){case"xsmall":return gfe(1.1*e)+1;case"small":return 2*e+10;case"medium":return 11*e+100;case"large":return 101*e+1e3;case"xlarge":return 1001*e+1e4;default:throw new Error(`Unable to compute lengths based on received size: ${t}`)}}function NR(e,t){let r=Yu(yfe,e);if(r===-1)return e;let n=Yu(Dh,t);if(n===-1)throw new Error(`Unable to offset size based on the unknown defaulted one: ${t}`);let o=n+r-4;return o<0?Dh[0]:o>=Dh.length?Dh[Dh.length-1]:Dh[o]}function qg(e,t,r,n){let{baseSize:o=Sfe,defaultSizeToMaxWhenMaxSpecified:s}=bc()||{},i=e!==void 0?e:n&&s?"max":o;if(i==="max")return r;let a=NR(i,o);return bfe(Efe(t,a),r)}function qr(e,t={}){let r=t.size,n=t.minLength||0,o=t.maxLength,s=t.depthIdentifier,i=o!==void 0?o:np,c=qg(r,n,i,o!==void 0),l=t.experimentalCustomSlices||[];return new Ug(e,n,c,i,s,void 0,l)}var B3=String.fromCodePoint;function z3(e){if(typeof e!="string")throw new Error("Cannot unmap non-string");if(e.length===0||e.length>2)throw new Error("Cannot unmap string with more or less than one character");let t=Yl(e,0);if(e.length===1)return t;let r=Yl(e,1);if(t<55296||t>56319||r<56320||r>57343)throw new Error("Cannot unmap invalid surrogate pairs");return e.codePointAt(0)}function Ec(e,t,r,n){return Pr({min:e,max:t}).map(o=>B3(r(o)),o=>n(z3(o)))}function Hg(e){return e<95?e+32:e<=126?e-95:e}function Wg(e){return e>=32&&e<=126?e-32:e>=0&&e<=31?e+95:e}function j3(e){return e}function UR(){return Ec(32,126,j3,j3)}var qR=2048;function Ofe(e){return e<55296?Hg(e):e+qR}function _fe(e){return e<55296?Wg(e):e<=57343?-1:e-qR}function BE(){return Ec(0,1114111-qR,Ofe,_fe)}var $3=class e{constructor(){this.receivedLogs=[]}log(t){this.receivedLogs.push(t)}size(){return this.receivedLogs.length}toString(){return JSON.stringify({logs:this.receivedLogs})}[Sr](){return new e}};var g6e=Number.NaN,b6e=Number.isNaN;var T6e=Number.isNaN;var W6e=Number.isNaN;var Eje=Number.POSITIVE_INFINITY,Cje=Number.MAX_SAFE_INTEGER,wje=Number.isInteger;var Mje=Number.isInteger;var $je=String.fromCharCode;function Rfe(e){let t=u3(e);return e!==t?t:`%${RE(Yl(e,0),16)}`}function Afe(e){if(typeof e!="string")throw new Error("Unsupported");return decodeURIComponent(e)}var Vje=BE().map(Rfe,Afe);var h4e=String.fromCodePoint;var q4e=Symbol("adapted-value");var S5e=Number.NEGATIVE_INFINITY,E5e=Number.POSITIVE_INFINITY,C5e=Number.EPSILON;var Y3=new Float64Array(1),w5e=new Uint32Array(Y3.buffer,Y3.byteOffset);var _5e=Number.isInteger;var k5e=Number.NEGATIVE_INFINITY,T5e=Number.POSITIVE_INFINITY;var A5e=Number.NEGATIVE_INFINITY,M5e=Number.POSITIVE_INFINITY,v5e=Number.MAX_VALUE;var j5e=Number.isInteger,$5e=Number.isNaN,V5e=Number.NEGATIVE_INFINITY,G5e=Number.POSITIVE_INFINITY,K5e=Number.MAX_VALUE,Q5e=Number.NaN;var Z5e=Number.NEGATIVE_INFINITY,Y5e=Number.POSITIVE_INFINITY,X5e=2**-126*2**-23,e6=2**127*(1+(2**23-1)/2**23),e$e=2**-23;var X3=new Float32Array(1),t$e=new Uint32Array(X3.buffer,X3.byteOffset);var s$e=Number.NEGATIVE_INFINITY,i$e=Number.POSITIVE_INFINITY;var x$e=Number.isInteger,g$e=Number.isNaN;var b$e=Number.NEGATIVE_INFINITY,y$e=Number.POSITIVE_INFINITY,S$e=Number.NaN;function t6(e){return e.replace(/([$`\\])/g,"\\$1").replace(/\r/g,"\\r")}var J$e=Number.MIN_SAFE_INTEGER,Z$e=Number.MAX_SAFE_INTEGER;var e8e=Number.MAX_SAFE_INTEGER;var n8e=Number.parseInt;var j9e=c3.isArray;var M7e=Symbol("no-key");var _de={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F",16:"G",17:"H",18:"J",19:"K",20:"M",21:"N",22:"P",23:"Q",24:"R",25:"S",26:"T",27:"V",28:"W",29:"X",30:"Y",31:"Z"};function kde(e){return e<10?vi(e):_de[e]}function u6(e,t){let r="";for(;e.length+r.length<t;)r+="0";return r+e}function p6(e){let t="";for(let r=e;r!==0;){let n=r>>5,o=r-(n<<5);t=kde(o)+t,r=n}return t}function Tde(e,t){let r=~~(e/1073741824),n=e&1073741823;return u6(p6(r),t-6)+u6(p6(n),6)}function zR(e){return function(r){return Tde(r,e)}}var BKe=zR(10),zKe=zR(8);var jR=class e{constructor(t,r){this.commands=t,this.metadataForReplay=r}[Symbol.iterator](){return this.commands[Symbol.iterator]()}[Sr](){return new e(this.commands.map(t=>t.clone()),this.metadataForReplay)}toString(){let t=this.commands.filter(n=>n.hasRan).map(n=>n.toString()).join(","),r=this.metadataForReplay();return r.length!==0?`${t} /*${r}*/`:t}};var KE=e=>e(),QE=class e{constructor(t,r){this.act=t,this.taskSelector=r,this.lastTaskId=0,this.sourceTaskSelector=r.clone(),this.scheduledTasks=[],this.triggeredTasks=[],this.scheduledWatchers=[]}static buildLog(t){return`[task\${${t.taskId}}] ${t.label.length!==0?`${t.schedulingType}::${t.label}`:t.schedulingType} ${t.status}${t.outputValue!==void 0?` with value ${t6(t.outputValue)}`:""}`}log(t,r,n,o,s,i){this.triggeredTasks.push({status:s,schedulingType:t,taskId:r,label:n,metadata:o,outputValue:i!==void 0?hs(i):void 0})}scheduleInternal(t,r,n,o,s,i){let a=null,c=++this.lastTaskId,l=new Promise((f,d)=>{a=()=>{(i?n.then(()=>i()):n).then(h=>(this.log(t,c,r,o,"resolved",h),f(h)),h=>(this.log(t,c,r,o,"rejected",h),d(h)))}});return this.scheduledTasks.push({original:n,scheduled:l,trigger:a,schedulingType:t,taskId:c,label:r,metadata:o,customAct:s}),this.scheduledWatchers.length!==0&&this.scheduledWatchers[0](),l}schedule(t,r,n,o){return this.scheduleInternal("promise",r||"",t,n,o||KE)}scheduleFunction(t,r){return(...n)=>this.scheduleInternal("function",`${t.name}(${n.map(hs).join(",")})`,t(...n),void 0,r||KE)}scheduleSequence(t,r){let n={done:!1,faulty:!1},o={then:a=>a()},s=()=>{},i=new Promise(a=>s=a);return t.reduce((a,c)=>{let[l,f,d]=typeof c=="function"?[c,c.name,void 0]:[c.builder,c.label,c.metadata];return a.then(()=>{let h=this.scheduleInternal("sequence",f,o,d,r||KE,()=>l());return h.catch(()=>{n.faulty=!0,s()}),h})},o).then(()=>{n.done=!0,s()},()=>{}),Object.assign(n,{task:Promise.resolve(i).then(()=>({done:n.done,faulty:n.faulty}))})}count(){return this.scheduledTasks.length}internalWaitOne(){if(this.scheduledTasks.length===0)throw new Error("No task scheduled");let t=this.taskSelector.nextTaskIndex(this.scheduledTasks),[r]=this.scheduledTasks.splice(t,1);return r.customAct(async()=>{r.trigger();try{await r.scheduled}catch{}})}async waitOne(t){let r=t||KE;await this.act(()=>r(async()=>await this.internalWaitOne()))}async waitAll(t){for(;this.scheduledTasks.length>0;)await this.waitOne(t)}async waitFor(t,r){let n=!1,o=null,s=async()=>{for(;!n&&this.scheduledTasks.length>0;)await this.waitOne(r);o=null},i=()=>{o===null&&(o=Promise.resolve().then(s))},a=()=>{let l=this.scheduledWatchers.indexOf(i);l!==-1&&this.scheduledWatchers.splice(l,1),l===0&&this.scheduledWatchers.length!==0&&this.scheduledWatchers[0]()},c=t.then(l=>(n=!0,o===null?(a(),l):o.then(()=>(a(),l))),l=>{if(n=!0,o===null)throw a(),l;return o.then(()=>{throw a(),l})});return this.scheduledTasks.length>0&&this.scheduledWatchers.length===0&&i(),this.scheduledWatchers.push(i),c}report(){return[...this.triggeredTasks,...this.scheduledTasks.map(t=>({status:"pending",schedulingType:t.schedulingType,taskId:t.taskId,label:t.label,metadata:t.metadata}))]}toString(){return"schedulerFor()`\n"+this.report().map(e.buildLog).map(t=>`-> ${t}`).join(`
`)+"`"}[Sr](){return new e(this.act,this.sourceTaskSelector)}};var $R;(function(e){e[e.Full=0]="Full",e[e.Character=1]="Character"})($R||($R={}));var dZe=String.fromCodePoint;var IZe=String.fromCodePoint,RZe=[..."abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_"],AZe=[..."0123456789"],MZe=[...` 	\r
\v\f`],Hde=[...`\r
`],Wde=[...""],vZe=[...Hde,...Wde],PZe=UR();var VR=(e,t)=>{switch(t._tag){case"StringKeyword":case"TemplateLiteral":return Object.keys(e);case"SymbolKeyword":return Object.getOwnPropertySymbols(e);case"Refinement":return VR(e,t.from)}},Uh=e=>{let t=!1,r;return()=>(t||(r=e(),t=!0),r)},JE=e=>Array.isArray(e),d6=e=>!Array.isArray(e),f6=e=>`[${$u(e)}]`,ZE=e=>JE(e)?e.map(f6).join(""):f6(e);var Fi=(e,t,r,n)=>{let o=e;return r&&ut(r)&&(o+=`
at path: ${ZE(r)}`),t!==void 0&&(o+=`
details: ${t}`),n&&(o+=`
schema (${n._tag}): ${n}`),o},XE=e=>Fi("Invalid Argument",e),GR=(e,t,r)=>Fi("Unsupported schema",e,t,r);var h6=(e,t)=>GR("Cannot build an Equivalence",t,e);var KR=(e,t,r)=>Fi("Unsupported schema or overlapping types",`cannot extend ${e} with ${t}`,r),m6=e=>Fi("Unsupported template literal span",void 0,void 0,e),Cc=e=>GR(void 0,void 0,e),x6=e=>Fi("Unsupported key schema",void 0,void 0,e),g6=e=>Fi("Unsupported literal",`literal value: ${Ho(e)}`),QR=e=>Fi("Duplicate index signature",`${e} index signature`),b6=Fi("Unsupported index signature parameter","An index signature parameter type must be `string`, `symbol`, a template literal type or a refinement of the previous types"),y6=Fi("Invalid element","A required element cannot follow an optional element. ts(1257)"),JR=e=>Fi("Duplicate property signature transformation",`Duplicate key ${Ho(e)}`),S6=e=>GR(void 0,void 0,e),eC=e=>Fi("Duplicate property signature",`Duplicate key ${Ho(e)}`);var C6=Symbol.for("effect/SchemaId/DateFromSelf"),w6=Symbol.for("effect/SchemaId/GreaterThan"),O6=Symbol.for("effect/SchemaId/GreaterThanOrEqualTo"),_6=Symbol.for("effect/SchemaId/LessThan"),k6=Symbol.for("effect/SchemaId/LessThanOrEqualTo"),T6=Symbol.for("effect/SchemaId/Int"),I6=Symbol.for("effect/SchemaId/NonNaN"),R6=Symbol.for("effect/SchemaId/Finite"),A6=Symbol.for("effect/SchemaId/JsonNumber"),M6=Symbol.for("effect/SchemaId/Between"),v6=Symbol.for("effect/SchemaId/GreaterThanBigint"),P6=Symbol.for("effect/SchemaId/GreaterThanOrEqualToBigint"),F6=Symbol.for("effect/SchemaId/LessThanBigint"),N6=Symbol.for("effect/SchemaId/LessThanOrEqualToBigint"),D6=Symbol.for("effect/SchemaId/BetweenBigint"),L6=Symbol.for("effect/SchemaId/MinLength"),U6=Symbol.for("effect/SchemaId/MaxLength"),q6=Symbol.for("effect/SchemaId/Length"),H6=Symbol.for("effect/SchemaId/MinItems"),W6=Symbol.for("effect/SchemaId/MaxItems"),B6=Symbol.for("effect/SchemaId/ItemsCount");var Ni=yE;var z6=Gu(Ni);var j6=u(2,(e,t)=>{let r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,o=r>n?r:n,s=parseInt(e.toFixed(o).replace(".","")),i=parseInt(t.toFixed(o).replace(".",""));return s%i/Math.pow(10,o)}),$6=e=>{let t=Math.ceil(Math.log(e)/Math.log(2));return Math.max(Math.pow(2,t),2)},V6=e=>{if(e==="NaN")return An(NaN);if(e==="Infinity")return An(1/0);if(e==="-Infinity")return An(-1/0);if(e.trim()==="")return Ii;let t=Number(e);return Number.isNaN(t)?Ii:An(t)};var Hh=e=>e.replace(/[/\\^$*+?.()|[\]{}]/g,"\\$&");var fA=Symbol.for("effect/annotation/Brand"),K6=Symbol.for("effect/annotation/SchemaId"),dA=Symbol.for("effect/annotation/Message"),nC=Symbol.for("effect/annotation/MissingMessage"),Gg=Symbol.for("effect/annotation/Identifier"),Bo=Symbol.for("effect/annotation/Title"),cp=Symbol.for("effect/annotation/AutoTitle"),Ic=Symbol.for("effect/annotation/Description"),hA=Symbol.for("effect/annotation/Examples"),mA=Symbol.for("effect/annotation/Default"),xA=Symbol.for("effect/annotation/JSONSchema"),gA=Symbol.for("effect/annotation/Arbitrary"),bA=Symbol.for("effect/annotation/Pretty"),oC=Symbol.for("effect/annotation/Equivalence"),Q6=Symbol.for("effect/annotation/Documentation"),yA=Symbol.for("effect/annotation/Concurrency"),SA=Symbol.for("effect/annotation/Batching"),EA=Symbol.for("effect/annotation/ParseIssueTitle"),CA=Symbol.for("effect/annotation/ParseOptions"),wA=Symbol.for("effect/annotation/DecodingFallback"),Kg=Symbol.for("effect/annotation/Surrogate"),Qg=Symbol.for("effect/annotation/StableFilter"),vn=u(2,(e,t)=>Object.prototype.hasOwnProperty.call(e.annotations,t)?x(e.annotations[t]):g()),OA=vn(fA);var J6=vn(dA),Z6=vn(nC),_A=vn(Bo),kA=vn(cp),Jg=vn(Gg),TA=vn(Ic);var Y6=vn(yA),X6=vn(SA),ej=vn(EA),tj=vn(CA),rj=vn(wA),up=vn(Kg),zde=vn(Qg),IA=e=>Z1(zde(e),t=>t===!0),sC=Symbol.for("effect/annotation/JSONIdentifier"),jde=vn(sC),$de=e=>yo(jde(e),()=>Jg(e)),nj=Symbol.for("effect/schema/ParseJson"),uf=class{typeParameters;decodeUnknown;encodeUnknown;annotations;_tag="Declaration";constructor(t,r,n,o={}){this.typeParameters=t,this.decodeUnknown=r,this.encodeUnknown=n,this.annotations=o}toString(){return _e($s(this),()=>"<declaration schema>")}toJSON(){return{_tag:this._tag,typeParameters:this.typeParameters.map(t=>t.toJSON()),annotations:ur(this.annotations)}}},ms=e=>t=>t._tag===e;var Ui=class{literal;annotations;_tag="Literal";constructor(t,r={}){this.literal=t,this.annotations=r}toString(){return _e($s(this),()=>Ho(this.literal))}toJSON(){return{_tag:this._tag,literal:Bu(this.literal)?String(this.literal):this.literal,annotations:ur(this.annotations)}}},Ma=ms("Literal"),oj=new Ui(null);var pf=class{symbol;annotations;_tag="UniqueSymbol";constructor(t,r={}){this.symbol=t,this.annotations=r}toString(){return _e($s(this),()=>Ho(this.symbol))}toJSON(){return{_tag:this._tag,symbol:String(this.symbol),annotations:ur(this.annotations)}}},Vde=ms("UniqueSymbol"),XR=class{annotations;_tag="UndefinedKeyword";constructor(t={}){this.annotations=t}toString(){return qi(this)}toJSON(){return{_tag:this._tag,annotations:ur(this.annotations)}}},lf=new XR({[Bo]:"undefined"});var eA=class{annotations;_tag="VoidKeyword";constructor(t={}){this.annotations=t}toString(){return qi(this)}toJSON(){return{_tag:this._tag,annotations:ur(this.annotations)}}},sj=new eA({[Bo]:"void"});var tA=class{annotations;_tag="NeverKeyword";constructor(t={}){this.annotations=t}toString(){return qi(this)}toJSON(){return{_tag:this._tag,annotations:ur(this.annotations)}}},Zg=new tA({[Bo]:"never"}),Gde=ms("NeverKeyword"),rA=class{annotations;_tag="UnknownKeyword";constructor(t={}){this.annotations=t}toString(){return qi(this)}toJSON(){return{_tag:this._tag,annotations:ur(this.annotations)}}},RA=new rA({[Bo]:"unknown"});var nA=class{annotations;_tag="AnyKeyword";constructor(t={}){this.annotations=t}toString(){return qi(this)}toJSON(){return{_tag:this._tag,annotations:ur(this.annotations)}}},AA=new nA({[Bo]:"any"});var oA=class{annotations;_tag="StringKeyword";constructor(t={}){this.annotations=t}toString(){return qi(this)}toJSON(){return{_tag:this._tag,annotations:ur(this.annotations)}}},iC=new oA({[Bo]:"string",[Ic]:"a string"}),Yg=ms("StringKeyword"),sA=class{annotations;_tag="NumberKeyword";constructor(t={}){this.annotations=t}toString(){return qi(this)}toJSON(){return{_tag:this._tag,annotations:ur(this.annotations)}}},aC=new sA({[Bo]:"number",[Ic]:"a number"}),MA=ms("NumberKeyword"),iA=class{annotations;_tag="BooleanKeyword";constructor(t={}){this.annotations=t}toString(){return qi(this)}toJSON(){return{_tag:this._tag,annotations:ur(this.annotations)}}},cC=new iA({[Bo]:"boolean",[Ic]:"a boolean"}),vA=ms("BooleanKeyword"),aA=class{annotations;_tag="BigIntKeyword";constructor(t={}){this.annotations=t}toString(){return qi(this)}toJSON(){return{_tag:this._tag,annotations:ur(this.annotations)}}},ij=new aA({[Bo]:"bigint",[Ic]:"a bigint"});var cA=class{annotations;_tag="SymbolKeyword";constructor(t={}){this.annotations=t}toString(){return qi(this)}toJSON(){return{_tag:this._tag,annotations:ur(this.annotations)}}},aj=new cA({[Bo]:"symbol",[Ic]:"a symbol"}),uC=ms("SymbolKeyword"),uA=class{annotations;_tag="ObjectKeyword";constructor(t={}){this.annotations=t}toString(){return qi(this)}toJSON(){return{_tag:this._tag,annotations:ur(this.annotations)}}},cj=new uA({[Bo]:"object",[Ic]:"an object in the TypeScript meaning, i.e. the `object` type"});var rC=class{enums;annotations;_tag="Enums";constructor(t,r={}){this.enums=t,this.annotations=r}toString(){return _e($s(this),()=>`<enum ${this.enums.length} value(s): ${this.enums.map(([t,r])=>JSON.stringify(r)).join(" | ")}>`)}toJSON(){return{_tag:this._tag,enums:this.enums,annotations:ur(this.annotations)}}},Kde=ms("Enums"),uj=e=>{switch(e._tag){case"Literal":case"NumberKeyword":case"StringKeyword":case"TemplateLiteral":return!0;case"Union":return e.types.every(uj)}return!1},pj=e=>{switch(e._tag){case"Literal":return JSON.stringify(String(e.literal));case"StringKeyword":return"string";case"NumberKeyword":return"number";case"TemplateLiteral":return String(e);case"Union":return e.types.map(pj).join(" | ")}},Qde=e=>{switch(e._tag){case"Literal":return String(e.literal);case"StringKeyword":return"${string}";case"NumberKeyword":return"${number}";case"TemplateLiteral":return"${"+String(e)+"}";case"Union":return"${"+e.types.map(pj).join(" | ")+"}"}},ip=class{literal;type;constructor(t,r){if(this.literal=r,uj(t))this.type=t;else throw new Error(m6(t))}toString(){return Qde(this.type)+this.literal}toJSON(){return{type:this.type.toJSON(),literal:this.literal}}},$g=class{head;spans;annotations;_tag="TemplateLiteral";constructor(t,r,n={}){this.head=t,this.spans=r,this.annotations=n}toString(){return _e($s(this),()=>Jde(this))}toJSON(){return{_tag:this._tag,head:this.head,spans:this.spans.map(t=>t.toJSON()),annotations:ur(this.annotations)}}},Jde=e=>"`"+e.head+e.spans.map(String).join("")+"`",lj=ms("TemplateLiteral"),ap=class{type;annotations;constructor(t,r={}){this.type=t,this.annotations=r}toJSON(){return{type:this.type.toJSON(),annotations:ur(this.annotations)}}toString(){return String(this.type)}},wo=class extends ap{isOptional;constructor(t,r,n={}){super(t,n),this.isOptional=r}toJSON(){return{type:this.type.toJSON(),isOptional:this.isOptional,annotations:ur(this.annotations)}}toString(){return String(this.type)+(this.isOptional?"?":"")}},pC=e=>e.map(t=>t.type),wc=class{elements;rest;isReadonly;annotations;_tag="TupleType";constructor(t,r,n,o={}){this.elements=t,this.rest=r,this.isReadonly=n,this.annotations=o;let s=!1,i=!1;for(let a of t)if(a.isOptional)s=!0;else if(s){i=!0;break}if(i||s&&r.length>1)throw new Error(y6)}toString(){return _e($s(this),()=>Zde(this))}toJSON(){return{_tag:this._tag,elements:this.elements.map(t=>t.toJSON()),rest:this.rest.map(t=>t.toJSON()),isReadonly:this.isReadonly,annotations:ur(this.annotations)}}},Zde=e=>{let t=e.elements.map(String).join(", ");return kz(e.rest,{onEmpty:()=>`readonly [${t}]`,onNonEmpty:(r,n)=>{let o=String(r),s=o.includes(" | ")?`(${o})`:o;if(n.length>0){let i=n.map(String).join(", ");return e.elements.length>0?`readonly [${t}, ...${s}[], ${i}]`:`readonly [...${s}[], ${i}]`}else return e.elements.length>0?`readonly [${t}, ...${s}[]]`:`ReadonlyArray<${o}>`}})};var It=class extends wo{name;isReadonly;constructor(t,r,n,o,s){super(r,n,s),this.name=t,this.isReadonly=o}toString(){return(this.isReadonly?"readonly ":"")+String(this.name)+(this.isOptional?"?":"")+": "+this.type}toJSON(){return{name:String(this.name),type:this.type.toJSON(),isOptional:this.isOptional,isReadonly:this.isReadonly,annotations:ur(this.annotations)}}},fj=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return!0;case"Refinement":return fj(e.from)}return!1},Oc=class{type;isReadonly;parameter;constructor(t,r,n){if(this.type=r,this.isReadonly=n,fj(t))this.parameter=t;else throw new Error(b6)}toString(){return(this.isReadonly?"readonly ":"")+`[x: ${this.parameter}]: ${this.type}`}toJSON(){return{parameter:this.parameter.toJSON(),type:this.type.toJSON(),isReadonly:this.isReadonly}}},nn=class{annotations;_tag="TypeLiteral";propertySignatures;indexSignatures;constructor(t,r,n={}){this.annotations=n;let o={};for(let i=0;i<t.length;i++){let a=t[i].name;if(Object.prototype.hasOwnProperty.call(o,a))throw new Error(eC(a));o[a]=null}let s={string:!1,symbol:!1};for(let i=0;i<r.length;i++){let a=Tc(r[i].parameter);if(Yg(a)){if(s.string)throw new Error(QR("string"));s.string=!0}else if(uC(a)){if(s.symbol)throw new Error(QR("symbol"));s.symbol=!0}}this.propertySignatures=t,this.indexSignatures=r}toString(){return _e($s(this),()=>Yde(this))}toJSON(){return{_tag:this._tag,propertySignatures:this.propertySignatures.map(t=>t.toJSON()),indexSignatures:this.indexSignatures.map(t=>t.toJSON()),annotations:ur(this.annotations)}}},G6=e=>e.map(String).join("; "),Yde=e=>{if(e.propertySignatures.length>0){let t=e.propertySignatures.map(String).join("; ");return e.indexSignatures.length>0?`{ ${t}; ${G6(e.indexSignatures)} }`:`{ ${t} }`}else return e.indexSignatures.length>0?`{ ${G6(e.indexSignatures)} }`:"{}"},PA=ms("TypeLiteral"),Xde=dc(_h(Ni,e=>{switch(e._tag){case"AnyKeyword":return 0;case"UnknownKeyword":return 1;case"ObjectKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3}return 4})),ehe={string:"StringKeyword",number:"NumberKeyword",boolean:"BooleanKeyword",bigint:"BigIntKeyword"},dj=e=>Ql(e,t=>Xg(t)?dj(t.types):[t]),the=e=>{let t=Xde(e),r=[],n={},o=[];for(let s of t)switch(s._tag){case"NeverKeyword":break;case"AnyKeyword":return[AA];case"UnknownKeyword":return[RA];case"ObjectKeyword":case"UndefinedKeyword":case"VoidKeyword":case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":{n[s._tag]||(n[s._tag]=s,r.push(s));break}case"Literal":{let i=typeof s.literal;switch(i){case"string":case"number":case"bigint":case"boolean":{let a=ehe[i];!n[a]&&!o.includes(s.literal)&&(o.push(s.literal),r.push(s));break}case"object":{o.includes(s.literal)||(o.push(s.literal),r.push(s));break}}break}case"UniqueSymbol":{!n.SymbolKeyword&&!o.includes(s.symbol)&&(o.push(s.symbol),r.push(s));break}case"TupleType":{n.ObjectKeyword||r.push(s);break}case"TypeLiteral":{s.propertySignatures.length===0&&s.indexSignatures.length===0?n["{}"]||(n["{}"]=s,r.push(s)):n.ObjectKeyword||r.push(s);break}default:r.push(s)}return r},Qt=class e{types;annotations;static make=(t,r)=>lC(t)?new e(t,r):t.length===1?t[0]:Zg;static unify=(t,r)=>e.make(the(dj(t)),r);_tag="Union";constructor(t,r={}){this.types=t,this.annotations=r}toString(){return _e($s(this),()=>this.types.map(String).join(" | "))}toJSON(){return{_tag:this._tag,types:this.types.map(t=>t.toJSON()),annotations:ur(this.annotations)}}},hj=(e,t)=>e.map(t),lC=e=>e.length>1,Xg=ms("Union"),YR=ne(Symbol.for("effect/Schema/AST/toJSONMemoMap"),()=>new WeakMap),js=class{f;annotations;_tag="Suspend";constructor(t,r={}){this.f=t,this.annotations=r,this.f=Uh(t)}toString(){return $s(this).pipe(yo(()=>kr(Vl(this.f)(),t=>$s(t))),_e(()=>"<suspended schema>"))}toJSON(){let t=this.f(),r=YR.get(t);return r||(YR.set(t,{_tag:this._tag}),r={_tag:this._tag,ast:t.toJSON(),annotations:ur(this.annotations)},YR.set(t,r),r)}};var _c=class{from;filter;annotations;_tag="Refinement";constructor(t,r,n={}){this.from=t,this.filter=r,this.annotations=n}toString(){return Jg(this).pipe(_e(()=>$(Oj(this),{onNone:()=>`{ ${this.from} | filter }`,onSome:t=>pp(this.from)?String(this.from)+" & "+t:t})))}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),annotations:ur(this.annotations)}}},pp=ms("Refinement"),fC={},En=class{from;to;transformation;annotations;_tag="Transformation";constructor(t,r,n,o={}){this.from=t,this.to=r,this.transformation=n,this.annotations=o}toString(){return _e($s(this),()=>`(${String(this.from)} <-> ${String(this.to)})`)}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),to:this.to.toJSON(),annotations:ur(this.annotations)}}},mj=ms("Transformation"),Vg=class{decode;encode;_tag="FinalTransformation";constructor(t,r){this.decode=t,this.encode=r}},rhe=e=>t=>t._tag===e;var pA=class{_tag="ComposeTransformation"},dC=new pA;var zh=class{from;to;decode;encode;constructor(t,r,n,o){this.from=t,this.to=r,this.decode=n,this.encode=o}},xj=e=>e.decode===R&&e.encode===R,kc=class{propertySignatureTransformations;_tag="TypeLiteralTransformation";constructor(t){this.propertySignatureTransformations=t;let r={},n={};for(let o of t){let s=o.from;if(r[s])throw new Error(JR(s));r[s]=!0;let i=o.to;if(n[i])throw new Error(JR(i));n[i]=!0}}},eb=rhe("TypeLiteralTransformation"),tb=(e,t)=>{let r=Object.getOwnPropertyDescriptors(e),n={...e.annotations};delete n[Gg];let o={...n,...t},s=up(e);return X(s)&&(o[Kg]=tb(s.value,t)),r.annotations.value=o,Object.create(Object.getPrototypeOf(e),r)},gj=e=>Qt.unify(Wh(e)),nhe="[\\s\\S]*?",ohe="[+-]?\\d*\\.?\\d+(?:[Ee][+-]?\\d+)?",bj=(e,t)=>{switch(e._tag){case"Literal":return Hh(String(e.literal));case"StringKeyword":return nhe;case"NumberKeyword":return ohe;case"TemplateLiteral":return FA(e,t,!1);case"Union":return e.types.map(r=>bj(r,t)).join("|")}},she=(e,t,r,n)=>{if(Xg(e)){if(r&&!n)return`(?:${t})`}else if(!r||!n)return t;return`(${t})`},FA=(e,t,r)=>{let n="";if(e.head!==""){let o=Hh(e.head);n+=t&&r?`(${o})`:o}for(let o of e.spans){let s=bj(o.type,t);if(n+=she(o.type,s,t,r),o.literal!==""){let i=Hh(o.literal);n+=t&&r?`(${i})`:i}}return n},NA=e=>new RegExp(`^${FA(e,!1,!0)}$`),yj=e=>new RegExp(`^${FA(e,!0,!0)}$`);var tC=e=>{let t=up(e);if(X(t))return tC(t.value);switch(e._tag){case"TypeLiteral":return e.indexSignatures.slice();case"Suspend":return tC(e.f());case"Refinement":return tC(e.from)}return[]},Bg=e=>{switch(e._tag){case"TupleType":{let t=!1,r=[];for(let n of e.elements)n.isOptional&&(t=!0),r.push(n.type);return t&&r.push(lf),r=r.concat(pC(e.rest)),Qt.make(r)}case"Refinement":return Bg(e.from);case"Union":return Qt.make(e.types.map(Bg));case"Suspend":return Bg(e.f())}throw new Error(Cc(e))},Sj=(e,t)=>{let r=kE(e.propertySignatures,n=>n.name===t);if(X(r))return r.value;if(cr(t)){let n;for(let o of e.indexSignatures){let s=Tc(o.parameter);switch(s._tag){case"TemplateLiteral":{if(NA(s).test(t))return new It(t,o.type,!1,!0);break}case"StringKeyword":n===void 0&&(n=new It(t,o.type,!1,!0))}}if(n)return n}else if(Oa(t))for(let n of e.indexSignatures){let o=Tc(n.parameter);if(uC(o))return new It(t,n.type,!1,!0)}},af=(e,t)=>{let r=up(e);if(X(r))return af(r.value,t);switch(e._tag){case"TypeLiteral":{let n=Sj(e,t);if(n)return n;break}case"Union":return new It(t,Qt.make(e.types.map(n=>af(n,t).type)),!1,!0);case"Suspend":return af(e.f(),t);case"Refinement":return af(e.from,t)}throw new Error(Cc(e))},of=e=>{let t=up(e);if(X(t))return of(t.value);switch(e._tag){case"TypeLiteral":return e.propertySignatures.map(r=>r.name);case"Union":return e.types.slice(1).reduce((r,n)=>uR(r,of(n)),of(e.types[0]));case"Suspend":return of(e.f());case"Refinement":return of(e.from);case"Transformation":return of(e.to)}return[]},DA=(e,t)=>{let r=[],n=[],o=s=>{switch(s._tag){case"NeverKeyword":break;case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":case"Refinement":n.push(new Oc(s,t,!0));break;case"Literal":if(cr(s.literal)||go(s.literal))r.push(new It(s.literal,t,!1,!0));else throw new Error(g6(s.literal));break;case"Enums":{for(let[i,a]of s.enums)r.push(new It(a,t,!1,!0));break}case"UniqueSymbol":r.push(new It(s.symbol,t,!1,!0));break;case"Union":s.types.forEach(o);break;default:throw new Error(x6(s))}};return o(e),{propertySignatures:r,indexSignatures:n}},Li=(e,t)=>{let r=up(e);if(X(r))return Li(r.value,t);switch(e._tag){case"TypeLiteral":{let n=[],o={};for(let s of e.propertySignatures)o[s.name]=null,t.includes(s.name)&&n.push(s);for(let s of t)if(!(s in o)){let i=Sj(e,s);i&&n.push(i)}return new nn(n,[])}case"Union":return new nn(t.map(n=>af(e,n)),[]);case"Suspend":return Li(e.f(),t);case"Refinement":return Li(e.from,t);case"Transformation":switch(e.transformation._tag){case"ComposeTransformation":return new En(Li(e.from,t),Li(e.to,t),dC);case"TypeLiteralTransformation":{let n=[],o=[];for(let s of t){let i=e.transformation.propertySignatureTransformations.find(a=>a.to===s);i?(n.push(i),o.push(i.from)):o.push(s)}return ut(n)?new En(Li(e.from,o),Li(e.to,t),new kc(n)):Li(e.from,o)}}}throw new Error(Cc(e))},Ej=(e,t)=>{let r=tC(e);return r.length>0?(r.some(n=>Yg(Tc(n.parameter)))&&(r=r.filter(n=>!lj(Tc(n.parameter)))),new nn([],r)):Li(e,of(e).filter(n=>!t.includes(n)))},zg=e=>Qt.make([e,lf]),cf=(e,t)=>{let r=t?.exact===!0;switch(e._tag){case"TupleType":return new wc(e.elements.map(n=>new wo(r?n.type:zg(n.type),!0)),X1(e.rest,{onEmpty:()=>e.rest,onNonEmpty:n=>[new ap(Qt.make([...pC(n),lf]))]}),e.isReadonly);case"TypeLiteral":return new nn(e.propertySignatures.map(n=>new It(n.name,r?n.type:zg(n.type),!0,n.isReadonly,n.annotations)),e.indexSignatures.map(n=>new Oc(n.parameter,zg(n.type),n.isReadonly)));case"Union":return Qt.make(e.types.map(n=>cf(n,t)));case"Suspend":return new js(()=>cf(e.f(),t));case"Declaration":case"Refinement":throw new Error(Cc(e));case"Transformation":{if(eb(e.transformation)&&e.transformation.propertySignatureTransformations.every(xj))return new En(cf(e.from,t),cf(e.to,t),e.transformation);throw new Error(Cc(e))}}return e},Bh=e=>{switch(e._tag){case"TupleType":return new wc(e.elements.map(t=>new wo(t.type,!1)),e.rest,e.isReadonly);case"TypeLiteral":return new nn(e.propertySignatures.map(t=>new It(t.name,t.type,!1,t.isReadonly,t.annotations)),e.indexSignatures);case"Union":return Qt.make(e.types.map(t=>Bh(t)));case"Suspend":return new js(()=>Bh(e.f()));case"Declaration":case"Refinement":throw new Error(Cc(e));case"Transformation":{if(eb(e.transformation)&&e.transformation.propertySignatureTransformations.every(xj))return new En(Bh(e.from),Bh(e.to),e.transformation);throw new Error(Cc(e))}}return e},sf=e=>{switch(e._tag){case"TupleType":return e.isReadonly===!1?e:new wc(e.elements,e.rest,!1,e.annotations);case"TypeLiteral":{let t=Co(e.propertySignatures,n=>n.isReadonly===!1?n:new It(n.name,n.type,n.isOptional,!1,n.annotations)),r=Co(e.indexSignatures,n=>n.isReadonly===!1?n:new Oc(n.parameter,n.type,!1));return t===e.propertySignatures&&r===e.indexSignatures?e:new nn(t,r,e.annotations)}case"Union":{let t=Co(e.types,sf);return t===e.types?e:Qt.make(t,e.annotations)}case"Suspend":return new js(()=>sf(e.f()),e.annotations);case"Refinement":{let t=sf(e.from);return t===e.from?e:new _c(t,e.filter,e.annotations)}case"Transformation":{let t=sf(e.from),r=sf(e.to);return t===e.from&&r===e.to?e:new En(t,r,e.transformation,e.annotations)}}return e};var LA=e=>t=>{let r;for(let n of e)Object.prototype.hasOwnProperty.call(t.annotations,n)&&(r===void 0&&(r={}),r[n]=t.annotations[n]);return r},Cj=e=>t=>{let r={...t.annotations};for(let n of e)delete r[n];return r},ihe=LA([hA,mA,xA,gA,bA,oC]),gt=e=>{switch(e._tag){case"Declaration":{let t=Co(e.typeParameters,gt);return t===e.typeParameters?e:new uf(t,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{let t=Co(e.elements,o=>{let s=gt(o.type);return s===o.type?o:new wo(s,o.isOptional)}),r=pC(e.rest),n=Co(r,gt);return t===e.elements&&n===r?e:new wc(t,n.map(o=>new ap(o)),e.isReadonly,e.annotations)}case"TypeLiteral":{let t=Co(e.propertySignatures,n=>{let o=gt(n.type);return o===n.type?n:new It(n.name,o,n.isOptional,n.isReadonly)}),r=Co(e.indexSignatures,n=>{let o=gt(n.type);return o===n.type?n:new Oc(n.parameter,o,n.isReadonly)});return t===e.propertySignatures&&r===e.indexSignatures?e:new nn(t,r,e.annotations)}case"Union":{let t=Co(e.types,gt);return t===e.types?e:Qt.make(t,e.annotations)}case"Suspend":return new js(()=>gt(e.f()),e.annotations);case"Refinement":{let t=gt(e.from);return t===e.from?e:new _c(t,e.filter,e.annotations)}case"Transformation":{let t=ihe(e);return gt(t!==void 0?tb(e.to,t):e.to)}}return e};function Co(e,t){let r=!1,n=Gl(e.length);for(let o=0;o<e.length;o++){let s=e[o],i=t(s);i!==s&&(r=!0),n[o]=i}return r?n:e}var lA=e=>{switch(e._tag){case"Transformation":return e.from;case"Refinement":return lA(e.from);case"Suspend":return lA(e.f())}},Di=(e,t)=>{switch(e._tag){case"Declaration":{let r=Co(e.typeParameters,n=>Di(n,t));return r===e.typeParameters?e:new uf(r,e.decodeUnknown,e.encodeUnknown)}case"TupleType":{let r=Co(e.elements,s=>{let i=Di(s.type,t);return i===s.type?s:new wo(i,s.isOptional)}),n=pC(e.rest),o=Co(n,s=>Di(s,t));return r===e.elements&&o===n?e:new wc(r,o.map(s=>new ap(s)),e.isReadonly)}case"TypeLiteral":{let r=Co(e.propertySignatures,o=>{let s=Di(o.type,t);return s===o.type?o:new It(o.name,s,o.isOptional,o.isReadonly)}),n=Co(e.indexSignatures,o=>{let s=Di(o.type,t);return s===o.type?o:new Oc(o.parameter,s,o.isReadonly)});return r===e.propertySignatures&&n===e.indexSignatures?e:new nn(r,n)}case"Union":{let r=Co(e.types,n=>Di(n,t));return r===e.types?e:Qt.make(r)}case"Suspend":{let r,n=$de(e);if(X(n)){let o=t?"Bound":"";r={[sC]:`${n.value}Encoded${o}`}}return new js(()=>Di(e.f(),t),r)}case"Refinement":{let r=Di(e.from,t);return t?r===e.from?e:lA(e.from)===void 0&&IA(e)?new _c(r,e.filter,e.annotations):r:r}case"Transformation":return Di(e.from,t)}return e},rb=e=>Di(e,!1),wj=e=>Di(e,!0),ur=e=>{let t={};for(let r of Object.getOwnPropertySymbols(e))t[String(r)]=e[r];return t},Tc=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return e;case"Refinement":return Tc(e.from)}},UA=(e,t)=>{switch(e._tag){case"Literal":return Ma(t)&&t.literal===e.literal;case"UniqueSymbol":return Vde(t)&&t.symbol===e.symbol;case"UndefinedKeyword":case"VoidKeyword":case"NeverKeyword":case"UnknownKeyword":case"AnyKeyword":case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":case"ObjectKeyword":return t._tag===e._tag;case"TemplateLiteral":return lj(t)&&t.head===e.head&&ahe(t.spans,e.spans);case"Enums":return Kde(t)&&che(t.enums,e.enums);case"Union":return Xg(t)&&uhe(e.types,t.types);case"Refinement":case"TupleType":case"TypeLiteral":case"Suspend":case"Transformation":case"Declaration":return e===t}},ahe=Mn((e,t)=>e.literal===t.literal&&UA(e.type,t.type)),che=Mn((e,t)=>t[0]===e[0]&&t[1]===e[1]),uhe=Mn(UA),phe=cR(UA),Wh=e=>{switch(e._tag){case"Declaration":{let t=up(e);if(X(t))return Wh(t.value);break}case"TypeLiteral":return e.propertySignatures.map(t=>Oa(t.name)?new pf(t.name):new Ui(t.name)).concat(e.indexSignatures.map(t=>Tc(t.parameter)));case"Suspend":return Wh(e.f());case"Union":return e.types.slice(1).reduce((t,r)=>phe(t,Wh(r)),Wh(e.types[0]));case"Transformation":return Wh(e.to)}throw new Error(Cc(e))},qA=(e,t)=>new En(e,t,dC),jg=(e,t)=>{switch(e._tag){case"TypeLiteral":{let r=[];for(let n of Reflect.ownKeys(t)){let o=t[n];o!==void 0&&r.push(new zh(n,o,R,R))}return r.length===0?e:new En(e,new nn(e.propertySignatures.map(n=>{let o=t[n.name];return new It(o===void 0?n.name:o,gt(n.type),n.isOptional,n.isReadonly,n.annotations)}),e.indexSignatures),new kc(r))}case"Union":return Qt.make(e.types.map(r=>jg(r,t)));case"Suspend":return new js(()=>jg(e.f(),t));case"Transformation":return qA(e,jg(gt(e),t))}throw new Error(S6(e))},qi=e=>_e($s(e),()=>e._tag);function lhe(e){return $(OA(e),{onNone:()=>"",onSome:t=>t.map(r=>` & Brand<${Ho(r)}>`).join("")})}var Oj=e=>_A(e).pipe(yo(()=>TA(e)),yo(()=>kA(e)),ct(t=>t+lhe(e))),$s=e=>yo(Jg(e),()=>Oj(e)),_j=(e,t,r)=>{switch(e._tag){case"UndefinedKeyword":return Zg;case"Union":{let n=[],o=!1;for(let s of e.types){let i=t(s);i?(o=!0,Gde(i)||n.push(i)):n.push(s)}if(o)return Qt.make(n);break}case"Suspend":return t(e.f());case"Transformation":return r(e)}};var kj=/^[+-]?\d+$/,WA=Symbol.for("effect/BigDecimal"),fhe={[WA]:WA,[W](){let e=ff(this);return p(M(e.value),K(ac(e.scale)),ie(this))},[H](e){return zA(e)&&hhe(this,e)},toString(){return`BigDecimal(${Wi(this)})`},toJSON(){return{_id:"BigDecimal",value:String(this.value),scale:this.scale}},[he](){return this.toJSON()},pipe(){return v(this,arguments)}},zA=e=>F(e,WA),lp=(e,t)=>{let r=Object.create(fhe);return r.value=e,r.scale=t,r},Ij=(e,t)=>{if(e!==Hi&&e%BA===Hi)throw new RangeError("Value must be normalized");let r=lp(e,t);return r.normalized=r,r},Hi=BigInt(0);var BA=BigInt(10),Rj=Ij(Hi,0),ff=e=>{if(e.normalized===void 0)if(e.value===Hi)e.normalized=Rj;else{let t=`${e.value}`,r=0;for(let s=t.length-1;s>=0&&t[s]==="0";s--)r++;r===0&&(e.normalized=e);let n=BigInt(t.substring(0,t.length-r)),o=e.scale-r;e.normalized=Ij(n,o)}return e.normalized},hC=u(2,(e,t)=>t>e.scale?lp(e.value*BA**BigInt(t-e.scale),t):t<e.scale?lp(e.value/BA**BigInt(e.scale-t),t):e);var jh=fc((e,t)=>{let r=yE(Tj(e),Tj(t));return r!==0?r:e.scale>t.scale?Oh(e.value,hC(t,e.scale).value):e.scale<t.scale?Oh(hC(e,t.scale).value,t.value):Oh(e.value,t.value)}),Aj=jl(jh),Mj=kh(jh),vj=$l(jh),Pj=Th(jh),Fj=Ih(jh),Nj=Gu(jh);var Tj=e=>e.value===Hi?0:e.value<Hi?-1:1,dhe=e=>e.value<Hi?lp(-e.value,e.scale):e;var jA=ar((e,t)=>e.scale>t.scale?hC(t,e.scale).value===e.value:e.scale<t.scale?hC(e,t.scale).value===t.value:e.value===t.value),hhe=u(2,(e,t)=>jA(e,t));var Dj=e=>CE(mhe(e),()=>new RangeError(`Number must be finite, got ${e}`));var mhe=e=>{if(!Number.isFinite(e))return g();let t=`${e}`;if(t.includes("e"))return $A(t);let[r,n=""]=t.split(".");return x(lp(BigInt(`${r}${n}`),n.length))},$A=e=>{if(e==="")return x(Rj);let t,r,n=e.search(/[eE]/);if(n!==-1){let c=e.slice(n+1);if(t=e.slice(0,n),r=Number(c),t===""||!Number.isSafeInteger(r)||!kj.test(c))return g()}else t=e,r=0;let o,s,i=t.search(/\./);if(i!==-1){let c=t.slice(0,i),l=t.slice(i+1);o=`${c}${l}`,s=l.length}else o=t,s=0;if(!kj.test(o))return g();let a=s-r;return Number.isSafeInteger(a)?x(lp(BigInt(o),a)):g()};var Wi=e=>{let t=ff(e);if(Math.abs(t.scale)>=16)return xhe(t);let r=t.value<Hi,n=r?`${t.value}`.substring(1):`${t.value}`,o,s;if(t.scale>=n.length)o="0",s="0".repeat(t.scale-n.length)+n;else{let a=n.length-t.scale;if(a>n.length){let c=a-n.length;o=`${n}${"0".repeat(c)}`,s=""}else s=n.slice(a),o=n.slice(0,a)}let i=s===""?o:`${o}.${s}`;return r?`-${i}`:i},xhe=e=>{if(ghe(e))return"0e+0";let t=ff(e),r=`${dhe(t).value}`,n=r.slice(0,1),o=r.slice(1),s=`${VA(t)?"-":""}${n}`;o!==""&&(s+=`.${o}`);let i=o.length-t.scale;return`${s}e${i>=0?"+":""}${i}`},Lj=e=>Number(Wi(e));var ghe=e=>e.value===Hi,VA=e=>e.value<Hi,Uj=e=>e.value>Hi;var bhe=Oh;var Hj=Gu(bhe);var Wj=e=>e>BigInt(Number.MAX_SAFE_INTEGER)||e<BigInt(Number.MIN_SAFE_INTEGER)?g():x(Number(e)),Bj=e=>{try{return e.trim()===""?g():x(BigInt(e))}catch{return g()}},zj=e=>{if(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER)return g();try{return x(BigInt(e))}catch{return g()}};var nb=e=>!e;var Jt={};Xn(Jt,{GenericTag:()=>on,Reference:()=>Bi,ReferenceTypeId:()=>khe,Tag:()=>vhe,TagTypeId:()=>_he,add:()=>qe,empty:()=>Cn,get:()=>jt,getOption:()=>xs,getOrElse:()=>Rhe,isContext:()=>ob,isReference:()=>Ihe,isTag:()=>Gh,make:()=>Oo,merge:()=>_o,mergeAll:()=>XA,omit:()=>Mhe,pick:()=>Ahe,unsafeGet:()=>Pn,unsafeMake:()=>The});var mC=Symbol.for("effect/Context/Tag"),$h=Symbol.for("effect/Context/Reference"),yhe="effect/STM",She=Symbol.for(yhe),Vh={...lc,_op:"Tag",[She]:Ta,[mC]:{_Service:e=>e,_Identifier:e=>e},toString(){return De(this.toJSON())},toJSON(){return{_id:"Tag",key:this.key,stack:this.stack}},[he](){return this.toJSON()},of(e){return e},context(e){return ZA(this,e)}},Ehe={...Vh,[$h]:$h},$j=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=2;let r=new Error;Error.stackTraceLimit=t;let n=Object.create(Vh);return Object.defineProperty(n,"stack",{get(){return r.stack}}),n.key=e,n},Vj=e=>()=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=2;let r=new Error;Error.stackTraceLimit=t;function n(){}return Object.setPrototypeOf(n,Vh),n.key=e,Object.defineProperty(n,"stack",{get(){return r.stack}}),n},Gj=()=>(e,t)=>{let r=Error.stackTraceLimit;Error.stackTraceLimit=2;let n=new Error;Error.stackTraceLimit=r;function o(){}return Object.setPrototypeOf(o,Ehe),o.key=e,o.defaultValue=t.defaultValue,Object.defineProperty(o,"stack",{get(){return n.stack}}),o},QA=Symbol.for("effect/Context"),Che={[QA]:{_Services:e=>e},[H](e){if(JA(e)&&this.unsafeMap.size===e.unsafeMap.size){for(let t of this.unsafeMap.keys())if(!e.unsafeMap.has(t)||!N(this.unsafeMap.get(t),e.unsafeMap.get(t)))return!1;return!0}return!1},[W](){return ie(this,ac(this.unsafeMap.size))},pipe(){return v(this,arguments)},toString(){return De(this.toJSON())},toJSON(){return{_id:"Context",services:Array.from(this.unsafeMap).map(ve)}},[he](){return this.toJSON()}},Vs=e=>{let t=Object.create(Che);return t.unsafeMap=e,t},whe=e=>{let t=new Error(`Service not found${e.key?`: ${String(e.key)}`:""}`);if(e.stack){let r=e.stack.split(`
`);if(r.length>2){let n=r[2].match(/at (.*)/);n&&(t.message=t.message+` (defined at ${n[1]})`)}}if(t.stack){let r=t.stack.split(`
`);r.splice(1,3),t.stack=r.join(`
`)}return t},JA=e=>F(e,QA),Kj=e=>F(e,mC),xC=e=>F(e,$h),Ohe=Vs(new Map),Qj=()=>Ohe,ZA=(e,t)=>Vs(new Map([[e.key,t]])),Jj=u(3,(e,t,r)=>{let n=new Map(e.unsafeMap);return n.set(t.key,r),Vs(n)}),KA=ne("effect/Context/defaultValueCache",()=>new Map),gC=e=>{if(KA.has(e.key))return KA.get(e.key);let t=e.defaultValue();return KA.set(e.key,t),t},Zj=(e,t)=>e.unsafeMap.has(t.key)?e.unsafeMap.get(t.key):gC(t),YA=u(2,(e,t)=>{if(!e.unsafeMap.has(t.key)){if($h in t)return gC(t);throw whe(t)}return e.unsafeMap.get(t.key)}),Yj=YA,Xj=u(3,(e,t,r)=>e.unsafeMap.has(t.key)?e.unsafeMap.get(t.key):xC(t)?gC(t):r()),e4=u(2,(e,t)=>e.unsafeMap.has(t.key)?An(e.unsafeMap.get(t.key)):xC(t)?An(gC(t)):Ii),t4=u(2,(e,t)=>{let r=new Map(e.unsafeMap);for(let[n,o]of t.unsafeMap)r.set(n,o);return Vs(r)}),r4=(...e)=>{let t=new Map;for(let r=0;r<e.length;r++)e[r].unsafeMap.forEach((n,o)=>{t.set(o,n)});return Vs(t)},n4=(...e)=>t=>{let r=new Set(e.map(o=>o.key)),n=new Map;for(let[o,s]of t.unsafeMap.entries())r.has(o)&&n.set(o,s);return Vs(n)},o4=(...e)=>t=>{let r=new Map(t.unsafeMap);for(let n of e)r.delete(n.key);return Vs(r)};var _he=mC,khe=$h,on=$j;var The=Vs,ob=JA,Gh=Kj,Ihe=xC,Cn=Qj,Oo=ZA,qe=Jj,jt=Yj,Rhe=Xj,Pn=YA,xs=e4,_o=t4,XA=r4,Ahe=n4,Mhe=o4,vhe=Vj,Bi=Gj;var i4=Symbol.for("effect/Chunk");function Phe(e,t,r,n,o){for(let s=t;s<Math.min(e.length,t+o);s++)r[n+s-t]=e[s];return r}var a4=[],bC=e=>ar((t,r)=>t.length===r.length&&Zt(t).every((n,o)=>e(n,dt(r,o)))),Fhe=bC(N),Nhe={[i4]:{_A:e=>e},toString(){return De(this.toJSON())},toJSON(){return{_id:"Chunk",values:Zt(this).map(ve)}},[he](){return this.toJSON()},[H](e){return df(e)&&Fhe(this,e)},[W](){return ie(this,qo(Zt(this)))},[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return a4[Symbol.iterator]();default:return Zt(this)[Symbol.iterator]()}},pipe(){return v(this,arguments)}},Fr=e=>{let t=Object.create(Nhe);switch(t.backing=e,e._tag){case"IEmpty":{t.length=0,t.depth=0,t.left=t,t.right=t;break}case"IConcat":{t.length=e.left.length+e.right.length,t.depth=1+Math.max(e.left.depth,e.right.depth),t.left=e.left,t.right=e.right;break}case"IArray":{t.length=e.array.length,t.depth=0,t.left=Gs,t.right=Gs;break}case"ISingleton":{t.length=1,t.depth=0,t.left=Gs,t.right=Gs;break}case"ISlice":{t.length=e.length,t.depth=e.chunk.depth+1,t.left=Gs,t.right=Gs;break}}return t},df=e=>F(e,i4),Gs=Fr({_tag:"IEmpty"}),ee=()=>Gs,fp=(...e)=>sb(e),G=e=>Fr({_tag:"ISingleton",a:e}),pt=e=>df(e)?e:Le(Ee(e)),eM=(e,t,r)=>{switch(e.backing._tag){case"IArray":{Phe(e.backing.array,0,t,r,e.length);break}case"IConcat":{eM(e.left,t,r),eM(e.right,t,r+e.left.length);break}case"ISingleton":{t[r]=e.backing.a;break}case"ISlice":{let n=0,o=r;for(;n<e.length;)t[o]=dt(e,n),n+=1,o+=1;break}}};var Dhe=e=>{switch(e.backing._tag){case"IEmpty":return a4;case"IArray":return e.backing.array;default:{let t=new Array(e.length);return eM(e,t,0),e.backing={_tag:"IArray",array:t},e.left=Gs,e.right=Gs,e.depth=0,t}}},Zt=Dhe,Lhe=e=>{switch(e.backing._tag){case"IEmpty":case"ISingleton":return e;case"IArray":return Fr({_tag:"IArray",array:oR(e.backing.array)});case"IConcat":return Fr({_tag:"IConcat",left:gs(e.backing.right),right:gs(e.backing.left)});case"ISlice":return Le(oR(Zt(e)))}},gs=Lhe,c4=u(2,(e,t)=>t<0||t>=e.length?g():x(dt(e,t))),Le=e=>e.length===0?ee():e.length===1?G(e[0]):Fr({_tag:"IArray",array:e}),sb=e=>Le(e),dt=u(2,(e,t)=>{switch(e.backing._tag){case"IEmpty":throw new Error("Index out of bounds");case"ISingleton":{if(t!==0)throw new Error("Index out of bounds");return e.backing.a}case"IArray":{if(t>=e.length||t<0)throw new Error("Index out of bounds");return e.backing.array[t]}case"IConcat":return t<e.left.length?dt(e.left,t):dt(e.right,t-e.left.length);case"ISlice":return dt(e.backing.chunk,t+e.backing.offset)}}),Fn=u(2,(e,t)=>He(e,G(t))),Et=u(2,(e,t)=>He(G(t),e)),bs=u(2,(e,t)=>{if(t<=0)return Gs;if(t>=e.length)return e;switch(e.backing._tag){case"ISlice":return Fr({_tag:"ISlice",chunk:e.backing.chunk,length:t,offset:e.backing.offset});case"IConcat":return t>e.left.length?Fr({_tag:"IConcat",left:e.left,right:bs(e.right,t-e.left.length)}):bs(e.left,t);default:return Fr({_tag:"ISlice",chunk:e,offset:0,length:t})}}),$t=u(2,(e,t)=>{if(t<=0)return e;if(t>=e.length)return Gs;switch(e.backing._tag){case"ISlice":return Fr({_tag:"ISlice",chunk:e.backing.chunk,offset:e.backing.offset+t,length:e.backing.length-t});case"IConcat":return t>e.left.length?$t(e.right,t-e.left.length):Fr({_tag:"IConcat",left:$t(e.left,t),right:e.right});default:return Fr({_tag:"ISlice",chunk:e,offset:t,length:e.length-t})}});var tM=u(2,(e,t)=>{let r=Zt(e),n=r.length,o=0;for(;o<n&&t(r[o]);)o++;return $t(e,o)});var He=u(2,(e,t)=>{if(e.backing._tag==="IEmpty")return t;if(t.backing._tag==="IEmpty")return e;let r=t.depth-e.depth;if(Math.abs(r)<=1)return Fr({_tag:"IConcat",left:e,right:t});if(r<-1)if(e.left.depth>=e.right.depth){let n=He(e.right,t);return Fr({_tag:"IConcat",left:e.left,right:n})}else{let n=He(e.right.right,t);if(n.depth===e.depth-3){let o=Fr({_tag:"IConcat",left:e.right.left,right:n});return Fr({_tag:"IConcat",left:e.left,right:o})}else{let o=Fr({_tag:"IConcat",left:e.left,right:e.right.left});return Fr({_tag:"IConcat",left:o,right:n})}}else if(t.right.depth>=t.left.depth){let n=He(e,t.left);return Fr({_tag:"IConcat",left:n,right:t.right})}else{let n=He(e,t.left.left);if(n.depth===t.depth-3){let o=Fr({_tag:"IConcat",left:n,right:t.left.right});return Fr({_tag:"IConcat",left:o,right:t.right})}else{let o=Fr({_tag:"IConcat",left:t.left.right,right:t.right});return Fr({_tag:"IConcat",left:n,right:o})}}}),Kh=u(2,(e,t)=>Le(hc(e,t))),zi=u(2,(e,t)=>Le(Dz(e,t))),u4=u(2,(e,t)=>Le(Fz(e,t)));var rM=u(2,(e,t)=>{if(e.backing._tag==="ISingleton")return t(e.backing.a,0);let r=Gs,n=0;for(let o of e)r=He(r,t(o,n++));return r});var yC=rM(R);var le=e=>e.length===0,Vt=e=>e.length>0,va=c4(0),ib=e=>dt(e,0),wn=ib,SC=e=>c4(e,e.length-1),hf=e=>dt(e,e.length-1);var bt=u(2,(e,t)=>e.backing._tag==="ISingleton"?G(t(e.backing.a,0)):Le(p(Zt(e),Mi((r,n)=>t(r,n))))),nM=u(3,(e,t,r)=>{let[n,o]=qz(e,t,r);return[n,Le(o)]});var mf=u(2,(e,t)=>[bs(e,t),$t(e,t)]);var oM=u(2,(e,t)=>{let r=0;for(let n of Zt(e)){if(t(n))break;r++}return mf(e,r)});var ro=e=>$t(e,1),p4=u(2,(e,t)=>$t(e,e.length-t)),sM=u(2,(e,t)=>{let r=[];for(let n of Zt(e))if(t(n))r.push(n);else break;return Le(r)});var iM=u(3,(e,t,r)=>Le(iR(e,t,r)));var Uhe=u(2,(e,t)=>pt(OE(e,t))),EC=(e,t)=>e<=t?Uhe(t-e+1,r=>e+r):G(e);var aM=kE;var xf=mc,l4=Pg;var cM=Symbol.for("effect/Duration"),x4=BigInt(0),f4=BigInt(24),CC=BigInt(60),uM=BigInt(1e3),d4=BigInt(1e6),h4=BigInt(1e9),qhe=/^(-?\d+(?:\.\d+)?)\s+(nanos?|micros?|millis?|seconds?|minutes?|hours?|days?|weeks?)$/,Qe=e=>{if(wC(e))return e;if(go(e))return On(e);if(Bu(e))return Ks(e);if(Array.isArray(e)&&e.length===2&&e.every(go))return e[0]===-1/0||e[1]===-1/0||Number.isNaN(e[0])||Number.isNaN(e[1])?Pa:e[0]===1/0||e[1]===1/0?ab:Ks(BigInt(Math.round(e[0]*1e9))+BigInt(Math.round(e[1])));if(cr(e)){let t=qhe.exec(e);if(t){let[r,n,o]=t,s=Number(n);switch(o){case"nano":case"nanos":return Ks(BigInt(n));case"micro":case"micros":return zhe(BigInt(n));case"milli":case"millis":return On(s);case"second":case"seconds":return pM(s);case"minute":case"minutes":return jhe(s);case"hour":case"hours":return $he(s);case"day":case"days":return Vhe(s);case"week":case"weeks":return Ghe(s)}}}throw new Error("Invalid DurationInput")};var m4={_tag:"Millis",millis:0},Hhe={_tag:"Infinity"},Whe={[cM]:cM,[W](){return ie(this,pE(this.value))},[H](e){return wC(e)&&Yhe(this,e)},toString(){return`Duration(${dM(this)})`},toJSON(){switch(this.value._tag){case"Millis":return{_id:"Duration",_tag:"Millis",millis:this.value.millis};case"Nanos":return{_id:"Duration",_tag:"Nanos",hrtime:Qhe(this)};case"Infinity":return{_id:"Duration",_tag:"Infinity"}}},[he](){return this.toJSON()},pipe(){return v(this,arguments)}},Qs=e=>{let t=Object.create(Whe);return go(e)?isNaN(e)||e<=0?t.value=m4:Number.isFinite(e)?Number.isInteger(e)?t.value={_tag:"Millis",millis:e}:t.value={_tag:"Nanos",nanos:BigInt(Math.round(e*1e6))}:t.value=Hhe:e<=x4?t.value=m4:t.value={_tag:"Nanos",nanos:e},t},wC=e=>F(e,cM),g4=e=>e.value._tag!=="Infinity",Bhe=e=>{switch(e.value._tag){case"Millis":return e.value.millis===0;case"Nanos":return e.value.nanos===x4;case"Infinity":return!1}},Pa=Qs(0),ab=Qs(1/0),Ks=e=>Qs(e),zhe=e=>Qs(e*uM),On=e=>Qs(e),pM=e=>Qs(e*1e3),jhe=e=>Qs(e*6e4),$he=e=>Qs(e*36e5),Vhe=e=>Qs(e*864e5),Ghe=e=>Qs(e*6048e5),Qr=e=>Jhe(e,{onMillis:t=>t,onNanos:t=>Number(t)/1e6});var b4=e=>{let t=Qe(e);switch(t.value._tag){case"Infinity":return g();case"Nanos":return x(t.value.nanos);case"Millis":return x(BigInt(Math.round(t.value.millis*1e6)))}},Khe=e=>{let t=Qe(e);switch(t.value._tag){case"Infinity":throw new Error("Cannot convert infinite duration to nanos");case"Nanos":return t.value.nanos;case"Millis":return BigInt(Math.round(t.value.millis*1e6))}},Qhe=e=>{let t=Qe(e);switch(t.value._tag){case"Infinity":return[1/0,0];case"Nanos":return[Number(t.value.nanos/h4),Number(t.value.nanos%h4)];case"Millis":return[Math.floor(t.value.millis/1e3),Math.round(t.value.millis%1e3*1e6)]}},Jhe=u(2,(e,t)=>{let r=Qe(e);switch(r.value._tag){case"Nanos":return t.onNanos(r.value.nanos);case"Infinity":return t.onMillis(1/0);case"Millis":return t.onMillis(r.value.millis)}}),gf=u(3,(e,t,r)=>{let n=Qe(e),o=Qe(t);if(n.value._tag==="Infinity"||o.value._tag==="Infinity")return r.onMillis(Qr(n),Qr(o));if(n.value._tag==="Nanos"||o.value._tag==="Nanos"){let s=n.value._tag==="Nanos"?n.value.nanos:BigInt(Math.round(n.value.millis*1e6)),i=o.value._tag==="Nanos"?o.value.nanos:BigInt(Math.round(o.value.millis*1e6));return r.onNanos(s,i)}return r.onMillis(n.value.millis,o.value.millis)}),y4=fc((e,t)=>gf(e,t,{onMillis:(r,n)=>r<n?-1:r>n?1:0,onNanos:(r,n)=>r<n?-1:r>n?1:0})),S4=Ih(_h(y4,Qe)),lM=(e,t)=>gf(e,t,{onMillis:(r,n)=>r===n,onNanos:(r,n)=>r===n});var Zhe=Gu(y4),E4=u(2,(e,t)=>Zhe(Qe(e),{minimum:Qe(t.minimum),maximum:Qe(t.maximum)}));var C4=u(2,(e,t)=>gf(e,t,{onMillis:(r,n)=>Qs(r+n),onNanos:(r,n)=>Qs(r+n)})),fM=u(2,(e,t)=>gf(e,t,{onMillis:(r,n)=>r<n,onNanos:(r,n)=>r<n})),OC=u(2,(e,t)=>gf(e,t,{onMillis:(r,n)=>r<=n,onNanos:(r,n)=>r<=n})),_C=u(2,(e,t)=>gf(e,t,{onMillis:(r,n)=>r>n,onNanos:(r,n)=>r>n})),cb=u(2,(e,t)=>gf(e,t,{onMillis:(r,n)=>r>=n,onNanos:(r,n)=>r>=n})),Yhe=u(2,(e,t)=>lM(Qe(e),Qe(t))),Xhe=e=>{let t=Qe(e);if(t.value._tag==="Infinity")return{days:1/0,hours:1/0,minutes:1/0,seconds:1/0,millis:1/0,nanos:1/0};let r=Khe(t),n=r/d4,o=n/uM,s=o/CC,i=s/CC,a=i/f4;return{days:Number(a),hours:Number(i%f4),minutes:Number(s%CC),seconds:Number(o%CC),millis:Number(n%uM),nanos:Number(r%d4)}},dM=e=>{let t=Qe(e);if(t.value._tag==="Infinity")return"Infinity";if(Bhe(t))return"0";let r=Xhe(t),n=[];return r.days!==0&&n.push(`${r.days}d`),r.hours!==0&&n.push(`${r.hours}h`),r.minutes!==0&&n.push(`${r.minutes}m`),r.seconds!==0&&n.push(`${r.seconds}s`),r.millis!==0&&n.push(`${r.millis}ms`),r.nanos!==0&&n.push(`${r.nanos}ns`),n.join(" ")};var hM=Math.pow(2,5),w4=hM-1,O4=hM/2,_4=hM/4;function eme(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function dp(e,t){return t>>>e&w4}function hp(e){return 1<<e}function kC(e,t){return eme(e&t-1)}var k4=(e,t)=>({value:e,previous:t});function bf(e,t,r,n){let o=n;if(!e){let s=n.length;o=new Array(s);for(let i=0;i<s;++i)o[i]=n[i]}return o[t]=r,o}function mM(e,t,r){let n=r.length-1,o=0,s=0,i=r;if(e)o=s=t;else for(i=new Array(n);o<t;)i[s++]=r[o++];for(++o;o<=n;)i[s++]=r[o++];return e&&(i.length=n),i}function T4(e,t,r,n){let o=n.length;if(e){let c=o;for(;c>=t;)n[c--]=n[c];return n[t]=r,n}let s=0,i=0,a=new Array(o+1);for(;s<t;)a[i++]=n[s++];for(a[t]=r;s<o;)a[++i]=n[s++];return a}var Rc=class e{_tag="EmptyNode";modify(t,r,n,o,s,i){let a=n(g());return ge(a)?new e:(++i.value,new Qh(t,o,s,a))}};function Js(e){return _a(e,"EmptyNode")}function rme(e){return Js(e)||e._tag==="LeafNode"||e._tag==="CollisionNode"}function TC(e,t){return Js(e)?!1:t===e.edit}var Qh=class e{edit;hash;key;value;_tag="LeafNode";constructor(t,r,n,o){this.edit=t,this.hash=r,this.key=n,this.value=o}modify(t,r,n,o,s,i){if(N(s,this.key)){let c=n(this.value);return c===this.value?this:ge(c)?(--i.value,new Rc):TC(this,t)?(this.value=c,this):new e(t,o,s,c)}let a=n(g());return ge(a)?this:(++i.value,I4(t,r,this.hash,this,o,new e(t,o,s,a)))}},xM=class e{edit;hash;children;_tag="CollisionNode";constructor(t,r,n){this.edit=t,this.hash=r,this.children=n}modify(t,r,n,o,s,i){if(o===this.hash){let c=TC(this,t),l=this.updateCollisionList(c,t,this.hash,this.children,n,s,i);return l===this.children?this:l.length>1?new e(t,this.hash,l):l[0]}let a=n(g());return ge(a)?this:(++i.value,I4(t,r,this.hash,this,o,new Qh(t,o,s,a)))}updateCollisionList(t,r,n,o,s,i,a){let c=o.length;for(let f=0;f<c;++f){let d=o[f];if("key"in d&&N(i,d.key)){let h=d.value,m=s(h);return m===h?o:ge(m)?(--a.value,mM(t,f,o)):bf(t,f,new Qh(r,n,i,m),o)}}let l=s(g());return ge(l)?o:(++a.value,bf(t,c,new Qh(r,n,i,l),o))}},ub=class e{edit;mask;children;_tag="IndexedNode";constructor(t,r,n){this.edit=t,this.mask=r,this.children=n}modify(t,r,n,o,s,i){let a=this.mask,c=this.children,l=dp(r,o),f=hp(l),d=kC(a,f),h=a&f,m=TC(this,t);if(!h){let U=new Rc().modify(t,r+5,n,o,s,i);return U?c.length>=O4?ome(t,l,U,a,c):new e(t,a|f,T4(m,d,U,c)):this}let y=c[d],_=y.modify(t,r+5,n,o,s,i);if(y===_)return this;let C=a,O;if(Js(_)){if(C&=~f,!C)return new Rc;if(c.length<=2&&rme(c[d^1]))return c[d^1];O=mM(m,d,c)}else O=bf(m,d,_,c);return m?(this.mask=C,this.children=O,this):new e(t,C,O)}},gM=class e{edit;size;children;_tag="ArrayNode";constructor(t,r,n){this.edit=t,this.size=r,this.children=n}modify(t,r,n,o,s,i){let a=this.size,c=this.children,l=dp(r,o),f=c[l],d=(f||new Rc).modify(t,r+5,n,o,s,i);if(f===d)return this;let h=TC(this,t),m;if(Js(f)&&!Js(d))++a,m=bf(h,l,d,c);else if(!Js(f)&&Js(d)){if(--a,a<=_4)return nme(t,a,l,c);m=bf(h,l,new Rc,c)}else m=bf(h,l,d,c);return h?(this.size=a,this.children=m,this):new e(t,a,m)}};function nme(e,t,r,n){let o=new Array(t-1),s=0,i=0;for(let a=0,c=n.length;a<c;++a)if(a!==r){let l=n[a];l&&!Js(l)&&(o[s++]=l,i|=1<<a)}return new ub(e,i,o)}function ome(e,t,r,n,o){let s=[],i=n,a=0;for(let c=0;i;++c)i&1&&(s[c]=o[a++]),i>>>=1;return s[t]=r,new gM(e,a+1,s)}function sme(e,t,r,n,o,s){if(r===o)return new xM(e,r,[s,n]);let i=dp(t,r),a=dp(t,o);if(i===a)return c=>new ub(e,hp(i)|hp(a),[c]);{let c=i<a?[n,s]:[s,n];return new ub(e,hp(i)|hp(a),c)}}function I4(e,t,r,n,o,s){let i,a=t;for(;;){let c=sme(e,a,r,n,o,s);if(typeof c=="function")i=k4(c,i),a=a+5;else{let l=c;for(;i!=null;)l=i.value(l),i=i.previous;return l}}}var R4="effect/HashMap",IC=Symbol.for(R4),ame={[IC]:IC,[Symbol.iterator](){return new RC(this,(e,t)=>[e,t])},[W](){let e=M(R4);for(let t of this)e^=p(M(t[0]),K(M(t[1])));return ie(this,e)},[H](e){if(yM(e)){if(e._size!==this._size)return!1;for(let t of this){let r=p(e,MC(t[0],M(t[0])));if(ge(r))return!1;if(!N(t[1],r.value))return!1}return!0}return!1},toString(){return De(this.toJSON())},toJSON(){return{_id:"HashMap",values:Array.from(this).map(ve)}},[he](){return this.toJSON()},pipe(){return v(this,arguments)}},bM=(e,t,r,n)=>{let o=Object.create(ame);return o._editable=e,o._edit=t,o._root=r,o._size=n,o},RC=class e{map;f;v;constructor(t,r){this.map=t,this.f=r,this.v=A4(this.map._root,this.f,void 0)}next(){if(ge(this.v))return{done:!0,value:void 0};let t=this.v.value;return this.v=AC(t.cont),{done:!1,value:t.value}}[Symbol.iterator](){return new e(this.map,this.f)}},AC=e=>e?M4(e[0],e[1],e[2],e[3],e[4]):g(),A4=(e,t,r=void 0)=>{switch(e._tag){case"LeafNode":return X(e.value)?x({value:t(e.key,e.value.value),cont:r}):AC(r);case"CollisionNode":case"ArrayNode":case"IndexedNode":{let n=e.children;return M4(n.length,n,0,t,r)}default:return AC(r)}},M4=(e,t,r,n,o)=>{for(;r<e;){let s=t[r++];if(s&&!Js(s))return A4(s,n,[e,t,r,n,o])}return AC(o)},cme=bM(!1,0,new Rc,0),Zh=()=>cme;var v4=e=>{let t=pb(Zh());for(let r of e)yf(t,r[0],r[1]);return EM(t)},yM=e=>F(e,IC),P4=e=>e&&Js(e._root),F4=u(2,(e,t)=>MC(e,t,M(t))),MC=u(3,(e,t,r)=>{let n=e._root,o=0;for(;;)switch(n._tag){case"LeafNode":return N(t,n.key)?n.value:g();case"CollisionNode":{if(r===n.hash){let s=n.children;for(let i=0,a=s.length;i<a;++i){let c=s[i];if("key"in c&&N(t,c.key))return c.value}}return g()}case"IndexedNode":{let s=dp(o,r),i=hp(s);if(n.mask&i){n=n.children[kC(n.mask,i)],o+=5;break}return g()}case"ArrayNode":{if(n=n.children[dp(o,r)],n){o+=5;break}return g()}default:return g()}});var SM=u(2,(e,t)=>X(MC(e,t,M(t))));var yf=u(3,(e,t,r)=>PC(e,t,()=>x(r))),ume=u(3,(e,t,r)=>e._editable?(e._root=t,e._size=r,e):t===e._root?e:bM(e._editable,e._edit,t,r)),vC=e=>new RC(e,t=>t);var Yh=e=>e._size;var pb=e=>bM(!0,e._edit+1,e._root,e._size),EM=e=>(e._editable=!1,e),N4=u(2,(e,t)=>{let r=pb(e);return t(r),EM(r)}),PC=u(3,(e,t,r)=>D4(e,t,M(t),r)),D4=u(4,(e,t,r,n)=>{let o={value:e._size},s=e._root.modify(e._editable?e._edit:NaN,0,n,r,t,o);return p(e,ume(s,o.value))});var FC=u(2,(e,t)=>PC(e,t,g));var L4=u(2,(e,t)=>Xh(e,Zh(),(r,n,o)=>yf(r,o,t(n,o))));var NC=u(2,(e,t)=>Xh(e,void 0,(r,n,o)=>t(n,o))),Xh=u(3,(e,t,r)=>{let n=e._root;if(n._tag==="LeafNode")return X(n.value)?r(t,n.value.value,n.key):t;if(n._tag==="EmptyNode")return t;let o=[n.children],s;for(;s=o.pop();)for(let i=0,a=s.length;i<a;){let c=s[i++];c&&!Js(c)&&(c._tag==="LeafNode"?X(c.value)&&(t=r(t,c.value.value,c.key)):o.push(c.children))}return t});var q4="effect/HashSet",DC=Symbol.for(q4),pme={[DC]:DC,[Symbol.iterator](){return vC(this._keyMap)},[W](){return ie(this,K(M(this._keyMap))(M(q4)))},[H](e){return CM(e)?Yh(this._keyMap)===Yh(e._keyMap)&&N(this._keyMap,e._keyMap):!1},toString(){return De(this.toJSON())},toJSON(){return{_id:"HashSet",values:Array.from(this).map(ve)}},[he](){return this.toJSON()},pipe(){return v(this,arguments)}},LC=e=>{let t=Object.create(pme);return t._keyMap=e,t},CM=e=>F(e,DC),lme=LC(Zh()),lb=()=>lme,H4=e=>{let t=UC(lb());for(let r of e)em(t,r);return qC(t)},W4=(...e)=>{let t=UC(lb());for(let r of e)em(t,r);return qC(t)},B4=u(2,(e,t)=>SM(e._keyMap,t));var z4=e=>Yh(e._keyMap),UC=e=>LC(pb(e._keyMap)),qC=e=>(e._keyMap._editable=!1,e),wM=u(2,(e,t)=>{let r=UC(e);return t(r),qC(r)}),em=u(2,(e,t)=>e._keyMap._editable?(yf(t,!0)(e._keyMap),e):LC(yf(t,!0)(e._keyMap))),OM=u(2,(e,t)=>e._keyMap._editable?(FC(t)(e._keyMap),e):LC(FC(t)(e._keyMap))),j4=u(2,(e,t)=>wM(e,r=>{for(let n of t)OM(r,n)}));var $4=u(2,(e,t)=>wM(lb(),r=>{_M(e,n=>em(r,n));for(let n of t)em(r,n)}));var _M=u(2,(e,t)=>NC(e._keyMap,(r,n)=>t(n))),V4=u(3,(e,t,r)=>Xh(e._keyMap,t,(n,o,s)=>r(n,s)));var G4=CM,Zs=lb,mp=H4,Sf=W4,K4=B4;var Ac=z4;var ji=em,Ef=OM,kM=j4;var Mc=$4;var Q4=_M,xp=V4;var J4=Symbol.for("effect/MutableRef"),dme={[J4]:J4,toString(){return De(this.toJSON())},toJSON(){return{_id:"MutableRef",current:ve(this.current)}},[he](){return this.toJSON()},pipe(){return v(this,arguments)}},ko=e=>{let t=Object.create(dme);return t.current=e,t},HC=u(3,(e,t,r)=>N(t,e.current)?(e.current=r,!0):!1);var Ie=e=>e.current;var Nn=u(2,(e,t)=>(e.current=t,e));var zC="effect/FiberId",gp=Symbol.for(zC),tm="None",TM="Runtime",IM="Composite",hme=Ke(`${zC}-${tm}`),RM=class{[gp]=gp;_tag=tm;id=-1;startTimeMillis=-1;[W](){return hme}[H](t){return db(t)&&t._tag===tm}toString(){return De(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag}}[he](){return this.toJSON()}},WC=class{id;startTimeMillis;[gp]=gp;_tag=TM;constructor(t,r){this.id=t,this.startTimeMillis=r}[W](){return ie(this,Ke(`${zC}-${this._tag}-${this.id}-${this.startTimeMillis}`))}[H](t){return db(t)&&t._tag===TM&&this.id===t.id&&this.startTimeMillis===t.startTimeMillis}toString(){return De(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,id:this.id,startTimeMillis:this.startTimeMillis}}[he](){return this.toJSON()}},BC=class{left;right;[gp]=gp;_tag=IM;constructor(t,r){this.left=t,this.right=r}_hash;[W](){return p(Ke(`${zC}-${this._tag}`),K(M(this.left)),K(M(this.right)),ie(this))}[H](t){return db(t)&&t._tag===IM&&N(this.left,t.left)&&N(this.right,t.right)}toString(){return De(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,left:ve(this.left),right:ve(this.right)}}[he](){return this.toJSON()}},Cf=new RM,Y4=(e,t)=>new WC(e,t),X4=(e,t)=>new BC(e,t),db=e=>F(e,gp);var AM=u(2,(e,t)=>e._tag===tm?t:t._tag===tm?e:new BC(e,t)),e5=e=>p(e,xp(Cf,(t,r)=>AM(r)(t)));var fb=e=>{switch(e._tag){case tm:return Zs();case TM:return Sf(e.id);case IM:return p(fb(e.left),Mc(fb(e.right)))}},Z4=ne(Symbol.for("effect/Fiber/Id/_fiberCounter"),()=>ko(0));var wf=e=>Array.from(fb(e)).map(r=>`#${r}`).join(",");var t5=()=>{let e=Ie(Z4);return p(Z4,Nn(e+1)),new WC(e,Date.now())};var Dn=Cf,r5=Y4,n5=X4,o5=db;var vM=AM,s5=e5;var PM=fb;var i5=wf;var jC=t5;var a5=yM,Pc=Zh;var rm=v4,c5=P4,FM=F4;var sn=yf,NM=vC;var $C=Yh;var u5=N4,p5=PC;var l5=L4;var f5=NC,DM=Xh;var mb=Symbol.for("effect/List"),LM=e=>Ee(e),xme=e=>_1(Mn(e),LM),gme=xme(N),bme={[mb]:mb,_tag:"Cons",toString(){return De(this.toJSON())},toJSON(){return{_id:"List",_tag:"Cons",values:LM(this).map(ve)}},[he](){return this.toJSON()},[H](e){return VC(e)&&this._tag===e._tag&&gme(this,e)},[W](){return ie(this,qo(LM(this)))},[Symbol.iterator](){let e=!1,t=this;return{next(){if(e)return this.return();if(t._tag==="Nil")return e=!0,this.return();let r=t.head;return t=t.tail,{done:e,value:r}},return(r){return e||(e=!0),{done:!0,value:r}}}},pipe(){return v(this,arguments)}},nm=(e,t)=>{let r=Object.create(bme);return r.head=e,r.tail=t,r},yme=Ke("Nil"),Sme={[mb]:mb,_tag:"Nil",toString(){return De(this.toJSON())},toJSON(){return{_id:"List",_tag:"Nil"}},[he](){return this.toJSON()},[W](){return yme},[H](e){return VC(e)&&this._tag===e._tag},[Symbol.iterator](){return{next(){return{done:!0,value:void 0}}}},pipe(){return v(this,arguments)}},hb=Object.create(Sme),VC=e=>F(e,mb),Na=e=>e._tag==="Nil",Of=e=>e._tag==="Cons";var Eme=()=>hb,Fc=(e,t)=>nm(e,t),Ys=Eme,xb=e=>nm(e,hb),GC=e=>{let t=e[Symbol.iterator](),r;if((r=t.next())&&!r.done){let n=nm(r.value,hb),o=n;for(;(r=t.next())&&!r.done;){let s=nm(r.value,hb);o.tail=s,o=s}return n}else return hb};var d5=u(2,(e,t)=>Cme(t,e)),KC=u(2,(e,t)=>Fc(t,e)),Cme=u(2,(e,t)=>{if(Na(e))return t;if(Na(t))return e;{let r=nm(t.head,e),n=r,o=t.tail;for(;!Na(o);){let s=nm(o.head,e);n.tail=s,n=s,o=o.tail}return r}});var h5=u(3,(e,t,r)=>{let n=t,o=e;for(;!Na(o);)n=r(n,o.head),o=o.tail;return n});var m5=e=>{let t=Ys(),r=e;for(;!Na(r);)t=KC(t,r.head),r=r.tail;return t};var x5=Object.assign(Object.create(Array.prototype),{[W](){return ie(this,qo(this))},[H](e){return Array.isArray(e)&&this.length===e.length?this.every((t,r)=>N(t,e[r])):!1}}),Sp=(function(){function e(t){t&&Object.assign(this,t)}return e.prototype=Sh,e})(),om=e=>Object.assign(Object.create(Sh),e);var wme=Symbol.for("effect/DifferContextPatch");function g5(e){return e}var bb={...Sp.prototype,[wme]:{_Value:g5,_Patch:g5}},Ome=Object.assign(Object.create(bb),{_tag:"Empty"}),_me=Object.create(Ome),qM=()=>_me,kme=Object.assign(Object.create(bb),{_tag:"AndThen"}),Tme=(e,t)=>{let r=Object.create(kme);return r.first=e,r.second=t,r},Ime=Object.assign(Object.create(bb),{_tag:"AddService"}),Rme=(e,t)=>{let r=Object.create(Ime);return r.key=e,r.service=t,r},Ame=Object.assign(Object.create(bb),{_tag:"RemoveService"}),Mme=e=>{let t=Object.create(Ame);return t.key=e,t},vme=Object.assign(Object.create(bb),{_tag:"UpdateService"}),Pme=(e,t)=>{let r=Object.create(vme);return r.key=e,r.update=t,r},b5=(e,t)=>{let r=new Map(e.unsafeMap),n=qM();for(let[o,s]of t.unsafeMap.entries())if(r.has(o)){let i=r.get(o);r.delete(o),N(i,s)||(n=gb(Pme(o,()=>s))(n))}else r.delete(o),n=gb(Rme(o,s))(n);for(let[o]of r.entries())n=gb(Mme(o))(n);return n},gb=u(2,(e,t)=>Tme(e,t)),y5=u(2,(e,t)=>{if(e._tag==="Empty")return t;let r=!1,n=G(e),o=new Map(t.unsafeMap);for(;Vt(n);){let i=wn(n),a=ro(n);switch(i._tag){case"Empty":{n=a;break}case"AddService":{o.set(i.key,i.service),n=a;break}case"AndThen":{n=Et(Et(a,i.second),i.first);break}case"RemoveService":{o.delete(i.key),n=a;break}case"UpdateService":{o.set(i.key,i.update(o.get(i.key))),r=!0,n=a;break}}}if(!r)return Vs(o);let s=new Map;for(let[i]of t.unsafeMap)o.has(i)&&(s.set(i,o.get(i)),o.delete(i));for(let[i,a]of o)s.set(i,a);return Vs(s)});var Nme=Symbol.for("effect/DifferHashSetPatch");function HM(e){return e}var JC={...Sp.prototype,[Nme]:{_Value:HM,_Key:HM,_Patch:HM}},Dme=Object.assign(Object.create(JC),{_tag:"Empty"}),Lme=Object.create(Dme),WM=()=>Lme,Ume=Object.assign(Object.create(JC),{_tag:"AndThen"}),qme=(e,t)=>{let r=Object.create(Ume);return r.first=e,r.second=t,r},Hme=Object.assign(Object.create(JC),{_tag:"Add"}),Wme=e=>{let t=Object.create(Hme);return t.value=e,t},Bme=Object.assign(Object.create(JC),{_tag:"Remove"}),zme=e=>{let t=Object.create(Bme);return t.value=e,t},S5=(e,t)=>{let[r,n]=xp([e,WM()],([o,s],i)=>K4(i)(o)?[Ef(i)(o),s]:[o,QC(Wme(i))(s)])(t);return xp(n,(o,s)=>QC(zme(s))(o))(r)},QC=u(2,(e,t)=>qme(e,t)),E5=u(2,(e,t)=>{if(e._tag==="Empty")return t;let r=t,n=G(e);for(;Vt(n);){let o=wn(n),s=ro(n);switch(o._tag){case"Empty":{n=s;break}case"AndThen":{n=Et(o.first)(Et(o.second)(s));break}case"Add":{r=ji(o.value)(r),n=s;break}case"Remove":r=Ef(o.value)(r),n=s}}return r});var $me=Symbol.for("effect/DifferReadonlyArrayPatch");function C5(e){return e}var Sb={...Sp.prototype,[$me]:{_Value:C5,_Patch:C5}},Vme=Object.assign(Object.create(Sb),{_tag:"Empty"}),Gme=Object.create(Vme),BM=()=>Gme,Kme=Object.assign(Object.create(Sb),{_tag:"AndThen"}),Qme=(e,t)=>{let r=Object.create(Kme);return r.first=e,r.second=t,r},Jme=Object.assign(Object.create(Sb),{_tag:"Append"}),Zme=e=>{let t=Object.create(Jme);return t.values=e,t},Yme=Object.assign(Object.create(Sb),{_tag:"Slice"}),Xme=(e,t)=>{let r=Object.create(Yme);return r.from=e,r.until=t,r},exe=Object.assign(Object.create(Sb),{_tag:"Update"}),txe=(e,t)=>{let r=Object.create(exe);return r.index=e,r.patch=t,r},w5=e=>{let t=0,r=BM();for(;t<e.oldValue.length&&t<e.newValue.length;){let n=e.oldValue[t],o=e.newValue[t],s=e.differ.diff(n,o);N(s,e.differ.empty)||(r=yb(r,txe(t,s))),t=t+1}return t<e.oldValue.length&&(r=yb(r,Xme(0,t))),t<e.newValue.length&&(r=yb(r,Zme(Mz(t)(e.newValue)))),r},yb=u(2,(e,t)=>Qme(e,t)),O5=u(3,(e,t,r)=>{if(e._tag==="Empty")return t;let n=t.slice(),o=Gr(e);for(;Ri(o);){let s=Ur(o),i=Ai(o);switch(s._tag){case"Empty":{o=i;break}case"AndThen":{i.unshift(s.first,s.second),o=i;break}case"Append":{for(let a of s.values)n.push(a);o=i;break}case"Slice":{n=n.slice(s.from,s.until),o=i;break}case"Update":{n[s.index]=r.patch(s.patch,n[s.index]),o=i;break}}}return n});var _5=Symbol.for("effect/Differ"),nxe={[_5]:{_P:R,_V:R},pipe(){return v(this,arguments)}},Ep=e=>{let t=Object.create(nxe);return t.empty=e.empty,t.diff=e.diff,t.combine=e.combine,t.patch=e.patch,t},zM=()=>Ep({empty:qM(),combine:(e,t)=>gb(t)(e),diff:(e,t)=>b5(e,t),patch:(e,t)=>y5(t)(e)});var jM=()=>Ep({empty:WM(),combine:(e,t)=>QC(t)(e),diff:(e,t)=>S5(e,t),patch:(e,t)=>E5(t)(e)});var $M=e=>Ep({empty:BM(),combine:(t,r)=>yb(t,r),diff:(t,r)=>w5({oldValue:t,newValue:r,differ:e}),patch:(t,r)=>O5(t,r,e)});var ZC=()=>k5((e,t)=>t),k5=e=>Ep({empty:R,combine:(t,r)=>t===R?r:r===R?t:n=>r(t(n)),diff:(t,r)=>N(t,r)?R:uh(r),patch:(t,r)=>e(r,t(r))});var Eb=255,T5=8,YC=e=>e&Eb,XC=e=>e>>T5&Eb,_f=(e,t)=>(e&Eb)+((t&e&Eb)<<T5),ew=_f(0,0),I5=e=>_f(e,e),R5=e=>_f(e,0);var A5=u(2,(e,t)=>_f(YC(e)&~t,XC(e)));var GM=u(2,(e,t)=>e|t);var M5=e=>~e>>>0&Eb;var oxe=0,$i=1,P5=2,KM=4,tw=16,QM=32;var F5=e=>ow(e,QM),rw=u(2,(e,t)=>e&~t);var nw=u(2,(e,t)=>e|t);var Nc=e=>Cb(e)&&!sxe(e),Cb=e=>ow(e,$i);var ow=u(2,(e,t)=>(e&t)!==0),JM=(...e)=>e.reduce((t,r)=>t|r,0),N5=JM(oxe);var ZM=e=>ow(e,KM);var sxe=e=>ow(e,tw);var Xs=u(2,(e,t)=>_f(e^t,t)),Dc=u(2,(e,t)=>e&(M5(YC(t))|XC(t))|YC(t)&XC(t));var YM=Ep({empty:ew,diff:(e,t)=>Xs(e,t),combine:(e,t)=>GM(t)(e),patch:(e,t)=>Dc(t,e)});var D5=ew;var XM=I5,ev=R5;var tv=A5;var L5={_tag:"Empty"},sv=(e,t)=>({_tag:"Par",left:e,right:t}),sw=(e,t)=>({_tag:"Seq",left:e,right:t}),iv=(e,t)=>({_tag:"Single",dataSource:e,blockedRequest:t});var U5=e=>{let t=xb(e),r=Ys();for(;;){let[n,o]=h5(t,[q5(),Ys()],([s,i],a)=>{let[c,l]=ixe(a);return[dxe(s,c),d5(i,l)]});if(r=axe(r,n),Na(o))return m5(r);t=o}throw new Error("BUG: BlockedRequests.flatten - please report an issue at https://github.com/Effect-TS/effect/issues")},ixe=e=>{let t=e,r=q5(),n=Ys(),o=Ys();for(;;)switch(t._tag){case"Empty":{if(Na(n))return[r,o];t=n.head,n=n.tail;break}case"Par":{n=Fc(t.right,n),t=t.left;break}case"Seq":{let s=t.left,i=t.right;switch(s._tag){case"Empty":{t=i;break}case"Par":{let a=s.left,c=s.right;t=sv(sw(a,i),sw(c,i));break}case"Seq":{let a=s.left,c=s.right;t=sw(a,sw(c,i));break}case"Single":{t=s,o=Fc(i,o);break}}break}case"Single":{if(r=fxe(r,t),Na(n))return[r,o];t=n.head,n=n.tail;break}}throw new Error("BUG: BlockedRequests.step - please report an issue at https://github.com/Effect-TS/effect/issues")},axe=(e,t)=>{if(Na(e))return xb(nv(t));if(hxe(t))return e;let r=Sxe(e.head),n=mxe(t);return r.length===1&&n.length===1&&N(r[0],n[0])?Fc(yxe(e.head,nv(t)),e.tail):Fc(nv(t),e)},cxe=Symbol.for("effect/RequestBlock/Entry"),ov=class{request;result;listeners;ownerId;state;[cxe]=uxe;constructor(t,r,n,o,s){this.request=t,this.result=r,this.listeners=n,this.ownerId=o,this.state=s}},uxe={_R:e=>e};var av=e=>new ov(e.request,e.result,e.listeners,e.ownerId,e.state),pxe=Symbol.for("effect/RequestBlock/RequestBlockParallel"),lxe={_R:e=>e},Ob=class{map;[pxe]=lxe;constructor(t){this.map=t}},q5=()=>new Ob(Pc());var fxe=(e,t)=>new Ob(p5(e.map,t.dataSource,r=>V1(ct(r,Fn(t.blockedRequest)),()=>G(t.blockedRequest)))),dxe=(e,t)=>new Ob(DM(e.map,t.map,(r,n,o)=>sn(r,o,$(FM(r,o),{onNone:()=>n,onSome:s=>He(n,s)})))),hxe=e=>c5(e.map),mxe=e=>Array.from(NM(e.map)),nv=e=>bxe(l5(e.map,t=>G(t))),xxe=Symbol.for("effect/RequestBlock/RequestBlockSequential"),gxe={_R:e=>e},iw=class{map;[xxe]=gxe;constructor(t){this.map=t}},bxe=e=>new iw(e),yxe=(e,t)=>new iw(DM(t.map,e.map,(r,n,o)=>sn(r,o,$(FM(r,o),{onNone:()=>ee(),onSome:s=>He(s,n)}))));var Sxe=e=>Array.from(NM(e.map)),H5=e=>Array.from(e.map);var Cp="Empty",wp="Fail",kf="Interrupt",Tf="Parallel",If="Sequential";var j5="effect/Cause",uv=Symbol.for(j5),Cxe={_E:e=>e},im={[uv]:Cxe,[W](){return p(M(j5),K(M(Oxe(this))),ie(this))},[H](e){return _b(e)&&wxe(this,e)},pipe(){return v(this,arguments)},toJSON(){switch(this._tag){case"Empty":return{_id:"Cause",_tag:this._tag};case"Die":return{_id:"Cause",_tag:this._tag,defect:ve(this.defect)};case"Interrupt":return{_id:"Cause",_tag:this._tag,fiberId:this.fiberId.toJSON()};case"Fail":return{_id:"Cause",_tag:this._tag,failure:ve(this.error)};case"Sequential":case"Parallel":return{_id:"Cause",_tag:this._tag,left:ve(this.left),right:ve(this.right)}}},toString(){return zo(this)},[he](){return this.toJSON()}},Ln=(()=>{let e=Object.create(im);return e._tag=Cp,e})(),Vi=e=>{let t=Object.create(im);return t._tag=wp,t.error=e,t},Nr=e=>{let t=Object.create(im);return t._tag="Die",t.defect=e,t},To=e=>{let t=Object.create(im);return t._tag=kf,t.fiberId=e,t},Jr=(e,t)=>{let r=Object.create(im);return r._tag=Tf,r.left=e,r.right=t,r},Rt=(e,t)=>{let r=Object.create(im);return r._tag=If,r.left=e,r.right=t,r},_b=e=>F(e,uv),pv=e=>e._tag===Cp,$5=e=>e._tag===wp,Mf=e=>e._tag==="Die";var vf=e=>e._tag===Cp?!0:Rf(e,!0,(t,r)=>{switch(r._tag){case Cp:return x(t);case"Die":case wp:case kf:return x(!1);default:return g()}});var am=e=>X(G5(e)),Pf=e=>pw(void 0,kxe)(e),kb=e=>gs(Rf(e,ee(),(t,r)=>r._tag===wp?x(p(t,Et(r.error))):g())),Ff=e=>gs(Rf(e,ee(),(t,r)=>r._tag==="Die"?x(p(t,Et(r.defect))):g())),Nf=e=>Rf(e,Zs(),(t,r)=>r._tag===kf?x(p(t,ji(r.fiberId))):g()),cw=e=>Op(e,t=>t._tag===wp?x(t.error):g()),Gi=e=>{let t=cw(e);switch(t._tag){case"None":return Y(e);case"Some":return V(t.value)}};var V5=e=>Df(e,{onEmpty:x(Ln),onFail:ct(Vi),onDie:t=>x(Nr(t)),onInterrupt:t=>x(To(t)),onSequential:Ju(Rt),onParallel:Ju(Jr)}),G5=e=>Op(e,t=>t._tag===kf?x(t.fiberId):g()),lv=e=>Df(e,{onEmpty:g(),onFail:()=>g(),onDie:t=>x(Nr(t)),onInterrupt:()=>g(),onSequential:Ju(Rt),onParallel:Ju(Jr)}),K5=e=>Df(e,{onEmpty:g(),onFail:t=>x(Nr(t)),onDie:t=>x(Nr(t)),onInterrupt:()=>g(),onSequential:Ju(Rt),onParallel:Ju(Jr)});var uw=e=>Df(e,{onEmpty:Ln,onFail:()=>Ln,onDie:Nr,onInterrupt:To,onSequential:Rt,onParallel:Jr}),Q5=e=>Df(e,{onEmpty:Ln,onFail:Nr,onDie:Nr,onInterrupt:To,onSequential:Rt,onParallel:Jr});var Tb=u(2,(e,t)=>fv(e,r=>Vi(t(r)))),fv=u(2,(e,t)=>Df(e,{onEmpty:Ln,onFail:r=>t(r),onDie:r=>Nr(r),onInterrupt:r=>To(r),onSequential:(r,n)=>Rt(r,n),onParallel:(r,n)=>Jr(r,n)})),dv=e=>fv(e,R);var wxe=(e,t)=>{let r=G(e),n=G(t);for(;Vt(r)&&Vt(n);){let[o,s]=p(wn(r),Rf([Zs(),ee()],([c,l],f)=>{let[d,h]=cv(f);return x([p(c,Mc(d)),p(l,He(h))])})),[i,a]=p(wn(n),Rf([Zs(),ee()],([c,l],f)=>{let[d,h]=cv(f);return x([p(c,Mc(d)),p(l,He(h))])}));if(!N(o,i))return!1;r=s,n=a}return!0},Oxe=e=>_xe(G(e),ee()),_xe=(e,t)=>{for(;;){let[r,n]=p(e,mc([Zs(),ee()],([s,i],a)=>{let[c,l]=cv(a);return[p(s,Mc(c)),p(i,He(l))]})),o=Ac(r)>0?p(t,Et(r)):t;if(le(n))return gs(o);e=n,t=o}throw new Error(ql("Cause.flattenCauseLoop"))},Op=u(2,(e,t)=>{let r=[e];for(;r.length>0;){let n=r.pop(),o=t(n);switch(o._tag){case"None":{switch(n._tag){case If:case Tf:{r.push(n.right),r.push(n.left);break}}break}case"Some":return o}}return g()});var cv=e=>{let t=e,r=[],n=Zs(),o=ee();for(;t!==void 0;)switch(t._tag){case Cp:{if(r.length===0)return[n,o];t=r.pop();break}case wp:{if(n=ji(n,fp(t._tag,t.error)),r.length===0)return[n,o];t=r.pop();break}case"Die":{if(n=ji(n,fp(t._tag,t.defect)),r.length===0)return[n,o];t=r.pop();break}case kf:{if(n=ji(n,fp(t._tag,t.fiberId)),r.length===0)return[n,o];t=r.pop();break}case If:{switch(t.left._tag){case Cp:{t=t.right;break}case If:{t=Rt(t.left.left,Rt(t.left.right,t.right));break}case Tf:{t=Jr(Rt(t.left.left,t.right),Rt(t.left.right,t.right));break}default:{o=Et(o,t.right),t=t.left;break}}break}case Tf:{r.push(t.right),t=t.left;break}}throw new Error(ql("Cause.evaluateCauseLoop"))};var kxe={emptyCase:jr,failCase:ls,dieCase:ls,interruptCase:jr,sequentialCase:(e,t,r)=>t&&r,parallelCase:(e,t,r)=>t&&r};var B5="SequentialCase",z5="ParallelCase",Df=u(2,(e,{onDie:t,onEmpty:r,onFail:n,onInterrupt:o,onParallel:s,onSequential:i})=>pw(e,void 0,{emptyCase:()=>r,failCase:(a,c)=>n(c),dieCase:(a,c)=>t(c),interruptCase:(a,c)=>o(c),sequentialCase:(a,c,l)=>i(c,l),parallelCase:(a,c,l)=>s(c,l)})),Rf=u(3,(e,t,r)=>{let n=t,o=e,s=[];for(;o!==void 0;){let i=r(n,o);switch(n=X(i)?i.value:n,o._tag){case If:{s.push(o.right),o=o.left;break}case Tf:{s.push(o.right),o=o.left;break}default:{o=void 0;break}}o===void 0&&s.length>0&&(o=s.pop())}return n}),pw=u(3,(e,t,r)=>{let n=[e],o=[];for(;n.length>0;){let i=n.pop();switch(i._tag){case Cp:{o.push(Y(r.emptyCase(t)));break}case wp:{o.push(Y(r.failCase(t,i.error)));break}case"Die":{o.push(Y(r.dieCase(t,i.defect)));break}case kf:{o.push(Y(r.interruptCase(t,i.fiberId)));break}case If:{n.push(i.right),n.push(i.left),o.push(V({_tag:B5}));break}case Tf:{n.push(i.right),n.push(i.left),o.push(V({_tag:z5}));break}}}let s=[];for(;o.length>0;){let i=o.pop();switch(i._tag){case"Left":{switch(i.left._tag){case B5:{let a=s.pop(),c=s.pop(),l=r.sequentialCase(t,a,c);s.push(l);break}case z5:{let a=s.pop(),c=s.pop(),l=r.parallelCase(t,a,c);s.push(l);break}}break}case"Right":{s.push(i.right);break}}}if(s.length===0)throw new Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return s.pop()}),zo=(e,t)=>Pf(e)?"All fibers interrupted without errors.":fw(e).map(function(r){return t?.renderErrorCause!==!0||r.cause===void 0?r.stack:`${r.stack} {
${J5(r.cause,"  ")}
}`}).join(`
`),J5=(e,t)=>{let r=e.stack.split(`
`),n=`${t}[cause]: ${r[0]}`;for(let o=1,s=r.length;o<s;o++)n+=`
${t}${r[o]}`;return e.cause&&(n+=` {
${J5(e.cause,`${t}  `)}
${t}}`),n},aw=class e extends globalThis.Error{span=void 0;constructor(t){let r=typeof t=="object"&&t!==null,n=Error.stackTraceLimit;Error.stackTraceLimit=1,super(lw(t),r&&"cause"in t&&typeof t.cause<"u"?{cause:new e(t.cause)}:void 0),this.message===""&&(this.message="An error has occurred"),Error.stackTraceLimit=n,this.name=t instanceof Error?t.name:"Error",r&&(Af in t&&(this.span=t[Af]),Object.keys(t).forEach(o=>{o in this||(this[o]=t[o])})),this.stack=Ixe(`${this.name}: ${this.message}`,t instanceof Error&&t.stack?t.stack:"",this.span)}},lw=e=>{if(typeof e=="string")return e;if(typeof e=="object"&&e!==null&&e instanceof Error)return e.message;try{if(F(e,"toString")&&ki(e.toString)&&e.toString!==Object.prototype.toString&&e.toString!==globalThis.Array.prototype.toString)return e.toString()}catch{}return Cg(e)},Txe=/\((.*)\)/g,Ib=ne("effect/Tracer/spanToTrace",()=>new WeakMap),Ixe=(e,t,r)=>{let n=[e],o=t.startsWith(e)?t.slice(e.length).split(`
`):t.split(`
`);for(let s=1;s<o.length;s++){if(o[s].includes(" at new BaseEffectError")||o[s].includes(" at new YieldableError")){s++;continue}if(o[s].includes("Generator.next")||o[s].includes("effect_internal_function"))break;n.push(o[s].replace(/at .*effect_instruction_i.*\((.*)\)/,"at $1").replace(/EffectPrimitive\.\w+/,"<anonymous>"))}if(r){let s=r,i=0;for(;s&&s._tag==="Span"&&i<10;){let a=Ib.get(s);if(typeof a=="function"){let c=a();if(typeof c=="string"){let l=c.matchAll(Txe),f=!1;for(let[,d]of l)f=!0,n.push(`    at ${s.name} (${d})`);f||n.push(`    at ${s.name} (${c.replace(/^at /,"")})`)}else n.push(`    at ${s.name}`)}else n.push(`    at ${s.name}`);s=yr(s.parent),i++}}return n.join(`
`)},Af=Symbol.for("effect/SpanAnnotation"),fw=e=>pw(e,void 0,{emptyCase:()=>[],dieCase:(t,r)=>[new aw(r)],failCase:(t,r)=>[new aw(r)],interruptCase:()=>[],parallelCase:(t,r,n)=>[...r,...n],sequentialCase:(t,r,n)=>[...r,...n]});var _p="Pending",Lf="Done";var Rxe="effect/Deferred",Y5=Symbol.for(Rxe),X5={_E:e=>e,_A:e=>e},e$=e=>({_tag:_p,joiners:e}),hv=e=>({_tag:Lf,effect:e});var kp=class e{self;called=!1;constructor(t){this.self=t}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new e(this.self)}};var Lc=(e,t)=>{let r=new Tr("Blocked");return r.effect_instruction_i0=e,r.effect_instruction_i1=t,r},yw=e=>{let t=new Tr("RunBlocked");return t.effect_instruction_i0=e,t},Uc=Symbol.for("effect/Effect"),dw=class{patch;op;_op=wg;constructor(t,r){this.patch=t,this.op=r}},Tr=class{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[Uc]=Ta;constructor(t){this._op=t}[H](t){return this===t}[W](){return ie(this,zu(this))}pipe(){return v(this,arguments)}toJSON(){return{_id:"Effect",_op:this._op,effect_instruction_i0:ve(this.effect_instruction_i0),effect_instruction_i1:ve(this.effect_instruction_i1),effect_instruction_i2:ve(this.effect_instruction_i2)}}toString(){return De(this.toJSON())}[he](){return this.toJSON()}[Symbol.iterator](){return new kp(new qs(this))}},hw=class{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[Uc]=Ta;constructor(t){this._op=t,this._tag=t}[H](t){return gm(t)&&t._op==="Failure"&&N(this.effect_instruction_i0,t.effect_instruction_i0)}[W](){return p(Ke(this._tag),K(M(this.effect_instruction_i0)),ie(this))}get cause(){return this.effect_instruction_i0}pipe(){return v(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,cause:this.cause.toJSON()}}toString(){return De(this.toJSON())}[he](){return this.toJSON()}[Symbol.iterator](){return new kp(new qs(this))}},mw=class{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[Uc]=Ta;constructor(t){this._op=t,this._tag=t}[H](t){return gm(t)&&t._op==="Success"&&N(this.effect_instruction_i0,t.effect_instruction_i0)}[W](){return p(Ke(this._tag),K(M(this.effect_instruction_i0)),ie(this))}get value(){return this.effect_instruction_i0}pipe(){return v(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,value:ve(this.value)}}toString(){return De(this.toJSON())}[he](){return this.toJSON()}[Symbol.iterator](){return new kp(new qs(this))}},et=e=>F(e,Uc),de=e=>{let t=new Tr(dE);return t.effect_instruction_i0=e,t},Sw=u(3,(e,t,r)=>er(n=>b(e,o=>b(pr(q(()=>n(t(o)))),s=>q(()=>r(o,s)).pipe(Gt({onFailure:i=>{switch(s._tag){case mt:return Re(Rt(s.effect_instruction_i0,i));case xt:return Re(i)}},onSuccess:()=>s})))))),tt=u(2,(e,t)=>b(e,()=>S(t))),Ct=e=>tt(e,void 0),vb=function(){let e=new Tr(uc);switch(arguments.length){case 2:{e.effect_instruction_i0=arguments[0],e.commit=arguments[1];break}case 3:{e.effect_instruction_i0=arguments[0],e.effect_instruction_i1=arguments[1],e.commit=arguments[2];break}case 4:{e.effect_instruction_i0=arguments[0],e.effect_instruction_i1=arguments[1],e.effect_instruction_i2=arguments[2],e.commit=arguments[3];break}default:throw new Error(ql("you're not supposed to end up here"))}return e},cm=(e,t=Dn)=>{let r=new Tr(Bl),n;return r.effect_instruction_i0=o=>{n=e(o)},r.effect_instruction_i1=t,io(r,o=>et(n)?n:ae)},Pb=(e,t=Dn)=>q(()=>cm(e,t)),oo=(e,t=Dn)=>vb(e,function(){let r,n;function o(c){r?r(c):n===void 0&&(n=c)}let s=new Tr(Bl);s.effect_instruction_i0=c=>{r=c,n&&c(n)},s.effect_instruction_i1=t;let i,a;return this.effect_instruction_i0.length!==1?(a=new AbortController,i=rt(()=>this.effect_instruction_i0(o,a.signal))):i=rt(()=>this.effect_instruction_i0(o)),i||a?io(s,c=>(a&&a.abort(),i??ae)):s});var La=u(2,(e,t)=>{let r=new Tr(mh);return r.effect_instruction_i0=e,r.effect_instruction_i1=t,r}),Ss=u(2,(e,t)=>Zr(e,{onFailure:t,onSuccess:S})),Fb=u(3,(e,t,r)=>La(e,n=>{let o=Gi(n);switch(o._tag){case"Left":return t(o.left)?r(o.left):Re(n);case"Right":return Re(o.right)}})),n$=u(2,(e,t)=>La(e,r=>{let n=Gi(r);switch(n._tag){case"Left":return p(t(n.left),_e(()=>Re(r)));case"Right":return Re(n.right)}})),o$=e=>de((t,r)=>e(Cb(r.runtimeFlags))),t$=Symbol.for("effect/OriginalAnnotation");var Ew=(e,t)=>X(t)?new Proxy(e,{has(r,n){return n===Af||n===t$||n in r},get(r,n){return n===Af?t.value:n===t$?e:r[n]}}):e,so=e=>$r(e)&&!(Af in e)?de(t=>Re(Nr(Ew(e,Pw(t))))):Re(Nr(e)),Ip=e=>qc(()=>Nr(new Iv(e))),Rp=e=>b(E(e),so),ei=e=>Zr(e,{onFailure:t=>S(V(t)),onSuccess:t=>S(Y(t))}),pr=e=>Nb(e,{onFailure:Be,onSuccess:ht}),ke=e=>$r(e)&&!(Af in e)?de(t=>Re(Vi(Ew(e,Pw(t))))):Re(Vi(e)),ti=e=>b(E(e),ke),Re=e=>{let t=new hw(mt);return t.effect_instruction_i0=e,t},qc=e=>b(E(e),Re),ri=de(e=>S(e.id())),jo=e=>de(t=>e(t.id())),b=u(2,(e,t)=>{let r=new Tr(xh);return r.effect_instruction_i0=e,r.effect_instruction_i1=t,r}),Ap=u(2,(e,t)=>b(e,r=>{let n=typeof t=="function"?t(r):t;return et(n)?n:T1(n)?cm(o=>{n.then(s=>o(S(s)),s=>o(ke(new xm(s,"An unknown error occurred in Effect.andThen"))))}):S(n)})),Cw=e=>{let t=new Tr("OnStep");return t.effect_instruction_i0=e,t},$o=e=>b(e,R),Mp=e=>Zr(e,{onFailure:S,onSuccess:ke}),Nb=u(2,(e,t)=>Gt(e,{onFailure:r=>S(t.onFailure(r)),onSuccess:r=>S(t.onSuccess(r))})),Gt=u(2,(e,t)=>{let r=new Tr(gh);return r.effect_instruction_i0=e,r.effect_instruction_i1=t.onFailure,r.effect_instruction_i2=t.onSuccess,r}),Zr=u(2,(e,t)=>Gt(e,{onFailure:r=>{if(Ff(r).length>0)return Re(Q5(r));let o=kb(r);return o.length>0?t.onFailure(ib(o)):Re(r)},onSuccess:t.onSuccess})),Un=u(2,(e,t)=>q(()=>{let r=Ee(e),n=Gl(r.length),o=0;return tt(Fp({while:()=>o<r.length,body:()=>t(r[o],o),step:s=>{n[o++]=s}}),n)})),Vo=u(2,(e,t)=>q(()=>{let r=Ee(e),n=0;return Fp({while:()=>n<r.length,body:()=>t(r[n],n),step:()=>{n++}})})),ww=u(e=>typeof e[0]=="boolean"||et(e[0]),(e,t)=>et(e)?b(e,r=>r?t.onTrue():t.onFalse()):e?t.onTrue():t.onFalse()),Xt=b(ri,e=>Db(e)),Db=e=>Re(To(e)),Ki=e=>{let t=new Tr(pc);return t.effect_instruction_i0=XM($i),t.effect_instruction_i1=()=>e,t},s$=e=>vb(e,function(){let t=new Tr(pc);return t.effect_instruction_i0=XM($i),t.effect_instruction_i1=r=>Cb(r)?rt(()=>this.effect_instruction_i0(Ki)):rt(()=>this.effect_instruction_i0(Go)),t}),Ua=u(2,(e,t)=>er(r=>b(pr(r(e)),n=>Fv(t,n)))),k=u(2,(e,t)=>b(e,r=>E(()=>t(r)))),Lb=u(2,(e,t)=>Zr(e,{onFailure:r=>ti(()=>t.onFailure(r)),onSuccess:r=>E(()=>t.onSuccess(r))})),vp=u(2,(e,t)=>Gt(e,{onFailure:r=>{let n=Gi(r);switch(n._tag){case"Left":return ti(()=>t(n.left));case"Right":return Re(n.right)}},onSuccess:S})),Ow=u(2,(e,t)=>Io(e,r=>Kb(r)?ae:t(r.effect_instruction_i0))),Io=u(2,(e,t)=>er(r=>Gt(r(e),{onFailure:n=>{let o=Be(n);return Gt(t(o),{onFailure:s=>Be(Rt(n,s)),onSuccess:()=>o})},onSuccess:n=>{let o=ht(n);return we(t(o),o)}}))),io=u(2,(e,t)=>Io(e,Vf({onFailure:r=>Pf(r)?Ct(t(Nf(r))):ae,onSuccess:()=>ae}))),Uf=u(2,(e,t)=>Mxe(e,t,S)),qf=e=>Sv(e,R),Sv=u(2,(e,t)=>Zr(e,{onFailure:r=>so(t(r)),onSuccess:S})),i$=pR,um=de((e,t)=>S(t.runtimeFlags)),S=e=>{let t=new mw(xt);return t.effect_instruction_i0=e,t},q=e=>{let t=new Tr(uc);return t.commit=e,t},E=e=>{let t=new Tr(fE);return t.effect_instruction_i0=e,t},Dr=u(e=>e.length===3||e.length===2&&!($r(e[1])&&"onlyEffect"in e[1]),(e,t)=>b(e,r=>{let n=typeof t=="function"?t(r):t;return et(n)?tt(n,r):T1(n)?cm(o=>{n.then(s=>o(S(r)),s=>o(ke(new xm(s,"An unknown error occurred in Effect.tap"))))}):S(r)})),_w=e=>de(t=>{let r=t.getFiberRef(Mb),n=p(r,_e(()=>t.scope()));return e(Lt(Mb,x(n)))}),Mxe=u(3,(e,t,r)=>Gt(e,{onFailure:n=>Ff(n).length>0?Re(vg(K5(n))):t(),onSuccess:r})),Go=e=>{let t=new Tr(pc);return t.effect_instruction_i0=ev($i),t.effect_instruction_i1=()=>e,t},er=e=>vb(e,function(){let t=new Tr(pc);return t.effect_instruction_i0=ev($i),t.effect_instruction_i1=r=>Cb(r)?rt(()=>this.effect_instruction_i0(Ki)):rt(()=>this.effect_instruction_i0(Go)),t}),ae=S(void 0);var Pp=e=>{let t=new Tr(pc);return t.effect_instruction_i0=e,t.effect_instruction_i1=void 0,t},Qi=u(2,(e,t)=>b(t,r=>r?p(e,k(x)):S(g()))),Fp=e=>{let t=new Tr(bh);return t.effect_instruction_i0=e.while,t.effect_instruction_i1=e.body,t.effect_instruction_i2=e.step,t},Ab=e=>q(()=>{let t=new Tr(zl);return t.effect_instruction_i0=e(),t}),kw=function(){let e=arguments.length===1?arguments[0]:arguments[1].bind(arguments[0]);return Ab(()=>e(p))},pm=(e,...t)=>Object.defineProperty(t.length===0?function(...r){return Ab(()=>e.apply(this,r))}:function(...r){let n=Ab(()=>e.apply(this,r));for(let o of t)n=o(n,...r);return n},"length",{value:e.length,configurable:!0}),a$=u(2,(e,t)=>Lt(e,Bb,t)),c$=u(2,(e,t)=>Lt(e,fm,t)),Tw=u(2,(e,t)=>{let r=new Tr(pc);return r.effect_instruction_i0=t,r.effect_instruction_i1=()=>e,r}),u$=u(2,(e,t)=>Lt(e,hm,t)),p$=u(2,(e,t)=>Lt(e,Ba,t)),qa=e=>{let t=new Tr(yh);return typeof e?.priority<"u"?Tv(t,e.priority):t},Hf=u(2,(e,t)=>b(e,r=>k(t,n=>[r,n])));var Wf=u(2,(e,t)=>b(e,r=>tt(t,r))),we=u(2,(e,t)=>b(e,()=>t)),Ha=u(3,(e,t,r)=>b(e,n=>k(t,o=>r(n,o)))),Np=Pb(()=>{let e=setInterval(()=>{},2147483647);return E(()=>clearInterval(e))}),Hc=e=>b(ri,t=>p(e,Ko(t))),Ko=u(2,(e,t)=>b(e.interruptAsFork(t),()=>e.await)),Ev={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER,pipe(){return v(this,arguments)}},Cv={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:5e4,pipe(){return v(this,arguments)}},wv={_tag:"Error",syslog:3,label:"ERROR",ordinal:4e4,pipe(){return v(this,arguments)}},Iw={_tag:"Warning",syslog:4,label:"WARN",ordinal:3e4,pipe(){return v(this,arguments)}},lm={_tag:"Info",syslog:6,label:"INFO",ordinal:2e4,pipe(){return v(this,arguments)}},Rw={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4,pipe(){return v(this,arguments)}},Ov={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0,pipe(){return v(this,arguments)}},_v={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER,pipe(){return v(this,arguments)}},l$=[Ev,Ov,Rw,lm,Iw,wv,Cv,_v],vxe="effect/FiberRef",f$=Symbol.for(vxe),Pxe={_A:e=>e},Ro=e=>de(t=>ht(t.getFiberRef(e)));var Hr=u(2,(e,t)=>b(Ro(e),t)),Tp=u(2,(e,t)=>d$(e,()=>[void 0,t]));var d$=u(2,(e,t)=>de(r=>{let[n,o]=t(r.getFiberRef(e));return r.setFiberRef(e,o),S(n)}));var Fxe="effect/RequestResolver",h$=Symbol.for(Fxe),Nxe={_A:e=>e,_R:e=>e},r$=class e{runAll;target;[h$]=Nxe;constructor(t,r){this.runAll=t,this.target=r}[W](){return ie(this,this.target?M(this.target):zu(this))}[H](t){return this.target?Dxe(t)&&N(this.target,t.target):this===t}identified(...t){return new e(this.runAll,pt(t))}pipe(){return v(this,arguments)}},Dxe=e=>F(e,h$);var Lt=u(3,(e,t,r)=>Sw(Wf(Ro(t),Tp(t,r)),()=>e,n=>Tp(t,n))),Yr=u(3,(e,t,r)=>Hr(t,n=>Lt(e,t,r(n)))),lr=(e,t)=>Dp(e,{differ:ZC(),fork:t?.fork??R,join:t?.join}),kv=e=>{let t=jM();return Dp(e,{differ:t,fork:t.empty})},Lxe=e=>{let t=$M(ZC());return Dp(e,{differ:t,fork:t.empty})},Ub=e=>{let t=zM();return Dp(e,{differ:t,fork:t.empty})},Dp=(e,t)=>({...Ti,[f$]:Pxe,initial:e,commit(){return Ro(this)},diff:(n,o)=>t.differ.diff(n,o),combine:(n,o)=>t.differ.combine(n,o),patch:n=>o=>t.differ.patch(n,o),fork:t.fork,join:t.join??((n,o)=>o)}),m$=e=>Dp(e,{differ:YM,fork:YM.empty}),Xr=ne(Symbol.for("effect/FiberRef/currentContext"),()=>Ub(Cn())),Ji=ne(Symbol.for("effect/FiberRef/currentSchedulingPriority"),()=>lr(0)),qb=ne(Symbol.for("effect/FiberRef/currentMaxOpsBeforeYield"),()=>lr(2048)),Wa=ne(Symbol.for("effect/FiberRef/currentLogAnnotation"),()=>lr(Pc())),Hb=ne(Symbol.for("effect/FiberRef/currentLogLevel"),()=>lr(lm)),Wb=ne(Symbol.for("effect/FiberRef/currentLogSpan"),()=>lr(Ys())),Tv=u(2,(e,t)=>Lt(e,Ji,t)),x$=u(2,(e,t)=>Lt(e,qb,t)),Bb=ne(Symbol.for("effect/FiberRef/currentConcurrency"),()=>lr("unbounded")),fm=ne(Symbol.for("effect/FiberRef/currentRequestBatching"),()=>lr(!0)),dm=ne(Symbol.for("effect/FiberRef/currentUnhandledErrorLogLevel"),()=>lr(x(Rw))),zb=ne(Symbol.for("effect/FiberRef/versionMismatchErrorLogLevel"),()=>lr(x(Iw))),g$=u(2,(e,t)=>Lt(e,dm,t)),ni=ne(Symbol.for("effect/FiberRef/currentMetricLabels"),()=>Lxe(ds())),b$=Ro(ni),Mb=ne(Symbol.for("effect/FiberRef/currentForkScopeOverride"),()=>lr(g(),{fork:()=>g(),join:(e,t)=>e})),Lp=ne(Symbol.for("effect/FiberRef/currentInterruptedCause"),()=>lr(Ln,{fork:()=>Ln,join:(e,t)=>e})),hm=ne(Symbol.for("effect/FiberRef/currentTracerEnabled"),()=>lr(!0)),Ba=ne(Symbol.for("effect/FiberRef/currentTracerTiming"),()=>lr(!0)),Bf=ne(Symbol.for("effect/FiberRef/currentTracerSpanAnnotations"),()=>lr(Pc())),jb=ne(Symbol.for("effect/FiberRef/currentTracerSpanLinks"),()=>lr(ee())),$b=Symbol.for("effect/Scope"),Vb=Symbol.for("effect/CloseableScope"),mm=(e,t)=>e.addFinalizer(()=>Ct(t)),Up=(e,t)=>e.addFinalizer(t),Zi=(e,t)=>e.close(t),Es=(e,t)=>e.fork(t),y$=e=>S$(R)(e),S$=u(2,(e,t)=>{let r=p(e,cw,ct(t));switch(r._tag){case"None":return p(Ff(e),va,$({onNone:()=>{let n=Ee(Nf(e)).flatMap(o=>Ee(PM(o)).map(s=>`#${s}`));return new C$(n?`Interrupted by fibers: ${n.join(", ")}`:void 0)},onSome:R}));case"Some":return r.value}}),Gb=(function(){class e extends globalThis.Error{commit(){return ke(this)}toJSON(){let r={...this};return this.message&&(r.message=this.message),this.cause&&(r.cause=this.cause),r}[he](){return this.toString!==globalThis.Error.prototype.toString?this.stack?`${this.toString()}
${this.stack.split(`
`).slice(1).join(`
`)}`:this.toString():"Bun"in globalThis?zo(Vi(this),{renderErrorCause:!0}):this}}return Object.assign(e.prototype,N1),e})(),zf=(e,t)=>{class r extends Gb{_tag=t}return Object.assign(r.prototype,e),r.prototype.name=t,r},xw=Symbol.for("effect/Cause/errors/RuntimeException"),Iv=zf({[xw]:xw},"RuntimeException"),E$=e=>F(e,xw),gw=Symbol.for("effect/Cause/errors/InterruptedException"),C$=zf({[gw]:gw},"InterruptedException"),Rv=e=>F(e,gw),mv=Symbol.for("effect/Cause/errors/IllegalArgument"),jf=zf({[mv]:mv},"IllegalArgumentException");var bw=Symbol.for("effect/Cause/errors/NoSuchElement"),Ao=zf({[bw]:bw},"NoSuchElementException"),Av=e=>F(e,bw),xv=Symbol.for("effect/Cause/errors/InvalidPubSubCapacityException"),w$=zf({[xv]:xv},"InvalidPubSubCapacityException"),gv=Symbol.for("effect/Cause/errors/ExceededCapacityException"),Uxe=zf({[gv]:gv},"ExceededCapacityException");var bv=Symbol.for("effect/Cause/errors/Timeout"),O$=zf({[bv]:bv},"TimeoutException"),_$=e=>new O$(`Operation timed out after '${dM(e)}'`);var yv=Symbol.for("effect/Cause/errors/UnknownException"),xm=(function(){class e extends Gb{_tag="UnknownException";error;constructor(r,n){super(n??"An unknown error occurred",{cause:r}),this.error=r}}return Object.assign(e.prototype,{[yv]:yv,name:"UnknownException"}),e})();var gm=e=>et(e)&&"_tag"in e&&(e._tag==="Success"||e._tag==="Failure"),Aw=e=>e._tag==="Failure",Kb=e=>e._tag==="Success",k$=e=>{switch(e._tag){case mt:return am(e.effect_instruction_i0);case xt:return!1}},Mv=u(2,(e,t)=>{switch(e._tag){case mt:return Be(e.effect_instruction_i0);case xt:return ht(t)}}),bm=e=>Mv(e,void 0),T$=e=>{switch(e._tag){case mt:return x(e.effect_instruction_i0);case xt:return g()}},qp=(e,t)=>qxe(e,t?.parallel?Jr:Rt),Mw=e=>Be(Nr(e)),I$=u(2,(e,t)=>{switch(e._tag){case mt:return!1;case xt:return t(e.effect_instruction_i0)}}),Hp=e=>Be(Vi(e)),Be=e=>{let t=new hw(mt);return t.effect_instruction_i0=e,t},vv=u(2,(e,t)=>{switch(e._tag){case mt:return Be(e.effect_instruction_i0);case xt:return t(e.effect_instruction_i0)}}),R$=u(2,(e,t)=>{switch(e._tag){case mt:return S(Be(e.effect_instruction_i0));case xt:return t(e.effect_instruction_i0)}}),A$=e=>p(e,vv(R)),M$=u(2,(e,t)=>{switch(e._tag){case mt:return S(Be(e.effect_instruction_i0));case xt:return pr(t(e.effect_instruction_i0))}}),v$=e=>{switch(e._tag){case"Left":return Hp(e.left);case"Right":return ht(e.right)}},P$=e=>{switch(e._tag){case"None":return Hp(void 0);case"Some":return ht(e.value)}},F$=u(2,(e,t)=>{switch(e._tag){case mt:return t(e.effect_instruction_i0);case xt:return e.effect_instruction_i0}}),$f=e=>Be(To(e)),Rb=u(2,(e,t)=>{switch(e._tag){case mt:return Be(e.effect_instruction_i0);case xt:return ht(t(e.effect_instruction_i0))}}),N$=u(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case mt:return Be(p(e.effect_instruction_i0,Tb(t)));case xt:return ht(r(e.effect_instruction_i0))}}),D$=u(2,(e,t)=>{switch(e._tag){case mt:return Be(p(e.effect_instruction_i0,Tb(t)));case xt:return ht(e.effect_instruction_i0)}}),L$=u(2,(e,t)=>{switch(e._tag){case mt:return Be(t(e.effect_instruction_i0));case xt:return ht(e.effect_instruction_i0)}}),Vf=u(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case mt:return t(e.effect_instruction_i0);case xt:return r(e.effect_instruction_i0)}}),Gf=u(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case mt:return t(e.effect_instruction_i0);case xt:return r(e.effect_instruction_i0)}}),ht=e=>{let t=new mw(xt);return t.effect_instruction_i0=e,t},en=ht(void 0),U$=u(2,(e,t)=>oi(e,t,{onSuccess:(r,n)=>[r,n],onFailure:Rt})),q$=u(2,(e,t)=>oi(e,t,{onSuccess:(r,n)=>r,onFailure:Rt})),H$=u(2,(e,t)=>oi(e,t,{onSuccess:(r,n)=>n,onFailure:Rt})),W$=u(2,(e,t)=>oi(e,t,{onSuccess:(r,n)=>[r,n],onFailure:Jr})),B$=u(2,(e,t)=>oi(e,t,{onSuccess:(r,n)=>r,onFailure:Jr})),z$=u(2,(e,t)=>oi(e,t,{onSuccess:(r,n)=>n,onFailure:Jr})),oi=u(3,(e,t,{onFailure:r,onSuccess:n})=>{switch(e._tag){case mt:switch(t._tag){case xt:return Be(e.effect_instruction_i0);case mt:return Be(r(e.effect_instruction_i0,t.effect_instruction_i0))}case xt:switch(t._tag){case xt:return ht(n(e.effect_instruction_i0,t.effect_instruction_i0));case mt:return Be(t.effect_instruction_i0)}}}),qxe=(e,t)=>{let r=pt(e);return Vt(r)?p(ro(r),mc(p(wn(r),Rb(G)),(n,o)=>p(n,oi(o,{onSuccess:(s,i)=>p(s,Et(i)),onFailure:t}))),Rb(gs),Rb(n=>Zt(n)),x):g()},Yi=e=>({...Ti,[Y5]:X5,state:ko(e$([])),commit(){return Ut(this)},blockingOn:e}),an=()=>b(ri,e=>j$(e)),j$=e=>E(()=>Yi(e)),Ut=e=>Pb(t=>{let r=Ie(e.state);switch(r._tag){case Lf:return t(r.effect);case _p:return r.joiners.push(t),Hxe(e,t)}},e.blockingOn),Pv=u(2,(e,t)=>Ua(t,e)),Kf=u(2,(e,t)=>E(()=>{let r=Ie(e.state);switch(r._tag){case Lf:return!1;case _p:{Nn(e.state,hv(t));for(let n=0,o=r.joiners.length;n<o;n++)r.joiners[n](t);return!0}}})),Fv=u(2,(e,t)=>Kf(e,t)),$$=u(2,(e,t)=>Kf(e,ke(t)));var ym=u(2,(e,t)=>Kf(e,Re(t)));var V$=e=>b(ri,t=>Kf(e,Db(t))),Qf=u(2,(e,t)=>Kf(e,Db(t))),G$=e=>E(()=>Ie(e.state)._tag===Lf),K$=e=>E(()=>{let t=Ie(e.state);switch(t._tag){case Lf:return x(t.effect);case _p:return g()}}),Wc=u(2,(e,t)=>Kf(e,S(t)));var za=(e,t)=>{let r=Ie(e.state);if(r._tag===_p){Nn(e.state,hv(t));for(let n=0,o=r.joiners.length;n<o;n++)r.joiners[n](t)}},Hxe=(e,t)=>E(()=>{let r=Ie(e.state);if(r._tag===_p){let n=r.joiners.indexOf(t);n>=0&&r.joiners.splice(n,1)}}),Wxe=de(e=>ht(e.currentContext)),Cs=()=>Wxe;var si=e=>b(Cs(),e),ws=u(2,(e,t)=>Lt(Xr,t)(e)),vw=u(2,(e,t)=>Yr(Xr,r=>_o(r,t))(e)),Jf=u(2,(e,t)=>si(r=>ws(e,t(r)))),Nv=u(2,(e,t)=>b(e,r=>b(t.predicate(r),n=>n?S(r):t.orElse(r)))),Q$=u(2,(e,t)=>Nv(e,{predicate:t.predicate,orElse:r=>ke(t.orFailWith(r))})),Pw=e=>{let t=e.currentSpan;return t!==void 0&&t._tag==="Span"?x(t):g()},Bxe={_tag:"Span",spanId:"noop",traceId:"noop",sampled:!1,status:{_tag:"Ended",startTime:BigInt(0),endTime:BigInt(0),exit:en},attributes:new Map,links:[],kind:"internal",attribute(){},event(){},end(){},addLinks(){}},J$=e=>Object.assign(Object.create(Bxe),e);var wt=an;var We=Ut;var Z$=Fv,Y$=$$;var Zf=ym;var X$=V$;var Qb=G$,e8=K$,Cr=Wc;var Dv=Yi,t8=za;var tn={};Xn(tn,{all:()=>Lv,as:()=>jxe,asVoid:()=>$xe,causeOption:()=>Vxe,die:()=>zc,exists:()=>Gxe,fail:()=>At,failCause:()=>st,flatMap:()=>Kxe,flatMapEffect:()=>Qxe,flatten:()=>Uv,forEachEffect:()=>r8,fromEither:()=>Jxe,fromOption:()=>Zxe,getOrElse:()=>Yxe,interrupt:()=>qv,isExit:()=>Jb,isFailure:()=>Bc,isInterrupted:()=>zxe,isSuccess:()=>Xi,map:()=>Sm,mapBoth:()=>Fw,mapError:()=>Xxe,mapErrorCause:()=>ege,match:()=>qt,matchEffect:()=>n8,succeed:()=>xe,void:()=>Bp,zip:()=>Nw,zipLeft:()=>tge,zipPar:()=>rge,zipParLeft:()=>nge,zipParRight:()=>oge,zipRight:()=>zp,zipWith:()=>sge});var Jb=gm,Bc=Aw,Xi=Kb,zxe=k$,jxe=Mv,$xe=bm,Vxe=T$,Lv=qp,zc=Mw,Gxe=I$,At=Hp,st=Be,Kxe=vv,Qxe=R$,Uv=A$,r8=M$,Jxe=v$,Zxe=P$,Yxe=F$,qv=$f,Sm=Rb,Fw=N$,Xxe=D$,ege=L$,qt=Vf,n8=Gf,xe=ht,Bp=en;var Nw=U$,tge=q$,zp=H$,rge=W$,nge=B$,oge=z$,sge=oi;var o8=Symbol.for("effect/MutableHashMap"),ige={[o8]:o8,[Symbol.iterator](){return new Hv(this)},toString(){return De(this.toJSON())},toJSON(){return{_id:"MutableHashMap",values:Array.from(this).map(ve)}},[he](){return this.toJSON()},pipe(){return v(this,arguments)}},Hv=class e{self;referentialIterator;bucketIterator;constructor(t){this.self=t,this.referentialIterator=t.referential[Symbol.iterator]()}next(){if(this.bucketIterator!==void 0)return this.bucketIterator.next();let t=this.referentialIterator.next();return t.done?(this.bucketIterator=new Wv(this.self.buckets.values()),this.next()):t}[Symbol.iterator](){return new e(this.self)}},Wv=class{backing;constructor(t){this.backing=t}currentBucket;next(){if(this.currentBucket===void 0){let r=this.backing.next();if(r.done)return r;this.currentBucket=r.value[Symbol.iterator]()}let t=this.currentBucket.next();return t.done?(this.currentBucket=void 0,this.next()):t}},Yf=()=>{let e=Object.create(ige);return e.referential=new Map,e.buckets=new Map,e.bucketsSize=0,e};var Wr=u(2,(e,t)=>{if(ju(t)===!1)return e.referential.has(t)?x(e.referential.get(t)):g();let r=t[W](),n=e.buckets.get(r);return n===void 0?g():age(e,n,t)});var age=(e,t,r,n=!1)=>{for(let o=0,s=t.length;o<s;o++)if(r[H](t[o][0])){let i=t[o][1];return n&&(t.splice(o,1),e.bucketsSize--),x(i)}return g()},ea=u(2,(e,t)=>X(Wr(e,t))),Qo=u(3,(e,t,r)=>{if(ju(t)===!1)return e.referential.set(t,r),e;let n=t[W](),o=e.buckets.get(n);return o===void 0?(e.buckets.set(n,[[t,r]]),e.bucketsSize++,e):(s8(e,o,t),o.push([t,r]),e.bucketsSize++,e)}),s8=(e,t,r)=>{for(let n=0,o=t.length;n<o;n++)if(r[H](t[n][0])){t.splice(n,1),e.bucketsSize--;return}};var Xf=u(2,(e,t)=>{if(ju(t)===!1)return e.referential.delete(t),e;let r=t[W](),n=e.buckets.get(r);return n===void 0||(s8(e,n,t),n.length===0&&e.buckets.delete(r)),e});var Dw=e=>e.referential.size+e.bucketsSize;var i8=Symbol.for("effect/MutableList"),cge={[i8]:i8,[Symbol.iterator](){let e=!1,t=this.head;return{next(){if(e)return this.return();if(t==null)return e=!0,this.return();let r=t.value;return t=t.next,{done:e,value:r}},return(r){return e||(e=!0),{done:!0,value:r}}}},toString(){return De(this.toJSON())},toJSON(){return{_id:"MutableList",values:Array.from(this).map(ve)}},[he](){return this.toJSON()},pipe(){return v(this,arguments)}},uge=e=>({value:e,removed:!1,prev:void 0,next:void 0}),a8=()=>{let e=Object.create(cge);return e.head=void 0,e.tail=void 0,e._length=0,e};var Bv=e=>Uw(e)===0,Uw=e=>e._length;var c8=u(2,(e,t)=>{let r=uge(t);return e.head===void 0&&(e.head=r),e.tail===void 0||(e.tail.next=r,r.prev=e.tail),e.tail=r,e._length+=1,e}),u8=e=>{let t=e.head;if(t!==void 0)return pge(e,t),t.value};var pge=(e,t)=>{t.removed||(t.removed=!0,t.prev!==void 0&&t.next!==void 0?(t.prev.next=t.next,t.next.prev=t.prev):t.prev!==void 0?(e.tail=t.prev,t.prev.next=void 0):t.next!==void 0?(e.head=t.next,t.next.prev=void 0):(e.tail=void 0,e.head=void 0),e._length>0&&(e._length-=1))};var l8=Symbol.for("effect/MutableQueue"),Mt=Symbol.for("effect/mutable/MutableQueue/Empty"),lge={[l8]:l8,[Symbol.iterator](){return Array.from(this.queue)[Symbol.iterator]()},toString(){return De(this.toJSON())},toJSON(){return{_id:"MutableQueue",values:Array.from(this).map(ve)}},[he](){return this.toJSON()},pipe(){return v(this,arguments)}},f8=e=>{let t=Object.create(lge);return t.queue=a8(),t.capacity=e,t},qw=e=>f8(e),jc=()=>f8(void 0),Hw=e=>Uw(e.queue),$c=e=>Bv(e.queue);var d8=e=>e.capacity===void 0?1/0:e.capacity,ii=u(2,(e,t)=>{let r=Uw(e.queue);return e.capacity!==void 0&&r===e.capacity?!1:(c8(t)(e.queue),!0)}),Zb=u(2,(e,t)=>{let r=t[Symbol.iterator](),n,o=ee(),s=!0;for(;s&&(n=r.next())&&!n.done;)s=ii(n.value)(e);for(;n!=null&&!n.done;)o=Et(n.value)(o),n=r.next();return gs(o)}),Jo=u(2,(e,t)=>Bv(e.queue)?t:u8(e.queue)),Em=u(2,(e,t)=>{let r=ee(),n=0;for(;n<t;){let o=Jo(Mt)(e);if(o===Mt)break;r=Et(o)(r),n+=1}return gs(r)});var fge="effect/Clock",zv=Symbol.for(fge),Mo=on("effect/Clock"),dge=2**31-1,h8={unsafeSchedule(e,t){let r=Qr(t);if(r>dge)return ls;let n=!1,o=setTimeout(()=>{n=!0,e()},r);return()=>(clearTimeout(o),!n)}},m8=(function(){let e=BigInt(1e6);if(typeof performance>"u")return()=>BigInt(Date.now())*e;let t;return()=>(t===void 0&&(t=BigInt(Date.now())*e-BigInt(Math.round(performance.now()*1e6))),t+BigInt(Math.round(performance.now()*1e6)))})(),hge=(function(){let e=typeof process=="object"&&"hrtime"in process&&typeof process.hrtime.bigint=="function"?process.hrtime:void 0;if(!e)return m8;let t=m8()-e.bigint();return()=>t+e.bigint()})(),jv=class{[zv]=zv;unsafeCurrentTimeMillis(){return Date.now()}unsafeCurrentTimeNanos(){return hge()}currentTimeMillis=E(()=>this.unsafeCurrentTimeMillis());currentTimeNanos=E(()=>this.unsafeCurrentTimeNanos());scheduler(){return S(h8)}sleep(t){return oo(r=>{let n=h8.unsafeSchedule(()=>r(ae),t);return Ct(E(n))})}},$v=()=>new jv;var Gv="InvalidData",Kv="MissingData",Qv="SourceUnavailable",Jv="Unsupported";var xge="effect/ConfigError",Zv=Symbol.for(xge),Cm={_tag:"ConfigError",[Zv]:Zv},Bw=(e,t)=>{let r=Object.create(Cm);return r._op="And",r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),Object.defineProperty(r,"message",{enumerable:!1,get(){return this.toString()}}),r},zw=(e,t)=>{let r=Object.create(Cm);return r._op="Or",r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),Object.defineProperty(r,"message",{enumerable:!1,get(){return this.toString()}}),r},Yv=(e,t,r={pathDelim:"."})=>{let n=Object.create(Cm);return n._op=Gv,n.path=e,n.message=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`(Invalid data at ${p(this.path,xc(r.pathDelim))}: "${this.message}")`}}),n},ja=(e,t,r={pathDelim:"."})=>{let n=Object.create(Cm);return n._op=Kv,n.path=e,n.message=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`(Missing data at ${p(this.path,xc(r.pathDelim))}: "${this.message}")`}}),n},b8=(e,t,r,n={pathDelim:"."})=>{let o=Object.create(Cm);return o._op=Qv,o.path=e,o.message=t,o.cause=r,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Source unavailable at ${p(this.path,xc(n.pathDelim))}: "${this.message}")`}}),o},y8=(e,t,r={pathDelim:"."})=>{let n=Object.create(Cm);return n._op=Jv,n.path=e,n.message=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`(Unsupported operation at ${p(this.path,xc(r.pathDelim))}: "${this.message}")`}}),n};var Vc=u(2,(e,t)=>{switch(e._op){case"And":return Bw(Vc(e.left,t),Vc(e.right,t));case"Or":return zw(Vc(e.left,t),Vc(e.right,t));case Gv:return Yv([...t,...e.path],e.message);case Kv:return ja([...t,...e.path],e.message);case Qv:return b8([...t,...e.path],e.message,e.cause);case Jv:return y8([...t,...e.path],e.message)}});var S8={_tag:"Empty"};var jw=u(2,(e,t)=>{let r=xb(t),n=e;for(;Of(r);){let o=r.head;switch(o._tag){case"Empty":{r=r.tail;break}case"AndThen":{r=Fc(o.first,Fc(o.second,r.tail));break}case"MapName":{n=Mi(n,o.f),r=r.tail;break}case"Nested":{n=Rh(n,o.name),r=r.tail;break}case"Unnested":{if(p(Ia(n),J1(o.name)))n=Ai(n),r=r.tail;else return V(ja(n,`Expected ${o.name} to be in path in ConfigProvider#unnested`));break}}}return Y(n)});var eP="Constant",tP="Fail",rP="Fallback",nP="Described",oP="Lazy",$w="MapOrFail",Vw="Nested",Gw="Primitive",sP="Sequence",iP="HashMap",aP="ZipWith";var Kw=(e,t)=>[...e,...t],bge="effect/ConfigProvider",C8=Symbol.for(bge),wm=on("effect/ConfigProvider"),yge="effect/ConfigProviderFlat",w8=Symbol.for(yge),Sge=e=>({[C8]:C8,pipe(){return v(this,arguments)},...e}),Ege=e=>({[w8]:w8,patch:e.patch,load:(t,r,n=!0)=>e.load(t,r,n),enumerateChildren:e.enumerateChildren}),Cge=e=>Sge({load:t=>b(ai(e,ds(),t,!1),r=>$(Ia(r),{onNone:()=>ke(ja(ds(),`Expected a single value having structure: ${t}`)),onSome:S})),flattened:e}),O8=e=>{let{pathDelim:t,seqDelim:r}=Object.assign({},{pathDelim:"_",seqDelim:","},e),n=c=>p(c,xc(t)),o=c=>c.split(t),s=()=>typeof process<"u"&&"env"in process&&typeof process.env=="object"?process.env:{};return Cge(Ege({load:(c,l,f=!0)=>{let d=n(c),h=s(),m=d in h?x(h[d]):g();return p(m,vp(()=>ja(c,`Expected ${d} to exist in the process context`)),b(y=>Tge(y,c,l,r,f)))},enumerateChildren:c=>E(()=>{let l=s(),h=Object.keys(l).map(m=>o(m.toUpperCase())).filter(m=>{for(let y=0;y<c.length;y++){let _=p(c,rR(y)),C=m[y];if(C===void 0||_!==C)return!1}return!0}).flatMap(m=>m.slice(c.length,c.length+1));return mp(h)}),patch:S8}))};var wge=(e,t,r,n)=>{let o=lR(r.length,c=>c>=n.length?g():x([e(c),c+1])),s=lR(n.length,c=>c>=r.length?g():x([t(c),c+1])),i=Kw(r,o),a=Kw(n,s);return[i,a]},Oge=(e,t)=>{let r=t;if(r._tag==="Nested"){let n=e.slice();for(;r._tag==="Nested";)n.push(r.name),r=r.config;return n}return e},ai=(e,t,r,n)=>{let o=r;switch(o._tag){case eP:return S(Gr(o.value));case nP:return q(()=>ai(e,t,o.config,n));case tP:return ke(ja(t,o.message));case rP:return p(q(()=>ai(e,t,o.first,n)),Ss(s=>o.condition(s)?p(ai(e,t,o.second,n),Ss(i=>ke(zw(s,i)))):ke(s)));case oP:return q(()=>ai(e,t,o.config(),n));case $w:return q(()=>p(ai(e,t,o.original,n),b(Un(s=>p(o.mapOrFail(s),vp(Vc(Oge(t,o.original))))))));case Vw:return q(()=>ai(e,Kw(t,Gr(o.name)),o.config,n));case Gw:return p(jw(t,e.patch),b(s=>p(e.load(s,o,n),b(i=>{if(i.length===0){let a=p(_E(s),_e(()=>"<n/a>"));return ke(ja([],`Expected ${o.description} with name ${a}`))}return S(i)}))));case sP:return p(jw(t,e.patch),b(s=>p(e.enumerateChildren(s),b(Rge),b(i=>i.length===0?q(()=>k(ai(e,t,o.config,!0),Gr)):p(Un(i,a=>ai(e,Tz(t,`[${a}]`),o.config,!0)),k(a=>{let c=Mh(a);return c.length===0?Gr(ds()):Gr(c)}))))));case iP:return q(()=>p(jw(t,e.patch),b(s=>p(e.enumerateChildren(s),b(i=>p(i,Un(a=>ai(e,Kw(s,Gr(a)),o.valueConfig,n)),k(a=>a.length===0?Gr(Pc()):p(Ige(a),Mi(c=>rm(sR(Ee(i),c)))))))))));case aP:return q(()=>p(ai(e,t,o.left,n),ei,b(s=>p(ai(e,t,o.right,n),ei,b(i=>{if(kt(s)&&kt(i))return ke(Bw(s.left,i.left));if(kt(s)&&Wo(i))return ke(s.left);if(Wo(s)&&kt(i))return ke(i.left);if(Wo(s)&&Wo(i)){let a=p(t,xc(".")),c=_ge(t,a),[l,f]=wge(c,c,p(s.right,Mi(Y)),p(i.right,Mi(Y)));return p(l,sR(f),Un(([d,h])=>p(Hf(d,h),k(([m,y])=>o.zip(m,y)))))}throw new Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/effect/issues")})))))}},_ge=(e,t)=>r=>V(ja(e,`The element at index ${r} in a sequence at path "${t}" was missing`));var kge=(e,t)=>e.split(new RegExp(`\\s*${Hh(t)}\\s*`)),Tge=(e,t,r,n,o)=>o?p(kge(e,n),Un(s=>r.parse(s.trim())),vp(Vc(t))):p(r.parse(e),Lb({onFailure:Vc(t),onSuccess:Gr})),Ige=e=>Object.keys(e[0]).map(t=>e.map(r=>r[t])),Rge=e=>p(Un(e,Mge),Lb({onFailure:()=>ds(),onSuccess:dc(Ni)}),ei,k(bE));var Age=/^(\[(\d+)\])$/,Mge=e=>{let t=e.match(Age);if(t!==null){let r=t[2];return p(r!==void 0&&r.length>0?x(r):g(),kr(vge))}return g()};var vge=e=>{let t=Number.parseInt(e);return Number.isNaN(t)?g():x(t)};var _8=Symbol.for("effect/Console"),Zo=on("effect/Console"),k8={[_8]:_8,assert(e,...t){return E(()=>{console.assert(e,...t)})},clear:E(()=>{console.clear()}),count(e){return E(()=>{console.count(e)})},countReset(e){return E(()=>{console.countReset(e)})},debug(...e){return E(()=>{console.debug(...e)})},dir(e,t){return E(()=>{console.dir(e,t)})},dirxml(...e){return E(()=>{console.dirxml(...e)})},error(...e){return E(()=>{console.error(...e)})},group(e){return e?.collapsed?E(()=>console.groupCollapsed(e?.label)):E(()=>console.group(e?.label))},groupEnd:E(()=>{console.groupEnd()}),info(...e){return E(()=>{console.info(...e)})},log(...e){return E(()=>{console.log(...e)})},table(e,t){return E(()=>{console.table(e,t)})},time(e){return E(()=>console.time(e))},timeEnd(e){return E(()=>console.timeEnd(e))},timeLog(e,...t){return E(()=>{console.timeLog(e,...t)})},trace(...e){return E(()=>{console.trace(...e)})},warn(...e){return E(()=>{console.warn(...e)})},unsafe:console};var Fge="effect/Random",Yb=Symbol.for(Fge),Gc=on("effect/Random"),cP=class{seed;[Yb]=Yb;PRNG;constructor(t){this.seed=t,this.PRNG=new cE(t)}get next(){return E(()=>this.PRNG.number())}get nextBoolean(){return k(this.next,t=>t>.5)}get nextInt(){return E(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER))}nextRange(t,r){return k(this.next,n=>(r-t)*n+t)}nextIntBetween(t,r){return E(()=>this.PRNG.integer(r-t)+t)}shuffle(t){return I8(t,r=>this.nextIntBetween(0,r))}},I8=(e,t)=>q(()=>p(E(()=>Array.from(e)),b(r=>{let n=[];for(let o=r.length;o>=2;o=o-1)n.push(o);return p(n,Vo(o=>p(t(o),k(s=>Nge(r,o-1,s)))),tt(pt(r)))}))),Nge=(e,t,r)=>{let n=e[t];return e[t]=e[r],e[r]=n,e},pP=e=>new cP(M(e)),uP=class{values;[Yb]=Yb;index=0;constructor(t){if(this.values=t,t.length===0)throw new Error("Requires at least one value")}getNextValue(){let t=this.values[this.index];return this.index=(this.index+1)%this.values.length,t}get next(){return E(()=>{let t=this.getNextValue();return typeof t=="number"?Math.max(0,Math.min(1,t)):M(t)/2147483647})}get nextBoolean(){return E(()=>{let t=this.getNextValue();return typeof t=="boolean"?t:M(t)%2===0})}get nextInt(){return E(()=>{let t=this.getNextValue();return typeof t=="number"&&Number.isFinite(t)?Math.round(t):Math.abs(M(t))})}nextRange(t,r){return k(this.next,n=>(r-t)*n+t)}nextIntBetween(t,r){return E(()=>{let n=this.getNextValue();if(typeof n=="number"&&Number.isFinite(n))return Math.max(t,Math.min(r-1,Math.round(n)));let o=Math.abs(M(n));return t+o%(r-t)})}shuffle(t){return I8(t,r=>this.nextIntBetween(0,r))}},R8=e=>new uP(e);var M8=Symbol.for("effect/Tracer"),Dge=e=>({[M8]:M8,...e}),Kc=on("effect/Tracer"),cn=on("effect/ParentSpan"),v8=(function(){let e="abcdef0123456789",t=e.length;return function(r){let n="";for(let o=0;o<r;o++)n+=e.charAt(Math.floor(Math.random()*t));return n}})(),lP=class{name;parent;context;startTime;kind;_tag="Span";spanId;traceId="native";sampled=!0;status;attributes;events=[];links;constructor(t,r,n,o,s,i){this.name=t,this.parent=r,this.context=n,this.startTime=s,this.kind=i,this.status={_tag:"Started",startTime:s},this.attributes=new Map,this.traceId=r._tag==="Some"?r.value.traceId:v8(32),this.spanId=v8(16),this.links=Array.from(o)}end(t,r){this.status={_tag:"Ended",endTime:t,exit:r,startTime:this.status.startTime}}attribute(t,r){this.attributes.set(t,r)}event(t,r,n){this.events.push([t,r,n??{}])}addLinks(t){this.links.push(...t)}},P8=Dge({span:(e,t,r,n,o,s)=>new lP(e,t,r,n,o,s),context:e=>e()});var qn=e=>{if(e?.captureStackTrace===!1)return e;if(e?.captureStackTrace!==void 0&&typeof e.captureStackTrace!="boolean")return e;let t=Error.stackTraceLimit;Error.stackTraceLimit=3;let r=new Error;Error.stackTraceLimit=t;let n=!1;return{...e,captureStackTrace:()=>{if(n!==!1)return n;if(r.stack!==void 0){let o=r.stack.split(`
`);if(o[3]!==void 0)return n=o[3].trim(),n}}}},Om=Bi()("effect/Tracer/DisablePropagation",{defaultValue:ls});var Lge=p(Cn(),qe(Mo,$v()),qe(Zo,k8),qe(Gc,pP(Math.random())),qe(wm,O8()),qe(Kc,P8)),Ot=ne(Symbol.for("effect/DefaultServices/currentServices"),()=>Ub(Lge)),F8=e=>{let t=Qe(e);return Xb(r=>r.sleep(t))},Qw=e=>de(t=>e(t.currentDefaultServices)),Xb=e=>Qw(t=>e(t.unsafeMap.get(Mo.key))),N8=Xb(e=>e.currentTimeMillis),D8=Xb(e=>e.currentTimeNanos),L8=u(2,(e,t)=>Yr(Ot,qe(Mo,t))(e)),U8=u(2,(e,t)=>Yr(Ot,qe(wm,t))(e)),fP=e=>Qw(t=>e(t.unsafeMap.get(wm.key))),q8=e=>fP(t=>t.load(e));var Jw=e=>Qw(t=>e(t.unsafeMap.get(Gc.key))),H8=u(2,(e,t)=>Yr(Ot,qe(Gc,t))(e));var Zw=e=>Qw(t=>e(t.unsafeMap.get(Kc.key))),W8=u(2,(e,t)=>Yr(Ot,qe(Kc,t))(e));var $a=F8,ta=N8,B8=D8,Yw=Xb,z8=Mo;function j8(e){return new Va(e)}function Xw(){return j8(new Map)}var dP=Symbol.for("effect/FiberRefs"),Va=class{locals;[dP]=dP;constructor(t){this.locals=t}pipe(){return v(this,arguments)}},Uge=(e,t,r,n=!1)=>{let o=e,s=t,i=r,a=n,c;for(;c===void 0;)if(ut(s)&&ut(i)){let l=Ur(s)[0],f=Ai(s),d=Ur(i)[0],h=Ur(i)[1],m=Ai(i);l.startTimeMillis<d.startTimeMillis?(i=m,a=!0):l.startTimeMillis>d.startTimeMillis?s=f:l.id<d.id?(i=m,a=!0):l.id>d.id?s=f:c=[h,a]}else c=[o.initial,!0];return c},eO=u(3,(e,t,r)=>{let n=new Map(e.locals);return r.locals.forEach((o,s)=>{let i=o[0][1];if(!o[0][0][H](t)){if(!n.has(s)){if(N(i,s.initial))return;n.set(s,[[t,s.join(s.initial,i)]]);return}let a=n.get(s),[c,l]=Uge(s,a,o);if(l){let f=s.diff(c,i),d=a[0][1],h=s.join(d,s.patch(f)(d));if(!N(d,h)){let m,y=a[0][0];y[H](t)?m=[[y,h],...a.slice(1)]:m=[[t,h],...a],n.set(s,m)}}}}),new Va(n)}),mP=u(2,(e,t)=>{let r=new Map;return $8(e,r,t),new Va(r)}),$8=(e,t,r)=>{e.locals.forEach((n,o)=>{let s=n[0][1],i=o.patch(o.fork)(s);N(s,i)?t.set(o,n):t.set(o,[[r,i],...n])})},V8=e=>mp(e.locals.keys()),G8=e=>Vo(V8(e),t=>Tp(t,Jc(e,t))),km=u(2,(e,t)=>{let r=new Map(e.locals);return r.delete(t),new Va(r)}),ey=u(2,(e,t)=>e.locals.has(t)?x(Ur(e.locals.get(t))[1]):g()),Jc=u(2,(e,t)=>p(ey(e,t),_e(()=>t.initial))),ed=u(2,(e,{fiberId:t,fiberRef:r,value:n})=>{if(e.locals.size===0)return new Va(new Map([[r,[[t,n]]]]));let o=new Map(e.locals);return hP(o,t,r,n),new Va(o)}),hP=(e,t,r,n)=>{let o=e.get(r)??[],s;if(ut(o)){let[i,a]=Ur(o);if(i[H](t)){if(N(a,n))return;s=[[t,n],...o.slice(1)]}else s=[[t,n],...o]}else s=[[t,n]];e.set(r,s)},K8=u(2,(e,{entries:t,forkAs:r})=>{if(e.locals.size===0)return new Va(new Map(t));let n=new Map(e.locals);return r!==void 0&&$8(e,n,r),t.forEach(([o,s])=>{s.length===1?hP(n,s[0][0],o,s[0][1]):s.forEach(([i,a])=>{hP(n,i,o,a)})}),new Va(n)});var Q8=km;var xP=ey,td=Jc,J8=eO,Z8=G8,Y8=ed,X8=K8;var eV=Xw;var $p={};Xn($p,{All:()=>tV,Debug:()=>iO,Error:()=>nO,Fatal:()=>rO,Info:()=>sO,None:()=>rV,Order:()=>ry,Trace:()=>aO,Warning:()=>oO,allLevels:()=>qge,fromLiteral:()=>uO,greaterThan:()=>cO,greaterThanEqual:()=>zge,lessThan:()=>Wge,lessThanEqual:()=>Bge,locally:()=>Hge});var tV=Ev,rO=Cv,nO=wv,oO=Iw,sO=lm,iO=Rw,aO=Ov,rV=_v,qge=l$,Hge=u(2,(e,t)=>Lt(e,Hb,t)),ry=p(Ni,_h(e=>e.ordinal)),Wge=jl(ry),Bge=kh(ry),cO=$l(ry),zge=Th(ry),uO=e=>{switch(e){case"All":return tV;case"Debug":return iO;case"Error":return nO;case"Fatal":return rO;case"Info":return sO;case"Trace":return aO;case"None":return rV;case"Warning":return oO}};var nV=(e,t)=>({label:e,startTime:t}),gP=e=>e.replace(/[\s="]/g,"_"),ny=e=>t=>`${gP(t.label)}=${e-t.startTime}ms`;var sV=nV;var Br={};Xn(Br,{RefTypeId:()=>SP,get:()=>_t,getAndSet:()=>sd,getAndUpdate:()=>EP,getAndUpdateSome:()=>CP,make:()=>tr,modify:()=>Yo,modifySome:()=>wP,set:()=>Lr,setAndGet:()=>OP,unsafeMake:()=>$ge,update:()=>Os,updateAndGet:()=>_P,updateSome:()=>kP,updateSomeAndGet:()=>TP});var aV=lc,bP=Ti;var jge=uz;var un=class extends jge{};var Hn=Symbol.for("effect/Readable");var znt={[Hn]:Hn,pipe(){return v(this,arguments)}};var oy=Symbol.for("effect/Ref"),sy={_A:e=>e},yP=class extends un{ref;commit(){return this.get}[oy]=sy;[Hn]=Hn;constructor(t){super(),this.ref=t,this.get=E(()=>Ie(this.ref))}get;modify(t){return E(()=>{let r=Ie(this.ref),[n,o]=t(r);return r!==o&&Nn(o)(this.ref),n})}},rd=e=>new yP(ko(e)),nd=e=>E(()=>rd(e)),Wn=e=>e.get,ra=u(2,(e,t)=>e.modify(()=>[void 0,t])),cV=u(2,(e,t)=>e.modify(r=>[r,t])),uV=u(2,(e,t)=>e.modify(r=>[r,t(r)])),pV=u(2,(e,t)=>e.modify(r=>{let n=t(r);switch(n._tag){case"None":return[r,r];case"Some":return[r,n.value]}})),lV=u(2,(e,t)=>e.modify(()=>[t,t])),pO=u(2,(e,t)=>e.modify(t)),fV=u(3,(e,t,r)=>e.modify(n=>{let o=r(n);switch(o._tag){case"None":return[t,n];case"Some":return o.value}})),od=u(2,(e,t)=>e.modify(r=>[void 0,t(r)])),dV=u(2,(e,t)=>e.modify(r=>{let n=t(r);return[n,n]})),hV=u(2,(e,t)=>e.modify(r=>[void 0,$(t(r),{onNone:()=>r,onSome:n=>n})])),mV=u(2,(e,t)=>e.modify(r=>{let n=t(r);switch(n._tag){case"None":return[r,r];case"Some":return[n.value,n.value]}}));var SP=oy,tr=nd,_t=Wn,sd=cV,EP=uV,CP=pV,Yo=pO,wP=fV,Lr=ra,OP=lV,Os=od,_P=dV,kP=hV,TP=mV,$ge=rd;var xV=Zw;var bV="Empty",yV="Add",SV="Remove",EV="Update",CV="AndThen",wV={_tag:bV},ay=(e,t)=>{let r=new Map(e.locals),n=wV;for(let[o,s]of t.locals.entries()){let i=Ur(s)[1],a=r.get(o);if(a!==void 0){let c=Ur(a)[1];N(c,i)||(n=lO({_tag:EV,fiberRef:o,patch:o.diff(c,i)})(n))}else n=lO({_tag:yV,fiberRef:o,value:i})(n);r.delete(o)}for(let[o]of r.entries())n=lO({_tag:SV,fiberRef:o})(n);return n},lO=u(2,(e,t)=>({_tag:CV,first:e,second:t})),fO=u(3,(e,t,r)=>{let n=r,o=Gr(e);for(;ut(o);){let s=Ur(o),i=Ai(o);switch(s._tag){case bV:{o=i;break}case yV:{n=ed(n,{fiberId:t,fiberRef:s.fiberRef,value:s.value}),o=i;break}case SV:{n=km(n,s.fiberRef),o=i;break}case EV:{let a=Jc(n,s.fiberRef);n=ed(n,{fiberId:t,fiberRef:s.fiberRef,value:s.fiberRef.patch(s.patch)(a)}),o=i;break}case CV:{o=Rh(s.first)(Rh(s.second)(i));break}}}return n});var _V="effect/MetricLabel",IP=Symbol.for(_V),RP=class{key;value;[IP]=IP;_hash;constructor(t,r){this.key=t,this.value=r,this._hash=Ke(_V+this.key+this.value)}[W](){return this._hash}[H](t){return Vge(t)&&this.key===t.key&&this.value===t.value}pipe(){return v(this,arguments)}},id=(e,t)=>new RP(e,t),Vge=e=>F(e,IP);var kV=u(e=>et(e[0]),function(){let e=arguments;return Yr(e[0],Wa,typeof e[1]=="string"?sn(e[1],e[2]):t=>Object.entries(e[1]).reduce((r,[n,o])=>sn(r,n,o),t))}),Im=e=>k(e,x),TV=e=>vp(e,x),MP=e=>{let t,r;return typeof e=="function"?t=e:(t=e.try,r=e.catch),q(()=>{try{return S(rt(t))}catch(n){return ke(r?rt(()=>r(n)):new xm(n,"An unknown error occurred in Effect.try"))}})},IV=u(3,(e,t,r)=>Ss(e,n=>F(n,t)&&n[t]===r.failure?r.onFailure(n):ke(n))),RV=u(2,(e,t)=>La(e,r=>{let n=Op(r,o=>Mf(o)?x(o):g());switch(n._tag){case"None":return Re(r);case"Some":return t(n.value.defect)}})),AV=u(2,(e,t)=>Gt(e,{onFailure:r=>{let n=t(r);switch(n._tag){case"None":return Re(r);case"Some":return n.value}},onSuccess:S})),MV=u(2,(e,t)=>La(e,r=>{let n=Op(r,o=>Mf(o)?x(o):g());switch(n._tag){case"None":return Re(r);case"Some":{let o=t(n.value.defect);return o._tag==="Some"?o.value:Re(r)}}})),vV=u(e=>et(e[0]),(e,...t)=>{let r=t[t.length-1],n;return t.length===2?n=_a(t[0]):n=o=>{let s=F(o,"_tag")?o._tag:void 0;if(!s)return!1;for(let i=0;i<t.length-1;i++)if(t[i]===s)return!0;return!1},Fb(e,n,r)}),PV=u(2,(e,t)=>{let r;return Fb(e,n=>(r??=Object.keys(t),F(n,"_tag")&&cr(n._tag)&&r.includes(n._tag)),n=>t[n._tag](n))}),FV=e=>Nb(e,{onFailure:R,onSuccess:()=>Ln}),Ka=Yw,NV=Ka(S),DV=u(2,(e,t)=>we($a(t),e)),mO=e=>de((t,r)=>e({id:t.id(),status:r,interruptors:Nf(t.getFiberRef(Lp))})),LV=mO(e=>Ac(e.interruptors)>0?Xt:ae),UV=mO(S),Rm=e=>fy(e,gO,ay),Gge=e=>fy(e,Hf(gO,um),([t,r],[n,o])=>[ay(t,n),Xs(r,o)]),qV=S({}),cy=sE(k,b),uy=fh(k),HV=lh(k),WV=u(2,(e,t)=>q(()=>{let r=e[Symbol.iterator](),n=[],o,s=S(!1),i=0;for(;(o=r.next())&&!o.done;){let a=o.value,c=i++;s=b(s,l=>l?(n.push(a),S(!0)):t(a,c))}return k(s,()=>n)})),BV=u(2,(e,t)=>q(()=>{let r=e[Symbol.iterator](),n=[],o,s=S(!0),i=0;for(;(o=r.next())&&!o.done;){let a=o.value,c=i++;s=b(s,l=>k(l?t(a,c):S(!1),f=>(f||n.push(a),f)))}return k(s,()=>n)})),zV=e=>k(Cs(),e),vP=e=>Uf(e,()=>b(qa(),()=>vP(e))),jV=u(2,(e,t)=>k(Un(e,R),hc(t))),$V=u(3,(e,t,r)=>py(e,t,n=>Rp(()=>r(n)))),VV=u(3,(e,t,r)=>py(e,t,()=>Ip(r))),py=u(3,(e,t,r)=>b(e,n=>t(n)?S(n):r(n))),GV=u(3,(e,t,r)=>q(()=>t(e)?S(e):ke(r(e)))),KV=u(e=>et(e[0]),(e,t,r)=>py(e,t,n=>r===void 0?ke(new Ao):ti(()=>r(n)))),QV=u(2,(e,t)=>q(()=>{let r=e[Symbol.iterator](),n=r.next();return n.done?S(g()):JV(r,0,t,n.value)})),JV=(e,t,r,n)=>b(r(n,t),o=>{if(o)return S(x(n));let s=e.next();return s.done?S(g()):JV(e,t+1,r,s.value)}),ZV=e=>q(()=>{let t=pt(e);return Vt(t)?p(ro(t),mc(wn(t),(r,n)=>Uf(r,()=>n))):Rp(()=>new jf("Received an empty collection of effects"))}),YV=u(2,(e,t)=>Mp(t(Mp(e)))),ly=u(2,(e,t)=>Zr(e,{onFailure:r=>S(t.onFailure(r)),onSuccess:r=>S(t.onSuccess(r))})),XV=u(2,(e,t)=>q(()=>e9(e[Symbol.iterator](),0,t))),e9=(e,t,r)=>{let n=e.next();return n.done?S(!0):b(r(n.value,t),o=>o?e9(e,t+1,r):S(o))},xO=e=>{let t=b(b(e,()=>qa()),()=>t);return t},gO=de(e=>S(e.getFiberRefs())),t9=e=>b(e,t=>{let n=t[Symbol.iterator]().next();return n.done?ke(new Ao):S(n.value)}),bO=e=>ly(e,{onFailure:Mr,onSuccess:Mr}),r9=e=>Gt(e,{onFailure:t=>FP(t,"An error was silently ignored because it is not anticipated to be useful"),onSuccess:()=>ae}),n9=e=>CO((t,r)=>J8(r,t,e)),o9=e=>ly(e,{onFailure:jr,onSuccess:ls}),s9=e=>ly(e,{onFailure:ls,onSuccess:jr}),PP=(e,t)=>q(()=>t.while(e)?b(t.body(e),r=>PP(r,t)):S(e)),Zc=e=>(...t)=>{let r=br(e),n;for(let o=0,s=t.length;o<s;o++){let i=t[o];_b(i)&&(n!==void 0?n=Rt(n,i):n=i,t=[...t.slice(0,o),...t.slice(o+1)],o--)}return n===void 0&&(n=Ln),de(o=>(o.log(t,n,r),ae))},i9=Zc(),a9=Zc(aO),FP=Zc(iO),c9=Zc(sO),u9=Zc(oO),p9=Zc(nO),l9=Zc(rO),f9=u(2,(e,t)=>b(ta,r=>Yr(e,Wb,KC(sV(t,r))))),d9=Ro(Wa),h9=(e,t)=>t.discard?x9(e,t.while,t.step,t.body):k(m9(e,t.while,t.step,t.body),Ee),m9=(e,t,r,n)=>q(()=>t(e)?b(n(e),o=>k(m9(r(e),t,r,n),KC(o))):E(()=>Ys())),x9=(e,t,r,n)=>q(()=>t(e)?b(n(e),()=>x9(r(e),t,r,n)):ae),g9=u(3,(e,t,r)=>q(()=>{let n=e[Symbol.iterator](),o=[],s=S(t),i,a=0;for(;!(i=n.next()).done;){let c=a++,l=i.value;s=b(s,f=>k(r(f,l,c),([d,h])=>(o.push(h),d)))}return k(s,c=>[c,o])})),Am=u(2,(e,t)=>Gt(e,{onFailure:r=>qc(()=>t(r)),onSuccess:S})),yO=e=>p(an(),b(t=>p(Gge(e),Ua(t),NP,k(r=>we(r,p(Ut(t),b(([n,o])=>tt(Hf(ad(n[0]),Pp(n[1])),o)))))))),b9=e=>Zr(e,{onFailure:t=>S(t),onSuccess:S}),SO=e=>k(e,t=>!t),y9=e=>b(e,t=>{switch(t._tag){case"None":return ae;case"Some":return ke(new Ao)}}),NP=e=>k(tr(!0),t=>Ct(Qi(e,sd(t,!1)))),S9=e=>Zr(e,{onFailure:()=>S(g()),onSuccess:t=>S(x(t))}),E9=u(2,(e,t)=>Uf(e,()=>ti(t))),C9=u(2,(e,t)=>Uf(e,()=>E(t))),w9=e=>Gt(e,{onFailure:t=>{let r=Ee(kb(t));return r.length===0?Re(t):ke(r)},onSuccess:S}),ad=e=>CO((t,r)=>p(e,fO(t,r))),O9=e=>e.length>=1?oo((t,r)=>{try{e(r).then(n=>t(S(n)),n=>t(so(n)))}catch(n){t(so(n))}}):oo(t=>{try{e().then(r=>t(S(r)),r=>t(so(r)))}catch(r){t(so(r))}}),Vp=u(3,(e,t,r)=>si(n=>ws(e,qe(n,t,r)))),Gp=u(3,(e,t,r)=>si(n=>b(r,o=>ws(e,p(n,qe(t,o)))))),_9=Jw(S),k9=u(3,(e,t,r)=>Ee(e).reduce((n,o,s)=>b(n,i=>r(i,o,s)),S(t))),T9=u(3,(e,t,r)=>Ee(e).reduceRight((n,o,s)=>b(n,i=>r(o,i,s)),S(t))),I9=u(3,(e,t,r)=>b(E(()=>e[Symbol.iterator]()),n=>R9(n,0,t,r.while,r.body))),R9=(e,t,r,n,o)=>{let s=e.next();return!s.done&&n(r)?b(o(r,s.value,t),i=>R9(e,t+1,i,n,o)):S(r)},A9=u(2,(e,t)=>q(()=>M9(e,t))),M9=(e,t)=>b(e,r=>t<=0?S(r):we(qa(),M9(e,t-1))),v9=e=>Gt(e,{onFailure:ke,onSuccess:S}),P9=e=>q(()=>Z8(e)),Qa=$a,cd=S(g()),F9=e=>S(x(e)),fy=u(3,(e,t,r)=>b(t,n=>b(e,o=>k(t,s=>[r(n,s),o])))),N9=u(e=>et(e[0]),function(){return DP(arguments[0],typeof arguments[1]=="string"?[id(arguments[1],arguments[2])]:Object.entries(arguments[1]).map(([e,t])=>id(e,t)))}),DP=u(2,(e,t)=>Yr(e,ni,r=>fs(r,t))),D9=u(2,(e,t)=>q(()=>{let r=e[Symbol.iterator](),n=[],o,s=S(!1),i=0;for(;(o=r.next())&&!o.done;){let a=o.value,c=i++;s=b(s,l=>l?S(!0):(n.push(a),t(a,c)))}return k(s,()=>n)})),L9=u(2,(e,t)=>q(()=>{let r=e[Symbol.iterator](),n=[],o,s=S(!0),i=0;for(;(o=r.next())&&!o.done;){let a=o.value,c=i++;s=b(s,l=>p(l?t(a,c):S(!1),k(f=>(f&&n.push(a),f))))}return k(s,()=>n)})),U9=u(2,(e,{onFailure:t,onSuccess:r})=>Gt(e,{onFailure:n=>{let o=Gi(n);switch(o._tag){case"Left":return we(t(o.left),Re(n));case"Right":return Re(n)}},onSuccess:n=>tt(r(n),n)})),EO=u(2,(e,t)=>La(e,r=>$(lv(r),{onNone:()=>Re(r),onSome:n=>we(t(n),Re(r))}))),dy=u(2,(e,t)=>Gt(e,{onFailure:r=>{let n=Gi(r);switch(n._tag){case"Left":return we(t(n.left),Re(r));case"Right":return Re(r)}},onSuccess:S})),q9=u(3,(e,t,r)=>dy(e,n=>_a(n,t)?r(n):ae)),H9=u(2,(e,t)=>Gt(e,{onFailure:r=>we(t(r),Re(r)),onSuccess:S})),W9=e=>LP(e,B8),LP=u(2,(e,t)=>fy(e,t,(r,n)=>Ks(n-r))),Kge=xV,B9=Kge(S),UP=e=>{let t,r;typeof e=="function"?t=e:(t=e.try,r=e.catch);let n=o=>r?ti(()=>r(o)):ke(new xm(o,"An unknown error occurred in Effect.tryPromise"));return t.length>=1?oo((o,s)=>{try{t(s).then(i=>o(S(i)),i=>o(n(i)))}catch(i){o(n(i))}}):oo(o=>{try{t().then(s=>o(S(s)),s=>o(n(s)))}catch(s){o(n(s))}})},z9=u(2,(e,t)=>b(e,r=>MP({try:()=>t.try(r),catch:t.catch}))),j9=u(2,(e,t)=>b(e,r=>UP({try:t.try.length>=1?n=>t.try(r,n):()=>t.try(r),catch:t.catch}))),$9=u(2,(e,t)=>q(()=>t()?cd:Im(e))),V9=u(2,(e,t)=>b(t,r=>r?cd:Im(e))),G9=e=>Am(e,dv),CO=e=>de(t=>(t.setFiberRefs(e(t.id(),t.getFiberRefs())),ae)),K9=u(3,(e,t,r)=>Jf(e,n=>qe(n,t,r(Pn(n,t))))),wO=u(2,(e,t)=>q(()=>t()?k(e,x):S(g()))),Q9=u(3,(e,t,r)=>b(Ro(t),n=>r(n)?k(e,o=>[n,x(o)]):S([n,g()]))),J9=u(3,(e,t,r)=>b(_t(t),n=>r(n)?k(e,o=>[n,x(o)]):S([n,g()]))),Z9=u(2,(e,t)=>t(e)),Y9=(e,t)=>(...r)=>b(e,n=>t(n)(...r)),X9=(e,t)=>(...r)=>k(e,n=>t(n)(...r)),qP=e=>new Proxy({},{get(t,r,n){return(...o)=>b(e,s=>s[r](...o))}}),HP=e=>new Proxy({},{get(t,r,n){return b(e,o=>et(o[r])?o[r]:S(o[r]))}}),eG=e=>({functions:qP(e),constants:HP(e)}),tG=e=>k(Cs(),xs(e)),WP=e=>b(Cs(),xs(e)),rG=function(){let e=arguments;return bO(b(OO,t=>E(()=>{if(typeof e[0]=="string")t.attribute(e[0],e[1]);else for(let r in e[0])t.attribute(r,e[0][r])})))},nG=function(){let e=arguments,t=Array.isArray(e[0])?e[0]:[{_tag:"SpanLink",span:e[0],attributes:e[1]??{}}];return bO(b(OO,r=>E(()=>r.addLinks(t))))},oG=u(e=>et(e[0]),function(){let e=arguments;return Yr(e[0],Bf,typeof e[1]=="string"?sn(e[1],e[2]):t=>Object.entries(e[1]).reduce((r,[n,o])=>sn(r,n,o),t))}),sG=WP(cn),OO=b(Cs(),e=>{let t=e.unsafeMap.get(cn.key);return t!==void 0&&t._tag==="Span"?S(t):ke(new Ao)}),iG=u(e=>et(e[0]),(e,t,r)=>Yr(e,jb,Fn({_tag:"SpanLink",span:t,attributes:r??{}}))),aG=BigInt(0),cG=kr(e=>jt(e.context,Om)?e._tag==="Span"?cG(e.parent):g():x(e)),_O=(e,t,r)=>{let n=!e.getFiberRef(hm)||r.context&&jt(r.context,Om),o=e.getFiberRef(Xr),s=r.parent?x(r.parent):r.root?g():cG(xs(o,cn)),i;if(n)i=J$({name:t,parent:s,context:qe(r.context??Cn(),Om,!0)});else{let a=e.getFiberRef(Ot),c=jt(a,Kc),l=jt(a,z8),f=e.getFiberRef(Ba),d=e.getFiberRefs(),h=xP(d,Bf),m=xP(d,jb),y=m._tag==="Some"?r.links!==void 0?[...Zt(m.value),...r.links??[]]:Zt(m.value):r.links??ds();i=c.span(t,s,r.context??Cn(),y,f?l.unsafeCurrentTimeNanos():aG,r.kind??"internal",r),h._tag==="Some"&&f5(h.value,(_,C)=>i.attribute(C,_)),r.attributes!==void 0&&Object.entries(r.attributes).forEach(([_,C])=>i.attribute(_,C))}return typeof r.captureStackTrace=="function"&&Ib.set(i,r.captureStackTrace),i},uG=(e,t)=>(t=qn(t),de(r=>S(_O(r,e,t)))),pG=Ro(Bf),lG=Ro(jb),Mm=(e,t,r,n)=>E(()=>{e.status._tag!=="Ended"&&(Aw(t)&&Ib.has(e)&&e.attribute("code.stacktrace",Ib.get(e)()),e.end(n?r.unsafeCurrentTimeNanos():aG,t))}),dO=(e,...t)=>{let r=qn(t.length===1?void 0:t[0]),n=t[t.length-1];return de(o=>{let s=_O(o,e,r),i=o.getFiberRef(Ba),a=jt(o.getFiberRef(Ot),Mo);return Io(n(s),c=>Mm(s,c,a,i))})},hO=u(2,(e,t)=>Vp(e,cn,t)),BP=function(){let e=typeof arguments[0]!="string",t=e?arguments[1]:arguments[0],r=qn(e?arguments[2]:arguments[1]);if(e){let n=arguments[0];return dO(t,r,o=>hO(n,o))}return n=>dO(t,r,o=>hO(n,o))},fG=e=>function(){let t=e.captureStackTrace??!1;if(e.captureStackTrace!==!1){let r=Error.stackTraceLimit;Error.stackTraceLimit=2;let n=new Error;Error.stackTraceLimit=r;let o=!1;t=()=>{if(o!==!1)return o;if(n.stack)return o=n.stack.trim().split(`
`).slice(2).join(`
`).trim(),o}}return q(()=>{let r=typeof e.options=="function"?e.options.apply(null,arguments):e.options;return BP(q(()=>rt(()=>e.body.apply(this,arguments))),r.name,{...r,captureStackTrace:t})})},dG=e=>e==null?ke(new Ao):S(e),hG=e=>Ss(k(e,x),t=>Av(t)?cd:ke(t));var mG="Sequential",xG="Parallel",Qge="ParallelN",Xo={_tag:mG},hy={_tag:xG},gG=e=>({_tag:Qge,parallelism:e}),zP=e=>e._tag===mG,jP=e=>e._tag===xG;var vm=Xo,kO=hy,TO=gG;var ud=ay;var pd=fO;var RO="effect/FiberStatus",Kp=Symbol.for(RO),IO="Done",bG="Running",yG="Suspended",Jge=Ke(`${RO}-${IO}`),GP=class{[Kp]=Kp;_tag=IO;[W](){return Jge}[H](t){return AO(t)&&t._tag===IO}},KP=class{runtimeFlags;[Kp]=Kp;_tag=bG;constructor(t){this.runtimeFlags=t}[W](){return p(M(RO),K(M(this._tag)),K(M(this.runtimeFlags)),ie(this))}[H](t){return AO(t)&&t._tag===bG&&this.runtimeFlags===t.runtimeFlags}},QP=class{runtimeFlags;blockingOn;[Kp]=Kp;_tag=yG;constructor(t,r){this.runtimeFlags=t,this.blockingOn=r}[W](){return p(M(RO),K(M(this._tag)),K(M(this.runtimeFlags)),K(M(this.blockingOn)),ie(this))}[H](t){return AO(t)&&t._tag===yG&&this.runtimeFlags===t.runtimeFlags&&N(this.blockingOn,t.blockingOn)}},SG=new GP,EG=e=>new KP(e),CG=(e,t)=>new QP(e,t),AO=e=>F(e,Kp),wG=e=>e._tag===IO;var OG=SG,JP=EG,_G=CG;var kG=wG;var Yge=Symbol.for("effect/Micro"),MO=Symbol.for("effect/Micro/MicroExit");var IG=Symbol.for("effect/Micro/MicroCause");var Xge={_E:R},vO=class extends globalThis.Error{_tag;traces;[IG];constructor(t,r,n){let o=`MicroCause.${t}`,s,i,a;if(r instanceof globalThis.Error){s=`(${o}) ${r.name}`,i=r.message;let c=i.split(`
`).length;a=r.stack?`(${o}) ${r.stack.split(`
`).slice(0,c+3).join(`
`)}`:`${s}: ${i}`}else s=o,i=cc(r,0),a=`${s}: ${i}`;n.length>0&&(a+=`
    ${n.join(`
    `)}`),super(i),this._tag=t,this.traces=n,this[IG]=Xge,this.name=s,this.stack=a}pipe(){return v(this,arguments)}toString(){return this.stack}[he](){return this.stack}};var YP=class extends vO{defect;constructor(t,r=[]){super("Die",t,r),this.defect=t}},ebe=(e,t=[])=>new YP(e,t),XP=class extends vO{constructor(t=[]){super("Interrupt","interrupted",t)}},tbe=(e=[])=>new XP(e);var vG=e=>e._tag==="Interrupt";var RG=Symbol.for("effect/Micro/MicroFiber"),rbe={_A:R,_E:R},PO=class{context;interruptible;[RG];_stack=[];_observers=[];_exit;_children;currentOpCount=0;constructor(t,r=!0){this.context=t,this.interruptible=r,this[RG]=rbe}getRef(t){return Zj(this.context,t)}addObserver(t){return this._exit?(t(this._exit),Mr):(this._observers.push(t),()=>{let r=this._observers.indexOf(t);r>=0&&this._observers.splice(r,1)})}_interrupted=!1;unsafeInterrupt(){this._exit||(this._interrupted=!0,this.interruptible&&this.evaluate(nF))}unsafePoll(){return this._exit}evaluate(t){if(this._exit)return;if(this._yielded!==void 0){let o=this._yielded;this._yielded=void 0,o()}let r=this.runLoop(t);if(r===Pm)return;let n=AG.interruptChildren&&AG.interruptChildren(this);if(n!==void 0)return this.evaluate(ld(n,()=>r));this._exit=r;for(let o=0;o<this._observers.length;o++)this._observers[o](r);this._observers.length=0}runLoop(t){let r=!1,n=t;this.currentOpCount=0;try{for(;;){if(this.currentOpCount++,!r&&this.getRef(Lm).shouldYield(this)){r=!0;let o=n;n=ld(cbe,()=>o)}if(n=n[eF](this),n===Pm){let o=this._yielded;return MO in o?(this._yielded=void 0,o):Pm}}}catch(o){return F(n,eF)?UO(o):UO(`MicroFiber.runLoop: Not a valid effect: ${String(n)}`)}}getCont(t){for(;;){let r=this._stack.pop();if(!r)return;let n=r[FO]&&r[FO](this);if(n)return{[t]:n};if(r[t])return r}}_yielded=void 0;yieldWith(t){return this._yielded=t,Pm}children(){return this._children??=new Set}},AG=ne("effect/Micro/fiberMiddleware",()=>({interruptChildren:void 0}));var nbe=e=>xy(()=>{for(let n of e)n.unsafeInterrupt();let t=e[Symbol.iterator](),r=xy(()=>{let n=t.next();for(;!n.done;){if(n.value.unsafePoll()){n=t.next();continue}let o=n.value;return NG(s=>{o.addObserver(i=>{s(r)})})}return Dm});return r}),PG=Symbol.for("effect/Micro/identifier"),vt=Symbol.for("effect/Micro/args"),eF=Symbol.for("effect/Micro/evaluate"),Qp=Symbol.for("effect/Micro/successCont"),Fm=Symbol.for("effect/Micro/failureCont"),FO=Symbol.for("effect/Micro/ensureCont"),Pm=Symbol.for("effect/Micro/Yield"),obe={_A:R,_E:R,_R:R},sbe={...aV,_op:"Micro",[Yge]:obe,pipe(){return v(this,arguments)},[Symbol.iterator](){return new Hl(new qs(this))},toJSON(){return{_id:"Micro",op:this[PG],...vt in this?{args:this[vt]}:void 0}},toString(){return De(this)},[he](){return De(this)}};function ibe(e){return UO("Micro.evaluate: Not implemented")}var HO=e=>({...sbe,[PG]:e.op,[eF]:e.eval??ibe,[Qp]:e.contA,[Fm]:e.contE,[FO]:e.ensure}),Jp=e=>{let t=HO(e);return function(){let r=Object.create(t);return r[vt]=e.single===!1?arguments:arguments[0],r}},FG=e=>{let t={...HO(e),[MO]:MO,_tag:e.op,get[e.prop](){return this[vt]},toJSON(){return{_id:"MicroExit",_tag:e.op,[e.prop]:this[vt]}},[H](r){return mbe(r)&&r._tag===e.op&&N(this[vt],r[vt])},[W](){return ie(this,K(Ke(e.op))(M(this[vt])))}};return function(r){let n=Object.create(t);return n[vt]=r,n[Qp]=void 0,n[Fm]=void 0,n[FO]=void 0,n}},Nm=FG({op:"Success",prop:"value",eval(e){let t=e.getCont(Qp);return t?t[Qp](this[vt],e):e.yieldWith(this)}}),NO=FG({op:"Failure",prop:"cause",eval(e){let t=e.getCont(Fm);for(;vG(this[vt])&&t&&e.interruptible;)t=e.getCont(Fm);return t?t[Fm](this[vt],e):e.yieldWith(this)}});var DO=Jp({op:"Sync",eval(e){let t=this[vt](),r=e.getCont(Qp);return r?r[Qp](t,e):e.yieldWith(BO(t))}}),xy=Jp({op:"Suspend",eval(e){return this[vt]()}}),abe=Jp({op:"Yield",eval(e){let t=!1;return e.getRef(Lm).scheduleTask(()=>{t||e.evaluate(Dm)},this[vt]??0),e.yieldWith(()=>{t=!0})}}),cbe=abe(0);var LO=Nm(void 0);var WO=Jp({op:"WithMicroFiber",eval(e){return this[vt](e)}});var ube=Jp({op:"Async",single:!1,eval(e){let t=this[vt][0],r=!1,n=!1,o=this[vt][1]?new AbortController:void 0,s=t(i=>{r||(r=!0,n?e.evaluate(i):n=i)},o?.signal);return n!==!1?n:(n=!0,e._yielded=()=>{r=!0},o===void 0&&s===void 0||e._stack.push(pbe(()=>(r=!0,o?.abort(),s??Dm))),Pm)}}),pbe=Jp({op:"AsyncFinalizer",ensure(e){e.interruptible&&(e.interruptible=!1,e._stack.push(oF(!0)))},contE(e,t){return vG(e)?ld(this[vt](),()=>NO(e)):NO(e)}}),NG=e=>ube(e,e.length>=2);var lbe=u(2,(e,t)=>hbe(e,r=>t));var fbe=e=>Sbe(e,{onFailure:zO,onSuccess:BO});var ld=u(2,(e,t)=>{let r=Object.create(dbe);return r[vt]=e,r[Qp]=t,r}),dbe=HO({op:"OnSuccess",eval(e){return e._stack.push(this),this[vt]}});var hbe=u(2,(e,t)=>ld(e,r=>Nm(t(r)))),mbe=e=>F(e,MO),BO=Nm,zO=NO,nF=zO(tbe());var UO=e=>zO(ebe(e));var Dm=BO(void 0),xbe=e=>{for(let t of e)if(t._tag==="Failure")return t;return Dm},gbe="setImmediate"in globalThis?globalThis.setImmediate:e=>setTimeout(e,0),qO=class{tasks=[];running=!1;scheduleTask(t,r){this.tasks.push(t),this.running||(this.running=!0,gbe(this.afterScheduled))}afterScheduled=()=>{this.running=!1,this.runTasks()};runTasks(){let t=this.tasks;this.tasks=[];for(let r=0,n=t.length;r<n;r++)t[r]()}shouldYield(t){return t.currentOpCount>=t.getRef(tF)}flush(){for(;this.tasks.length>0;)this.runTasks()}};var bbe=u(2,(e,t)=>WO(r=>{let n=r.context;return r.context=t(n),Ebe(e,()=>(r.context=n,LO))}));var DG=u(2,(e,t)=>bbe(e,_o(t)));var tF=class extends Bi()("effect/Micro/currentMaxOpsBeforeYield",{defaultValue:()=>2048}){},rF=class extends Bi()("effect/Micro/currentConcurrency",{defaultValue:()=>"unbounded"}){},Lm=class extends Bi()("effect/Micro/currentScheduler",{defaultValue:()=>new qO}){};var LG=u(2,(e,t)=>{let r=Object.create(ybe);return r[vt]=e,r[Qp]=t.onSuccess,r[Fm]=t.onFailure,r}),ybe=HO({op:"OnSuccessAndFailure",eval(e){return e._stack.push(this),this[vt]}}),Sbe=u(2,(e,t)=>LG(e,{onFailure:r=>DO(()=>t.onFailure(r)),onSuccess:r=>DO(()=>t.onSuccess(r))}));var ZP=Symbol.for("effect/Micro/MicroScope");var MG=class e{[ZP];state={_tag:"Open",finalizers:new Set};constructor(){this[ZP]=ZP}unsafeAddFinalizer(t){this.state._tag==="Open"&&this.state.finalizers.add(t)}addFinalizer(t){return xy(()=>this.state._tag==="Open"?(this.state.finalizers.add(t),LO):t(this.state.exit))}unsafeRemoveFinalizer(t){this.state._tag==="Open"&&this.state.finalizers.delete(t)}close(t){return xy(()=>{if(this.state._tag==="Open"){let r=Array.from(this.state.finalizers).reverse();return this.state={_tag:"Closed",exit:t},ld(_be(r,n=>fbe(n(t))),xbe)}return LO})}get fork(){return DO(()=>{let t=new e;if(this.state._tag==="Closed")return t.state=this.state,t;function r(n){return t.close(n)}return this.state.finalizers.add(r),t.unsafeAddFinalizer(n=>DO(()=>this.unsafeRemoveFinalizer(r))),t})}};var Ebe=u(2,(e,t)=>wbe(r=>LG(r(e),{onFailure:n=>ld(t(zO(n)),()=>NO(n)),onSuccess:n=>ld(t(BO(n)),()=>Nm(n))})));var oF=Jp({op:"SetInterruptible",ensure(e){if(e.interruptible=this[vt],e._interrupted&&e.interruptible)return()=>nF}}),Cbe=e=>WO(t=>t.interruptible?e:(t.interruptible=!0,t._stack.push(oF(!1)),t._interrupted?nF:e)),wbe=e=>WO(t=>t.interruptible?(t.interruptible=!1,t._stack.push(oF(!0)),e(Cbe)):e(R));var Obe=Jp({op:"While",contA(e,t){return this[vt].step(e),this[vt].while()?(t._stack.push(this),this[vt].body()):Dm},eval(e){return this[vt].while()?(e._stack.push(this),this[vt].body()):Dm}}),_be=(e,t,r)=>WO(n=>{let o=r?.concurrency==="inherit"?n.getRef(rF):r?.concurrency??1,s=o==="unbounded"?Number.POSITIVE_INFINITY:Math.max(1,o),i=Ee(e),a=i.length;if(a===0)return r?.discard?LO:Nm([]);let c=r?.discard?void 0:new Array(a),l=0;return s===1?lbe(Obe({while:()=>l<i.length,body:()=>t(i[l],l),step:c?f=>c[l++]=f:f=>l++}),c):NG(f=>{let d=new Set,h,m=0,y=0,_=!1,C=!1;function O(){for(_=!0;m<s&&l<a;){let U=l,I=i[U];l++,m++;try{let Q=kbe(n,t(I,U),!0,!0);d.add(Q),Q.addObserver(J=>{d.delete(Q),!C&&(J._tag==="Failure"?h===void 0&&(h=J,a=l,d.forEach(z=>z.unsafeInterrupt())):c!==void 0&&(c[U]=J.value),y++,m--,y===a?f(h??Nm(c)):!_&&m<s&&O())})}catch(Q){h=UO(Q),a=l,d.forEach(J=>J.unsafeInterrupt())}}_=!1}return O(),xy(()=>(C=!0,l=a,nbe(d)))})});var kbe=(e,t,r=!1,n=!1)=>{let o=new PO(e.context,e.interruptible);return n||(e.children().add(o),o.addObserver(()=>e.children().delete(o))),r?o.evaluate(t):e.getRef(Lm).scheduleTask(()=>o.evaluate(t),0),o};var UG=(e,t)=>{let r=new PO(Lm.context(t?.scheduler??new qO));if(r.evaluate(e),t?.signal)if(t.signal.aborted)r.unsafeInterrupt();else{let n=()=>r.unsafeInterrupt();t.signal.addEventListener("abort",n,{once:!0}),r.addObserver(()=>t.signal.removeEventListener("abort",n))}return r};var jO=class{buckets=[];scheduleTask(t,r){let n=this.buckets.length,o,s=0;for(;s<n&&this.buckets[s][0]<=r;s++)o=this.buckets[s];o&&o[0]===r?o[1].push(t):s===n?this.buckets.push([r,[t]]):this.buckets.splice(s,0,[r,[t]])}},sF=class{maxNextTickBeforeTimer;running=!1;tasks=new jO;constructor(t){this.maxNextTickBeforeTimer=t}starveInternal(t){let r=this.tasks.buckets;this.tasks.buckets=[];for(let[n,o]of r)for(let s=0;s<o.length;s++)o[s]();this.tasks.buckets.length===0?this.running=!1:this.starve(t)}starve(t=0){t>=this.maxNextTickBeforeTimer?setTimeout(()=>this.starveInternal(0),0):Promise.resolve(void 0).then(()=>this.starveInternal(t+1))}shouldYield(t){return t.currentOpCount>t.getFiberRef(qb)?t.getFiberRef(Ji):!1}scheduleTask(t,r){this.tasks.scheduleTask(t,r),this.running||(this.running=!0,this.starve())}},HG=ne(Symbol.for("effect/Scheduler/defaultScheduler"),()=>new sF(2048)),Zp=class{tasks=new jO;deferred=!1;scheduleTask(t,r){this.deferred?HG.scheduleTask(t,r):this.tasks.scheduleTask(t,r)}shouldYield(t){return t.currentOpCount>t.getFiberRef(qb)?t.getFiberRef(Ji):!1}flush(){for(;this.tasks.buckets.length>0;){let t=this.tasks.buckets;this.tasks.buckets=[];for(let[r,n]of t)for(let o=0;o<n.length;o++)n[o]()}this.deferred=!0}};var na=ne(Symbol.for("effect/FiberRef/currentScheduler"),()=>lr(HG)),WG=u(2,(e,t)=>Lt(e,na,t));var $O=ne(Symbol.for("effect/FiberRef/currentRequestMap"),()=>lr(new Map));var iF=(e,t,r,n)=>{switch(e){case void 0:return t();case"unbounded":return r();case"inherit":return Hr(Bb,o=>o==="unbounded"?r():o>1?n(o):t());default:return e>1?n(e):t()}},gy=(e,t,r)=>{switch(e){case void 0:return t();case"unbounded":return r();case"inherit":return Hr(Bb,n=>n==="unbounded"||n>1?r():t());default:return e>1?r():t()}};var VO="InterruptSignal",GO="Stateful",KO="Resume",QO="YieldNow",JO=e=>({_tag:VO,cause:e}),Um=e=>({_tag:GO,onFiber:e}),dd=e=>({_tag:KO,effect:e}),BG=()=>({_tag:QO});var Rbe="effect/FiberScope",ZO=Symbol.for(Rbe),aF=class{[ZO]=ZO;fiberId=Dn;roots=new Set;add(t,r){this.roots.add(r),r.addObserver(()=>{this.roots.delete(r)})}},cF=class{fiberId;parent;[ZO]=ZO;constructor(t,r){this.fiberId=t,this.parent=r}add(t,r){this.parent.tell(Um(n=>{n.addChild(r),r.addObserver(()=>{n.removeChild(r)})}))}},jG=e=>new cF(e.id(),e),Xc=ne(Symbol.for("effect/FiberScope/Global"),()=>new aF);var Abe="effect/Fiber",qm=Symbol.for(Abe),by={_E:e=>e,_A:e=>e},Mbe={[qm]:by,pipe(){return v(this,arguments)}},vbe="effect/Fiber",YO=Symbol.for(vbe);var uF=e=>YO in e,XO=e=>e.await;var e_=e=>e.inheritAll;var pF=u(2,pm(function*(e,t){for(let r of e){if(uF(r)){r.unsafeInterruptAsFork(t);continue}yield*r.interruptAsFork(t)}for(let r of e)uF(r)&&r.unsafePoll()||(yield*r.await)})),lF=u(2,(e,t)=>e.interruptAsFork(t)),_s=e=>Wf($o(e.await),e.inheritAll);var bot={...Ti,commit(){return _s(this)},...Mbe,id:()=>Dn,await:Np,children:S([]),inheritAll:Np,poll:S(g()),interruptAsFork:()=>Np};var VG=e=>e.poll;var Yp="effect/FiberCurrent";var Pbe="effect/Logger",Hm=Symbol.for(Pbe),dF={_Message:e=>e,_Output:e=>e},_n=e=>({[Hm]:dF,log:e,pipe(){return v(this,arguments)}}),GG=u(2,(e,t)=>_n(r=>e.log({...r,message:t(r.message)}))),t_=u(2,(e,t)=>_n(r=>e.log(t(r)))),KG=u(2,(e,t)=>_n(r=>t(r.logLevel)?x(e.log(r)):g())),Sy=u(2,(e,t)=>_n(r=>t(e.log(r)))),QG={[Hm]:dF,log:Mr,pipe(){return v(this,arguments)}},r_=e=>({[Hm]:dF,log:({message:t})=>e(t),pipe(){return v(this,arguments)}}),JG=e=>r_(()=>e),ZG=e=>r_(e),n_=u(2,(e,t)=>_n(r=>[e.log(r),t.log(r)])),YG=u(2,(e,t)=>Sy(n_(e,t),r=>r[0])),XG=u(2,(e,t)=>Sy(n_(e,t),r=>r[1])),Fbe=/^[^\s"=]*$/,e7=(e,t)=>({annotations:r,cause:n,date:o,fiberId:s,logLevel:i,message:a,spans:c})=>{let l=y=>y.match(Fbe)?y:e(y),f=(y,_)=>`${gP(y)}=${l(_)}`,d=(y,_)=>" "+f(y,_),h=f("timestamp",o.toISOString());h+=d("level",i.label),h+=d("fiber",wf(s));let m=Kl(a);for(let y=0;y<m.length;y++)h+=d("message",cc(m[y],t));pv(n)||(h+=d("cause",zo(n,{renderErrorCause:!0})));for(let y of c)h+=" "+ny(o.getTime())(y);for(let[y,_]of r)h+=d(y,cc(_,t));return h},Nbe=e=>`"${e.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`,o_=_n(e7(Nbe)),s_=_n(e7(JSON.stringify,0)),Ey=_n(({annotations:e,cause:t,date:r,fiberId:n,logLevel:o,message:s,spans:i})=>{let a=r.getTime(),c={},l={};if($C(e)>0)for(let[d,h]of e)c[d]=yy(h);if(Of(i))for(let d of i)l[d.label]=a-d.startTime;let f=Kl(s);return{message:f.length===1?yy(f[0]):f.map(yy),logLevel:o.label,timestamp:r.toISOString(),cause:vf(t)?void 0:zo(t,{renderErrorCause:!0}),annotations:c,spans:l,fiberId:wf(n)}}),yy=e=>{switch(typeof e){case"bigint":case"function":case"symbol":return String(e);default:return ve(e)}},i_=Sy(Ey,Cg),t7=e=>typeof e=="object"&&e!=null&&Hm in e,Dbe=(e,...t)=>{let r="";for(let n=0;n<t.length;n++)r+=`\x1B[${t[n]}m`;return r+e+"\x1B[0m"},Lbe=(e,...t)=>e,ci={bold:"1",red:"31",green:"32",yellow:"33",blue:"34",cyan:"36",white:"37",gray:"90",black:"30",bgBrightRed:"101"},Ube={None:[],All:[],Trace:[ci.gray],Debug:[ci.blue],Info:[ci.green],Warning:[ci.yellow],Error:[ci.red],Fatal:[ci.bgBrightRed,ci.black]},qbe={None:"",All:"",Trace:"color:gray",Debug:"color:blue",Info:"color:green",Warning:"color:orange",Error:"color:red",Fatal:"background-color:red;color:white"},Hbe=e=>`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:${e.getSeconds().toString().padStart(2,"0")}.${e.getMilliseconds().toString().padStart(3,"0")}`,r7=typeof process=="object"&&process!==null&&typeof process.stdout=="object"&&process.stdout!==null,Wbe=r7&&process.stdout.isTTY===!0,Bbe=r7||"Deno"in globalThis,hF=e=>{let t=e?.mode??"auto",n=(t==="auto"?Bbe?"tty":"browser":t)==="browser",o=typeof e?.colors=="boolean"?e.colors:Wbe||n,s=e?.formatDate??Hbe;return n?jbe({colors:o,formatDate:s}):zbe({colors:o,formatDate:s,stderr:e?.stderr===!0})},zbe=e=>{let t=e.colors?Dbe:Lbe;return _n(({annotations:r,cause:n,context:o,date:s,fiberId:i,logLevel:a,message:c,spans:l})=>{let f=td(o,Ot),d=jt(f,Zo).unsafe,h=e.stderr===!0?d.error:d.log,m=Kl(c),y=t(`[${e.formatDate(s)}]`,ci.white)+` ${t(a.label,...Ube[a._tag])} (${wf(i)})`;if(Of(l)){let C=s.getTime(),O=ny(C);for(let U of l)y+=" "+O(U)}y+=":";let _=0;if(m.length>0){let C=yy(m[0]);typeof C=="string"&&(y+=" "+t(C,ci.bold,ci.cyan),_++)}if(h(y),d.group(),vf(n)||h(zo(n,{renderErrorCause:!0})),_<m.length)for(;_<m.length;_++)h(hh(m[_]));if($C(r)>0)for(let[C,O]of r)h(t(`${C}:`,ci.bold,ci.white),hh(O));d.groupEnd()})},jbe=e=>{let t=e.colors?"%c":"";return _n(({annotations:r,cause:n,context:o,date:s,fiberId:i,logLevel:a,message:c,spans:l})=>{let f=td(o,Ot),d=jt(f,Zo).unsafe,h=Kl(c),m=`${t}[${e.formatDate(s)}]`,y=[];if(e.colors&&y.push("color:gray"),m+=` ${t}${a.label}${t} (${wf(i)})`,e.colors&&y.push(qbe[a._tag],""),Of(l)){let C=s.getTime(),O=ny(C);for(let U of l)m+=" "+O(U)}m+=":";let _=0;if(h.length>0){let C=yy(h[0]);typeof C=="string"&&(m+=` ${t}${C}`,e.colors&&y.push("color:deepskyblue"),_++)}if(d.groupCollapsed(m,...y),vf(n)||d.error(zo(n,{renderErrorCause:!0})),_<h.length)for(;_<h.length;_++)d.log(hh(h[_]));if($C(r)>0)for(let[C,O]of r){let U=hh(O);e.colors?d.log(`%c${C}:`,"color:gray",U):d.log(`${C}:`,U)}d.groupEnd()})},a_=ne("effect/Logger/prettyLoggerDefault",()=>hF());var o7="effect/MetricBoundaries",mF=Symbol.for(o7),xF=class{values;[mF]=mF;constructor(t){this.values=t,this._hash=p(Ke(o7),K(qo(this.values)))}_hash;[W](){return this._hash}[H](t){return $be(t)&&N(this.values,t.values)}pipe(){return v(this,arguments)}},$be=e=>F(e,mF),gF=e=>{let t=p(e,eR(G(Number.POSITIVE_INFINITY)),fR);return new xF(t)};var c_=e=>p(OE(e.count-1,t=>e.start*Math.pow(e.factor,t)),Le,gF);var Vbe="effect/MetricKeyType",Cy=Symbol.for(Vbe),i7="effect/MetricKeyType/Counter",bF=Symbol.for(i7),a7="effect/MetricKeyType/Frequency",yF=Symbol.for(a7),c7="effect/MetricKeyType/Gauge",SF=Symbol.for(c7),u7="effect/MetricKeyType/Histogram",EF=Symbol.for(u7),p7="effect/MetricKeyType/Summary",CF=Symbol.for(p7),wy={_In:e=>e,_Out:e=>e},wF=class{incremental;bigint;[Cy]=wy;[bF]=bF;constructor(t,r){this.incremental=t,this.bigint=r,this._hash=Ke(i7)}_hash;[W](){return this._hash}[H](t){return Wm(t)}pipe(){return v(this,arguments)}},Gbe=Ke(a7),OF=class{preregisteredWords;[Cy]=wy;[yF]=yF;constructor(t){this.preregisteredWords=t}[W](){return Gbe}[H](t){return IF(t)}pipe(){return v(this,arguments)}},Kbe=Ke(c7),_F=class{bigint;[Cy]=wy;[SF]=SF;constructor(t){this.bigint=t}[W](){return Kbe}[H](t){return RF(t)}pipe(){return v(this,arguments)}},kF=class{boundaries;[Cy]=wy;[EF]=EF;constructor(t){this.boundaries=t,this._hash=p(Ke(u7),K(M(this.boundaries)))}_hash;[W](){return this._hash}[H](t){return AF(t)&&N(this.boundaries,t.boundaries)}pipe(){return v(this,arguments)}},TF=class{maxAge;maxSize;error;quantiles;[Cy]=wy;[CF]=CF;constructor(t,r,n,o){this.maxAge=t,this.maxSize=r,this.error=n,this.quantiles=o,this._hash=p(Ke(p7),K(M(this.maxAge)),K(M(this.maxSize)),K(M(this.error)),K(qo(this.quantiles)))}_hash;[W](){return this._hash}[H](t){return MF(t)&&N(this.maxAge,t.maxAge)&&this.maxSize===t.maxSize&&this.error===t.error&&N(this.quantiles,t.quantiles)}pipe(){return v(this,arguments)}},l7=e=>new wF(e?.incremental??!1,e?.bigint??!1),f7=e=>new OF(e?.preregisteredWords??[]),d7=e=>new _F(e?.bigint??!1),h7=e=>new kF(e),m7=e=>new TF(Qe(e.maxAge),e.maxSize,e.error,e.quantiles);var Wm=e=>F(e,bF),IF=e=>F(e,yF),RF=e=>F(e,SF),AF=e=>F(e,EF),MF=e=>F(e,CF);var Qbe="effect/MetricKey",x7=Symbol.for(Qbe),Jbe={_Type:e=>e},Zbe=Mn(N),Xp=class{name;keyType;description;tags;[x7]=Jbe;constructor(t,r,n,o=[]){this.name=t,this.keyType=r,this.description=n,this.tags=o,this._hash=p(Ke(this.name+this.description),K(M(this.keyType)),K(qo(this.tags)))}_hash;[W](){return this._hash}[H](t){return Ybe(t)&&this.name===t.name&&N(this.keyType,t.keyType)&&N(this.description,t.description)&&Zbe(this.tags,t.tags)}pipe(){return v(this,arguments)}},Ybe=e=>F(e,x7),g7=(e,t)=>new Xp(e,l7(t),br(t?.description)),b7=(e,t)=>new Xp(e,f7(t),br(t?.description)),y7=(e,t)=>new Xp(e,d7(t),br(t?.description)),S7=(e,t,r)=>new Xp(e,h7(t),br(r)),E7=e=>new Xp(e.name,m7(e),br(e.description));var C7=u(2,(e,t)=>t.length===0?e:new Xp(e.name,e.keyType,e.description,fs(e.tags,t)));var eye="effect/MetricState",Oy=Symbol.for(eye),w7="effect/MetricState/Counter",PF=Symbol.for(w7),O7="effect/MetricState/Frequency",FF=Symbol.for(O7),_7="effect/MetricState/Gauge",NF=Symbol.for(_7),k7="effect/MetricState/Histogram",DF=Symbol.for(k7),T7="effect/MetricState/Summary",LF=Symbol.for(T7),_y={_A:e=>e},UF=class{count;[Oy]=_y;[PF]=PF;constructor(t){this.count=t}[W](){return p(M(w7),K(M(this.count)),ie(this))}[H](t){return rye(t)&&this.count===t.count}pipe(){return v(this,arguments)}},tye=Mn(N),qF=class{occurrences;[Oy]=_y;[FF]=FF;constructor(t){this.occurrences=t}_hash;[W](){return p(Ke(O7),K(qo(Ee(this.occurrences.entries()))),ie(this))}[H](t){return nye(t)&&tye(Ee(this.occurrences.entries()),Ee(t.occurrences.entries()))}pipe(){return v(this,arguments)}},HF=class{value;[Oy]=_y;[NF]=NF;constructor(t){this.value=t}[W](){return p(M(_7),K(M(this.value)),ie(this))}[H](t){return oye(t)&&this.value===t.value}pipe(){return v(this,arguments)}},WF=class{buckets;count;min;max;sum;[Oy]=_y;[DF]=DF;constructor(t,r,n,o,s){this.buckets=t,this.count=r,this.min=n,this.max=o,this.sum=s}[W](){return p(M(k7),K(M(this.buckets)),K(M(this.count)),K(M(this.min)),K(M(this.max)),K(M(this.sum)),ie(this))}[H](t){return sye(t)&&N(this.buckets,t.buckets)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return v(this,arguments)}},BF=class{error;quantiles;count;min;max;sum;[Oy]=_y;[LF]=LF;constructor(t,r,n,o,s,i){this.error=t,this.quantiles=r,this.count=n,this.min=o,this.max=s,this.sum=i}[W](){return p(M(T7),K(M(this.error)),K(M(this.quantiles)),K(M(this.count)),K(M(this.min)),K(M(this.max)),K(M(this.sum)),ie(this))}[H](t){return iye(t)&&this.error===t.error&&N(this.quantiles,t.quantiles)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return v(this,arguments)}},I7=e=>new UF(e),R7=e=>new qF(e),A7=e=>new HF(e),M7=e=>new WF(e.buckets,e.count,e.min,e.max,e.sum),v7=e=>new BF(e.error,e.quantiles,e.count,e.min,e.max,e.sum);var rye=e=>F(e,PF),nye=e=>F(e,FF),oye=e=>F(e,NF),sye=e=>F(e,DF),iye=e=>F(e,LF);var cye="effect/MetricHook",uye=Symbol.for(cye),pye={_In:e=>e,_Out:e=>e},ky=e=>({[uye]:pye,pipe(){return v(this,arguments)},...e});var P7=BigInt(0),N7=e=>{let t=e.keyType.bigint?P7:0,r=e.keyType.incremental?e.keyType.bigint?o=>o>=P7:o=>o>=0:o=>!0,n=o=>{r(o)&&(t=t+o)};return ky({get:()=>I7(t),update:n,modify:n})},D7=e=>{let t=new Map;for(let n of e.keyType.preregisteredWords)t.set(n,0);let r=n=>{let o=t.get(n)??0;t.set(n,o+1)};return ky({get:()=>R7(t),update:r,modify:r})},L7=(e,t)=>{let r=t;return ky({get:()=>A7(r),update:n=>{r=n},modify:n=>{r=r+n}})},U7=e=>{let t=e.keyType.boundaries.values,r=t.length,n=new Uint32Array(r+1),o=new Float64Array(r),s=0,i=0,a=Number.MAX_VALUE,c=Number.MIN_VALUE;p(t,dc(Ni),Mi((d,h)=>{o[h]=d}));let l=d=>{let h=0,m=r;for(;h!==m;){let y=Math.floor(h+(m-h)/2),_=o[y];d<=_?m=y:h=y,m===h+1&&(d<=o[h]?m=h:h=m)}n[h]=n[h]+1,s=s+1,i=i+d,d<a&&(a=d),d>c&&(c=d)},f=()=>{let d=Gl(r),h=0;for(let m=0;m<r;m++){let y=o[m],_=n[m];h=h+_,d[m]=[y,h]}return d};return ky({get:()=>M7({buckets:f(),count:s,min:a,max:c,sum:i}),update:l,modify:l})},q7=e=>{let{error:t,maxAge:r,maxSize:n,quantiles:o}=e.keyType,s=p(o,dc(Ni)),i=Gl(n),a=0,c=0,l=0,f=0,d=0,h=y=>{let _=[],C=0;for(;C!==n-1;){let O=i[C];if(O!=null){let[U,I]=O,Q=On(y-U);cb(Q,Pa)&&OC(Q,r)&&_.push(I)}C=C+1}return lye(t,s,dc(_,Ni))},m=(y,_)=>{if(n>0){a=a+1;let C=a%n;i[C]=[_,y]}f=c===0?y:Math.min(f,y),d=c===0?y:Math.max(d,y),c=c+1,l=l+y};return ky({get:()=>v7({error:t,quantiles:h(Date.now()),count:c,min:f,max:d,sum:l}),update:([y,_])=>m(y,_),modify:([y,_])=>m(y,_)})},lye=(e,t,r)=>{let n=r.length;if(!ut(t))return ds();let o=t[0],s=t.slice(1),i=F7(e,n,g(),0,o,r),a=Gr(i);return s.forEach(c=>{a.push(F7(e,n,i.value,i.consumed,c,i.rest))}),Mi(a,c=>[c.quantile,c.value])},F7=(e,t,r,n,o,s)=>{let i=e,a=t,c=r,l=n,f=o,d=s,h=e,m=t,y=r,_=n,C=o,O=s;for(;;){if(!ut(d))return{quantile:f,value:g(),consumed:l,rest:[]};if(f===1)return{quantile:f,value:x(nR(d)),consumed:l+d.length,rest:[]};let U=Ur(d),I=Az(d,ce=>ce===U),Q=f*a,J=i/2*Q,z=l+I[0].length,te=Math.abs(z-Q);if(z<Q-J){h=i,m=a,y=Ia(d),_=z,C=f,O=I[1],i=h,a=m,c=y,l=_,f=C,d=O;continue}if(z>Q+J){let ce=ge(c)?x(U):c;return{quantile:f,value:ce,consumed:l,rest:d}}switch(c._tag){case"None":{h=i,m=a,y=Ia(d),_=z,C=f,O=I[1],i=h,a=m,c=y,l=_,f=C,d=O;continue}case"Some":{let ce=Math.abs(Q-c.value);if(te<ce){h=i,m=a,y=Ia(d),_=z,C=f,O=I[1],i=h,a=m,c=y,l=_,f=C,d=O;continue}return{quantile:f,value:x(c.value),consumed:l,rest:d}}}}throw new Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/effect/issues")};var dye="effect/MetricPair",hye=Symbol.for(dye),mye={_Type:e=>e};var H7=(e,t)=>({[hye]:mye,metricKey:e,metricState:t,pipe(){return v(this,arguments)}});var gye="effect/MetricRegistry",W7=Symbol.for(gye),zF=class{[W7]=W7;map=Yf();snapshot(){let t=[];for(let[r,n]of this.map)t.push(H7(r,n.get()));return t}get(t){let r=p(this.map,Wr(t),yr);if(r==null){if(Wm(t.keyType))return this.getCounter(t);if(RF(t.keyType))return this.getGauge(t);if(IF(t.keyType))return this.getFrequency(t);if(AF(t.keyType))return this.getHistogram(t);if(MF(t.keyType))return this.getSummary(t);throw new Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/effect/issues")}else return r}getCounter(t){let r=p(this.map,Wr(t),yr);if(r==null){let n=N7(t);p(this.map,ea(t))||p(this.map,Qo(t,n)),r=n}return r}getFrequency(t){let r=p(this.map,Wr(t),yr);if(r==null){let n=D7(t);p(this.map,ea(t))||p(this.map,Qo(t,n)),r=n}return r}getGauge(t){let r=p(this.map,Wr(t),yr);if(r==null){let n=L7(t,t.keyType.bigint?BigInt(0):0);p(this.map,ea(t))||p(this.map,Qo(t,n)),r=n}return r}getHistogram(t){let r=p(this.map,Wr(t),yr);if(r==null){let n=U7(t);p(this.map,ea(t))||p(this.map,Qo(t,n)),r=n}return r}getSummary(t){let r=p(this.map,Wr(t),yr);if(r==null){let n=q7(t);p(this.map,ea(t))||p(this.map,Qo(t,n)),r=n}return r}},B7=()=>new zF;var yye="effect/Metric",jF=Symbol.for(yye),Sye={_Type:e=>e,_In:e=>e,_Out:e=>e},Ty=ne(Symbol.for("effect/Metric/globalMetricRegistry"),()=>B7()),oa=function(e,t,r,n){let o=Object.assign(s=>Dr(s,i=>ui(o,i)),{[jF]:Sye,keyType:e,unsafeUpdate:t,unsafeValue:r,unsafeModify:n,register(){return this.unsafeValue([]),this},pipe(){return v(this,arguments)}});return o},Bm=u(2,(e,t)=>oa(e.keyType,(r,n)=>e.unsafeUpdate(t(r),n),e.unsafeValue,(r,n)=>e.unsafeModify(t(r),n))),hd=(e,t)=>md(g7(e,t)),z7=(e,t)=>md(b7(e,t)),j7=u(2,(e,t)=>Bm(e,()=>t)),md=e=>{let t,r=new WeakMap,n=o=>{if(o.length===0)return t!==void 0||(t=Ty.get(e)),t;let s=r.get(o);return s!==void 0||(s=Ty.get(C7(e,o)),r.set(o,s)),s};return oa(e.keyType,(o,s)=>n(s).update(o),o=>n(o).get(),(o,s)=>n(s).modify(o))},$7=(e,t)=>md(y7(e,t)),zm=(e,t,r)=>md(S7(e,t,r)),V7=e=>Wm(e.keyType)?ui(e,e.keyType.bigint?BigInt(1):1):u_(e,e.keyType.bigint?BigInt(1):1),G7=u(2,(e,t)=>Wm(e.keyType)?ui(e,t):u_(e,t)),$F=u(2,(e,t)=>oa(e.keyType,e.unsafeUpdate,r=>t(e.unsafeValue(r)),e.unsafeModify)),K7=u(2,(e,t)=>oa(t(e.keyType),e.unsafeUpdate,e.unsafeValue,e.unsafeModify)),u_=u(2,(e,t)=>Hr(ni,r=>E(()=>e.unsafeModify(t,r)))),Q7=u(2,(e,t)=>ui(e,t)),J7=e=>oa(void 0,Mr,()=>e,Mr),Z7=e=>oa(void 0,Mr,e,Mr),Y7=e=>YF(VF(e)),VF=e=>md(E7(e)),jm=u(3,(e,t,r)=>GF(e,[id(t,r)])),X7=u(2,(e,t)=>$F(oa(e.keyType,(r,n)=>e.unsafeUpdate(r,fs(t(r),n)),e.unsafeValue,(r,n)=>e.unsafeModify(r,fs(t(r),n))),Mr)),GF=u(2,(e,t)=>oa(e.keyType,(r,n)=>e.unsafeUpdate(r,fs(t,n)),r=>e.unsafeValue(fs(t,r)),(r,n)=>e.unsafeModify(r,fs(t,n)))),eK=(e,t)=>{let r=c_({start:.5,factor:2,count:35}),n=p(zm(e,r,t),jm("time_unit","milliseconds"));return Bm(n,Qr)},tK=(e,t,r)=>{let n=p(zm(e,gF(t),r),jm("time_unit","milliseconds"));return Bm(n,Qr)},rK=u(2,(e,t)=>r=>Gt(r,{onFailure:n=>we(ui(e,t),Re(n)),onSuccess:n=>we(ui(e,t),S(n))})),nK=u(2,(e,t)=>KF(e,t,R)),KF=u(3,(e,t,r)=>{let n=o=>ui(t,r(o));return EO(e,o=>Vo(Ff(o),n))}),oK=u(2,(e,t)=>QF(e,t,R)),QF=u(3,(e,t,r)=>Yw(n=>{let o=n.unsafeCurrentTimeNanos();return Dr(e,s=>{let i=n.unsafeCurrentTimeNanos(),a=Ks(i-o);return ui(t,r(a))})})),sK=u(2,(e,t)=>JF(e,t,r=>r)),JF=u(3,(e,t,r)=>dy(e,o=>ui(t,r(o)))),iK=u(2,(e,t)=>ZF(e,t,r=>r)),ZF=u(3,(e,t,r)=>Dr(e,o=>ui(t,r(o)))),ui=u(2,(e,t)=>Hr(ni,r=>E(()=>e.unsafeUpdate(t,r)))),aK=e=>Hr(ni,t=>E(()=>e.unsafeValue(t))),YF=e=>Bm(e,t=>[t,Date.now()]),cK=u(2,(e,t)=>oa([e.keyType,t.keyType],(r,n)=>{let[o,s]=r;e.unsafeUpdate(o,n),t.unsafeUpdate(s,n)},r=>[e.unsafeValue(r),t.unsafeValue(r)],(r,n)=>{let[o,s]=r;e.unsafeModify(o,n),t.unsafeModify(s,n)})),XF=()=>Ty.snapshot(),uK=E(XF);var Eye="effect/Request",e2=Symbol.for(Eye),Cye={_E:e=>e,_A:e=>e},wye={...Sh,[e2]:Cye},lK=e=>F(e,e2);var fK=(function(){function e(t){t&&Object.assign(this,t)}return e.prototype=wye,e})();var t2=u(2,(e,t)=>Hr($O,r=>E(()=>{if(r.has(e)){let n=r.get(e);n.state.completed||(n.state.completed=!0,za(n.result,t))}})));var $m=class{count=0;observers=new Set;interrupted=!1;addObserver(t){this.observers.add(t)}removeObserver(t){this.observers.delete(t)}increment(){this.count++,this.observers.forEach(t=>t(this.count))}decrement(){this.count--,this.observers.forEach(t=>t(this.count))}};var el={Forward:0,Backward:1},p_=class e{self;stack;direction;count=0;constructor(t,r,n){this.self=t,this.stack=r,this.direction=n}clone(){return new e(this.self,this.stack.slice(),this.direction)}reversed(){return new e(this.self,this.stack.slice(),this.direction===el.Forward?el.Backward:el.Forward)}next(){let t=this.entry;switch(this.count++,this.direction===el.Forward?this.moveNext():this.movePrev(),t._tag){case"None":return{done:!0,value:this.count};case"Some":return{done:!1,value:t.value}}}get key(){return this.stack.length>0?x(this.stack[this.stack.length-1].key):g()}get value(){return this.stack.length>0?x(this.stack[this.stack.length-1].value):g()}get entry(){return ct(_E(this.stack),t=>[t.key,t.value])}get index(){let t=0,r=this.stack;if(r.length===0){let n=this.self._root;return n!=null?n.count:0}else r[r.length-1].left!=null&&(t=r[r.length-1].left.count);for(let n=r.length-2;n>=0;--n)r[n+1]===r[n].right&&(++t,r[n].left!=null&&(t+=r[n].left.count));return t}moveNext(){let t=this.stack;if(t.length===0)return;let r=t[t.length-1];if(r.right!=null)for(r=r.right;r!=null;)t.push(r),r=r.left;else for(t.pop();t.length>0&&t[t.length-1].right===r;)r=t[t.length-1],t.pop()}get hasNext(){let t=this.stack;if(t.length===0)return!1;if(t[t.length-1].right!=null)return!0;for(let r=t.length-1;r>0;--r)if(t[r-1].left===t[r])return!0;return!1}movePrev(){let t=this.stack;if(t.length===0)return;let r=t[t.length-1];if(r!=null&&r.left!=null)for(r=r.left;r!=null;)t.push(r),r=r.right;else for(t.pop();t.length>0&&t[t.length-1].left===r;)r=t[t.length-1],t.pop()}get hasPrev(){let t=this.stack;if(t.length===0)return!1;if(t[t.length-1].left!=null)return!0;for(let r=t.length-1;r>0;--r)if(t[r-1].right===t[r])return!0;return!1}};var fe={Red:0,Black:1},sa=({color:e,count:t,key:r,left:n,right:o,value:s})=>({color:e,key:r,value:s,left:n,right:o,count:t});function r2(e,t){e.key=t.key,e.value=t.value,e.left=t.left,e.right=t.right,e.color=t.color,e.count=t.count}var eu=({count:e,key:t,left:r,right:n,value:o},s)=>({color:s,key:t,value:o,left:r,right:n,count:e}),fr=e=>{e.count=1+(e.left?.count??0)+(e.right?.count??0)};var dK="effect/RedBlackTree",n2=Symbol.for(dK),kye={_Key:e=>e,_Value:e=>e},Tye={[n2]:kye,[W](){let e=M(dK);for(let t of this)e^=p(M(t[0]),K(M(t[1])));return ie(this,e)},[H](e){if(hK(e)){if((this._root?.count??0)!==(e._root?.count??0))return!1;let t=Array.from(e);return Array.from(this).every((r,n)=>{let o=t[n];return N(r[0],o[0])&&N(r[1],o[1])})}return!1},[Symbol.iterator](){let e=[],t=this._root;for(;t!=null;)e.push(t),t=t.left;return new p_(this,e,el.Forward)},toString(){return De(this.toJSON())},toJSON(){return{_id:"RedBlackTree",values:Array.from(this).map(ve)}},[he](){return this.toJSON()},pipe(){return v(this,arguments)}},Vm=(e,t)=>{let r=Object.create(Tye);return r._ord=e,r._root=t,r},hK=e=>F(e,n2),mK=e=>Vm(e,void 0),xK=u(2,(e,t)=>{let r=mK(t);for(let[n,o]of e)r=s2(r,n,o);return r});var gK=u(2,(e,t)=>{let r=e._ord,n=e._root;for(;n!==void 0;){let o=r(t,n.key);if(N(t,n.key))return x(n.value);o<=0?n=n.left:n=n.right}return g()});var o2=u(2,(e,t)=>X(gK(e,t))),s2=u(3,(e,t,r)=>{let n=e._ord,o=e._root,s=[],i=[];for(;o!=null;){let a=n(t,o.key);s.push(o),i.push(a),a<=0?o=o.left:o=o.right}s.push({color:fe.Red,key:t,value:r,left:void 0,right:void 0,count:1});for(let a=s.length-2;a>=0;--a){let c=s[a];i[a]<=0?s[a]={color:c.color,key:c.key,value:c.value,left:s[a+1],right:c.right,count:c.count+1}:s[a]={color:c.color,key:c.key,value:c.value,left:c.left,right:s[a+1],count:c.count+1}}for(let a=s.length-1;a>1;--a){let c=s[a-1],l=s[a];if(c.color===fe.Black||l.color===fe.Black)break;let f=s[a-2];if(f.left===c)if(c.left===l){let d=f.right;if(d&&d.color===fe.Red)c.color=fe.Black,f.right=eu(d,fe.Black),f.color=fe.Red,a-=1;else{if(f.color=fe.Red,f.left=c.right,c.color=fe.Black,c.right=f,s[a-2]=c,s[a-1]=l,fr(f),fr(c),a>=3){let h=s[a-3];h.left===f?h.left=c:h.right=c}break}}else{let d=f.right;if(d&&d.color===fe.Red)c.color=fe.Black,f.right=eu(d,fe.Black),f.color=fe.Red,a-=1;else{if(c.right=l.left,f.color=fe.Red,f.left=l.right,l.color=fe.Black,l.left=c,l.right=f,s[a-2]=l,s[a-1]=c,fr(f),fr(c),fr(l),a>=3){let h=s[a-3];h.left===f?h.left=l:h.right=l}break}}else if(c.right===l){let d=f.left;if(d&&d.color===fe.Red)c.color=fe.Black,f.left=eu(d,fe.Black),f.color=fe.Red,a-=1;else{if(f.color=fe.Red,f.right=c.left,c.color=fe.Black,c.left=f,s[a-2]=c,s[a-1]=l,fr(f),fr(c),a>=3){let h=s[a-3];h.right===f?h.right=c:h.left=c}break}}else{let d=f.left;if(d&&d.color===fe.Red)c.color=fe.Black,f.left=eu(d,fe.Black),f.color=fe.Red,a-=1;else{if(c.left=l.right,f.color=fe.Red,f.right=l.left,l.color=fe.Black,l.right=c,l.left=f,s[a-2]=l,s[a-1]=c,fr(f),fr(c),fr(l),a>=3){let h=s[a-3];h.right===f?h.right=l:h.left=l}break}}}return s[0].color=fe.Black,Vm(e._ord,s[0])}),bK=e=>yK(e,el.Forward);var yK=(e,t)=>{let r=e[Symbol.iterator](),n=0;return{[Symbol.iterator]:()=>yK(e,t),next:()=>{n++;let o=r.key;switch(t===el.Forward?r.moveNext():r.movePrev(),o._tag){case"None":return{done:!0,value:n};case"Some":return{done:!1,value:o.value}}}}};var SK=u(2,(e,t)=>{if(!o2(e,t))return e;let r=e._ord,n=r,o=e._root,s=[];for(;o!==void 0;){let c=n(t,o.key);s.push(o),N(t,o.key)?o=void 0:c<=0?o=o.left:o=o.right}if(s.length===0)return e;let i=new Array(s.length),a=s[s.length-1];i[i.length-1]={color:a.color,key:a.key,value:a.value,left:a.left,right:a.right,count:a.count};for(let c=s.length-2;c>=0;--c)a=s[c],a.left===s[c+1]?i[c]={color:a.color,key:a.key,value:a.value,left:i[c+1],right:a.right,count:a.count}:i[c]={color:a.color,key:a.key,value:a.value,left:a.left,right:i[c+1],count:a.count};if(a=i[i.length-1],a.left!==void 0&&a.right!==void 0){let c=i.length;for(a=a.left;a.right!=null;)i.push(a),a=a.right;let l=i[c-1];i.push({color:a.color,key:l.key,value:l.value,left:a.left,right:a.right,count:a.count}),i[c-1].key=a.key,i[c-1].value=a.value;for(let f=i.length-2;f>=c;--f)a=i[f],i[f]={color:a.color,key:a.key,value:a.value,left:a.left,right:i[f+1],count:a.count};i[c-1].left=i[c]}if(a=i[i.length-1],a.color===fe.Red){let c=i[i.length-2];c.left===a?c.left=void 0:c.right===a&&(c.right=void 0),i.pop();for(let l=0;l<i.length;++l)i[l].count--;return Vm(r,i[0])}else if(a.left!==void 0||a.right!==void 0){a.left!==void 0?r2(a,a.left):a.right!==void 0&&r2(a,a.right),a.color=fe.Black;for(let c=0;c<i.length-1;++c)i[c].count--;return Vm(r,i[0])}else{if(i.length===1)return Vm(r,void 0);{for(let l=0;l<i.length;++l)i[l].count--;let c=i[i.length-2];Iye(i),c.left===a?c.left=void 0:c.right=void 0}}return Vm(r,i[0])});var Iye=e=>{let t,r,n,o;for(let s=e.length-1;s>=0;--s){if(t=e[s],s===0){t.color=fe.Black;return}if(r=e[s-1],r.left===t){if(n=r.right,n!==void 0&&n.right!==void 0&&n.right.color===fe.Red){if(n=r.right=sa(n),o=n.right=sa(n.right),r.right=n.left,n.left=r,n.right=o,n.color=r.color,t.color=fe.Black,r.color=fe.Black,o.color=fe.Black,fr(r),fr(n),s>1){let i=e[s-2];i.left===r?i.left=n:i.right=n}e[s-1]=n;return}else if(n!==void 0&&n.left!==void 0&&n.left.color===fe.Red){if(n=r.right=sa(n),o=n.left=sa(n.left),r.right=o.left,n.left=o.right,o.left=r,o.right=n,o.color=r.color,r.color=fe.Black,n.color=fe.Black,t.color=fe.Black,fr(r),fr(n),fr(o),s>1){let i=e[s-2];i.left===r?i.left=o:i.right=o}e[s-1]=o;return}if(n!==void 0&&n.color===fe.Black)if(r.color===fe.Red){r.color=fe.Black,r.right=eu(n,fe.Red);return}else{r.right=eu(n,fe.Red);continue}else if(n!==void 0){if(n=sa(n),r.right=n.left,n.left=r,n.color=r.color,r.color=fe.Red,fr(r),fr(n),s>1){let i=e[s-2];i.left===r?i.left=n:i.right=n}e[s-1]=n,e[s]=r,s+1<e.length?e[s+1]=t:e.push(t),s=s+2}}else{if(n=r.left,n!==void 0&&n.left!==void 0&&n.left.color===fe.Red){if(n=r.left=sa(n),o=n.left=sa(n.left),r.left=n.right,n.right=r,n.left=o,n.color=r.color,t.color=fe.Black,r.color=fe.Black,o.color=fe.Black,fr(r),fr(n),s>1){let i=e[s-2];i.right===r?i.right=n:i.left=n}e[s-1]=n;return}else if(n!==void 0&&n.right!==void 0&&n.right.color===fe.Red){if(n=r.left=sa(n),o=n.right=sa(n.right),r.left=o.right,n.right=o.left,o.right=r,o.left=n,o.color=r.color,r.color=fe.Black,n.color=fe.Black,t.color=fe.Black,fr(r),fr(n),fr(o),s>1){let i=e[s-2];i.right===r?i.right=o:i.left=o}e[s-1]=o;return}if(n!==void 0&&n.color===fe.Black)if(r.color===fe.Red){r.color=fe.Black,r.left=eu(n,fe.Red);return}else{r.left=eu(n,fe.Red);continue}else if(n!==void 0){if(n=sa(n),r.left=n.right,n.right=r,n.color=r.color,r.color=fe.Red,fr(r),fr(n),s>1){let i=e[s-2];i.right===r?i.right=n:i.left=n}e[s-1]=n,e[s]=r,s+1<e.length?e[s+1]=t:e.push(t),s=s+2}}}};var EK=xK;var i2=o2,CK=s2,a2=bK;var wK=SK;var c2=Symbol.for("effect/SortedSet"),Aye={[c2]:{_A:e=>e},[W](){return p(M(this.keyTree),K(M(c2)),ie(this))},[H](e){return p2(e)&&N(this.keyTree,e.keyTree)},[Symbol.iterator](){return a2(this.keyTree)},toString(){return De(this.toJSON())},toJSON(){return{_id:"SortedSet",values:Array.from(this).map(ve)}},[he](){return this.toJSON()},pipe(){return v(this,arguments)}},u2=e=>{let t=Object.create(Aye);return t.keyTree=e,t},p2=e=>F(e,c2);var l_=u(2,(e,t)=>u2(EK(Array.from(e).map(r=>[r,!0]),t)));var kK=u(2,(e,t)=>i2(e.keyTree,t)?e:u2(CK(e.keyTree,t,!0)));var Mye=u(2,(e,t)=>{for(let r of e)if(!t(r))return!1;return!0});var vye=u(2,(e,t)=>i2(e.keyTree,t));var _K=u(2,(e,t)=>Mye(e,r=>vye(t,r)));var TK=u(2,(e,t)=>u2(wK(e.keyTree,t)));var f_=e=>a2(e.keyTree),IK=()=>(e,t)=>_K(e,t)&&_K(t,e);var Pye="effect/Supervisor",Qm=Symbol.for(Pye),Iy={_T:e=>e},Gm=class e{underlying;value0;[Qm]=Iy;constructor(t,r){this.underlying=t,this.value0=r}get value(){return this.value0}onStart(t,r,n,o){this.underlying.onStart(t,r,n,o)}onEnd(t,r){this.underlying.onEnd(t,r)}onEffect(t,r){this.underlying.onEffect(t,r)}onSuspend(t){this.underlying.onSuspend(t)}onResume(t){this.underlying.onResume(t)}map(t){return new e(this,p(this.value,k(t)))}zip(t){return new Km(this,t)}},Km=class e{left;right;_tag="Zip";[Qm]=Iy;constructor(t,r){this.left=t,this.right=r}get value(){return Hf(this.left.value,this.right.value)}onStart(t,r,n,o){this.left.onStart(t,r,n,o),this.right.onStart(t,r,n,o)}onEnd(t,r){this.left.onEnd(t,r),this.right.onEnd(t,r)}onEffect(t,r){this.left.onEffect(t,r),this.right.onEffect(t,r)}onSuspend(t){this.left.onSuspend(t),this.right.onSuspend(t)}onResume(t){this.left.onResume(t),this.right.onResume(t)}map(t){return new Gm(this,p(this.value,k(t)))}zip(t){return new e(this,t)}},h2=e=>F(e,Qm)&&_a(e,"Zip"),f2=class{[Qm]=Iy;fibers=new Set;get value(){return E(()=>Array.from(this.fibers))}onStart(t,r,n,o){this.fibers.add(o)}onEnd(t,r){this.fibers.delete(r)}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new Gm(this,p(this.value,k(t)))}zip(t){return new Km(this,t)}onRun(t,r){return t()}},d2=class{effect;[Qm]=Iy;constructor(t){this.effect=t}get value(){return this.effect}onStart(t,r,n,o){}onEnd(t,r){}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new Gm(this,p(this.value,k(t)))}zip(t){return new Km(this,t)}onRun(t,r){return t()}},RK=class{ref;[Qm]=Iy;constructor(t){this.ref=t}get value(){return E(()=>Ie(this.ref))}onStart(t,r,n,o){p(this.ref,Nn(p(Ie(this.ref),kK(o))))}onEnd(t,r){p(this.ref,Nn(p(Ie(this.ref),TK(r))))}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new Gm(this,p(this.value,k(t)))}zip(t){return new Km(this,t)}onRun(t,r){return t()}},Fye=()=>new f2,AK=E(Fye),Nye=e=>new d2(e),xd=ne("effect/Supervisor/none",()=>Nye(ae));var MK=Ep;var PK="Empty",FK="AddSupervisor",NK="RemoveSupervisor",DK="AndThen",Jm={_tag:PK},h_=(e,t)=>({_tag:DK,first:e,second:t}),Dye=(e,t)=>Lye(t,G(e)),Lye=(e,t)=>{let r=e,n=t;for(;Vt(n);){let o=wn(n);switch(o._tag){case PK:{n=ro(n);break}case FK:{r=r.zip(o.supervisor),n=ro(n);break}case NK:{r=m2(r,o.supervisor),n=ro(n);break}case DK:{n=Et(o.first)(Et(o.second)(ro(n)));break}}}return r},m2=(e,t)=>N(e,t)?xd:h2(e)?m2(e.left,t).zip(m2(e.right,t)):e,m_=e=>N(e,xd)?Zs():h2(e)?p(m_(e.left),Mc(m_(e.right))):Sf(e),Uye=(e,t)=>{if(N(e,t))return Jm;let r=m_(e),n=m_(t),o=p(n,kM(r),xp(Jm,(i,a)=>h_(i,{_tag:FK,supervisor:a}))),s=p(r,kM(n),xp(Jm,(i,a)=>h_(i,{_tag:NK,supervisor:a})));return h_(o,s)},LK=MK({empty:Jm,patch:Dye,combine:h_,diff:Uye});var g2=hd("effect_fiber_started",{incremental:!0}),g_=hd("effect_fiber_active"),b2=hd("effect_fiber_successes",{incremental:!0}),y2=hd("effect_fiber_failures",{incremental:!0}),S2=jm(zm("effect_fiber_lifetimes",c_({start:.5,factor:2,count:35})),"time_unit","milliseconds"),Ry="Continue",zye="Done",UK="Yield",jye={_E:e=>e,_A:e=>e},x_=e=>{throw new Error(`BUG: FiberRuntime - ${cc(e)} - please report an issue at https://github.com/Effect-TS/effect/issues`)},tu=Symbol.for("effect/internal/fiberRuntime/YieldedOp"),ru=ne("effect/internal/fiberRuntime/yieldedOpChannel",()=>({currentOp:null})),Ay={[xh]:(e,t,r)=>rt(()=>t.effect_instruction_i1(r)),OnStep:(e,t,r)=>ht(ht(r)),[gh]:(e,t,r)=>rt(()=>t.effect_instruction_i2(r)),[wg]:(e,t,r)=>(e.patchRuntimeFlags(e.currentRuntimeFlags,t.patch),Nc(e.currentRuntimeFlags)&&e.isInterrupted()?Be(e.getInterruptedCause()):ht(r)),[bh]:(e,t,r)=>(rt(()=>t.effect_instruction_i2(r)),rt(()=>t.effect_instruction_i0())?(e.pushStack(t),rt(()=>t.effect_instruction_i1())):ae),[zl]:(e,t,r)=>{let n=rt(()=>t.effect_instruction_i0.next(r));return n.done?ht(n.value):(e.pushStack(t),Sg(n.value))}},$ye={[VO]:(e,t,r,n)=>(e.processNewInterruptSignal(n.cause),Nc(t)?Be(n.cause):r),[KO]:(e,t,r,n)=>{throw new Error("It is illegal to have multiple concurrent run loops in a single fiber")},[GO]:(e,t,r,n)=>(n.onFiber(e,JP(t)),r),[QO]:(e,t,r,n)=>b(qa(),()=>r)},Vye=e=>Vo(U5(e),t=>es(H5(t),([r,n])=>{let o=new Map,s=[];for(let a of n){s.push(Zt(a));for(let c of a)o.set(c.request,c)}let i=s.flat();return Lt(rSe(r.runAll(s),i,()=>i.forEach(a=>{a.listeners.interrupted=!0})),$O,o)},!1,!1)),Gye=_g(),My=class extends un{[qm]=by;[YO]=jye;_fiberRefs;_fiberId;_queue=new Array;_children=null;_observers=new Array;_running=!1;_stack=[];_asyncInterruptor=null;_asyncBlockingOn=null;_exitValue=null;_steps=[];_isYielding=!1;currentRuntimeFlags;currentOpCount=0;currentSupervisor;currentScheduler;currentTracer;currentSpan;currentContext;currentDefaultServices;constructor(t,r,n){if(super(),this.currentRuntimeFlags=n,this._fiberId=t,this._fiberRefs=r,ZM(n)){let o=this.getFiberRef(ni);g2.unsafeUpdate(1,o),g_.unsafeUpdate(1,o)}this.refreshRefCache()}commit(){return _s(this)}id(){return this._fiberId}resume(t){this.tell(dd(t))}get status(){return this.ask((t,r)=>r)}get runtimeFlags(){return this.ask((t,r)=>kG(r)?t.currentRuntimeFlags:r.runtimeFlags)}scope(){return jG(this)}get children(){return this.ask(t=>Array.from(t.getChildren()))}getChildren(){return this._children===null&&(this._children=new Set),this._children}getInterruptedCause(){return this.getFiberRef(Lp)}fiberRefs(){return this.ask(t=>t.getFiberRefs())}ask(t){return q(()=>{let r=Yi(this._fiberId);return this.tell(Um((n,o)=>{za(r,E(()=>t(n,o)))})),Ut(r)})}tell(t){this._queue.push(t),this._running||(this._running=!0,this.drainQueueLaterOnExecutor())}get await(){return oo(t=>{let r=n=>t(S(n));return this.tell(Um((n,o)=>{n._exitValue!==null?r(this._exitValue):n.addObserver(r)})),E(()=>this.tell(Um((n,o)=>{n.removeObserver(r)})))},this.id())}get inheritAll(){return de((t,r)=>{let n=t.id(),o=t.getFiberRefs(),s=r.runtimeFlags,i=this.getFiberRefs(),a=eO(o,n,i);t.setFiberRefs(a);let c=t.getFiberRef(WK),l=p(Xs(s,c),tv($i),tv(tw));return Pp(l)})}get poll(){return E(()=>br(this._exitValue))}unsafePoll(){return this._exitValue}interruptAsFork(t){return E(()=>this.tell(JO(To(t))))}unsafeInterruptAsFork(t){this.tell(JO(To(t)))}addObserver(t){this._exitValue!==null?t(this._exitValue):this._observers.push(t)}removeObserver(t){this._observers=this._observers.filter(r=>r!==t)}getFiberRefs(){return this.setFiberRef(WK,this.currentRuntimeFlags),this._fiberRefs}unsafeDeleteFiberRef(t){this._fiberRefs=km(this._fiberRefs,t)}getFiberRef(t){return this._fiberRefs.locals.has(t)?this._fiberRefs.locals.get(t)[0][1]:t.initial}setFiberRef(t,r){this._fiberRefs=ed(this._fiberRefs,{fiberId:this._fiberId,fiberRef:t,value:r}),this.refreshRefCache()}refreshRefCache(){this.currentDefaultServices=this.getFiberRef(Ot),this.currentTracer=this.currentDefaultServices.unsafeMap.get(Kc.key),this.currentSupervisor=this.getFiberRef(__),this.currentScheduler=this.getFiberRef(na),this.currentContext=this.getFiberRef(Xr),this.currentSpan=this.currentContext.unsafeMap.get(cn.key)}setFiberRefs(t){this._fiberRefs=t,this.refreshRefCache()}addChild(t){this.getChildren().add(t)}removeChild(t){this.getChildren().delete(t)}transferChildren(t){let r=this._children;if(this._children=null,r!==null&&r.size>0)for(let n of r)n._exitValue===null&&t.add(this.currentRuntimeFlags,n)}drainQueueOnCurrentThread(){let t=!0;for(;t;){let r=Ry,n=globalThis[Yp];globalThis[Yp]=this;try{for(;r===Ry;)r=this._queue.length===0?zye:this.evaluateMessageWhileSuspended(this._queue.splice(0,1)[0])}finally{this._running=!1,globalThis[Yp]=n}this._queue.length>0&&!this._running?(this._running=!0,r===UK?(this.drainQueueLaterOnExecutor(),t=!1):t=!0):t=!1}}drainQueueLaterOnExecutor(){this.currentScheduler.scheduleTask(this.run,this.getFiberRef(Ji))}drainQueueWhileRunning(t,r){let n=r;for(;this._queue.length>0;){let o=this._queue.splice(0,1)[0];n=$ye[o._tag](this,t,n,o)}return n}isInterrupted(){return!vf(this.getFiberRef(Lp))}addInterruptedCause(t){let r=this.getFiberRef(Lp);this.setFiberRef(Lp,Rt(r,t))}processNewInterruptSignal(t){this.addInterruptedCause(t),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(this._children===null||this._children.size===0)return!1;let t=!1;for(let r of this._children)r.tell(JO(To(this.id()))),t=!0;return t}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){let t=this._children.values();this._children=null;let r=!1;return Fp({while:()=>!r,body:()=>{let o=t.next();return o.done?E(()=>{r=!0}):Ct(o.value.await)},step:()=>{}})}return null}reportExitValue(t){if(ZM(this.currentRuntimeFlags)){let r=this.getFiberRef(ni),n=this.id().startTimeMillis,o=Date.now();switch(S2.unsafeUpdate(o-n,r),g_.unsafeUpdate(-1,r),t._tag){case xt:{b2.unsafeUpdate(1,r);break}case mt:{y2.unsafeUpdate(1,r);break}}}if(t._tag==="Failure"){let r=this.getFiberRef(dm);!Pf(t.cause)&&r._tag==="Some"&&this.log("Fiber terminated with an unhandled error",t.cause,r)}}setExitValue(t){this._exitValue=t,this.reportExitValue(t);for(let r=this._observers.length-1;r>=0;r--)this._observers[r](t);this._observers=[]}getLoggers(){return this.getFiberRef(E_)}log(t,r,n){let o=X(n)?n.value:this.getFiberRef(Hb),s=this.getFiberRef(vy);if(cO(s,o))return;let i=this.getFiberRef(Wb),a=this.getFiberRef(Wa),c=this.getLoggers(),l=this.getFiberRefs();if(Ac(c)>0){let f=jt(this.getFiberRef(Ot),Mo),d=new Date(f.unsafeCurrentTimeMillis());oz(l,()=>{for(let h of c)h.log({fiberId:this.id(),logLevel:o,message:t,cause:r,context:l,spans:i,annotations:a,date:d})})}}evaluateMessageWhileSuspended(t){switch(t._tag){case QO:return UK;case VO:return this.processNewInterruptSignal(t.cause),this._asyncInterruptor!==null&&(this._asyncInterruptor(Be(t.cause)),this._asyncInterruptor=null),Ry;case KO:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(t.effect),Ry;case GO:return t.onFiber(this,this._exitValue!==null?OG:_G(this.currentRuntimeFlags,this._asyncBlockingOn)),Ry;default:return x_(t)}}evaluateEffect(t){this.currentSupervisor.onResume(this);try{let r=Nc(this.currentRuntimeFlags)&&this.isInterrupted()?Be(this.getInterruptedCause()):t;for(;r!==null;){let n=r,o=this.runLoop(n);if(o===tu){let s=ru.currentOp;ru.currentOp=null,s._op===yh?F5(this.currentRuntimeFlags)?(this.tell(BG()),this.tell(dd(en)),r=null):r=en:s._op===Bl&&(r=null)}else{this.currentRuntimeFlags=p(this.currentRuntimeFlags,nw(tw));let s=this.interruptAllChildren();s!==null?r=b(s,()=>o):(this._queue.length===0?this.setExitValue(o):this.tell(dd(o)),r=null)}}}finally{this.currentSupervisor.onSuspend(this)}}start(t){if(this._running)this.tell(dd(t));else{this._running=!0;let r=globalThis[Yp];globalThis[Yp]=this;try{this.evaluateEffect(t)}finally{this._running=!1,globalThis[Yp]=r,this._queue.length>0&&this.drainQueueLaterOnExecutor()}}}startFork(t){this.tell(dd(t))}patchRuntimeFlags(t,r){let n=Dc(t,r);return globalThis[Yp]=this,this.currentRuntimeFlags=n,n}initiateAsync(t,r){let n=!1,o=s=>{n||(n=!0,this.tell(dd(s)))};Nc(t)&&(this._asyncInterruptor=o);try{r(o)}catch(s){o(Re(Nr(s)))}}pushStack(t){this._stack.push(t),t._op==="OnStep"&&this._steps.push({refs:this.getFiberRefs(),flags:this.currentRuntimeFlags})}popStack(){let t=this._stack.pop();if(t)return t._op==="OnStep"&&this._steps.pop(),t}getNextSuccessCont(){let t=this.popStack();for(;t;){if(t._op!==mh)return t;t=this.popStack()}}getNextFailCont(){let t=this.popStack();for(;t;){if(t._op!==xh&&t._op!==bh&&t._op!==zl)return t;t=this.popStack()}}Tag(t){return E(()=>Pn(this.currentContext,t))}Left(t){return ke(t.left)}None(t){return ke(new Ao)}Right(t){return ht(t.right)}Some(t){return ht(t.value)}Micro(t){return cm(r=>{let n=r,o=UG(DG(t,this.currentContext));return o.addObserver(s=>{if(s._tag==="Success")return n(ht(s.value));switch(s.cause._tag){case"Interrupt":return n(Be(To(Dn)));case"Fail":return n(ke(s.cause.error));case"Die":return n(so(s.cause.defect))}}),cm(s=>{n=i=>{s(ae)},o.unsafeInterrupt()})})}[fE](t){let r=rt(()=>t.effect_instruction_i0()),n=this.getNextSuccessCont();return n!==void 0?(n._op in Ay||x_(n),Ay[n._op](this,n,r)):(ru.currentOp=ht(r),tu)}[xt](t){let r=t,n=this.getNextSuccessCont();return n!==void 0?(n._op in Ay||x_(n),Ay[n._op](this,n,r.effect_instruction_i0)):(ru.currentOp=r,tu)}[mt](t){let r=t.effect_instruction_i0,n=this.getNextFailCont();if(n!==void 0)switch(n._op){case mh:case gh:return Nc(this.currentRuntimeFlags)&&this.isInterrupted()?Be(uw(r)):rt(()=>n.effect_instruction_i1(r));case"OnStep":return Nc(this.currentRuntimeFlags)&&this.isInterrupted()?Be(uw(r)):ht(Be(r));case wg:return this.patchRuntimeFlags(this.currentRuntimeFlags,n.patch),Nc(this.currentRuntimeFlags)&&this.isInterrupted()?Be(Rt(r,this.getInterruptedCause())):Be(r);default:x_(n)}else return ru.currentOp=Be(r),tu}[dE](t){return rt(()=>t.effect_instruction_i0(this,JP(this.currentRuntimeFlags)))}Blocked(t){let r=this.getFiberRefs(),n=this.currentRuntimeFlags;if(this._steps.length>0){let o=[],s=this._steps[this._steps.length-1],i=this.popStack();for(;i&&i._op!=="OnStep";)o.push(i),i=this.popStack();this.setFiberRefs(s.refs),this.currentRuntimeFlags=s.flags;let a=ud(s.refs,r),c=Xs(s.flags,n);return ht(Lc(t.effect_instruction_i0,de(l=>{for(;o.length>0;)l.pushStack(o.pop());return l.setFiberRefs(pd(l.id(),l.getFiberRefs())(a)),l.currentRuntimeFlags=Dc(c)(l.currentRuntimeFlags),t.effect_instruction_i1})))}return er(o=>b(Xm(yw(t.effect_instruction_i0)),()=>o(t.effect_instruction_i1)))}RunBlocked(t){return Vye(t.effect_instruction_i0)}[pc](t){let r=t.effect_instruction_i0,n=this.currentRuntimeFlags,o=Dc(n,r);if(Nc(o)&&this.isInterrupted())return Be(this.getInterruptedCause());if(this.patchRuntimeFlags(this.currentRuntimeFlags,r),t.effect_instruction_i1){let s=Xs(o,n);return this.pushStack(new dw(s,t)),rt(()=>t.effect_instruction_i1(n))}else return en}[xh](t){return this.pushStack(t),t.effect_instruction_i0}OnStep(t){return this.pushStack(t),t.effect_instruction_i0}[mh](t){return this.pushStack(t),t.effect_instruction_i0}[gh](t){return this.pushStack(t),t.effect_instruction_i0}[Bl](t){return this._asyncBlockingOn=t.effect_instruction_i1,this.initiateAsync(this.currentRuntimeFlags,t.effect_instruction_i0),ru.currentOp=t,tu}[yh](t){return this._isYielding=!1,ru.currentOp=t,tu}[bh](t){let r=t.effect_instruction_i0,n=t.effect_instruction_i1;return r()?(this.pushStack(t),n()):en}[zl](t){return Ay[zl](this,t,void 0)}[uc](t){return rt(()=>t.commit())}runLoop(t){let r=t;for(this.currentOpCount=0;;){if((this.currentRuntimeFlags&P5)!==0&&this.currentSupervisor.onEffect(this,r),this._queue.length>0&&(r=this.drainQueueWhileRunning(this.currentRuntimeFlags,r)),!this._isYielding){this.currentOpCount+=1;let n=this.currentScheduler.shouldYield(this);if(n!==!1){this._isYielding=!0,this.currentOpCount=0;let o=r;r=b(qa({priority:n}),()=>o)}}try{if(r=this.currentTracer.context(()=>{if(Gye!==r[Uc]._V){let n=this.getFiberRef(zb);if(n._tag==="Some"){let o=r[Uc]._V;this.log(`Executing an Effect versioned ${o} with a Runtime of version ${_g()}, you may want to dedupe the effect dependencies, you can use the language service plugin to detect this at compile time: https://github.com/Effect-TS/language-service`,Ln,n)}}return this[r._op](r)},this),r===tu){let n=ru.currentOp;return n._op===yh||n._op===Bl?tu:(ru.currentOp=null,n._op===xt||n._op===mt?n:Be(Nr(n)))}}catch(n){r!==tu&&!F(r,"_op")||!(r._op in this)?r=Ip(`Not a valid effect: ${cc(r)}`):Rv(n)?r=Be(Rt(Nr(n),To(Dn))):r=so(n)}}}run=()=>{this.drainQueueOnCurrentThread()}},vy=ne("effect/FiberRef/currentMinimumLogLevel",()=>lr(uO("Info"))),Ym=e=>_n(t=>{let r=td(t.context,Ot);jt(r,Zo).unsafe.log(e.log(t))}),zK=e=>_n(t=>{let r=td(t.context,Ot),n=jt(r,Zo).unsafe;switch(t.logLevel._tag){case"Debug":return n.debug(e.log(t));case"Info":return n.info(e.log(t));case"Trace":return n.trace(e.log(t));case"Warning":return n.warn(e.log(t));case"Error":case"Fatal":return n.error(e.log(t));default:return n.log(e.log(t))}}),jK=e=>_n(t=>{let r=td(t.context,Ot);jt(r,Zo).unsafe.error(e.log(t))}),bd=ne(Symbol.for("effect/Logger/defaultLogger"),()=>Ym(o_)),$K=ne(Symbol.for("effect/Logger/jsonLogger"),()=>Ym(i_)),VK=ne(Symbol.for("effect/Logger/logFmtLogger"),()=>Ym(s_)),GK=ne(Symbol.for("effect/Logger/prettyLogger"),()=>a_),KK=ne(Symbol.for("effect/Logger/structuredLogger"),()=>Ym(Ey)),E2=ne(Symbol.for("effect/Logger/tracerLogger"),()=>_n(({annotations:e,cause:t,context:r,fiberId:n,logLevel:o,message:s})=>{let i=xs(Jc(r,Xr),cn);if(i._tag==="None"||i.value._tag==="ExternalSpan")return;let a=Pn(Jc(r,Ot),Mo),c={};for(let[l,f]of e)c[l]=f;c["effect.fiberId"]=i5(n),c["effect.logLevel"]=o.label,t!==null&&t._tag!=="Empty"&&(c["effect.cause"]=zo(t,{renderErrorCause:!0})),i.value.event(cc(Array.isArray(s)&&s.length===1?s[0]:s),a.unsafeCurrentTimeNanos(),c)})),QK=e=>t_(e,t=>{let r=kr(ey(t.context,Xr),xs(cn));return r._tag==="None"?t:{...t,annotations:p(t.annotations,sn("effect.traceId",r.value.traceId),sn("effect.spanId",r.value.spanId),r.value._tag==="Span"?sn("effect.spanName",r.value.name):R)}}),E_=ne(Symbol.for("effect/FiberRef/currentLoggers"),()=>kv(Sf(bd,E2))),JK=u(3,(e,t,r)=>b(O_,n=>{let o=[],s=q(()=>{if(o.length===0)return ae;let i=o;return o=[],r(i)});return er(i=>p(Qa(t),we(s),xO,i,Xm,b(a=>mm(n,Hc(a))),we(ia(()=>s)),tt(_n(a=>{o.push(e.log(a))}))))})),ZK=function(){if(typeof arguments[0]=="string")return pn(Wa,sn(arguments[0],arguments[1]));let e=Object.entries(arguments[0]);return pn(Wa,u5(t=>{for(let r=0;r<e.length;r++){let[n,o]=e[r];sn(t,n,o)}return t}))},YK=u(2,(e,t)=>{let r=typeof t=="string"?uO(t):t;return de(n=>{let o=n.getFiberRef(vy);return cO(o,r)?S(g()):k(e,x)})}),tl=u(e=>et(e[0]),(e,t)=>Go(Dr(e,r=>ia(n=>t(r,n))))),XK=u(e=>et(e[0]),(e,t)=>rs(e,ia(r=>t(r)))),ia=e=>de(t=>{let r=t.getFiberRefs(),n=rw(t.currentRuntimeFlags,$i);return b(O_,o=>Up(o,s=>de(i=>{let a=i.getFiberRefs(),c=i.currentRuntimeFlags,l=ud(a,r),f=Xs(c,n),d=ud(r,a);return i.setFiberRefs(pd(l,i.id(),r)),rs(Tw(e(s),f),E(()=>{i.setFiberRefs(pd(d,i.id(),i.getFiberRefs()))}))})))}),eQ=e=>Lt(Mb,x(Xc))(e),qK=Symbol.for("effect/Effect/existsPar/found"),tQ=u(e=>Lo(e[0])&&!et(e[0]),(e,t,r)=>gy(r?.concurrency,()=>q(()=>rQ(e[Symbol.iterator](),0,t)),()=>Zr(ks(e,(n,o)=>ww(t(n,o),{onTrue:()=>ke(qK),onFalse:()=>ae}),r),{onFailure:n=>n===qK?S(!0):ke(n),onSuccess:()=>S(!1)}))),rQ=(e,t,r)=>{let n=e.next();return n.done?S(!1):b(r(n.value,t),o=>o?S(o):rQ(e,t+1,r))},nQ=u(e=>Lo(e[0])&&!et(e[0]),(e,t,r)=>{let n=r?.negate?(o,s)=>k(t(o,s),nb):t;return gy(r?.concurrency,()=>q(()=>Ee(e).reduceRight((o,s,i)=>Ha(o,q(()=>n(s,i)),(a,c)=>c?[s,...a]:a),E(()=>new Array))),()=>k(ks(e,(o,s)=>k(n(o,s),i=>i?x(o):g()),r),Nz))}),Kye=e=>{if(Array.isArray(e)||Lo(e))return[e,g()];let t=Object.keys(e),r=t.length;return[t.map(n=>e[n]),x(n=>{let o={};for(let s=0;s<r;s++)o[t[s]]=n[s];return o})]},Qye=(e,t,r)=>{let n=[];for(let o of e)n.push(ei(o));return b(ks(n,R,{concurrency:r?.concurrency,batching:r?.batching,concurrentFinalizers:r?.concurrentFinalizers}),o=>{let s=g(),i=o.length,a=new Array(i),c=new Array(i),l=!1;for(let f=0;f<i;f++){let d=o[f];d._tag==="Left"?(a[f]=x(d.left),l=!0):(c[f]=d.right,a[f]=s)}return l?t._tag==="Some"?ke(t.value(a)):ke(a):r?.discard?ae:t._tag==="Some"?S(t.value(c)):S(c)})},Jye=(e,t,r)=>{let n=[];for(let o of e)n.push(ei(o));return r?.discard?ks(n,R,{concurrency:r?.concurrency,batching:r?.batching,discard:!0,concurrentFinalizers:r?.concurrentFinalizers}):k(ks(n,R,{concurrency:r?.concurrency,batching:r?.batching,concurrentFinalizers:r?.concurrentFinalizers}),o=>t._tag==="Some"?t.value(o):o)},Ja=(e,t)=>{let[r,n]=Kye(e);return t?.mode==="validate"?Qye(r,n,t):t?.mode==="either"?Jye(r,n,t):t?.discard!==!0&&n._tag==="Some"?k(ks(r,R,t),n.value):ks(r,R,t)},oQ=e=>t=>Ja(t,e),sQ=(e,t)=>k(Ja(Ee(e).map(pr),t),hc(r=>Kb(r)?x(r.effect_instruction_i0):g())),C2=u(2,(e,t)=>Array.from({length:t},()=>e)),iQ=u(e=>et(e[0]),(e,t,r)=>Ja(C2(e,t),r)),ks=u(e=>Lo(e[0]),(e,t,r)=>de(n=>{let o=r?.batching===!0||r?.batching==="inherit"&&n.getFiberRef(fm);return r?.discard?iF(r.concurrency,()=>gd(vm,r?.concurrentFinalizers)(s=>o?es(e,(i,a)=>s(t(i,a)),!0,!1,1):Vo(e,(i,a)=>s(t(i,a)))),()=>gd(kO,r?.concurrentFinalizers)(s=>es(e,(i,a)=>s(t(i,a)),o,!1)),s=>gd(TO(s),r?.concurrentFinalizers)(i=>es(e,(a,c)=>i(t(a,c)),o,!1,s))):iF(r?.concurrency,()=>gd(vm,r?.concurrentFinalizers)(s=>o?x2(e,1,(i,a)=>s(t(i,a)),!0):Un(e,(i,a)=>s(t(i,a)))),()=>gd(kO,r?.concurrentFinalizers)(s=>Zm(e,(i,a)=>s(t(i,a)),o)),s=>gd(TO(s),r?.concurrentFinalizers)(i=>x2(e,s,(a,c)=>i(t(a,c)),o)))})),Zm=(e,t,r)=>q(()=>{let n=Ee(e),o=new Array(n.length);return we(es(n,(i,a)=>b(t(i,a),c=>E(()=>o[a]=c)),r,!1),S(o))}),es=(e,t,r,n,o)=>er(s=>_w(i=>de(a=>{let c=Array.from(e).reverse(),l=c.length;if(l===0)return ae;let f=0,d=!1,h=o?Math.min(c.length,o):c.length,m=new Set,y=new Array,_=()=>m.forEach(ce=>{ce.currentScheduler.scheduleTask(()=>{ce.unsafeInterruptAsFork(a.id())},0)}),C=new Array,O=new Array,U=new Array,I=()=>{let ce=y.filter(({exit:Ye})=>Ye._tag==="Failure").sort((Ye,at)=>Ye.index<at.index?-1:Ye.index===at.index?0:1).map(({exit:Ye})=>Ye);return ce.length===0&&ce.push(en),ce},Q=(ce,Ye=!1)=>{let at=Go(i(ce)),Ue=Zye(at,a,a.currentRuntimeFlags,Xc);return a.currentScheduler.scheduleTask(()=>{Ye&&Ue.unsafeInterruptAsFork(a.id()),Ue.resume(at)},0),Ue},J=()=>{n||(l-=c.length,c=[]),d=!0,_()},z=r?Cw:pr,te=Q(oo(ce=>{let Ye=(Ue,_r)=>{Ue._op==="Blocked"?U.push(Ue):(y.push({index:_r,exit:Ue}),Ue._op==="Failure"&&!d&&J())},at=()=>{if(c.length>0){let Ue=c.pop(),_r=f++,Ns=()=>{let Rn=c.pop();return _r=f++,b(qa(),()=>b(z(s(t(Rn,_r))),Ds))},Ds=Rn=>c.length>0&&(Ye(Rn,_r),c.length>0)?Ns():S(Rn),Oi=b(z(s(t(Ue,_r))),Ds),Yn=Q(Oi);C.push(Yn),m.add(Yn),d&&Yn.currentScheduler.scheduleTask(()=>{Yn.unsafeInterruptAsFork(a.id())},0),Yn.addObserver(Rn=>{let Ls;if(Rn._op==="Failure"?Ls=Rn:Ls=Rn.effect_instruction_i0,O.push(Yn),m.delete(Yn),Ye(Ls,_r),y.length===l)ce(S(_e(qp(I(),{parallel:!0}),()=>en)));else if(U.length+y.length===l){let ch=I(),w1=U.map(xg=>xg.effect_instruction_i0).reduce(sv);ce(S(Lc(w1,es([_e(qp(ch,{parallel:!0}),()=>en),...U.map(xg=>xg.effect_instruction_i1)],xg=>xg,r,!0,o))))}else at()})}};for(let Ue=0;Ue<h;Ue++)at()}));return Ct(Io($o(s(_s(te))),Vf({onFailure:ce=>{J();let Ye=U.length+1,at=Math.min(typeof o=="number"?o:U.length,U.length),Ue=Array.from(U);return oo(_r=>{let Ns=[],Ds=0,Oi=0,Yn=(Ls,ch)=>w1=>{Ns[Ls]=w1,Ds++,Ds===Ye&&_r(ht(Be(ce))),Ue.length>0&&ch&&Rn()},Rn=()=>{Q(Ue.pop(),!0).addObserver(Yn(Oi,!0)),Oi++};te.addObserver(Yn(Oi,!1)),Oi++;for(let Ls=0;Ls<at;Ls++)Rn()})},onSuccess:()=>Un(O,ce=>ce.inheritAll)})))}))),x2=(e,t,r,n)=>q(()=>{let o=Ee(e),s=new Array(o.length);return we(es(o,(a,c)=>k(r(a,c),l=>s[c]=l),n,!1,t),S(s))}),nu=e=>de((t,r)=>S(Py(e,t,r.runtimeFlags))),Xm=e=>Yye(e,Xc),aQ=u(2,(e,t)=>nu(Ow(e,r=>{let n=Gi(r);switch(n._tag){case"Left":return t(n.left);case"Right":return Re(n.right)}}))),Py=(e,t,r,n=null)=>{let o=b_(e,t,r,n);return o.resume(e),o},Zye=(e,t,r,n=null)=>b_(e,t,r,n),b_=(e,t,r,n=null)=>{let o=jC(),s=t.getFiberRefs(),i=mP(s,o),a=new My(o,i,r),c=Jc(i,Xr),l=a.currentSupervisor;return l.onStart(c,e,x(t),a),a.addObserver(d=>l.onEnd(d,a)),(n!==null?n:p(t.getFiberRef(Mb),_e(()=>t.scope()))).add(r,a),a},Yye=(e,t)=>de((r,n)=>S(Py(e,r,n.runtimeFlags,t))),w2=u(e=>ki(e[2]),(e,t,r,n)=>gy(n?.concurrency,()=>Ee(e).reduce((o,s,i)=>Ha(o,s,(a,c)=>r(a,c,i)),S(t)),()=>b(tr(t),o=>b(ks(e,(s,i)=>b(s,a=>Os(o,c=>r(c,a,i))),n),()=>_t(o))))),O2=u(e=>Lo(e[0]),(e,t,r)=>p(ks(e,(n,o)=>ei(t(n,o)),r),k(n=>i$(n,R)))),cQ=u(e=>Lo(e[0]),(e,t,r)=>b(O2(e,t,{concurrency:r?.concurrency,batching:r?.batching,concurrentFinalizers:r?.concurrentFinalizers}),([n,o])=>Ri(n)?ke(n):r?.discard?ae:S(o))),uQ=e=>de((t,r)=>oo(n=>{let o=new Set,s,i=Ln,a=()=>{for(let f of o)f.unsafeInterruptAsFork(t.id())},c=!1,l=!0;for(let f of e){l=!1;let d=Py(Ki(f),t,r.runtimeFlags);if(o.add(d),d.addObserver(h=>{o.delete(d),s||(h._tag==="Success"?(c=!0,s=d,i=Ln,a()):i=Jr(h.cause,i)),c&&o.size===0&&n(s?we(e_(s),s.unsafePoll()):Re(i))}),s)break}return l?n(Rp(()=>new jf("Received an empty collection of effects"))):(c=!0,pF(o,t.id()))})),pQ=u(e=>Lo(e[0])&&!et(e[0]),(e,t,r,n)=>gy(n?.concurrency,()=>Ee(e).reduce((o,s,i)=>Ha(o,s,(a,c)=>r(a,c,i)),t),()=>q(()=>p(w2([t,...e],g(),(o,s,i)=>{switch(o._tag){case"None":return x(s);case"Some":return x(r(o.value,s,i))}},n),k(o=>{switch(o._tag){case"None":throw new Error("BUG: Effect.reduceEffect - please report an issue at https://github.com/Effect-TS/effect/issues");case"Some":return o.value}}))))),y_=e=>si(t=>$(xs(t,ts),{onNone:()=>e,onSome:r=>{switch(r.strategy._tag){case"Parallel":return e;case"Sequential":case"ParallelN":return b(Es(r,kO),n=>Za(e,n))}}})),HK=e=>t=>si(r=>$(xs(r,ts),{onNone:()=>t,onSome:n=>n.strategy._tag==="ParallelN"&&n.strategy.parallelism===e?t:b(Es(n,TO(e)),o=>Za(t,o))})),lQ=e=>t=>gd(e,!0)(t),gd=(e,t)=>r=>si(n=>$(xs(n,ts),{onNone:()=>r(R),onSome:o=>{if(t===!0){let s=e._tag==="Parallel"?y_:e._tag==="Sequential"?S_:HK(e.parallelism);switch(o.strategy._tag){case"Parallel":return s(r(y_));case"Sequential":return s(r(S_));case"ParallelN":return s(r(HK(o.strategy.parallelism)))}}else return r(R)}})),li=e=>b(ts,e),Fy=e=>b(aa(),t=>Io(e(t),r=>t.close(r))),C_=e=>b(aa(),t=>I2(e,t)),S_=e=>si(t=>$(xs(t,ts),{onNone:()=>e,onSome:r=>{switch(r.strategy._tag){case"Sequential":return e;case"Parallel":case"ParallelN":return b(Es(r,vm),n=>Za(e,n))}}})),fQ=(e,t)=>_2([id(e,t)]),_2=e=>pn(ni,t=>fs(t,e)),dQ=u(2,(e,t)=>Fy(r=>b(Za(e,r),t))),hQ=u(e=>et(e[1]),(e,t,r)=>k2(e,t,(n,o)=>[n,o],r)),k2=u(e=>et(e[1]),(e,t,r,n)=>$o(ou(pr(e),pr(t),(o,s)=>oi(o,s,{onSuccess:r,onFailure:(i,a)=>n?.concurrent?Jr(i,a):Rt(i,a)}),n)));var mQ=u(e=>Lo(e[0]),(e,t,r)=>Mp(ks(e,(n,o)=>Mp(t(n,o)),r))),xQ=e=>pn(Ot,qe(Mo,e)),gQ=e=>pn(Ot,qe(Gc,e)),w_=e=>pn(Ot,qe(wm,e)),bQ=e=>li(t=>b(Es(t,Xo),r=>p(e,Za(r),k(n=>[jo(o=>Zi(r,$f(o))),n])))),yQ=u(e=>et(e[1]),(e,t,r)=>ou(e,t,(n,o)=>[n,o],r)),SQ=u(e=>et(e[1]),(e,t,r)=>r?.concurrent!==!0&&(r?.batching===void 0||r.batching===!1)?Wf(e,t):ou(e,t,(n,o)=>n,r)),EQ=u(e=>et(e[1]),(e,t,r)=>r?.concurrent!==!0&&(r?.batching===void 0||r.batching===!1)?we(e,t):ou(e,t,(n,o)=>o,r)),ou=u(e=>et(e[1]),(e,t,r,n)=>k(Ja([e,t],{concurrency:n?.concurrent?2:1,batching:n?.batching,concurrentFinalizers:n?.concurrentFinalizers}),([o,s])=>r(o,s))),T2=e=>e===D5?ae:p(um,b(t=>{let r=Dc(t,e),n=Xs(r,t);return p(Pp(e),we(ia(()=>Pp(n))),Ct)}),Go),ts=on("effect/Scope"),O_=ts,Xye=(e,t)=>{e.state._tag==="Open"&&e.state.finalizers.set({},t)},eSe={[$b]:$b,[Vb]:Vb,pipe(){return v(this,arguments)},fork(e){return E(()=>{let t=CQ(e);if(this.state._tag==="Closed")return t.state=this.state,t;let r={},n=o=>t.close(o);return this.state.finalizers.set(r,n),Xye(t,o=>E(()=>{this.state._tag==="Open"&&this.state.finalizers.delete(r)})),t})},close(e){return q(()=>{if(this.state._tag==="Closed")return ae;let t=Array.from(this.state.finalizers.values()).reverse();return this.state={_tag:"Closed",exit:e},t.length===0?ae:zP(this.strategy)?p(Un(t,r=>pr(r(e))),b(r=>p(qp(r),ct(bm),_e(()=>en)))):jP(this.strategy)?p(Zm(t,r=>pr(r(e)),!1),b(r=>p(qp(r,{parallel:!0}),ct(bm),_e(()=>en)))):p(x2(t,this.strategy.parallelism,r=>pr(r(e)),!1),b(r=>p(qp(r,{parallel:!0}),ct(bm),_e(()=>en))))})},addFinalizer(e){return q(()=>this.state._tag==="Closed"?e(this.state.exit):(this.state.finalizers.set({},e),ae))}},CQ=(e=Xo)=>{let t=Object.create(eSe);return t.strategy=e,t.state={_tag:"Open",finalizers:new Map},t},aa=(e=Xo)=>E(()=>CQ(e)),Za=u(2,(e,t)=>Jf(e,_o(Oo(ts,t)))),I2=u(2,(e,t)=>p(e,Za(t),Io(r=>t.close(r)))),tSe=e=>Dp(e,{differ:LK,fork:Jm}),Bn=u(2,(e,t)=>Ct(tl(b(Ro(e),r=>tt(Tp(e,t),r)),r=>Tp(e,r)))),pn=u(2,(e,t)=>Hr(e,r=>Bn(e,t(r))));var WK=m$(N5),__=tSe(xd),wQ=e=>ks(e,XO),R2=e=>({...bP,commit(){return _s(this)},[qm]:by,id:()=>Ee(e).reduce((r,n)=>vM(r,n.id()),Dn),await:pr(Zm(e,r=>$o(r.await),!1)),children:k(Zm(e,r=>r.children,!1),Mh),inheritAll:Vo(e,r=>r.inheritAll),poll:k(Un(e,r=>r.poll),Pg(x(ht(new Array)),(r,n)=>{switch(n._tag){case"None":return g();case"Some":switch(r._tag){case"None":return g();case"Some":return x(oi(n.value,r.value,{onSuccess:(o,s)=>[o,...s],onFailure:Jr}))}}})),interruptAsFork:r=>Vo(e,n=>n.interruptAsFork(r))});var A2=u(3,(e,t,r)=>M2(e,t,{onSelfWin:(n,o)=>b(n.await,s=>{switch(s._tag){case xt:return b(n.inheritAll,()=>r.onSelfDone(s,o));case mt:return r.onSelfDone(s,o)}}),onOtherWin:(n,o)=>b(n.await,s=>{switch(s._tag){case xt:return b(n.inheritAll,()=>r.onOtherDone(s,o));case mt:return r.onOtherDone(s,o)}})})),OQ=e=>er(t=>jo(r=>b(Xm(t(e)),n=>p(t(_s(n)),io(()=>p(n,lF(r))))))),k_=u(2,(e,t)=>jo(r=>A2(e,t,{onSelfDone:(n,o)=>Gf(n,{onFailure:s=>p(_s(o),Am(i=>Jr(s,i))),onSuccess:s=>p(o,Ko(r),tt(s))}),onOtherDone:(n,o)=>Gf(n,{onFailure:s=>p(_s(o),Am(i=>Jr(i,s))),onSuccess:s=>p(o,Ko(r),tt(s))})}))),M2=u(3,(e,t,r)=>de((n,o)=>{let s=o.runtimeFlags,i=ko(!0),a=b_(e,n,s,r.selfScope),c=b_(t,n,s,r.otherScope);return oo(l=>{a.addObserver(()=>BK(a,c,r.onSelfWin,i,l)),c.addObserver(()=>BK(c,a,r.onOtherWin,i,l)),a.startFork(e),c.startFork(t)},vM(a.id(),c.id()))})),BK=(e,t,r,n,o)=>{HC(!0,!1)(n)&&o(r(e,t))},rs=u(2,(e,t)=>er(r=>Gt(r(e),{onFailure:n=>Gt(t,{onFailure:o=>Re(Rt(n,o)),onSuccess:()=>Re(n)}),onSuccess:n=>tt(t,n)}))),rSe=(e,t,r)=>jo(n=>b(b(Xm(Ki(e)),o=>oo(s=>{let i=t.map(l=>l.listeners.count),a=()=>{i.every(l=>l===0)&&t.every(l=>l.result.state.current._tag==="Pending"?!0:!!(l.result.state.current._tag==="Done"&&gm(l.result.state.current.effect)&&l.result.state.current.effect._tag==="Failure"&&am(l.result.state.current.effect.cause)))&&(c.forEach(l=>l()),r?.(),s(Hc(o)))};o.addObserver(l=>{c.forEach(f=>f()),s(l)});let c=t.map((l,f)=>{let d=h=>{i[f]=h,a()};return l.listeners.addObserver(d),()=>l.listeners.removeObserver(d)});return a(),E(()=>{c.forEach(l=>l())})})),()=>q(()=>{let o=t.flatMap(s=>s.state.completed?[]:[s]);return Vo(o,s=>t2(s.request,$f(n)))})));var pi=(e,t)=>(t=qn(t),Go(de(r=>{let n=Pn(r.getFiberRef(Xr),ts),o=_O(r,e,t),s=r.getFiberRef(Ba),i=jt(r.getFiberRef(Ot),Mo);return tt(Up(n,a=>Mm(o,a,i,s)),o)}))),T_=e=>pn(Ot,qe(Kc,e)),_Q=function(){let e=typeof arguments[0]!="string",t=e?arguments[1]:arguments[0],r=qn(e?arguments[2]:arguments[1]);if(e){let n=arguments[0];return b(pi(t,qn(r)),o=>Vp(n,cn,o))}return n=>b(pi(t,qn(r)),o=>Vp(n,cn,o))};var kQ=(e,t,r,n)=>om({_tag:"Complete",key:e,exit:t,entryStats:r,timeToLiveMillis:n}),TQ=(e,t)=>om({_tag:"Pending",key:e,deferred:t}),nSe=(e,t)=>om({_tag:"Refreshing",deferred:e,complete:t}),v2=Symbol.for("effect/Cache/MapKey"),P2=class{current;[v2]=v2;previous=void 0;next=void 0;constructor(t){this.current=t}[W](){return p(M(this.current),K(M(this.previous)),K(M(this.next)),ie(this))}[H](t){return this===t?!0:oSe(t)&&N(this.current,t.current)&&N(this.previous,t.previous)&&N(this.next,t.next)}},ex=e=>new P2(e),oSe=e=>F(e,v2),F2=class{head=void 0;tail=void 0;add(t){if(t!==this.tail)if(this.tail===void 0)this.head=t,this.tail=t;else{let r=t.previous,n=t.next;n!==void 0&&(t.next=void 0,r!==void 0?(r.next=n,n.previous=r):(this.head=n,this.head.previous=void 0)),this.tail.next=t,t.previous=this.tail,this.tail=t}}remove(){let t=this.head;if(t!==void 0){let r=t.next;r!==void 0?(t.next=void 0,this.head=r,this.head.previous=void 0):(this.head=void 0,this.tail=void 0)}return t}},sSe=()=>new F2,iSe=(e,t,r,n,o,s)=>({map:e,keys:t,accesses:r,updating:n,hits:o,misses:s}),aSe=()=>iSe(Yf(),sSe(),jc(),ko(!1),0,0),cSe="effect/Cache",uSe=Symbol.for(cSe),pSe={_Key:e=>e,_Error:e=>e,_Value:e=>e},lSe="effect/ConsumerCache",fSe=Symbol.for(lSe),dSe={_Key:e=>e,_Error:e=>e,_Value:e=>e},hSe=e=>e,I_=e=>({loadedMillis:e}),N2=class{capacity;context;fiberId;lookup;timeToLive;[uSe]=pSe;[fSe]=dSe;cacheState;constructor(t,r,n,o,s){this.capacity=t,this.context=r,this.fiberId=n,this.lookup=o,this.timeToLive=s,this.cacheState=aSe()}get(t){return k(this.getEither(t),bE)}get cacheStats(){return E(()=>hSe({hits:this.cacheState.hits,misses:this.cacheState.misses,size:Dw(this.cacheState.map)}))}getOption(t){return q(()=>$(Wr(this.cacheState.map,t),{onNone:()=>{let r=ex(t);return this.trackAccess(r),this.trackMiss(),S(g())},onSome:r=>this.resolveMapValue(r)}))}getOptionComplete(t){return q(()=>$(Wr(this.cacheState.map,t),{onNone:()=>{let r=ex(t);return this.trackAccess(r),this.trackMiss(),S(g())},onSome:r=>this.resolveMapValue(r,!0)}))}contains(t){return E(()=>ea(this.cacheState.map,t))}entryStats(t){return E(()=>{let r=Wr(this.cacheState.map,t);if(X(r))switch(r.value._tag){case"Complete":{let n=r.value.entryStats.loadedMillis;return x(I_(n))}case"Pending":return g();case"Refreshing":{let n=r.value.complete.entryStats.loadedMillis;return x(I_(n))}}return g()})}getEither(t){return q(()=>{let r=t,n,o,s=yr(Wr(this.cacheState.map,r));return s===void 0&&(o=Dv(this.fiberId),n=ex(r),ea(this.cacheState.map,r)?s=yr(Wr(this.cacheState.map,r)):Qo(this.cacheState.map,r,TQ(n,o))),s===void 0?(this.trackAccess(n),this.trackMiss(),k(this.lookupValueOf(t,o),Y)):b(this.resolveMapValue(s),$({onNone:()=>this.getEither(t),onSome:i=>S(V(i))}))})}invalidate(t){return E(()=>{Xf(this.cacheState.map,t)})}invalidateWhen(t,r){return E(()=>{let n=Wr(this.cacheState.map,t);X(n)&&n.value._tag==="Complete"&&n.value.exit._tag==="Success"&&r(n.value.exit.value)&&Xf(this.cacheState.map,t)})}get invalidateAll(){return E(()=>{this.cacheState.map=Yf()})}refresh(t){return Ka(r=>q(()=>{let n=t,o=Dv(this.fiberId),s=yr(Wr(this.cacheState.map,n));if(s===void 0&&(ea(this.cacheState.map,n)?s=yr(Wr(this.cacheState.map,n)):Qo(this.cacheState.map,n,TQ(ex(n),o))),s===void 0)return Ct(this.lookupValueOf(t,o));switch(s._tag){case"Complete":{if(this.hasExpired(r,s.timeToLiveMillis)){let i=yr(Wr(this.cacheState.map,n));return N(i,s)&&Xf(this.cacheState.map,n),Ct(this.get(t))}return p(this.lookupValueOf(t,o),wO(()=>{let i=yr(Wr(this.cacheState.map,n));if(N(i,s)){let a=nSe(o,s);return Qo(this.cacheState.map,n,a),!0}return!1}),Ct)}case"Pending":return We(s.deferred);case"Refreshing":return We(s.deferred)}}))}set(t,r){return Ka(n=>E(()=>{let o=n.unsafeCurrentTimeMillis(),s=t,i=xe(r),a=kQ(ex(s),i,I_(o),o+Qr(Qe(this.timeToLive(i))));Qo(this.cacheState.map,s,a)}))}get size(){return E(()=>Dw(this.cacheState.map))}get values(){return E(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push(r[1].exit.value);return t})}get entries(){return E(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push([r[0],r[1].exit.value]);return t})}get keys(){return E(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push(r[0]);return t})}resolveMapValue(t,r=!1){return Ka(n=>{switch(t._tag){case"Complete":return this.trackAccess(t.key),this.hasExpired(n,t.timeToLiveMillis)?(Xf(this.cacheState.map,t.key.current),S(g())):(this.trackHit(),k(t.exit,x));case"Pending":return this.trackAccess(t.key),this.trackHit(),r?S(g()):k(We(t.deferred),x);case"Refreshing":return this.trackAccess(t.complete.key),this.trackHit(),this.hasExpired(n,t.complete.timeToLiveMillis)?r?S(g()):k(We(t.deferred),x):k(t.complete.exit,x)}})}trackHit(){this.cacheState.hits=this.cacheState.hits+1}trackMiss(){this.cacheState.misses=this.cacheState.misses+1}trackAccess(t){if(ii(this.cacheState.accesses,t),HC(this.cacheState.updating,!1,!0)){let r=!0;for(;r;){let o=Jo(this.cacheState.accesses,Mt);o===Mt?r=!1:this.cacheState.keys.add(o)}let n=Dw(this.cacheState.map);for(r=n>this.capacity;r;){let o=this.cacheState.keys.remove();o!==void 0?ea(this.cacheState.map,o.current)&&(Xf(this.cacheState.map,o.current),n=n-1,r=n>this.capacity):r=!1}Nn(this.cacheState.updating,!1)}}hasExpired(t,r){return t.unsafeCurrentTimeMillis()>r}lookupValueOf(t,r){return Ka(n=>q(()=>{let o=t;return p(this.lookup(t),ws(this.context),pr,b(s=>{let i=n.unsafeCurrentTimeMillis(),a=I_(i),c=kQ(ex(o),s,a,i+Qr(Qe(this.timeToLive(s))));return Qo(this.cacheState.map,o,c),we(Z$(r,s),s)}),io(()=>we(X$(r),E(()=>{Xf(this.cacheState.map,o)}))))}))}};var IQ=(e,t,r)=>new N2(e,Cn(),Cf,t,n=>Qe(r(n)));var R_=Ln,Ya=Vi,zn=Nr,yd=To,RQ=Jr,AQ=Rt,MQ=_b;var vQ=$5,A_=Mf;var ca=am,M_=Pf;var PQ=Nf;var Xa=Gi,tx=V5;var Is=Tb;var rx=y$;var Sd=jf;var FQ=Ao;var v_=Iv,NQ=E$;var Ny=zo;var j={};Xn(j,{Do:()=>dCe,EffectTypeId:()=>Ck,Service:()=>EOe,Tag:()=>SOe,acquireRelease:()=>wr,acquireReleaseInterruptible:()=>fEe,acquireUseRelease:()=>pD,addFinalizer:()=>dEe,all:()=>Po,allSuccesses:()=>d0e,allWith:()=>f0e,allowInterrupt:()=>Y0e,andThen:()=>MCe,annotateCurrentSpan:()=>oOe,annotateLogs:()=>fwe,annotateLogsScoped:()=>dwe,annotateSpans:()=>nOe,ap:()=>Bwe,as:()=>Kt,asSome:()=>uD,asSomeError:()=>sEe,asVoid:()=>po,async:()=>sD,asyncEffect:()=>I0e,awaitAllChildren:()=>SEe,bind:()=>hCe,bindAll:()=>mCe,bindTo:()=>xCe,blocked:()=>zwe,cacheRequestResult:()=>Gwe,cached:()=>u0e,cachedFunction:()=>p0e,cachedInvalidateWithTTL:()=>c0e,cachedWithTTL:()=>a0e,catch:()=>P0e,catchAll:()=>Ex,catchAllCause:()=>hi,catchAllDefect:()=>F0e,catchIf:()=>N0e,catchSome:()=>D0e,catchSomeCause:()=>kd,catchSomeDefect:()=>L0e,catchTag:()=>U0e,catchTags:()=>q0e,cause:()=>H0e,checkInterruptible:()=>X0e,clock:()=>mD,clockWith:()=>qEe,configProviderWith:()=>XEe,console:()=>BEe,consoleWith:()=>zEe,context:()=>Cx,contextWith:()=>zY,contextWithEffect:()=>rCe,currentParentSpan:()=>iOe,currentSpan:()=>sOe,custom:()=>R0e,daemonChildren:()=>EEe,delay:()=>VEe,descriptor:()=>CEe,descriptorWith:()=>wEe,die:()=>_d,dieMessage:()=>il,dieSync:()=>aD,diffFiberRefs:()=>OEe,disconnect:()=>eEe,dropUntil:()=>wk,dropWhile:()=>Ok,either:()=>pl,ensureErrorType:()=>_Oe,ensureRequirementsType:()=>kOe,ensureSuccessType:()=>OOe,ensuring:()=>la,ensuringChild:()=>_Ee,ensuringChildren:()=>kEe,eventually:()=>W0e,every:()=>m0e,exists:()=>x0e,exit:()=>Ir,fail:()=>Fo,failCause:()=>Ht,failCauseSync:()=>iD,failSync:()=>kk,fiberId:()=>TEe,fiberIdWith:()=>hD,filter:()=>BY,filterEffectOrElse:()=>OCe,filterEffectOrFail:()=>_Ce,filterMap:()=>g0e,filterOrDie:()=>SCe,filterOrDieMessage:()=>ECe,filterOrElse:()=>CCe,filterOrFail:()=>wCe,finalizersMask:()=>gEe,findFirst:()=>oD,firstSuccessOf:()=>Swe,flatMap:()=>P,flatten:()=>lo,flip:()=>iEe,flipWith:()=>aEe,fn:()=>COe,fnUntraced:()=>wOe,forEach:()=>zr,forever:()=>SD,fork:()=>IEe,forkAll:()=>REe,forkDaemon:()=>ul,forkIn:()=>yt,forkScoped:()=>cu,forkWithErrorHandler:()=>AEe,fromFiber:()=>MEe,fromFiberEffect:()=>vEe,fromNullable:()=>xOe,functionWithSpan:()=>dOe,gen:()=>co,getFiberRefs:()=>VCe,getRuntimeFlags:()=>_we,head:()=>b0e,if:()=>yCe,ignore:()=>cD,ignoreLogged:()=>B0e,inheritFiberRefs:()=>GCe,interrupt:()=>al,interruptWith:()=>tEe,interruptible:()=>uo,interruptibleMask:()=>rEe,intoDeferred:()=>pS,isEffect:()=>di,isFailure:()=>twe,isSuccess:()=>rwe,iterate:()=>UCe,labelMetrics:()=>Awe,labelMetricsScoped:()=>vwe,let:()=>gCe,liftPredicate:()=>oEe,linkSpanCurrent:()=>pOe,linkSpans:()=>uOe,locally:()=>KCe,locallyScoped:()=>JCe,locallyScopedWith:()=>ZCe,locallyWith:()=>QCe,log:()=>nwe,logAnnotations:()=>hwe,logDebug:()=>iwe,logError:()=>uwe,logFatal:()=>pwe,logInfo:()=>awe,logTrace:()=>swe,logWarning:()=>cwe,logWithLevel:()=>owe,loop:()=>qCe,makeLatch:()=>Dwe,makeSemaphore:()=>fl,makeSpan:()=>CD,makeSpanScoped:()=>lOe,map:()=>w,mapAccum:()=>cEe,mapBoth:()=>cS,mapError:()=>mi,mapErrorCause:()=>uEe,mapInputContext:()=>nCe,match:()=>fa,matchCause:()=>uu,matchCauseEffect:()=>jn,matchEffect:()=>$n,merge:()=>pEe,mergeAll:()=>y0e,metricLabels:()=>Pwe,negate:()=>lEe,never:()=>Sx,none:()=>A0e,onError:()=>lD,onExit:()=>hEe,onInterrupt:()=>nEe,once:()=>l0e,option:()=>bCe,optionFromOptional:()=>gOe,orDie:()=>Rk,orDieWith:()=>gwe,orElse:()=>ED,orElseFail:()=>bwe,orElseSucceed:()=>ywe,parallelErrors:()=>z0e,parallelFinalizers:()=>mEe,partition:()=>S0e,patchFiberRefs:()=>YCe,patchRuntimeFlags:()=>kwe,promise:()=>sS,provide:()=>wx,provideService:()=>oCe,provideServiceEffect:()=>bD,race:()=>lS,raceAll:()=>vCe,raceFirst:()=>yD,raceWith:()=>ll,random:()=>Ewe,randomWith:()=>Cwe,reduce:()=>oS,reduceEffect:()=>w0e,reduceRight:()=>C0e,reduceWhile:()=>E0e,repeat:()=>Ik,repeatN:()=>HCe,repeatOrElse:()=>WCe,replicate:()=>O0e,replicateEffect:()=>_0e,request:()=>Vwe,retry:()=>$0e,retryOrElse:()=>G0e,runCallback:()=>Lwe,runFork:()=>Td,runPromise:()=>lu,runPromiseExit:()=>Uwe,runRequestBlock:()=>jwe,runSync:()=>kx,runSyncExit:()=>qwe,runtime:()=>pu,sandbox:()=>j0e,schedule:()=>BCe,scheduleForked:()=>zCe,scheduleFrom:()=>jCe,scope:()=>Tk,scopeWith:()=>fD,scoped:()=>dD,scopedWith:()=>uS,sequentialFinalizers:()=>xEe,serviceConstants:()=>cCe,serviceFunction:()=>sCe,serviceFunctionEffect:()=>iCe,serviceFunctions:()=>aCe,serviceMembers:()=>uCe,serviceOption:()=>pCe,serviceOptional:()=>lCe,setFiberRefs:()=>XCe,sleep:()=>GEe,spanAnnotations:()=>aOe,spanLinks:()=>cOe,step:()=>$we,succeed:()=>B,succeedNone:()=>iS,succeedSome:()=>M0e,summarized:()=>PCe,supervised:()=>PEe,suspend:()=>Je,sync:()=>Ze,tagMetrics:()=>Rwe,tagMetricsScoped:()=>Mwe,takeUntil:()=>h0e,takeWhile:()=>WY,tap:()=>ln,tapBoth:()=>FCe,tapDefect:()=>NCe,tapError:()=>DCe,tapErrorCause:()=>_x,tapErrorTag:()=>LCe,timed:()=>KEe,timedWith:()=>QEe,timeout:()=>JEe,timeoutFail:()=>xD,timeoutFailCause:()=>gD,timeoutOption:()=>ZEe,timeoutTo:()=>YEe,tracer:()=>Zwe,tracerWith:()=>Ywe,transplant:()=>FEe,transposeMapOption:()=>yOe,transposeOption:()=>bOe,try:()=>K0e,tryMap:()=>Q0e,tryMapPromise:()=>J0e,tryPromise:()=>aS,uninterruptible:()=>au,uninterruptibleMask:()=>cl,unless:()=>kCe,unlessEffect:()=>TCe,unsafeMakeLatch:()=>Ak,unsafeMakeSemaphore:()=>Nwe,unsandbox:()=>Z0e,updateFiberRefs:()=>ewe,updateService:()=>fCe,useSpan:()=>fOe,using:()=>bEe,validate:()=>Hwe,validateAll:()=>k0e,validateFirst:()=>T0e,validateWith:()=>Wwe,void:()=>be,when:()=>Ox,whenEffect:()=>ICe,whenFiberRef:()=>RCe,whenLogLevel:()=>xwe,whenRef:()=>ACe,whileLoop:()=>$Ce,withClock:()=>WEe,withClockScoped:()=>HEe,withConcurrency:()=>NEe,withConfigProvider:()=>eCe,withConfigProviderScoped:()=>tCe,withConsole:()=>$Ee,withConsoleScoped:()=>jEe,withEarlyRelease:()=>yEe,withExecutionPlan:()=>V0e,withFiberRuntime:()=>_k,withLogSpan:()=>lwe,withMaxOpsBeforeYield:()=>UEe,withMetric:()=>Fwe,withParentSpan:()=>mOe,withRandom:()=>jY,withRandomFixed:()=>wwe,withRandomScoped:()=>Owe,withRequestBatching:()=>Kwe,withRequestCache:()=>Jwe,withRequestCaching:()=>Qwe,withRuntimeFlagsPatch:()=>Twe,withRuntimeFlagsPatchScoped:()=>Iwe,withScheduler:()=>DEe,withSchedulingPriority:()=>LEe,withSpan:()=>$Y,withSpanScoped:()=>hOe,withTracer:()=>Xwe,withTracerEnabled:()=>tOe,withTracerScoped:()=>eOe,withTracerTiming:()=>rOe,withUnhandledErrorLogLevel:()=>mwe,yieldNow:()=>v0e,zip:()=>fo,zipLeft:()=>dl,zipRight:()=>ue,zipWith:()=>da});var mSe="effect/ScheduleInterval",Dy=Symbol.for(mSe),D2={[Dy]:Dy,startMillis:0,endMillis:0},P_=(e,t)=>e>t?D2:{[Dy]:Dy,startMillis:e,endMillis:t},DQ=u(2,(e,t)=>LQ(e,t)===e),LQ=u(2,(e,t)=>e.endMillis<=t.startMillis?e:t.endMillis<=e.startMillis?t:e.startMillis<t.startMillis?e:t.startMillis<e.startMillis?t:e.endMillis<=t.endMillis?e:t);var UQ=e=>e.startMillis>=e.endMillis;var qQ=u(2,(e,t)=>{let r=Math.max(e.startMillis,t.startMillis),n=Math.min(e.endMillis,t.endMillis);return P_(r,n)}),HQ=e=>On(e.endMillis-e.startMillis);var WQ=e=>P_(e,Number.POSITIVE_INFINITY);var F_=P_,L2=D2,BQ=DQ;var zQ=UQ;var jQ=qQ,$Q=HQ;var VQ=WQ;var gSe="effect/ScheduleIntervals",q2=Symbol.for(gSe),H2=e=>({[q2]:q2,intervals:e});var GQ=u(2,(e,t)=>bSe(e.intervals,t.intervals,ee())),bSe=(e,t,r)=>{let n=e,o=t,s=r;for(;Vt(n)&&Vt(o);){let i=p(wn(n),jQ(wn(o))),a=zQ(i)?s:p(s,Et(i));p(wn(n),BQ(wn(o)))?n=ro(n):o=ro(o),s=a}return H2(gs(s))},N_=e=>p(e.intervals,va,_e(()=>L2)).startMillis,KQ=e=>p(e.intervals,va,_e(()=>L2)).endMillis,QQ=u(2,(e,t)=>N_(e)<N_(t)),JQ=e=>Vt(e.intervals);var ZQ=H2;var YQ=GQ,nx=N_,D_=KQ,XQ=QQ,eJ=JQ;var W2="Continue",tJ="Done",rJ=e=>({_tag:W2,intervals:e}),nJ=e=>({_tag:W2,intervals:ZQ(G(e))}),oJ={_tag:tJ},sJ=e=>e._tag===W2,iJ=e=>e._tag===tJ;var aJ=rJ;var B2=nJ,ox=oJ,z2=sJ,rl=iJ;var ua={};Xn(ua,{CloseableScopeTypeId:()=>CSe,Scope:()=>$2,ScopeTypeId:()=>ESe,addFinalizer:()=>su,addFinalizerExit:()=>V2,close:()=>sx,extend:()=>ix,fork:()=>Ly,make:()=>G2,use:()=>wSe});var ESe=$b,CSe=Vb,$2=ts,su=mm,V2=Up,sx=Zi,ix=Za,Ly=Es,wSe=I2,G2=aa;var Q2=class{permits;waiters=new Set;taken=0;constructor(t){this.permits=t}get free(){return this.permits-this.taken}take=t=>Pb(r=>{if(this.free<t){let n=()=>{this.free<t||(this.waiters.delete(n),this.taken+=t,r(S(t)))};return this.waiters.add(n),E(()=>{this.waiters.delete(n)})}return this.taken+=t,r(S(t))});updateTakenUnsafe(t,r){return this.taken=r(this.taken),this.waiters.size>0&&t.getFiberRef(na).scheduleTask(()=>{let n=this.waiters.values(),o=n.next();for(;o.done===!1&&this.free>0;)o.value(),o=n.next()},t.getFiberRef(Ji)),S(this.free)}updateTaken(t){return de(r=>this.updateTakenUnsafe(r,t))}resize=t=>Ct(de(r=>(this.permits=t,this.free<0?ae:this.updateTakenUnsafe(r,n=>n))));release=t=>this.updateTaken(r=>r-t);releaseAll=this.updateTaken(t=>0);withPermits=t=>r=>er(n=>b(n(this.take(t)),o=>rs(n(r),this.release(o))));withPermitsIfAvailable=t=>r=>er(n=>q(()=>this.free<t?cd:(this.taken+=t,rs(n(Im(r)),this.release(t)))))},ax=e=>new Q2(e),uJ=e=>E(()=>ax(e)),J2=class extends un{isOpen;waiters=[];scheduled=!1;constructor(t){super(),this.isOpen=t}commit(){return this.await}unsafeSchedule(t){return this.scheduled||this.waiters.length===0?ae:(this.scheduled=!0,t.currentScheduler.scheduleTask(this.flushWaiters,t.getFiberRef(Ji)),ae)}flushWaiters=()=>{this.scheduled=!1;let t=this.waiters;this.waiters=[];for(let r=0;r<t.length;r++)t[r](en)};open=de(t=>this.isOpen?ae:(this.isOpen=!0,this.unsafeSchedule(t)));unsafeOpen(){this.isOpen||(this.isOpen=!0,this.flushWaiters())}release=de(t=>this.isOpen?ae:this.unsafeSchedule(t));await=Pb(t=>this.isOpen?t(ae):(this.waiters.push(t),E(()=>{let r=this.waiters.indexOf(t);r!==-1&&this.waiters.splice(r,1)})));unsafeClose(){this.isOpen=!1}close=E(()=>{this.isOpen=!1});whenOpen=t=>we(this.await,t)},Y2=e=>new J2(e??!1),pJ=e=>E(()=>Y2(e)),lJ=e=>q_(e,wQ),fJ=u(2,(e,t)=>k(X2(e,t),r=>r[0])),X2=u(2,(e,t)=>{let r=Qe(t);return b(Cs(),n=>k(Hy(g()),o=>[ws(OSe(e,r,o),n),_Se(o)]))}),cJ=(e,t,r)=>{let n=Qr(Qe(t));return p(an(),Dr(o=>Ua(e,o)),k(o=>x([r+n,o])))},OSe=(e,t,r)=>er(n=>p(Ka(o=>o.currentTimeMillis),b(o=>oN(r,s=>{switch(s._tag){case"None":return x(cJ(e,t,o));case"Some":{let[i]=s.value;return i-o<=0?x(cJ(e,t,o)):g()}}})),b(o=>ge(o)?Ip("BUG: Effect.cachedInvalidate - please report an issue at https://github.com/Effect-TS/effect/issues"):n(Ut(o.value[1]))))),_Se=e=>ra(e,g()),dJ=u(2,(e,t)=>q_(e,r=>t(R2(r)))),q_=u(2,(e,t)=>b(AK,r=>p(eN(e,r),rs(b(r.value,t))))),hJ=u(e=>Lo(e[0]),(e,t)=>t?.discard?Vo(e,nu):k(Un(e,nu),R2)),Uy=u(2,(e,t)=>de((r,n)=>{let o=t,s=Py(e,r,n.runtimeFlags,Xc);if(o.state._tag==="Open"){let i=()=>jo(c=>N(c,s.id())?ae:Ct(Hc(s))),a={};o.state.finalizers.set(a,i),s.addObserver(()=>{o.state._tag!=="Closed"&&o.state.finalizers.delete(a)})}else s.unsafeInterruptAsFork(r.id());return S(s)})),H_=e=>li(t=>Uy(e,t)),mJ=e=>_s(e),xJ=e=>q(()=>b(e,_s)),K2=Symbol.for("effect/Effect/memoizeFunction.key"),U_=class{a;eq;[K2]=K2;constructor(t,r){this.a=t,this.eq=r}[H](t){return F(t,K2)?this.eq?this.eq(this.a,t.a):N(this.a,t.a):!1}[W](){return this.eq?0:ie(this,M(this.a))}},gJ=(e,t)=>p(E(()=>Yf()),b(Hy),k(r=>n=>p(r.modifyEffect(o=>{let s=p(o,Wr(new U_(n,t)));return ge(s)?p(an(),Dr(i=>p(Rm(e(n)),Ua(i),nu)),k(i=>[i,p(o,Qo(new U_(n,t),i))])):S([s.value,o])}),b(Ut),b(([o,s])=>p(ad(o),tt(s)))))),bJ=u(2,(e,t)=>p(pr(e),k_(pr(t)),r=>$o(r))),eN=u(2,(e,t)=>Yr(__,n=>n.zip(t))(e)),yJ=u(2,(e,t)=>tN(e,{onTimeout:()=>_$(t),duration:t})),tN=u(2,(e,{duration:t,onTimeout:r})=>$o(qy(e,{onTimeout:()=>ti(r),onSuccess:S,duration:t}))),SJ=u(2,(e,{duration:t,onTimeout:r})=>$o(qy(e,{onTimeout:()=>qc(r),onSuccess:S,duration:t}))),EJ=u(2,(e,t)=>qy(e,{duration:t,onSuccess:x,onTimeout:g})),qy=u(2,(e,{duration:t,onSuccess:r,onTimeout:n})=>jo(o=>er(s=>M2(s(e),Ki(Qa(t)),{onSelfWin:(i,a)=>b(i.await,c=>c._tag==="Success"?b(i.inheritAll,()=>tt(Ko(a,o),r(c.value))):b(Ko(a,o),()=>Be(c.cause))),onOtherWin:(i,a)=>b(i.await,c=>c._tag==="Success"?b(i.inheritAll,()=>tt(Ko(a,o),n())):b(Ko(a,o),()=>Be(c.cause))),otherScope:Xc})))),kSe="effect/Ref/SynchronizedRef",rN=Symbol.for(kSe),nN={_A:e=>e},Z2=class extends un{ref;withLock;[rN]=nN;[oy]=sy;[Hn]=Hn;constructor(t,r){super(),this.ref=t,this.withLock=r,this.get=Wn(this.ref)}get;commit(){return this.get}modify(t){return this.modifyEffect(r=>S(t(r)))}modifyEffect(t){return this.withLock(p(b(Wn(this.ref),t),b(([r,n])=>tt(ra(this.ref,n),r))))}},Hy=e=>E(()=>W_(e)),W_=e=>{let t=rd(e),r=ax(1);return new Z2(t,r.withPermits(1))},oN=u(2,(e,t)=>e.modifyEffect(r=>{let n=t(r);switch(n._tag){case"None":return S([r,r]);case"Some":return k(n.value,o=>[o,o])}}));var CJ=u(e=>et(e[0]),(e,t,r)=>b(e,n=>Ja(t(n),r).pipe(k(o=>Object.assign({},n,o)))));var wJ=Symbol.for("effect/ManagedRuntime");var OJ="ExtendScope",_J="Fold",sN="Fresh",kJ="FromEffect",TJ="Scoped",IJ="Suspend",RJ="Provide",iN="ProvideMerge",AJ="MergeAll",MJ="ZipWith";var B_=XO;var aN=e_,kn=Hc;var z_=Ko;var vo=_s;var vJ=VG;var ux=e=>function(){if(arguments.length===1){let t=arguments[0];return(r,...n)=>e(t,r,...n)}return e.apply(this,arguments)},px=ux((e,t,r)=>{let n=jC(),o=[[Xr,[[n,e.context]]]];r?.scheduler&&o.push([na,[[n,r.scheduler]]]);let s=X8(e.fiberRefs,{entries:o,forkAs:n});r?.updateRefs&&(s=r.updateRefs(s,n));let i=new My(n,s,e.runtimeFlags),a=t;r?.scope&&(a=b(Ly(r.scope,Xo),l=>we(mm(l,jo(f=>N(f,i.id())?ae:Ko(i,f))),Io(t,f=>sx(l,f)))));let c=i.currentSupervisor;return c!==xd&&(c.onStart(e.context,a,g(),i),i.addObserver(l=>c.onEnd(l,i))),Xc.add(e.runtimeFlags,i),r?.immediate===!1?i.resume(a):i.start(a),i}),zy=ux((e,t,r={})=>{let n=px(e,t,r);return r.onExit&&n.addObserver(o=>{r.onExit(o)}),(o,s)=>zy(e)(p(n,z_(o??Dn)),{...s,onExit:s?.onExit?i=>s.onExit(Uv(i)):void 0})}),pN=ux((e,t)=>{let r=G_(e)(t);if(r._tag==="Failure")throw V_(r.effect_instruction_i0);return r.effect_instruction_i0}),cN=class extends Error{fiber;_tag="AsyncFiberException";constructor(t){super(`Fiber #${t.id().id} cannot be resolved synchronously. This is caused by using runSync on an effect that performs async work`),this.fiber=t,this.name=this._tag,this.stack=this.message}},RSe=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=0;let r=new cN(e);return Error.stackTraceLimit=t,r},PJ=e=>_a(e,"AsyncFiberException")&&"fiber"in e,j_=Symbol.for("effect/Runtime/FiberFailure"),cx=Symbol.for("effect/Runtime/FiberFailure/Cause"),uN=class extends Error{[j_];[cx];constructor(t){let r=fw(t)[0];super(r?.message||"An error has occurred"),this[j_]=j_,this[cx]=t,this.name=r?`(FiberFailure) ${r.name}`:"FiberFailure",r?.stack&&(this.stack=r.stack)}toJSON(){return{_id:"FiberFailure",cause:this[cx].toJSON()}}toString(){return"(FiberFailure) "+zo(this[cx],{renderErrorCause:!0})}[he](){return this.toString()}},V_=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=0;let r=new uN(e);return Error.stackTraceLimit=t,r},FJ=e=>F(e,j_),NJ=e=>{let t=e;switch(t._op){case"Failure":case"Success":return t;case"Left":return Hp(t.left);case"Right":return ht(t.right);case"Some":return ht(t.value);case"None":return Hp(Ao())}},G_=ux((e,t)=>{let r=NJ(t);if(r)return r;let n=new Zp,o=px(e)(t,{scheduler:n});n.flush();let s=o.unsafePoll();return s||Mw(Ew(RSe(o),Pw(o)))}),lN=ux((e,t,r)=>K_(e,t,r).then(n=>{switch(n._tag){case xt:return n.effect_instruction_i0;case mt:throw V_(n.effect_instruction_i0)}})),K_=ux((e,t,r)=>new Promise(n=>{let o=NJ(t);o&&n(o);let s=px(e)(t);s.addObserver(i=>{n(i)}),r?.signal!==void 0&&(r.signal.aborted?s.unsafeInterruptAsFork(s.id()):r.signal.addEventListener("abort",()=>{s.unsafeInterruptAsFork(s.id())},{once:!0}))})),$_=class{context;runtimeFlags;fiberRefs;constructor(t,r,n){this.context=t,this.runtimeFlags=r,this.fiberRefs=n}pipe(){return v(this,arguments)}},lx=e=>new $_(e.context,e.runtimeFlags,e.fiberRefs),fx=()=>de((e,t)=>S(new $_(e.getFiberRef(Xr),t.runtimeFlags,e.getFiberRefs()))),fN=JM($i,QM,KM),pa=lx({context:Cn(),runtimeFlags:fN,fiberRefs:eV()}),Q_=u(2,(e,t)=>lx({context:e.context,runtimeFlags:t(e.runtimeFlags),fiberRefs:e.fiberRefs})),DJ=u(2,(e,t)=>Q_(e,rw(t))),LJ=u(2,(e,t)=>Q_(e,nw(t))),dN=u(2,(e,t)=>lx({context:t(e.context),runtimeFlags:e.runtimeFlags,fiberRefs:e.fiberRefs})),UJ=u(3,(e,t,r)=>dN(e,qe(t,r))),J_=u(2,(e,t)=>lx({context:e.context,runtimeFlags:e.runtimeFlags,fiberRefs:t(e.fiberRefs)})),qJ=u(3,(e,t,r)=>J_(e,Y8({fiberId:Dn,fiberRef:t,value:r}))),HJ=u(2,(e,t)=>J_(e,Q8(t))),WJ=zy(pa),BJ=px(pa),zJ=lN(pa),jJ=K_(pa),$J=pN(pa),VJ=G_(pa),GJ=e=>q(()=>{let t;return b(an(),r=>b(fx(),n=>er(o=>we(nu(o(Gt(e(s=>zy(n)(Ua(s,r))),{onFailure:s=>ym(r,s),onSuccess:s=>(t=s,ae)}))),o(io(Ut(r),()=>t??ae))))))});var KJ=u(2,(e,t)=>e.modifyEffect(r=>k(t(r),n=>[r,n]))),QJ=u(2,(e,t)=>e.modifyEffect(r=>{let n=t(r);switch(n._tag){case"None":return S([r,r]);case"Some":return k(n.value,o=>[r,o])}}));var mN=u(2,(e,t)=>e.modifyEffect(t)),JJ=u(3,(e,t,r)=>e.modifyEffect(n=>p(r(n),_e(()=>S([t,n]))))),ZJ=u(2,(e,t)=>e.modifyEffect(r=>k(t(r),n=>[void 0,n]))),YJ=u(2,(e,t)=>e.modifyEffect(r=>k(t(r),n=>[n,n]))),XJ=u(2,(e,t)=>e.modifyEffect(r=>{let n=t(r);switch(n._tag){case"None":return S([void 0,r]);case"Some":return k(n.value,o=>[void 0,o])}}));var ASe="effect/Layer",X_=Symbol.for(ASe),MSe={_RIn:e=>e,_E:e=>e,_ROut:e=>e},fi={[X_]:MSe,pipe(){return v(this,arguments)}},vSe="effect/Layer/MemoMap",jy=Symbol.for(vSe),xN=Bi()("effect/Layer/CurrentMemoMap",{defaultValue:()=>PSe()}),$y=e=>F(e,X_),gN=e=>e._op_layer===sN,Z_=class{ref;[jy];constructor(t){this.ref=t,this[jy]=jy}getOrElseMemoize(t,r){return p(mN(this.ref,n=>{let o=n.get(t);if(o!==void 0){let[s,i]=o,a=p(s,b(([c,l])=>p(ad(c),tt(l))),Io(Vf({onFailure:()=>ae,onSuccess:()=>Up(r,i)})));return S([a,n])}return p(nd(0),b(s=>p(an(),b(i=>p(nd(()=>ae),k(a=>{let c=er(f=>p(aa(),b(d=>p(f(b(sZ(t,d,!0),h=>Rm(h(this)))),pr,b(h=>{switch(h._tag){case mt:return p(ym(i,h.effect_instruction_i0),we(Zi(d,h)),we(Re(h.effect_instruction_i0)));case xt:return p(ra(a,m=>p(Zi(d,m),Qi(pO(s,y=>[y===1,y-1])),Ct)),we(od(s,m=>m+1)),we(Up(r,m=>p(E(()=>n.delete(t)),we(Wn(a)),b(y=>y(m))))),we(Wc(i,h.effect_instruction_i0)),tt(h.effect_instruction_i0[1]))}}))))),l=[p(Ut(i),Io(Gf({onFailure:()=>ae,onSuccess:()=>od(s,f=>f+1)}))),f=>p(Wn(a),b(d=>d(f)))];return[c,gN(t)?n:n.set(t,l)]}))))))}),$o)}},bN=q(()=>k(Hy(new Map),e=>new Z_(e))),PSe=()=>new Z_(W_(new Map)),oZ=e=>li(t=>nl(e,t)),nl=u(2,(e,t)=>b(bN,r=>ek(e,r,t))),ek=u(3,(e,t,r)=>b(sZ(e,r),n=>Vp(n(t),xN,t))),sZ=(e,t,r=!1)=>{let n=e;switch(n._op_layer){case"Locally":return E(()=>o=>n.f(o.getOrElseMemoize(n.self,t)));case"ExtendScope":return E(()=>o=>li(s=>o.getOrElseMemoize(n.layer,s)));case"Fold":return E(()=>o=>p(o.getOrElseMemoize(n.layer,t),Gt({onFailure:s=>o.getOrElseMemoize(n.failureK(s),t),onSuccess:s=>o.getOrElseMemoize(n.successK(s),t)})));case"Fresh":return E(()=>o=>p(n.layer,nl(t)));case"FromEffect":return r?E(()=>o=>n.effect):E(()=>o=>o.getOrElseMemoize(e,t));case"Provide":return E(()=>o=>p(o.getOrElseMemoize(n.first,t),b(s=>p(o.getOrElseMemoize(n.second,t),ws(s)))));case"Scoped":return r?E(()=>o=>Za(n.effect,t)):E(()=>o=>o.getOrElseMemoize(e,t));case"Suspend":return E(()=>o=>o.getOrElseMemoize(n.evaluate(),t));case"ProvideMerge":return E(()=>o=>p(o.getOrElseMemoize(n.first,t),Ha(o.getOrElseMemoize(n.second,t),n.zipK)));case"ZipWith":return kw(function*(){let o=yield*Es(t,hy),s=yield*Es(o,Xo),i=yield*Es(o,Xo);return a=>p(a.getOrElseMemoize(n.first,s),ou(a.getOrElseMemoize(n.second,i),n.zipK,{concurrent:!0}))});case"MergeAll":{let o=n.layers;return k(Es(t,hy),s=>i=>{let a=new Array(o.length);return k(es(o,pm(function*(c,l){let f=yield*Es(s,Xo),d=yield*i.getOrElseMemoize(c,f);a[l]=d}),!1,!1),()=>XA(...a))})}}},Ed=u(2,(e,t)=>ak(e,{onFailure:t,onSuccess:iu})),yN=u(2,(e,t)=>ik(e,{onFailure:t,onSuccess:iu})),SN=e=>Vy(zn(e)),iZ=e=>rk(()=>zn(e())),aZ=e=>sk(e,()=>Cn()),tk=()=>ao(Cs()),cZ=e=>{let t=Object.create(fi);return t._op_layer=OJ,t.layer=e,t},EN=e=>Vy(Ya(e)),CN=e=>rk(()=>Ya(e())),Vy=e=>ao(Re(e)),rk=e=>ao(qc(e)),Rs=u(2,(e,t)=>ak(e,{onFailure:EN,onSuccess:t})),uZ=u(2,(e,t)=>Rs(e,jt(t))),wN=e=>{let t=Object.create(fi);return t._op_layer=sN,t.layer=e,t},ol=u(2,(e,t)=>{let r=Gh(e),n=r?e:t;return ao(k(r?t:e,s=>Oo(n,s)))}),pZ=e=>ao(k(e,()=>Cn()));function ao(e){let t=Object.create(fi);return t._op_layer=kJ,t.effect=e,t}var lZ=u(3,(e,t,r)=>nk(e,Lt(t,r))),nk=u(2,(e,t)=>{let r=Object.create(fi);return r._op_layer="Locally",r.self=e,r.f=t,r}),ok=u(3,(e,t,r)=>nk(e,Yr(t,r))),fZ=(e,t)=>ec(Bn(e,t)),dZ=(e,t)=>ec(pn(e,t)),hZ=(e,t,r)=>ao(k(e,n=>Oo(t,r(n)))),mZ=e=>C_(we(li(t=>p(e,nl(t))),Np)),xZ=function(){return arguments.length===1?e=>tZ(arguments[0],e):tZ(arguments[0],arguments[1])},tZ=(e,t)=>hx(e,new Proxy({...t},{get(r,n,o){if(n in r)return r[n];let s=Error.stackTraceLimit;Error.stackTraceLimit=2;let i=new Error(`${e.key}: Unimplemented method "${n.toString()}"`);return Error.stackTraceLimit=s,i.name="UnimplementedError",FSe(i)},has:jr})),FSe=e=>{let t=so(e);function r(){return t}return Object.assign(r,t),Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r},sk=u(2,(e,t)=>Rs(e,r=>iu(t(r)))),gZ=u(2,(e,t)=>Ed(e,r=>CN(()=>t(r)))),ik=u(2,(e,{onFailure:t,onSuccess:r})=>{let n=Object.create(fi);return n._op_layer=_J,n.layer=e,n.failureK=t,n.successK=r,n}),ak=u(2,(e,{onFailure:t,onSuccess:r})=>ik(e,{onFailure:n=>{let o=Xa(n);switch(o._tag){case"Left":return t(o.left);case"Right":return Vy(o.right)}},onSuccess:r})),bZ=e=>li(t=>k(yO(nl(e,t)),ao)),ON=u(2,(e,t)=>_N(e,t,(r,n)=>_o(r,n))),ck=(...e)=>{let t=Object.create(fi);return t._op_layer=AJ,t.layers=e,t},yZ=e=>Ed(e,t=>SN(t)),SZ=u(2,(e,t)=>Ed(e,t)),EZ=e=>ON(tk(),e),CZ=u(4,(e,t,r,n)=>sk(e,o=>Oo(r,n(Pn(o,t))))),wZ=u(2,(e,t)=>Ky(()=>{let r=on("effect/Layer/retry/{ state: unknown }");return p(hx(r,{state:t.initial}),Rs(n=>OZ(e,t,r,p(n,jt(r)).state)))})),OZ=(e,t,r,n)=>p(e,Ed(o=>p(NSe(t,r,o,n),Rs(s=>wN(OZ(e,t,r,p(s,jt(r)).state)))))),NSe=(e,t,r,n)=>ol(t,p(ta,b(o=>p(e.step(o,r,n),b(([s,i,a])=>rl(a)?ke(r):p($a(On(nx(a.intervals)-o)),tt({state:s}))))))),sl=u(2,(e,t)=>{let r=Gh(e),n=r?e:t;return Gy(k(r?t:e,s=>Oo(n,s)))}),ec=e=>Gy(p(e,tt(Cn()))),Gy=e=>{let t=Object.create(fi);return t._op_layer=TJ,t.effect=e,t},_Z=Gy(k(tl(aa(),(e,t)=>e.close(t)),e=>Oo($2,e))),kZ=e=>ol(e,e),hx=u(2,(e,t)=>{let r=Gh(e);return ao(S(Oo(r?e:t,r?t:e)))}),iu=e=>ao(S(e)),TZ=iu(Cn()),Ky=e=>{let t=Object.create(fi);return t._op_layer=IJ,t.evaluate=e,t},uk=u(2,(e,t)=>{let r=Gh(e),n=r?e:t,o=r?t:e;return ao(E(()=>Oo(n,o())))}),IZ=e=>ao(E(e)),RZ=u(2,(e,t)=>Rs(e,r=>ao(tt(t(r),r)))),AZ=u(2,(e,t)=>Ed(e,r=>ao(b(t(r),()=>ke(r))))),MZ=u(2,(e,t)=>yN(e,r=>ao(b(t(r),()=>Re(r))))),vZ=e=>p(li(t=>nl(e,t)),b(t=>p(fx(),ws(t)))),PZ=u(2,(e,t)=>b(li(r=>ek(e,t,r)),r=>p(fx(),ws(r)))),Cd=u(2,(e,t)=>Ky(()=>{let r=Object.create(fi);return r._op_layer=RJ,r.first=Object.create(fi,{_op_layer:{value:iN,enumerable:!0},first:{value:tk(),enumerable:!0},second:{value:Array.isArray(t)?ck(...t):t},zipK:{value:(n,o)=>p(n,_o(o))}}),r.second=e,r})),FZ=u(2,(e,t)=>{let r=Object.create(fi);return r._op_layer=iN,r.first=t,r.second=Cd(e,t),r.zipK=(n,o)=>p(n,_o(o)),r}),_N=u(3,(e,t,r)=>Ky(()=>{let n=Object.create(fi);return n._op_layer=MJ,n.first=e,n.second=t,n.zipK=r,n})),pk=e=>{let t=on("effect/Layer/unwrapEffect/Layer.Layer<R1, E1, A>");return Rs(ol(t,e),r=>jt(r,t))},dx=e=>{let t=on("effect/Layer/unwrapScoped/Layer.Layer<R1, E1, A>");return Rs(sl(t,e),r=>jt(r,t))},NZ=u(e=>$y(e[0]),function(){let e=arguments;return ok(e[0],Wa,typeof e[1]=="string"?sn(e[1],e[2]):t=>Object.entries(e[1]).reduce((r,[n,o])=>sn(r,n,o),t))}),DZ=u(e=>$y(e[0]),function(){let e=arguments;return ok(e[0],Bf,typeof e[1]=="string"?sn(e[1],e[2]):t=>Object.entries(e[1]).reduce((r,[n,o])=>sn(r,n,o),t))}),LZ=function(){let e=typeof arguments[0]!="string",t=e?arguments[1]:arguments[0],r=qn(e?arguments[2]:arguments[1]);if(e){let n=arguments[0];return dx(k(r?.onEnd?Dr(pi(t,r),o=>ia(s=>r.onEnd(o,s))):pi(t,r),o=>Y_(n,o)))}return n=>dx(k(r?.onEnd?Dr(pi(t,r),o=>ia(s=>r.onEnd(o,s))):pi(t,r),o=>Y_(n,o)))},Y_=u(2,(e,t)=>Cd(e,iu(Oo(cn,t)))),rZ=u(2,(e,t)=>Fy(r=>b(nl(t,r),n=>vw(e,n)))),nZ=u(2,(e,t)=>{let r=ud(pa.fiberRefs,t.fiberRefs),n=Xs(pa.runtimeFlags,t.runtimeFlags);return er(o=>de(s=>{let i=s.getFiberRef(Xr),a=s.getFiberRefs(),c=pd(s.id(),a)(r),l=s.currentRuntimeFlags,f=Dc(n)(l),d=ud(c,a),h=Xs(f,l);return s.setFiberRefs(c),s.currentRuntimeFlags=f,rs(vw(o(e),_o(i,t.context)),de(m=>(m.setFiberRefs(pd(m.id(),m.getFiberRefs())(d)),m.currentRuntimeFlags=Dc(h)(m.currentRuntimeFlags),ae)))}))}),lk=u(2,(e,t)=>Array.isArray(t)?rZ(e,ck(...t)):$y(t)?rZ(e,t):ob(t)?vw(e,t):wJ in t?b(t.runtimeEffect,r=>nZ(e,r)):nZ(e,t));var UZ=k(Ro(Ot),jt(Zo)),qZ=e=>Hr(Ot,t=>e(jt(t,Zo))),HZ=u(2,(e,t)=>Yr(e,Ot,qe(Zo,t))),WZ=e=>pn(Ot,qe(Zo,e));var BZ=om;var zZ=e=>LSe(e.slice(0)),LSe=e=>Object.setPrototypeOf(e,x5);var kN=Sp;var TN=(function(){let e=Symbol.for("effect/Data/Error/plainArgs");return{BaseEffectError:class extends Gb{constructor(r){super(r?.message,r?.cause?{cause:r.cause}:void 0),r&&(Object.assign(this,r),Object.defineProperty(this,e,{value:r,enumerable:!1}))}toJSON(){return{...this[e],...this}}}}.BaseEffectError})(),jZ=e=>{let t={BaseEffectError:class extends TN{_tag=e}};return t.BaseEffectError.prototype.name=e,t.BaseEffectError};var dk=Symbol.for("effect/DateTime"),hk=Symbol.for("effect/DateTime/TimeZone"),GZ={[dk]:dk,pipe(){return v(this,arguments)},[he](){return this.toString()},toJSON(){return Yy(this).toJSON()}},USe={...GZ,_tag:"Utc",[W](){return ie(this,ac(this.epochMillis))},[H](e){return xx(e)&&e._tag==="Utc"&&this.epochMillis===e.epochMillis},toString(){return`DateTime.Utc(${Yy(this).toJSON()})`}},qSe={...GZ,_tag:"Zoned",[W](){return p(ac(this.epochMillis),K(M(this.zone)),ie(this))},[H](e){return xx(e)&&e._tag==="Zoned"&&this.epochMillis===e.epochMillis&&N(this.zone,e.zone)},toString(){return`DateTime.Zoned(${qN(this)})`}},KZ={[hk]:hk,[he](){return this.toString()}},HSe={...KZ,_tag:"Named",[W](){return ie(this,Ke(`Named:${this.id}`))},[H](e){return gx(e)&&e._tag==="Named"&&this.id===e.id},toString(){return`TimeZone.Named(${this.id})`},toJSON(){return{_id:"TimeZone",_tag:"Named",id:this.id}}},WSe={...KZ,_tag:"Offset",[W](){return ie(this,Ke(`Offset:${this.offset}`))},[H](e){return gx(e)&&e._tag==="Offset"&&this.offset===e.offset},toString(){return`TimeZone.Offset(${DN(this.offset)})`},toJSON(){return{_id:"TimeZone",_tag:"Offset",offset:this.offset}}},tc=(e,t,r)=>{let n=Object.create(qSe);return n.epochMillis=e,n.zone=t,Object.defineProperty(n,"partsUtc",{value:r,enumerable:!1,writable:!0}),Object.defineProperty(n,"adjustedEpochMillis",{value:void 0,enumerable:!1,writable:!0}),Object.defineProperty(n,"partsAdjusted",{value:void 0,enumerable:!1,writable:!0}),n},xx=e=>F(e,dk);var gx=e=>F(e,hk),QZ=e=>gx(e)&&e._tag==="Offset",JZ=e=>gx(e)&&e._tag==="Named",ZZ=e=>e._tag==="Utc",AN=e=>e._tag==="Zoned",YZ=ar((e,t)=>e.epochMillis===t.epochMillis);var BSe=e=>{let t=Object.create(USe);return t.epochMillis=e,Object.defineProperty(t,"partsUtc",{value:void 0,enumerable:!1,writable:!0}),t},mx=e=>{let t=e.getTime();if(Number.isNaN(t))throw new Sd("Invalid date");return BSe(t)},MN=e=>{if(xx(e))return e;if(e instanceof Date)return mx(e);if(typeof e=="object"){let t=new Date(0);return JSe(t,e),mx(t)}else if(typeof e=="string"&&!zSe(e))return mx(new Date(e+"Z"));return mx(new Date(e))},zSe=e=>/Z|[+-]\d{2}$|[+-]\d{2}:?\d{2}$|\]$/.test(e),jSe=-864e13+720*60*1e3,$Se=864e13-840*60*1e3,vN=(e,t)=>{if(t?.timeZone===void 0&&xx(e)&&AN(e))return e;let r=MN(e);if(r.epochMillis<jSe||r.epochMillis>$Se)throw new RangeError(`Epoch millis out of range: ${r.epochMillis}`);let n;if(t?.timeZone===void 0){let o=new Date(r.epochMillis).getTimezoneOffset()*-60*1e3;n=Zy(o)}else if(gx(t?.timeZone))n=t.timeZone;else if(typeof t?.timeZone=="number")n=Zy(t.timeZone);else{let o=FN(t.timeZone);if(ge(o))throw new Sd(`Invalid time zone: ${t.timeZone}`);n=o.value}return t?.adjustForTimeZone!==!0?tc(r.epochMillis,n,r.partsUtc):ZSe(r.epochMillis,n,t?.disambiguation??"compatible")},IN=Vl(vN);var VSe=/^(.{17,35})\[(.+)\]$/,XZ=e=>{let t=VSe.exec(e);if(t===null){let o=UN(e);return o!==null?IN(e,{timeZone:o}):g()}let[,r,n]=t;return IN(r,{timeZone:n})};var Jy=ne("effect/DateTime/validZoneCache",()=>new Map),GSe={day:"numeric",month:"numeric",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"longOffset",fractionalSecondDigits:3,hourCycle:"h23"},KSe=e=>{let t=e.resolvedOptions().timeZone;if(Jy.has(t))return Jy.get(t);let r=Object.create(HSe);return r.id=t,r.format=e,Jy.set(t,r),r},PN=e=>{if(Jy.has(e))return Jy.get(e);try{return KSe(new Intl.DateTimeFormat("en-US",{...GSe,timeZone:e}))}catch{throw new Sd(`Invalid time zone: ${e}`)}},Zy=e=>{let t=Object.create(WSe);return t.offset=e,t},eY=Vl(PN);var QSe=/^(?:GMT|[+-])/,FN=e=>{if(QSe.test(e)){let t=UN(e);return t===null?g():x(Zy(t))}return eY(e)},tY=e=>e._tag==="Offset"?DN(e.offset):e.id;var Yy=e=>new Date(e.epochMillis),mk=e=>{if(e._tag==="Utc")return new Date(e.epochMillis);if(e.zone._tag==="Offset")return new Date(e.epochMillis+e.zone.offset);if(e.adjustedEpochMillis!==void 0)return new Date(e.adjustedEpochMillis);let t=e.zone.format.formatToParts(e.epochMillis).filter(n=>n.type!=="literal"),r=new Date(0);return r.setUTCFullYear(Number(t[2].value),Number(t[0].value)-1,Number(t[1].value)),r.setUTCHours(Number(t[3].value),Number(t[4].value),Number(t[5].value),Number(t[6].value)),e.adjustedEpochMillis=r.getTime(),r},NN=e=>mk(e).getTime()-LN(e),DN=e=>{let t=Math.abs(e),r=Math.floor(t/(3600*1e3)),n=Math.round(t%(3600*1e3)/(60*1e3));return n===60&&(r+=1,n=0),`${e<0?"-":"+"}${String(r).padStart(2,"0")}:${String(n).padStart(2,"0")}`},rY=e=>DN(NN(e)),LN=e=>e.epochMillis;var JSe=(e,t)=>{if(t.year!==void 0&&e.setUTCFullYear(t.year),t.month!==void 0&&e.setUTCMonth(t.month-1),t.day!==void 0&&e.setUTCDate(t.day),t.weekDay!==void 0){let r=t.weekDay-e.getUTCDay();e.setUTCDate(e.getUTCDate()+r)}t.hours!==void 0&&e.setUTCHours(t.hours),t.minutes!==void 0&&e.setUTCMinutes(t.minutes),t.seconds!==void 0&&e.setUTCSeconds(t.seconds),t.millis!==void 0&&e.setUTCMilliseconds(t.millis)};var VZ=1440*60*1e3,ZSe=(e,t,r)=>{if(t._tag==="Offset")return tc(e-t.offset,t);let n=Qy(e-VZ,e,t),o=Qy(e+VZ,e,t);if(n===o)return tc(e-n,t);let s=n<o,i=n-o;if(s){if(Qy(e-o,e,t)===o)return tc(e-o,t);let l=tc(e-n,t),f=mk(l).getTime();if(e!==f)switch(r){case"reject":{let d=new Date(e).toISOString();throw new RangeError(`Gap time: ${d} does not exist in time zone ${t.id}`)}case"earlier":return tc(e-o,t);case"compatible":case"later":return l}return l}if(Qy(e-n,e,t)===n){if(r==="earlier"||r==="compatible"||Qy(e-n+i,e+i,t)===n)return tc(e-n,t);if(r==="reject"){let l=new Date(e).toISOString();throw new RangeError(`Ambiguous time: ${l} occurs twice in time zone ${t.id}`)}}return tc(e-o,t)},YSe=/([+-])(\d{2}):(\d{2})$/,UN=e=>{let t=YSe.exec(e);if(t===null)return null;let[,r,n,o]=t;return(r==="+"?1:-1)*(Number(n)*60+Number(o))*60*1e3},Qy=(e,t,r)=>{let n=r.format.formatToParts(e).find(s=>s.type==="timeZoneName")?.value??"";if(n==="GMT")return 0;let o=UN(n);return o===null?NN(tc(t,r)):o};var nY=e=>Yy(e).toISOString();var RN=e=>{let t=mk(e);return e._tag==="Utc"?t.toISOString():`${t.toISOString().slice(0,-1)}${rY(e)}`},qN=e=>e.zone._tag==="Offset"?RN(e):`${RN(e)}[${e.zone.id}]`;var e0e=e=>e.toUpperCase(),t0e=e=>e.toLowerCase(),oY=e=>e.length===0?e:e0e(e[0])+e.slice(1),sY=e=>e.length===0?e:t0e(e[0])+e.slice(1);var iY=e=>e.length>0;var cY=R8;var r0e="effect/Schedule",$N=Symbol.for(r0e),VN=e=>F(e,$N),n0e="effect/ScheduleDriver",fY=Symbol.for(n0e),HN={start:0,now:0,input:void 0,output:void 0,elapsed:Pa,elapsedSincePrevious:Pa,recurrence:0},wd=Bi()("effect/Schedule/CurrentIterationMetadata",{defaultValue:()=>HN}),o0e={_Out:e=>e,_In:e=>e,_R:e=>e},s0e={_Out:e=>e,_In:e=>e,_R:e=>e},WN=class{initial;step;[$N]=o0e;constructor(t,r){this.initial=t,this.step=r}pipe(){return v(this,arguments)}},pY=(e,t,r,n)=>od(e,o=>o.recurrence===0?{now:t,input:r,output:n,recurrence:o.recurrence+1,elapsed:Pa,elapsedSincePrevious:Pa,start:t}:{now:t,input:r,output:n,recurrence:o.recurrence+1,elapsed:On(t-o.start),elapsedSincePrevious:On(t-o.now),start:o.start}),BN=class{schedule;ref;[fY]=s0e;constructor(t,r){this.schedule=t,this.ref=r}get state(){return k(Wn(this.ref),t=>t[1])}get last(){return b(Wn(this.ref),([t,r])=>{switch(t._tag){case"None":return ti(()=>new Ao);case"Some":return S(t.value)}})}iterationMeta=rd(HN);get reset(){return ra(this.ref,[g(),this.schedule.initial]).pipe(Wf(ra(this.iterationMeta,HN)))}next(t){return p(k(Wn(this.ref),r=>r[1]),b(r=>p(ta,b(n=>p(q(()=>this.schedule.step(n,t,r)),b(([o,s,i])=>{let a=ra(this.ref,[x(s),o]);if(rl(i))return a.pipe(we(ke(g())));let c=nx(i.intervals)-n;if(c<=0)return a.pipe(we(pY(this.iterationMeta,n,t,s)),tt(s));let l=On(c);return p(a,we(pY(this.iterationMeta,n,t,s)),we(Qa(l)),tt(s))}))))))}},Od=(e,t)=>new WN(e,t),dY=u(2,(e,t)=>hY(e,r=>E(()=>t(r)))),hY=u(2,(e,t)=>yY(e,(r,n)=>k(t(r),o=>C4(n,Qe(o)))));var mY=e=>KN(e,Mr);var xY=u(2,(e,t)=>bk(e,(r,n)=>E(()=>t(r,n)))),bk=u(2,(e,t)=>Od(e.initial,(r,n,o)=>b(e.step(r,n,o),([s,i,a])=>rl(a)?S([s,i,ox]):k(t(n,i),c=>c?[s,i,a]:[s,i,ox]))));var eS=e=>p(nd([g(),e.initial]),k(t=>new BN(e,t)));var GN=u(2,(e,t)=>gY(e,t,YQ)),gY=u(3,(e,t,r)=>Od([e.initial,t.initial],(n,o,s)=>p(Ha(e.step(n,o,s[0]),t.step(n,o,s[1]),(i,a)=>[i,a]),b(([[i,a,c],[l,f,d]])=>z2(c)&&z2(d)?zN(e,t,o,i,a,c.intervals,l,f,d.intervals,r):S([[i,l],[a,f],ox]))))),zN=(e,t,r,n,o,s,i,a,c,l)=>{let f=l(s,c);return eJ(f)?S([[n,i],[o,a],aJ(f)]):p(s,XQ(c))?b(e.step(D_(s),r,n),([d,h,m])=>rl(m)?S([[d,i],[h,a],ox]):zN(e,t,r,d,h,m.intervals,i,a,c,l)):b(t.step(D_(c),r,i),([d,h,m])=>rl(m)?S([[n,d],[o,h],ox]):zN(e,t,r,n,o,s,d,h,m.intervals,l))};var KN=u(2,(e,t)=>bY(e,r=>E(()=>t(r)))),bY=u(2,(e,t)=>Od(e.initial,(r,n,o)=>b(e.step(r,n,o),([s,i,a])=>k(t(i),c=>[s,c,a]))));var yY=u(2,(e,t)=>Od(e.initial,(r,n,o)=>b(e.step(r,n,o),([s,i,a])=>{if(rl(a))return S([s,i,a]);let c=a.intervals,l=$Q(F_(r,nx(c)));return k(t(i,l),f=>{let d=Qe(f),h=nx(c),m=r+Qr(d),y=m-h,_=Math.max(0,D_(c)+y),C=F_(m,_);return[s,i,B2(C)]})})));var SY=e=>Od(e.initial,(t,r,n)=>p(e.step(t,r,n),k(([o,s,i])=>[o,r,i])));var yk=e=>wY(bx,t=>t<e);var EY=e=>dY(bx,()=>e);var CY=(e,t)=>Od(e,(r,n,o)=>E(()=>[t(o),o,B2(VQ(r))]));var QN=u(2,(e,t)=>bk(e,(r,n)=>SO(t(r))));var JN=u(2,(e,t)=>bk(e,(r,n)=>t(r))),wY=u(2,(e,t)=>xY(e,(r,n)=>t(n)));var xk=Symbol.for("effect/Schedule/ScheduleDefect"),jN=class{error;[xk];constructor(t){this.error=t,this[xk]=xk}},i0e=e=>F(e,xk),gk=e=>Ss(e,t=>so(new jN(t))),ZN=e=>$(Op(e,t=>Mf(t)&&i0e(t.defect)?x(t.defect):g()),{onNone:()=>e,onSome:t=>Vi(t.error)}),tS=e=>La(e,t=>Re(ZN(t))),lY=u(2,(e,t)=>YN(e,t,(r,n)=>ke(r))),OY=u(2,(e,t)=>{if(VN(t))return lY(e,t);let r=t.schedule??SY(bx),n=t.while?JN(r,i=>{let a=t.while(i);return typeof a=="boolean"?S(a):gk(a)}):r,o=t.until?QN(n,i=>{let a=t.until(i);return typeof a=="boolean"?S(a):gk(a)}):n,s=t.times?GN(o,yk(t.times)).pipe(KN(i=>i[0])):o;return tS(lY(e,s))}),YN=u(3,(e,t,r)=>b(eS(t),n=>Zr(e,{onFailure:o=>r(o,g()),onSuccess:o=>_Y(Gp(e,wd,Wn(n.iterationMeta)),n,(s,i)=>Gp(r(s,i),wd,Wn(n.iterationMeta)),o)}))),_Y=(e,t,r,n)=>Zr(t.next(n),{onFailure:()=>qf(t.last),onSuccess:o=>Zr(e,{onFailure:s=>r(s,x(o)),onSuccess:s=>_Y(e,t,r,s)})}),Xy=u(2,(e,t)=>XN(e,t,(r,n)=>ke(r))),kY=u(2,(e,t)=>VN(t)?Xy(e,t):tS(Xy(e,Sk(t)))),Sk=e=>{let t=e.schedule??bx,r=e.while?JN(t,o=>{let s=e.while(o);return typeof s=="boolean"?S(s):gk(s)}):t,n=e.until?QN(r,o=>{let s=e.until(o);return typeof s=="boolean"?S(s):gk(s)}):r;return e.times?GN(n,yk(e.times)):n},XN=u(3,(e,t,r)=>b(eS(t),n=>TY(Gp(e,wd,Wn(n.iterationMeta)),n,(o,s)=>Gp(r(o,s),wd,Wn(n.iterationMeta))))),TY=(e,t,r)=>Ss(e,n=>Zr(t.next(n),{onFailure:()=>p(t.last,qf,b(o=>r(n,o))),onSuccess:()=>TY(e,t,r)})),eD=u(2,(e,t)=>tD(e,void 0,t)),tD=u(3,(e,t,r)=>b(eS(r),n=>IY(Gp(e,wd,Wn(n.iterationMeta)),t,n))),IY=(e,t,r)=>Zr(r.next(t),{onFailure:()=>qf(r.last),onSuccess:()=>b(e,n=>IY(e,n,r))});var bx=CY(0,e=>e+1),rD=mY(yk(1));var RY=u(2,(e,t)=>H_(eD(e,t)));var AY=u(2,(e,t)=>q(()=>{let r=0,n;return b(Fp({while:()=>r<t.steps.length&&(n===void 0||kt(n)),body:()=>{let o=t.steps[r],s=lk(e,o.provide);if(n){let i=!1,a=s;s=q(()=>i?a:(i=!0,n)),s=tS(Xy(s,rS(o,!1)))}else{let i=rS(o,!0);s=i?tS(Xy(s,i)):s}return ei(s)},step:o=>{n=o,r++}}),()=>n)})),rS=(e,t)=>{if(t){if(e.attempts===1||!(e.schedule||e.attempts))return}else return Sk({schedule:e.schedule?e.schedule:e.attempts?void 0:rD,times:e.attempts,while:e.while});return Sk({schedule:e.schedule,while:e.while,times:e.attempts?e.attempts-1:void 0})};var yx=ne(Symbol.for("effect/FiberRef/currentCache"),()=>lr(IQ(65536,()=>k(an(),e=>({listeners:new $m,handle:e})),()=>pM(60)))),nS=ne(Symbol.for("effect/FiberRef/currentCacheEnabled"),()=>lr(!1)),vY=(e,t)=>b(et(t)?t:S(t),r=>jo(n=>{let o=new Proxy(e,{});return Hr(nS,s=>{if(s){let a=Hr(yx,c=>b(c.getEither(o),l=>{switch(l._tag){case"Left":return l.left.listeners.interrupted?b(c.invalidateWhen(o,f=>f.handle===l.left.handle),()=>a):(l.left.listeners.increment(),er(f=>b(pr(Lc(L5,f(Ut(l.left.handle)))),d=>(l.left.listeners.decrement(),d))));case"Right":return l.right.listeners.increment(),er(f=>b(pr(Lc(iv(r,av({request:o,result:l.right.handle,listeners:l.right.listeners,ownerId:n,state:{completed:!1}})),f(Ut(l.right.handle)))),()=>(l.right.listeners.decrement(),Ut(l.right.handle))))}}));return a}let i=new $m;return i.increment(),b(an(),a=>rs(Lc(iv(r,av({request:o,result:a,listeners:i,ownerId:n,state:{completed:!1}})),Ut(a)),E(()=>i.decrement())))})})),PY=(e,t)=>Hr(nS,r=>r?Hr(yx,n=>b(n.getEither(e),o=>{switch(o._tag){case"Left":return ae;case"Right":return Pv(o.right.handle,t)}})):ae),FY=u(2,(e,t)=>Lt(e,nS,t)),NY=u(2,(e,t)=>Lt(e,yx,t));var LY=lK;var UY=fK;var Ck=Uc,di=et,a0e=fJ,c0e=X2,u0e=yO,p0e=gJ,l0e=NP,Po=Ja,f0e=oQ,d0e=sQ,wk=WV,Ok=BV,h0e=D9,WY=L9,m0e=XV,x0e=tQ,BY=nQ,g0e=jV,oD=QV,zr=ks,b0e=t9,y0e=w2,S0e=O2,oS=k9,E0e=I9,C0e=T9,w0e=pQ,O0e=C2,_0e=iQ,k0e=cQ,T0e=mQ,sD=oo,I0e=GJ,R0e=vb,_k=de,Fo=ke,kk=ti,Ht=Re,iD=qc,_d=so,il=Ip,aD=Rp,co=kw,Sx=Np,A0e=y9,sS=O9,B=S,iS=cd,M0e=F9,Je=q,Ze=E,be=ae;var v0e=qa,P0e=IV;var Ex=Ss,hi=La,F0e=RV,N0e=Fb,D0e=n$,kd=AV,L0e=MV,U0e=vV,q0e=PV,H0e=FV,W0e=vP,cD=bO,B0e=r9,z0e=w9,j0e=v9,$0e=kY,V0e=AY,G0e=XN,K0e=MP;var Q0e=z9,J0e=j9,aS=UP,Z0e=G9,Y0e=LV,X0e=o$,eEe=OQ,al=Xt,tEe=Db,uo=Ki,rEe=s$,nEe=io,au=Go,cl=er,oEe=GV,Kt=tt,uD=Im,sEe=TV,po=Ct,iEe=Mp,aEe=YV,w=k,cEe=g9,cS=Lb,mi=vp,uEe=Am,pEe=b9,lEe=SO,wr=tl,fEe=XK,pD=Sw,dEe=ia,la=rs,lD=Ow,hEe=Io,mEe=y_,xEe=S_,gEe=lQ,Tk=O_,fD=li,uS=Fy,dD=C_,bEe=dQ,yEe=bQ,SEe=lJ,EEe=eQ,CEe=UV,wEe=mO,OEe=Rm,_Ee=dJ,kEe=q_,TEe=ri,hD=jo,IEe=nu,ul=Xm,REe=hJ,yt=Uy,cu=H_,AEe=aQ,MEe=mJ,vEe=xJ,PEe=eN,FEe=_w,NEe=a$,DEe=WG,LEe=Tv,UEe=x$,mD=NV,qEe=Ka,HEe=xQ,WEe=L8,BEe=UZ,zEe=qZ,jEe=WZ,$Ee=HZ,VEe=DV,GEe=Qa,KEe=W9,QEe=LP,JEe=yJ,ZEe=EJ,xD=tN,gD=SJ,YEe=qy,XEe=fP,eCe=U8,tCe=w_,Cx=Cs,zY=zV,rCe=si,nCe=Jf,wx=lk,oCe=Vp,bD=Gp,sCe=X9,iCe=Y9,aCe=qP,cCe=HP,uCe=eG,pCe=tG,lCe=WP,fCe=K9,dCe=qV,hCe=cy,mCe=CJ,xCe=uy,gCe=HV;var bCe=S9,pl=ei,Ir=pr,pS=Ua,yCe=ww;var SCe=$V,ECe=VV,CCe=py,wCe=KV,OCe=Nv,_Ce=Q$,kCe=$9,TCe=V9,Ox=wO,ICe=Qi,RCe=Q9,ACe=J9,P=b,MCe=Ap,lo=$o,lS=k_,vCe=uQ,yD=bJ,ll=A2,PCe=fy,ln=Dr,FCe=U9,NCe=EO,DCe=dy,LCe=q9,_x=H9,SD=xO,UCe=PP,qCe=h9,Ik=OY,HCe=A9,WCe=YN,BCe=eD,zCe=RY,jCe=tD,$Ce=Fp,VCe=gO,GCe=n9,KCe=Lt,QCe=Yr,JCe=Bn,ZCe=pn,YCe=ad,XCe=P9,ewe=CO,twe=o9,rwe=s9,fa=ly,uu=Nb,jn=Gt,$n=Zr,nwe=i9,owe=(e,...t)=>Zc(e)(...t),swe=a9,iwe=FP,awe=c9,cwe=u9,uwe=p9,pwe=l9,lwe=f9,fwe=kV,dwe=ZK,hwe=d9,mwe=g$,xwe=YK,Rk=qf,gwe=Sv,ED=Uf,bwe=E9,ywe=C9,Swe=ZV,Ewe=_9,Cwe=Jw,jY=H8,wwe=u(2,(e,t)=>jY(e,cY(t))),Owe=gQ,pu=fx,_we=um,kwe=Pp,Twe=Tw,Iwe=T2,Rwe=N9,Awe=DP,Mwe=fQ,vwe=_2,Pwe=b$,Fwe=Z9,Nwe=ax,fl=uJ,Ak=Y2,Dwe=pJ,Td=BJ,Lwe=WJ,lu=zJ,Uwe=jJ,kx=$J,qwe=VJ,Hwe=hQ,Wwe=k2,fo=yQ,dl=SQ,ue=EQ,da=ou,Bwe=u(2,(e,t)=>da(e,t,(r,n)=>r(n))),zwe=Lc,jwe=yw,$we=Cw,Vwe=u(e=>LY(e[0]),vY),Gwe=PY,Kwe=c$,Qwe=FY,Jwe=NY,Zwe=B9,Ywe=Zw,Xwe=W8,eOe=T_,tOe=u$,rOe=p$,nOe=oG,oOe=rG,sOe=OO,iOe=sG,aOe=pG,cOe=lG,uOe=iG,pOe=nG,CD=uG,lOe=pi,fOe=dO,$Y=BP,dOe=fG,hOe=_Q,mOe=hO,xOe=dG,gOe=hG,bOe=e=>Vu(e)?iS:w(e.value,An),yOe=u(2,(e,t)=>Vu(e)?iS:w(t(e.value),An)),VY=e=>{let t=new Map;return new Proxy(e,{get(r,n,o){if(n in r)return Reflect.get(r,n,o);if(t.has(n))return t.get(n);let s=(...d)=>Ap(r,h=>typeof h[n]=="function"?(t.set(n,(...m)=>Ap(r,y=>y[n](...m))),h[n](...d)):(t.set(n,Ap(r,m=>m[n])),h[n])),i=Ap(r,d=>d[n]);Object.assign(s,i);let a=s.apply,c=s.bind,l=s.call,f=Object.setPrototypeOf({},Object.getPrototypeOf(i));return f.apply=a,f.bind=c,f.call=l,Object.setPrototypeOf(s,f),t.set(n,s),s}})},SOe=e=>()=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=2;let r=new Error;Error.stackTraceLimit=t;function n(){}return Object.setPrototypeOf(n,Vh),n.key=e,Object.defineProperty(n,"use",{get(){return o=>Ap(this,o)}}),Object.defineProperty(n,"stack",{get(){return r.stack}}),VY(n)},EOe=function(){return function(){let[e,t]=arguments,r="accessors"in t?t.accessors:!1,n=Error.stackTraceLimit;Error.stackTraceLimit=2;let o=new Error;Error.stackTraceLimit=n;let s="unchecked",i=function(d){if(s==="unchecked"){let h=Object.getPrototypeOf(d);if(h===Object.prototype||h===null)s="plain";else{let m=Object.getPrototypeOf(this);Object.setPrototypeOf(m,h),s="patched"}}if(s==="plain")Object.assign(this,d);else if(s==="patched")return Object.setPrototypeOf(d,Object.getPrototypeOf(this)),d};i.prototype._tag=e,Object.defineProperty(i,"make",{get(){return d=>new this(d)}}),Object.defineProperty(i,"use",{get(){return d=>Ap(this,d)}}),i.key=e,Object.assign(i,Vh),Object.defineProperty(i,"stack",{get(){return o.stack}});let a="dependencies"in t&&t.dependencies.length>0,c=a?"DefaultWithoutDependencies":"Default",l,f=!1;if("effect"in t?(f=typeof t.effect=="function",Object.defineProperty(i,c,{get(){return f?function(){return ol(i,w(t.effect.apply(null,arguments),d=>new this(d)))}.bind(this):l??=ol(i,w(t.effect,d=>new this(d)))}})):"scoped"in t?(f=typeof t.scoped=="function",Object.defineProperty(i,c,{get(){return f?function(){return sl(i,w(t.scoped.apply(null,arguments),d=>new this(d)))}.bind(this):l??=sl(i,w(t.scoped,d=>new this(d)))}})):"sync"in t?Object.defineProperty(i,c,{get(){return l??=uk(i,()=>new this(t.sync()))}}):Object.defineProperty(i,c,{get(){return l??=hx(i,new this(t.succeed))}}),a){let d;Object.defineProperty(i,"Default",{get(){return f?function(){return Cd(this.DefaultWithoutDependencies.apply(null,arguments),t.dependencies)}:d??=Cd(this.DefaultWithoutDependencies,t.dependencies)}})}return r===!0?VY(i):i}},COe=function(e,...t){let r=Error.stackTraceLimit;Error.stackTraceLimit=2;let n=new Error;if(Error.stackTraceLimit=r,typeof e!="string")return qY(e.length,function(...i){let a=Error.stackTraceLimit;Error.stackTraceLimit=2;let c=new Error;return Error.stackTraceLimit=a,HY({self:this,body:e,args:i,pipeables:t,spanName:"<anonymous>",spanOptions:{context:Om.context(!0)},errorDef:n,errorCall:c})});let o=e,s=t[0];return(i,...a)=>qY(i.length,{[o](...c){let l=Error.stackTraceLimit;Error.stackTraceLimit=2;let f=new Error;return Error.stackTraceLimit=l,HY({self:this,body:i,args:c,pipeables:a,spanName:o,spanOptions:s,errorDef:n,errorCall:f})}}[o])};function qY(e,t){return Object.defineProperty(t,"length",{value:e,configurable:!0})}function HY(e){let t,r;if(tz(e.body))t=Ab(()=>e.body.apply(e.self,e.args));else try{t=e.body.apply(e.self,e.args)}catch(i){r=i,t=_d(i)}if(e.pipeables.length>0)try{for(let i of e.pipeables)t=i(t,...e.args)}catch(i){t=r?Ht(Rt(Nr(r),Nr(i))):_d(i)}let n=!1,o=()=>{if(n!==!1)return n;if(e.errorCall.stack){let i=e.errorDef.stack.trim().split(`
`),a=e.errorCall.stack.trim().split(`
`),c=i.slice(2).join(`
`).trim();c.includes("(")||(c=c.replace(/at (.*)/,"at ($1)"));let l=a.slice(2).join(`
`).trim();return l.includes("(")||(l=l.replace(/at (.*)/,"at ($1)")),n=`${c}
${l}`,n}},s=e.spanOptions&&"captureStackTrace"in e.spanOptions?e.spanOptions:{captureStackTrace:o,...e.spanOptions};return $Y(t,e.spanName,s)}var wOe=pm,OOe=()=>e=>e,_Oe=()=>e=>e,kOe=()=>e=>e;var GY=Ro;var KY=Hr;var QY=Xr,JY=Ji;var Mk=na;var ZY=Ba;var xi={};Xn(xi,{CurrentMemoMap:()=>ROe,LayerTypeId:()=>TOe,MemoMapTypeId:()=>IOe,annotateLogs:()=>vOe,annotateSpans:()=>POe,build:()=>FOe,buildWithMemoMap:()=>Z_e,buildWithScope:()=>_D,catchAll:()=>NOe,catchAllCause:()=>DOe,context:()=>Pk,die:()=>LOe,dieSync:()=>UOe,discard:()=>qOe,effect:()=>HOe,effectContext:()=>BOe,effectDiscard:()=>WOe,empty:()=>zOe,extendScope:()=>jOe,fail:()=>$Oe,failCause:()=>GOe,failCauseSync:()=>KOe,failSync:()=>VOe,fiberRefLocallyScopedWith:()=>h_e,flatMap:()=>QOe,flatten:()=>JOe,fresh:()=>ZOe,function:()=>XOe,isFresh:()=>MOe,isLayer:()=>AOe,launch:()=>e_e,locally:()=>l_e,locallyEffect:()=>p_e,locallyScoped:()=>d_e,locallyWith:()=>f_e,makeMemoMap:()=>J_e,map:()=>cX,mapError:()=>t_e,match:()=>r_e,matchCause:()=>n_e,memoize:()=>o_e,merge:()=>kD,mergeAll:()=>s_e,mock:()=>YOe,orDie:()=>i_e,orElse:()=>a_e,parentSpan:()=>D_e,passthrough:()=>c_e,project:()=>u_e,provide:()=>uX,provideMerge:()=>A_e,retry:()=>m_e,scope:()=>x_e,scoped:()=>g_e,scopedContext:()=>b_e,scopedDiscard:()=>ha,service:()=>y_e,setClock:()=>F_e,setConfigProvider:()=>N_e,setRandom:()=>L_e,setRequestBatching:()=>U_e,setRequestCache:()=>H_e,setRequestCaching:()=>q_e,setScheduler:()=>W_e,setTracer:()=>z_e,setTracerEnabled:()=>j_e,setTracerTiming:()=>$_e,setUnhandledErrorLogLevel:()=>V_e,setVersionMismatchErrorLogLevel:()=>G_e,span:()=>B_e,succeed:()=>S_e,succeedContext:()=>E_e,suspend:()=>C_e,sync:()=>w_e,syncContext:()=>O_e,tap:()=>__e,tapError:()=>k_e,tapErrorCause:()=>T_e,toRuntime:()=>I_e,toRuntimeWithMemoMap:()=>R_e,unwrapEffect:()=>v_e,unwrapScoped:()=>P_e,updateService:()=>Y_e,withParentSpan:()=>Q_e,withSpan:()=>K_e,zipWith:()=>M_e});var YY=e=>ec(Bn(vy,e)),XY=u(2,(e,t)=>Lt(vy,t)(e)),fS=e=>ec(pn(E_,ji(e))),wD=e=>pk(k(e,fS)),OD=e=>dx(k(e,fS)),dS=e=>ec(pn(E_,Ef(e))),eX=u(2,(e,t)=>Rs(dS(e),()=>fS(t))),tX=u(2,(e,t)=>Rs(dS(e),()=>wD(t))),rX=u(2,(e,t)=>Rs(dS(e),()=>OD(t)));var nX=e=>ec(w_(e)),oX=e=>iu(Oo(cn,e)),sX=(e,t)=>(t=qn(t),sl(cn,t?.onEnd?Dr(pi(e,t),r=>ia(n=>t.onEnd(r,n))):pi(e,t))),iX=e=>ec(T_(e));var TOe=X_,IOe=jy,ROe=xN,AOe=$y,MOe=gN,vOe=NZ,POe=DZ,FOe=oZ,_D=nl,NOe=Ed,DOe=yN,Pk=tk,LOe=SN,UOe=iZ,qOe=aZ,HOe=ol,WOe=pZ,BOe=ao,zOe=TZ,jOe=cZ,$Oe=EN,VOe=CN,GOe=Vy,KOe=rk,QOe=Rs,JOe=uZ,ZOe=wN,YOe=xZ,XOe=hZ;var e_e=mZ,cX=sk,t_e=gZ,r_e=ak,n_e=ik,o_e=bZ,kD=ON,s_e=ck,i_e=yZ,a_e=SZ,c_e=EZ,u_e=CZ,p_e=nk,l_e=lZ,f_e=ok,d_e=fZ,h_e=dZ,m_e=wZ,x_e=_Z,g_e=sl,ha=ec,b_e=Gy,y_e=kZ,S_e=hx,E_e=iu,C_e=Ky,w_e=uk,O_e=IZ,__e=RZ,k_e=AZ,T_e=MZ,I_e=vZ,R_e=PZ,uX=Cd,A_e=FZ,M_e=_N,v_e=pk,P_e=dx,F_e=e=>ha(pn(Ot,qe(Mo,e))),N_e=nX,D_e=oX,L_e=e=>ha(pn(Ot,qe(Gc,e))),U_e=e=>ha(Bn(fm,e)),q_e=e=>ha(Bn(nS,e)),H_e=e=>ha(et(e)?b(e,t=>Bn(yx,t)):Bn(yx,e)),W_e=e=>ha(Bn(na,e)),B_e=sX,z_e=iX,j_e=e=>ha(Bn(hm,e)),$_e=e=>ha(Bn(Ba,e)),V_e=e=>ha(Bn(dm,e)),G_e=e=>ha(Bn(zb,e)),K_e=LZ,Q_e=Y_,J_e=bN,Z_e=ek,Y_e=u(3,(e,t,r)=>uX(e,cX(Pk(),n=>qe(n,t,r(Pn(n,t))))));var X_e="effect/QueueEnqueue",Dk=Symbol.for(X_e),eke="effect/QueueDequeue",Ix=Symbol.for(eke),tke="effect/QueueStrategy",Lk=Symbol.for(tke),rke="effect/BackingQueue",pX=Symbol.for(rke),vD={_A:e=>e},nke={_A:e=>e},PD={_In:e=>e},Uk={_Out:e=>e},TD=class extends un{queue;takers;shutdownHook;shutdownFlag;strategy;[Dk]=PD;[Ix]=Uk;constructor(t,r,n,o,s){super(),this.queue=t,this.takers=r,this.shutdownHook=n,this.shutdownFlag=o,this.strategy=s}pipe(){return v(this,arguments)}commit(){return this.take}capacity(){return this.queue.capacity()}get size(){return q(()=>Ss(this.unsafeSize(),()=>Xt))}unsafeSize(){return Ie(this.shutdownFlag)?g():x(this.queue.length()-Hw(this.takers)+this.strategy.surplusSize())}get isEmpty(){return k(this.size,t=>t<=0)}get isFull(){return k(this.size,t=>t>=this.capacity())}get shutdown(){return Go(de(t=>(p(this.shutdownFlag,Nn(!0)),p(es(Tx(this.takers),r=>Qf(r,t.id()),!1,!1),we(this.strategy.shutdown),Qi(Wc(this.shutdownHook,void 0)),Ct))))}get isShutdown(){return E(()=>Ie(this.shutdownFlag))}get awaitShutdown(){return Ut(this.shutdownHook)}isActive(){return!Ie(this.shutdownFlag)}unsafeOffer(t){if(Ie(this.shutdownFlag))return!1;let r;if(this.queue.length()===0){let o=p(this.takers,Jo(Mt));o!==Mt?(Rd(o,t),r=!0):r=!1}else r=!1;if(r)return!0;let n=this.queue.offer(t);return Id(this.strategy,this.queue,this.takers),n}offer(t){return q(()=>{if(Ie(this.shutdownFlag))return Xt;let r;if(this.queue.length()===0){let o=p(this.takers,Jo(Mt));o!==Mt?(Rd(o,t),r=!0):r=!1}else r=!1;if(r)return S(!0);let n=this.queue.offer(t);return Id(this.strategy,this.queue,this.takers),n?S(!0):this.strategy.handleSurplus([t],this.queue,this.takers,this.shutdownFlag)})}offerAll(t){return q(()=>{if(Ie(this.shutdownFlag))return Xt;let r=Ee(t),n=this.queue.length()===0?Ee(ske(this.takers,r.length)):ds,[o,s]=p(r,aR(n.length));for(let a=0;a<n.length;a++){let c=n[a],l=o[a];Rd(c,l)}if(s.length===0)return S(!0);let i=this.queue.offerAll(s);return Id(this.strategy,this.queue,this.takers),le(i)?S(!0):this.strategy.handleSurplus(i,this.queue,this.takers,this.shutdownFlag)})}get take(){return de(t=>{if(Ie(this.shutdownFlag))return Xt;let r=this.queue.poll(Mt);if(r!==Mt)return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),S(r);{let n=Yi(t.id());return p(q(()=>(p(this.takers,ii(n)),Id(this.strategy,this.queue,this.takers),Ie(this.shutdownFlag)?Xt:Ut(n))),io(()=>E(()=>ike(this.takers,n))))}})}get takeAll(){return q(()=>Ie(this.shutdownFlag)?Xt:E(()=>{let t=this.queue.pollUpTo(Number.POSITIVE_INFINITY);return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),pt(t)}))}takeUpTo(t){return q(()=>Ie(this.shutdownFlag)?Xt:E(()=>{let r=this.queue.pollUpTo(t);return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),pt(r)}))}takeBetween(t,r){return q(()=>lX(this,t,r,ee()))}},lX=(e,t,r,n)=>r<t?S(n):p(FD(e,r),b(o=>{let s=t-o.length;return s===1?p(Fk(e),k(i=>p(n,He(o),Fn(i)))):s>1?p(Fk(e),b(i=>lX(e,s-1,r-o.length-1,p(n,He(o),Fn(i))))):S(p(n,He(o)))}));var fX=e=>p(E(()=>qw(e)),b(t=>hS(qk(t),RX()))),dX=e=>p(E(()=>qw(e)),b(t=>hS(qk(t),ND()))),hX=e=>p(E(()=>qw(e)),b(t=>hS(qk(t),AX()))),mX=()=>p(E(()=>jc()),b(e=>hS(qk(e),ND()))),oke=(e,t,r,n,o)=>new TD(e,t,r,n,o),hS=(e,t)=>p(an(),k(r=>oke(e,jc(),r,ko(!1),t))),ID=class{mutable;[pX]=nke;constructor(t){this.mutable=t}poll(t){return Jo(this.mutable,t)}pollUpTo(t){return Em(this.mutable,t)}offerAll(t){return Zb(this.mutable,t)}offer(t){return ii(this.mutable,t)}capacity(){return d8(this.mutable)}length(){return Hw(this.mutable)}},qk=e=>new ID(e),xX=e=>e.capacity(),gX=e=>e.size,bX=e=>e.isFull,yX=e=>e.isEmpty,SX=e=>e.isShutdown,EX=e=>e.awaitShutdown,CX=e=>e.shutdown,wX=u(2,(e,t)=>e.offer(t));var OX=u(2,(e,t)=>e.offerAll(t)),_X=e=>k(e.takeUpTo(1),va),Fk=e=>e.take,kX=e=>e.takeAll,FD=u(2,(e,t)=>e.takeUpTo(t)),TX=u(3,(e,t,r)=>e.takeBetween(t,r)),IX=u(2,(e,t)=>e.takeBetween(t,t)),RX=()=>new RD,ND=()=>new AD,AX=()=>new MD,RD=class{[Lk]=vD;putters=jc();surplusSize(){return Hw(this.putters)}onCompleteTakersWithEmptyQueue(t){for(;!$c(this.putters)&&!$c(t);){let r=Jo(t,void 0),n=Jo(this.putters,void 0);n[2]&&Rd(n[1],!0),Rd(r,n[0])}}get shutdown(){return p(ri,b(t=>p(E(()=>Tx(this.putters)),b(r=>es(r,([n,o,s])=>s?p(Qf(o,t),Ct):ae,!1,!1)))))}handleSurplus(t,r,n,o){return de(s=>{let i=Yi(s.id());return p(q(()=>(this.unsafeOffer(t,i),this.unsafeOnQueueEmptySpace(r,n),Id(this,r,n),Ie(o)?Xt:Ut(i))),io(()=>E(()=>this.unsafeRemove(i))))})}unsafeOnQueueEmptySpace(t,r){let n=!0;for(;n&&(t.capacity()===Number.POSITIVE_INFINITY||t.length()<t.capacity());){let o=p(this.putters,Jo(Mt));if(o===Mt)n=!1;else{let s=t.offer(o[0]);s&&o[2]?Rd(o[1],!0):s||Nk(this.putters,p(Tx(this.putters),Et(o))),Id(this,t,r)}}}unsafeOffer(t,r){let n=Ee(t);for(let o=0;o<n.length;o++){let s=n[o];o===n.length-1?p(this.putters,ii([s,r,!0])):p(this.putters,ii([s,r,!1]))}}unsafeRemove(t){Nk(this.putters,p(Tx(this.putters),zi(([,r])=>r!==t)))}},AD=class{[Lk]=vD;surplusSize(){return 0}get shutdown(){return ae}onCompleteTakersWithEmptyQueue(){}handleSurplus(t,r,n,o){return S(!1)}unsafeOnQueueEmptySpace(t,r){}},MD=class{[Lk]=vD;surplusSize(){return 0}get shutdown(){return ae}onCompleteTakersWithEmptyQueue(){}handleSurplus(t,r,n,o){return E(()=>(this.unsafeOffer(r,t),Id(this,r,n),!0))}unsafeOnQueueEmptySpace(t,r){}unsafeOffer(t,r){let n=r[Symbol.iterator](),o,s=!0;for(;!(o=n.next()).done&&s;){if(t.capacity()===0)return;t.poll(Mt),s=t.offer(o.value)}}},Rd=(e,t)=>za(e,S(t)),Nk=(e,t)=>p(e,Zb(t)),Tx=e=>p(e,Em(Number.POSITIVE_INFINITY)),ske=(e,t)=>p(e,Em(t)),ike=(e,t)=>{Nk(e,p(Tx(e),zi(r=>t!==r)))},Id=(e,t,r)=>{let n=!0;for(;n&&t.length()!==0;){let o=p(r,Jo(Mt));if(o!==Mt){let s=t.poll(Mt);s!==Mt?(Rd(o,s),e.unsafeOnQueueEmptySpace(t,r)):Nk(r,p(Tx(r),Et(o))),n=!0}else n=!1}n&&t.length()===0&&!$c(r)&&e.onCompleteTakersWithEmptyQueue(r)};var Rr=Symbol.for("effect/PubSub/AbsentValue"),vX=(e,t)=>r=>{r.has(e)||r.set(e,new Set),r.get(e).add(t)},ake=(e,t)=>r=>{if(!r.has(e))return;let n=r.get(e);n.delete(t),n.size===0&&r.delete(e)},PX=e=>q(()=>{let t=KD(e);return zk(t,new VD)}),FX=e=>q(()=>{let t=KD(e);return zk(t,new Wk)}),NX=e=>q(()=>{let t=KD(e);return zk(t,new GD)}),DX=e=>q(()=>{let t=cke(e);return zk(t,new Wk)});var LX=e=>e.shutdown;var UX=u(2,(e,t)=>e.publish(t));var qX=e=>e.subscribe,KD=e=>{let t=typeof e=="number"?{capacity:e}:e;fke(t.capacity);let r=t.replay&&t.replay>0?new Bk(Math.ceil(t.replay)):void 0;return t.capacity===1?new HD(r):$6(t.capacity)===t.capacity?new UD(t.capacity,r):new DD(t.capacity,r)},cke=e=>new BD(e?.replay?new Bk(e.replay):void 0),uke=(e,t,r)=>k(an(),n=>pke(e,t,e.subscribe(),jc(),n,ko(!1),r)),pke=(e,t,r,n,o,s,i)=>new jD(e,t,r,n,o,s,i,e.replayWindow()),DD=class{capacity;replayBuffer;array;publisherIndex=0;subscribers;subscriberCount=0;subscribersIndex=0;constructor(t,r){this.capacity=t,this.replayBuffer=r,this.array=Array.from({length:t}),this.subscribers=Array.from({length:t})}replayWindow(){return this.replayBuffer?new Ax(this.replayBuffer):jk}isEmpty(){return this.publisherIndex===this.subscribersIndex}isFull(){return this.publisherIndex===this.subscribersIndex+this.capacity}size(){return this.publisherIndex-this.subscribersIndex}publish(t){if(this.isFull())return!1;if(this.subscriberCount!==0){let r=this.publisherIndex%this.capacity;this.array[r]=t,this.subscribers[r]=this.subscriberCount,this.publisherIndex+=1}return this.replayBuffer&&this.replayBuffer.offer(t),!0}publishAll(t){if(this.subscriberCount===0)return this.replayBuffer&&this.replayBuffer.offerAll(t),ee();let r=pt(t),n=r.length,o=this.publisherIndex-this.subscribersIndex,s=this.capacity-o,i=Math.min(n,s);if(i===0)return r;let a=0,c=this.publisherIndex+i;for(;this.publisherIndex!==c;){let l=dt(r,a++),f=this.publisherIndex%this.capacity;this.array[f]=l,this.subscribers[f]=this.subscriberCount,this.publisherIndex+=1,this.replayBuffer&&this.replayBuffer.offer(l)}return $t(r,a)}slide(){if(this.subscribersIndex!==this.publisherIndex){let t=this.subscribersIndex%this.capacity;this.array[t]=Rr,this.subscribers[t]=0,this.subscribersIndex+=1}this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.subscriberCount+=1,new LD(this,this.publisherIndex,!1)}},LD=class{self;subscriberIndex;unsubscribed;constructor(t,r,n){this.self=t,this.subscriberIndex=r,this.unsubscribed=n}isEmpty(){return this.unsubscribed||this.self.publisherIndex===this.subscriberIndex||this.self.publisherIndex===this.self.subscribersIndex}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(t){if(this.unsubscribed)return t;if(this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex),this.subscriberIndex!==this.self.publisherIndex){let r=this.subscriberIndex%this.self.capacity,n=this.self.array[r];return this.self.subscribers[r]-=1,this.self.subscribers[r]===0&&(this.self.array[r]=Rr,this.self.subscribersIndex+=1),this.subscriberIndex+=1,n}return t}pollUpTo(t){if(this.unsubscribed)return ee();this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);let r=this.self.publisherIndex-this.subscriberIndex,n=Math.min(t,r);if(n<=0)return ee();let o=[],s=this.subscriberIndex+n;for(;this.subscriberIndex!==s;){let i=this.subscriberIndex%this.self.capacity,a=this.self.array[i];this.self.subscribers[i]-=1,this.self.subscribers[i]===0&&(this.self.array[i]=Rr,this.self.subscribersIndex+=1),o.push(a),this.subscriberIndex+=1}return pt(o)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.subscriberCount-=1,this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);this.subscriberIndex!==this.self.publisherIndex;){let t=this.subscriberIndex%this.self.capacity;this.self.subscribers[t]-=1,this.self.subscribers[t]===0&&(this.self.array[t]=Rr,this.self.subscribersIndex+=1),this.subscriberIndex+=1}}},UD=class{capacity;replayBuffer;array;mask;publisherIndex=0;subscribers;subscriberCount=0;subscribersIndex=0;constructor(t,r){this.capacity=t,this.replayBuffer=r,this.array=Array.from({length:t}),this.mask=t-1,this.subscribers=Array.from({length:t})}replayWindow(){return this.replayBuffer?new Ax(this.replayBuffer):jk}isEmpty(){return this.publisherIndex===this.subscribersIndex}isFull(){return this.publisherIndex===this.subscribersIndex+this.capacity}size(){return this.publisherIndex-this.subscribersIndex}publish(t){if(this.isFull())return!1;if(this.subscriberCount!==0){let r=this.publisherIndex&this.mask;this.array[r]=t,this.subscribers[r]=this.subscriberCount,this.publisherIndex+=1}return this.replayBuffer&&this.replayBuffer.offer(t),!0}publishAll(t){if(this.subscriberCount===0)return this.replayBuffer&&this.replayBuffer.offerAll(t),ee();let r=pt(t),n=r.length,o=this.publisherIndex-this.subscribersIndex,s=this.capacity-o,i=Math.min(n,s);if(i===0)return r;let a=0,c=this.publisherIndex+i;for(;this.publisherIndex!==c;){let l=dt(r,a++),f=this.publisherIndex&this.mask;this.array[f]=l,this.subscribers[f]=this.subscriberCount,this.publisherIndex+=1,this.replayBuffer&&this.replayBuffer.offer(l)}return $t(r,a)}slide(){if(this.subscribersIndex!==this.publisherIndex){let t=this.subscribersIndex&this.mask;this.array[t]=Rr,this.subscribers[t]=0,this.subscribersIndex+=1}this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.subscriberCount+=1,new qD(this,this.publisherIndex,!1)}},qD=class{self;subscriberIndex;unsubscribed;constructor(t,r,n){this.self=t,this.subscriberIndex=r,this.unsubscribed=n}isEmpty(){return this.unsubscribed||this.self.publisherIndex===this.subscriberIndex||this.self.publisherIndex===this.self.subscribersIndex}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(t){if(this.unsubscribed)return t;if(this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex),this.subscriberIndex!==this.self.publisherIndex){let r=this.subscriberIndex&this.self.mask,n=this.self.array[r];return this.self.subscribers[r]-=1,this.self.subscribers[r]===0&&(this.self.array[r]=Rr,this.self.subscribersIndex+=1),this.subscriberIndex+=1,n}return t}pollUpTo(t){if(this.unsubscribed)return ee();this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);let r=this.self.publisherIndex-this.subscriberIndex,n=Math.min(t,r);if(n<=0)return ee();let o=[],s=this.subscriberIndex+n;for(;this.subscriberIndex!==s;){let i=this.subscriberIndex&this.self.mask,a=this.self.array[i];this.self.subscribers[i]-=1,this.self.subscribers[i]===0&&(this.self.array[i]=Rr,this.self.subscribersIndex+=1),o.push(a),this.subscriberIndex+=1}return pt(o)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.subscriberCount-=1,this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);this.subscriberIndex!==this.self.publisherIndex;){let t=this.subscriberIndex&this.self.mask;this.self.subscribers[t]-=1,this.self.subscribers[t]===0&&(this.self.array[t]=Rr,this.self.subscribersIndex+=1),this.subscriberIndex+=1}}},HD=class{replayBuffer;publisherIndex=0;subscriberCount=0;subscribers=0;value=Rr;capacity=1;constructor(t){this.replayBuffer=t}replayWindow(){return this.replayBuffer?new Ax(this.replayBuffer):jk}pipe(){return v(this,arguments)}isEmpty(){return this.subscribers===0}isFull(){return!this.isEmpty()}size(){return this.isEmpty()?0:1}publish(t){return this.isFull()?!1:(this.subscriberCount!==0&&(this.value=t,this.subscribers=this.subscriberCount,this.publisherIndex+=1),this.replayBuffer&&this.replayBuffer.offer(t),!0)}publishAll(t){if(this.subscriberCount===0)return this.replayBuffer&&this.replayBuffer.offerAll(t),ee();let r=pt(t);return le(r)?r:this.publish(ib(r))?$t(r,1):r}slide(){this.isFull()&&(this.subscribers=0,this.value=Rr),this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.subscriberCount+=1,new WD(this,this.publisherIndex,!1)}},WD=class{self;subscriberIndex;unsubscribed;constructor(t,r,n){this.self=t,this.subscriberIndex=r,this.unsubscribed=n}isEmpty(){return this.unsubscribed||this.self.subscribers===0||this.subscriberIndex===this.self.publisherIndex}size(){return this.isEmpty()?0:1}poll(t){if(this.isEmpty())return t;let r=this.self.value;return this.self.subscribers-=1,this.self.subscribers===0&&(this.self.value=Rr),this.subscriberIndex+=1,r}pollUpTo(t){if(this.isEmpty()||t<1)return ee();let r=this.self.value;return this.self.subscribers-=1,this.self.subscribers===0&&(this.self.value=Rr),this.subscriberIndex+=1,G(r)}unsubscribe(){this.unsubscribed||(this.unsubscribed=!0,this.self.subscriberCount-=1,this.subscriberIndex!==this.self.publisherIndex&&(this.self.subscribers-=1,this.self.subscribers===0&&(this.self.value=Rr)))}},BD=class{replayBuffer;publisherHead={value:Rr,subscribers:0,next:null};publisherTail=this.publisherHead;publisherIndex=0;subscribersIndex=0;capacity=Number.MAX_SAFE_INTEGER;constructor(t){this.replayBuffer=t}replayWindow(){return this.replayBuffer?new Ax(this.replayBuffer):jk}isEmpty(){return this.publisherHead===this.publisherTail}isFull(){return!1}size(){return this.publisherIndex-this.subscribersIndex}publish(t){let r=this.publisherTail.subscribers;return r!==0&&(this.publisherTail.next={value:t,subscribers:r,next:null},this.publisherTail=this.publisherTail.next,this.publisherIndex+=1),this.replayBuffer&&this.replayBuffer.offer(t),!0}publishAll(t){if(this.publisherTail.subscribers!==0)for(let r of t)this.publish(r);else this.replayBuffer&&this.replayBuffer.offerAll(t);return ee()}slide(){this.publisherHead!==this.publisherTail&&(this.publisherHead=this.publisherHead.next,this.publisherHead.value=Rr,this.subscribersIndex+=1),this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.publisherTail.subscribers+=1,new zD(this,this.publisherTail,this.publisherIndex,!1)}},zD=class{self;subscriberHead;subscriberIndex;unsubscribed;constructor(t,r,n,o){this.self=t,this.subscriberHead=r,this.subscriberIndex=n,this.unsubscribed=o}isEmpty(){if(this.unsubscribed)return!0;let t=!0,r=!0;for(;r;)this.subscriberHead===this.self.publisherTail?r=!1:this.subscriberHead.next.value!==Rr?(t=!1,r=!1):(this.subscriberHead=this.subscriberHead.next,this.subscriberIndex+=1);return t}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(t){if(this.unsubscribed)return t;let r=!0,n=t;for(;r;)if(this.subscriberHead===this.self.publisherTail)r=!1;else{let o=this.subscriberHead.next.value;o!==Rr&&(n=o,this.subscriberHead.subscribers-=1,this.subscriberHead.subscribers===0&&(this.self.publisherHead=this.self.publisherHead.next,this.self.publisherHead.value=Rr,this.self.subscribersIndex+=1),r=!1),this.subscriberHead=this.subscriberHead.next,this.subscriberIndex+=1}return n}pollUpTo(t){let r=[],n=Rr,o=0;for(;o!==t;){let s=this.poll(n);s===n?o=t:(r.push(s),o+=1)}return pt(r)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.publisherTail.subscribers-=1;this.subscriberHead!==this.self.publisherTail;)this.subscriberHead.next.value!==Rr&&(this.subscriberHead.subscribers-=1,this.subscriberHead.subscribers===0&&(this.self.publisherHead=this.self.publisherHead.next,this.self.publisherHead.value=Rr,this.self.subscribersIndex+=1)),this.subscriberHead=this.subscriberHead.next}},jD=class extends un{pubsub;subscribers;subscription;pollers;shutdownHook;shutdownFlag;strategy;replayWindow;[Ix]=Uk;constructor(t,r,n,o,s,i,a,c){super(),this.pubsub=t,this.subscribers=r,this.subscription=n,this.pollers=o,this.shutdownHook=s,this.shutdownFlag=i,this.strategy=a,this.replayWindow=c}commit(){return this.take}pipe(){return v(this,arguments)}capacity(){return this.pubsub.capacity}isActive(){return!Ie(this.shutdownFlag)}get size(){return q(()=>Ie(this.shutdownFlag)?Xt:S(this.subscription.size()+this.replayWindow.remaining))}unsafeSize(){return Ie(this.shutdownFlag)?g():x(this.subscription.size()+this.replayWindow.remaining)}get isFull(){return q(()=>Ie(this.shutdownFlag)?Xt:S(this.subscription.size()===this.capacity()))}get isEmpty(){return k(this.size,t=>t===0)}get shutdown(){return Go(de(t=>(Nn(this.shutdownFlag,!0),p(Zm(Rx(this.pollers),r=>Qf(r,t.id()),!1),we(E(()=>{this.subscribers.delete(this.subscription),this.subscription.unsubscribe(),this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers)})),Qi(Wc(this.shutdownHook,void 0)),Ct))))}get isShutdown(){return E(()=>Ie(this.shutdownFlag))}get awaitShutdown(){return Ut(this.shutdownHook)}get take(){return de(t=>{if(Ie(this.shutdownFlag))return Xt;if(this.replayWindow.remaining>0){let n=this.replayWindow.take();return S(n)}let r=$c(this.pollers)?this.subscription.poll(Mt):Mt;if(r===Mt){let n=Yi(t.id());return p(q(()=>(p(this.pollers,ii(n)),p(this.subscribers,vX(this.subscription,this.pollers)),this.strategy.unsafeCompletePollers(this.pubsub,this.subscribers,this.subscription,this.pollers),Ie(this.shutdownFlag)?Xt:Ut(n))),io(()=>E(()=>xke(this.pollers,n))))}else return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),S(r)})}get takeAll(){return q(()=>{if(Ie(this.shutdownFlag))return Xt;let t=$c(this.pollers)?dke(this.subscription):ee();return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),this.replayWindow.remaining>0?S(He(this.replayWindow.takeAll(),t)):S(t)})}takeUpTo(t){return q(()=>{if(Ie(this.shutdownFlag))return Xt;let r;if(this.replayWindow.remaining>=t){let o=this.replayWindow.takeN(t);return S(o)}else this.replayWindow.remaining>0&&(r=this.replayWindow.takeAll(),t=t-r.length);let n=$c(this.pollers)?hke(this.subscription,t):ee();return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),r?S(He(r,n)):S(n)})}takeBetween(t,r){return q(()=>HX(this,t,r,ee()))}},HX=(e,t,r,n)=>r<t?S(n):p(e.takeUpTo(r),b(o=>{let s=t-o.length;return s===1?p(e.take,k(i=>p(n,He(o),Fn(i)))):s>1?p(e.take,b(i=>HX(e,s-1,r-o.length-1,p(n,He(o),Fn(i))))):S(p(n,He(o)))})),$D=class{pubsub;subscribers;scope;shutdownHook;shutdownFlag;strategy;[Dk]=PD;[Ix]=Uk;constructor(t,r,n,o,s,i){this.pubsub=t,this.subscribers=r,this.scope=n,this.shutdownHook=o,this.shutdownFlag=s,this.strategy=i}capacity(){return this.pubsub.capacity}get size(){return q(()=>Ie(this.shutdownFlag)?Xt:E(()=>this.pubsub.size()))}unsafeSize(){return Ie(this.shutdownFlag)?g():x(this.pubsub.size())}get isFull(){return k(this.size,t=>t===this.capacity())}get isEmpty(){return k(this.size,t=>t===0)}get awaitShutdown(){return Ut(this.shutdownHook)}get isShutdown(){return E(()=>Ie(this.shutdownFlag))}get shutdown(){return Go(de(t=>(p(this.shutdownFlag,Nn(!0)),p(this.scope.close($f(t.id())),we(this.strategy.shutdown),Qi(Wc(this.shutdownHook,void 0)),Ct))))}publish(t){return q(()=>Ie(this.shutdownFlag)?Xt:this.pubsub.publish(t)?(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),S(!0)):this.strategy.handleSurplus(this.pubsub,this.subscribers,G(t),this.shutdownFlag))}isActive(){return!Ie(this.shutdownFlag)}unsafeOffer(t){return Ie(this.shutdownFlag)?!1:this.pubsub.publish(t)?(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),!0):!1}publishAll(t){return q(()=>{if(Ie(this.shutdownFlag))return Xt;let r=mke(this.pubsub,t);return this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),le(r)?S(!0):this.strategy.handleSurplus(this.pubsub,this.subscribers,r,this.shutdownFlag)})}get subscribe(){let t=Dr(Ja([this.scope.fork(Xo),uke(this.pubsub,this.subscribers,this.strategy)]),r=>r[0].addFinalizer(()=>r[1].shutdown));return k(tl(t,(r,n)=>r[0].close(n)),r=>r[1])}offer(t){return this.publish(t)}offerAll(t){return this.publishAll(t)}pipe(){return v(this,arguments)}},zk=(e,t)=>b(aa(),r=>k(an(),n=>lke(e,new Map,r,n,ko(!1),t))),lke=(e,t,r,n,o,s)=>new $D(e,t,r,n,o,s),fke=e=>{if(e<=0)throw new w$(`Cannot construct PubSub with capacity of ${e}`)},WX=(e,t)=>{za(e,S(t))},Hk=(e,t)=>p(e,Zb(t)),Rx=e=>p(e,Em(Number.POSITIVE_INFINITY)),dke=e=>e.pollUpTo(Number.POSITIVE_INFINITY),hke=(e,t)=>e.pollUpTo(t),mke=(e,t)=>e.publishAll(t),xke=(e,t)=>{Hk(e,p(Rx(e),zi(r=>r!==t)))},VD=class{publishers=jc();get shutdown(){return b(ri,t=>b(E(()=>Rx(this.publishers)),r=>es(r,([n,o,s])=>s?p(Qf(o,t),Ct):ae,!1,!1)))}handleSurplus(t,r,n,o){return de(s=>{let i=Yi(s.id());return p(q(()=>(this.unsafeOffer(n,i),this.unsafeOnPubSubEmptySpace(t,r),this.unsafeCompleteSubscribers(t,r),Ie(o)?Xt:Ut(i))),io(()=>E(()=>this.unsafeRemove(i))))})}unsafeOnPubSubEmptySpace(t,r){let n=!0;for(;n&&!t.isFull();){let o=p(this.publishers,Jo(Mt));if(o===Mt)n=!1;else{let s=t.publish(o[0]);s&&o[2]?WX(o[1],!0):s||Hk(this.publishers,p(Rx(this.publishers),Et(o))),this.unsafeCompleteSubscribers(t,r)}}}unsafeCompletePollers(t,r,n,o){return QD(this,t,r,n,o)}unsafeCompleteSubscribers(t,r){return JD(this,t,r)}unsafeOffer(t,r){let n=t[Symbol.iterator](),o=n.next();if(!o.done)for(;;){let s=o.value;if(o=n.next(),o.done){p(this.publishers,ii([s,r,!0]));break}p(this.publishers,ii([s,r,!1]))}}unsafeRemove(t){Hk(this.publishers,p(Rx(this.publishers),zi(([r,n])=>n!==t)))}},Wk=class{get shutdown(){return ae}handleSurplus(t,r,n,o){return S(!1)}unsafeOnPubSubEmptySpace(t,r){}unsafeCompletePollers(t,r,n,o){return QD(this,t,r,n,o)}unsafeCompleteSubscribers(t,r){return JD(this,t,r)}},GD=class{get shutdown(){return ae}handleSurplus(t,r,n,o){return E(()=>(this.unsafeSlidingPublish(t,n),this.unsafeCompleteSubscribers(t,r),!0))}unsafeOnPubSubEmptySpace(t,r){}unsafeCompletePollers(t,r,n,o){return QD(this,t,r,n,o)}unsafeCompleteSubscribers(t,r){return JD(this,t,r)}unsafeSlidingPublish(t,r){let n=r[Symbol.iterator](),o=n.next();if(!o.done&&t.capacity>0){let s=o.value,i=!0;for(;i;){t.slide();let a=t.publish(s);a&&(o=n.next())&&!o.done?s=o.value:a&&(i=!1)}}}},QD=(e,t,r,n,o)=>{let s=!0;for(;s&&!n.isEmpty();){let i=p(o,Jo(Mt));if(i===Mt)p(r,ake(n,o)),$c(o)?s=!1:p(r,vX(n,o));else{let a=n.poll(Mt);a===Mt?Hk(o,p(Rx(o),Et(i))):(WX(i,a),e.unsafeOnPubSubEmptySpace(t,r))}}},JD=(e,t,r)=>{for(let[n,o]of r)for(let s of o)e.unsafeCompletePollers(t,r,n,s)},Bk=class{capacity;constructor(t){this.capacity=t}head={value:Rr,next:null};tail=this.head;size=0;index=0;slide(){this.index++}offer(t){this.tail.value=t,this.tail.next={value:Rr,next:null},this.tail=this.tail.next,this.size===this.capacity?this.head=this.head.next:this.size+=1}offerAll(t){for(let r of t)this.offer(r)}},Ax=class{buffer;head;index;remaining;constructor(t){this.buffer=t,this.index=t.index,this.remaining=t.size,this.head=t.head}fastForward(){for(;this.index<this.buffer.index;)this.head=this.head.next,this.index++}take(){if(this.remaining===0)return;this.index<this.buffer.index&&this.fastForward(),this.remaining--;let t=this.head.value;return this.head=this.head.next,t}takeN(t){if(this.remaining===0)return ee();this.index<this.buffer.index&&this.fastForward();let r=Math.min(t,this.remaining),n=new Array(r);for(let o=0;o<r;o++){let s=this.head.value;this.head=this.head.next,n[o]=s}return this.remaining-=r,Le(n)}takeAll(){return this.takeN(this.remaining)}},jk={remaining:0,take:()=>{},takeN:()=>ee(),takeAll:()=>ee()};var mS=PX,BX=FX,zX=NX,$k=DX;var Mx=LX;var ZD=UX;var rc=qX;var jX=Ix;var os=fX,vx=dX,Px=hX,hl=mX,$X=xX,Gk=gX,VX=yX,GX=bX,xS=SX,KX=EX,Pt=CX,Ve=wX;var YD=OX,QX=_X,Vn=Fk,JX=kX,ZX=FD,Kk=TX,YX=IX;var Qk="Continue",XD="Close",eL="Yield";var bke="effect/ChannelChildExecutorDecision",eee=Symbol.for(bke),yke={[eee]:eee},tL=e=>{let t=Object.create(yke);return t._tag=Qk,t};var Fx="ContinuationK",tee="ContinuationFinalizer";var nee=Symbol.for("effect/ChannelContinuation"),oee={_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutDone:e=>e,_OutErr2:e=>e,_OutElem:e=>e,_OutDone2:e=>e},Ad=class{onSuccess;onHalt;_tag=Fx;[nee]=oee;constructor(t,r){this.onSuccess=t,this.onHalt=r}onExit(t){return Bc(t)?this.onHalt(t.cause):this.onSuccess(t.value)}},Jk=class{finalizer;_tag=tee;[nee]=oee;constructor(t){this.finalizer=t}};var Zk="PullAfterNext",rL="PullAfterAllEnqueued";var Cke="effect/ChannelUpstreamPullStrategy",wke=Symbol.for(Cke),Oke={_A:e=>e},_ke={[wke]:Oke},nL=e=>{let t=Object.create(_ke);return t._tag=Zk,t.emitSeparator=e,t};var Yk="BracketOut",Xk="Bridge",bS="ConcatAll",eT="Emit",tT="Ensuring",rT="Fail",Nx="Fold",nT="FromEffect",oT="PipeTo",sT="Provide",iT="Read",aT="Succeed",cT="SucceedNow",uT="Suspend";var Tke="effect/Channel",yS=Symbol.for(Tke),Ike={_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutElem:e=>e,_OutDone:e=>e},Gn={[yS]:Ike,pipe(){return v(this,arguments)}},pT=e=>F(e,yS)||di(e),aee=u(2,(e,t)=>{let r=Object.create(Gn);return r._tag=Yk,r.acquire=()=>e,r.finalizer=t,r}),SS=u(2,(e,t)=>{let r=Object.create(Gn);return r._tag=Nx,r.channel=e,r.k=new Ad(dr,t),r}),fu=e=>nr(()=>{let t=[];return T(pe(e,cee(t)),r=>du(()=>[pt(t),r]))}),cee=e=>lt({onInput:t=>T(du(()=>{e.push(t)}),()=>cee(e)),onFailure:Ne,onDone:rr});var oL=(e,t,r)=>{let n=Object.create(Gn);return n._tag=bS,n.combineInners=t,n.combineAll=r,n.onPull=()=>nL(g()),n.onEmit=()=>tL,n.value=()=>e,n.k=R,n},uee=u(4,(e,t,r,n)=>{let o=Object.create(Gn);return o._tag=bS,o.combineInners=r,o.combineAll=n,o.onPull=()=>nL(g()),o.onEmit=()=>tL,o.value=()=>e,o.k=t,o});var lT=u(2,(e,t)=>{let r=Object.create(Gn);return r._tag=Xk,r.input=t,r.channel=e,r}),Md=u(2,(e,t)=>{let r=Object.create(Gn);return r._tag=tT,r.channel=e,r.finalizer=t,r}),Ne=e=>se(Ya(e));var se=e=>fT(()=>e),fT=e=>{let t=Object.create(Gn);return t._tag=rT,t.error=e,t},T=u(2,(e,t)=>{let r=Object.create(Gn);return r._tag=Nx,r.channel=e,r.k=new Ad(t,se),r}),Dx=u(2,(e,t)=>{let r=Object.create(Gn);return r._tag=Nx,r.channel=e,r.k=new Ad(t.onSuccess,t.onFailure),r}),Z=e=>{let t=Object.create(Gn);return t._tag=nT,t.effect=()=>e,t},pe=u(2,(e,t)=>{let r=Object.create(Gn);return r._tag=oT,r.left=()=>e,r.right=()=>t,r}),vd=u(2,(e,t)=>{let r=Object.create(Gn);return r._tag=sT,r.context=()=>t,r.inner=e,r});var lt=e=>Ae({onInput:e.onInput,onFailure:t=>Xe(Xa(t),{onLeft:e.onFailure,onRight:se}),onDone:e.onDone}),Ae=e=>{let t=Object.create(Gn);return t._tag=iT,t.more=e.onInput,t.done=new Ad(e.onDone,e.onFailure),t},dr=e=>du(()=>e),rr=e=>{let t=Object.create(Gn);return t._tag=cT,t.terminal=e,t},nr=e=>{let t=Object.create(Gn);return t._tag=uT,t.channel=e,t},du=e=>{let t=Object.create(Gn);return t._tag=aT,t.evaluate=e,t},re=rr(void 0);var A=e=>{let t=Object.create(Gn);return t._tag=eT,t.out=e,t};var ml="Done",xl="Emit",hu="FromEffect",gl="Read";var Rke=Symbol.for("effect/ChannelState"),Ake={_E:e=>e,_R:e=>e},dT={[Rke]:Ake},Pd=()=>{let e=Object.create(dT);return e._tag=ml,e},hT=()=>{let e=Object.create(dT);return e._tag=xl,e},Lx=e=>{let t=Object.create(dT);return t._tag=hu,t.effect=e,t},mT=(e,t,r,n)=>{let o=Object.create(dT);return o._tag=gl,o.upstream=e,o.onEffect=t,o.onEmit=r,o.onDone=n,o};var CS=e=>e._tag===hu;var pee=e=>CS(e)?e.effect:be,iL=e=>CS(e)?cD(e.effect):void 0;var aL="PullFromChild",xT="PullFromUpstream",gT="DrainChildExecutors",cL="Emit",Fd=class{childExecutor;parentSubexecutor;onEmit;_tag=aL;constructor(t,r,n){this.childExecutor=t,this.parentSubexecutor=r,this.onEmit=n}close(t){let r=this.childExecutor.close(t),n=this.parentSubexecutor.close(t);return r!==void 0&&n!==void 0?da(Ir(r),Ir(n),(o,s)=>p(o,zp(s))):r!==void 0?r:n!==void 0?n:void 0}enqueuePullFromChild(t){return this}},bl=class e{upstreamExecutor;createChild;lastDone;activeChildExecutors;combineChildResults;combineWithChildResult;onPull;onEmit;_tag=xT;constructor(t,r,n,o,s,i,a,c){this.upstreamExecutor=t,this.createChild=r,this.lastDone=n,this.activeChildExecutors=o,this.combineChildResults=s,this.combineWithChildResult=i,this.onPull=a,this.onEmit=c}close(t){let r=this.upstreamExecutor.close(t),o=[...this.activeChildExecutors.map(s=>s!==void 0?s.childExecutor.close(t):void 0),r].reduce((s,i)=>s!==void 0&&i!==void 0?da(s,Ir(i),(a,c)=>zp(a,c)):s!==void 0?s:i!==void 0?Ir(i):void 0,void 0);return o}enqueuePullFromChild(t){return new e(this.upstreamExecutor,this.createChild,this.lastDone,[...this.activeChildExecutors,t],this.combineChildResults,this.combineWithChildResult,this.onPull,this.onEmit)}},Nd=class e{upstreamExecutor;lastDone;activeChildExecutors;upstreamDone;combineChildResults;combineWithChildResult;onPull;_tag=gT;constructor(t,r,n,o,s,i,a){this.upstreamExecutor=t,this.lastDone=r,this.activeChildExecutors=n,this.upstreamDone=o,this.combineChildResults=s,this.combineWithChildResult=i,this.onPull=a}close(t){let r=this.upstreamExecutor.close(t),o=[...this.activeChildExecutors.map(s=>s!==void 0?s.childExecutor.close(t):void 0),r].reduce((s,i)=>s!==void 0&&i!==void 0?da(s,Ir(i),(a,c)=>zp(a,c)):s!==void 0?s:i!==void 0?Ir(i):void 0,void 0);return o}enqueuePullFromChild(t){return new e(this.upstreamExecutor,this.lastDone,[...this.activeChildExecutors,t],this.upstreamDone,this.combineChildResults,this.combineWithChildResult,this.onPull)}},Ux=class{value;next;_tag=cL;constructor(t,r){this.value=t,this.next=r}close(t){let r=this.next.close(t);return r}enqueuePullFromChild(t){return this}};var lee="Pulled",fee="NoUpstream";var Fke="effect/ChannelUpstreamPullRequest",Nke=Symbol.for(Fke),Dke={_A:e=>e},dee={[Nke]:Dke},uL=e=>{let t=Object.create(dee);return t._tag=lee,t.value=e,t},hee=e=>{let t=Object.create(dee);return t._tag=fee,t.activeDownstreamCount=e,t};var wS=class e{_activeSubexecutor=void 0;_cancelled=void 0;_closeLastSubstream=void 0;_currentChannel;_done=void 0;_doneStack=[];_emitted=void 0;_executeCloseLastSubstream;_input=void 0;_inProgressFinalizer=void 0;_providedEnv;constructor(t,r,n){this._currentChannel=t,this._executeCloseLastSubstream=n,this._providedEnv=r}run(){let t;for(;t===void 0;)if(this._cancelled!==void 0)t=this.processCancellation();else if(this._activeSubexecutor!==void 0)t=this.runSubexecutor();else try{if(this._currentChannel===void 0)t=Pd();else switch(di(this._currentChannel)&&(this._currentChannel=Z(this._currentChannel)),this._currentChannel._tag){case Yk:{t=this.runBracketOut(this._currentChannel);break}case Xk:{let r=this._currentChannel.input;if(this._currentChannel=this._currentChannel.channel,this._input!==void 0){let n=this._input;this._input=void 0;let o=()=>P(r.awaitRead(),()=>Je(()=>{let s=n.run();switch(s._tag){case ml:return qt(n.getDone(),{onFailure:i=>r.error(i),onSuccess:i=>r.done(i)});case xl:return P(r.emit(n.getEmit()),()=>o());case hu:return jn(s.effect,{onFailure:i=>r.error(i),onSuccess:()=>o()});case gl:return yT(s,()=>o(),i=>r.error(i))}}));t=Lx(P(ul(uo(o())),s=>Ze(()=>this.addFinalizer(i=>P(kn(s),()=>Je(()=>{let a=this.restorePipe(i,n);return a!==void 0?a:be}))))))}break}case bS:{let r=new e(this._currentChannel.value(),this._providedEnv,o=>Ze(()=>{let s=this._closeLastSubstream===void 0?be:this._closeLastSubstream;this._closeLastSubstream=p(s,ue(o))}));r._input=this._input;let n=this._currentChannel;this._activeSubexecutor=new bl(r,o=>n.k(o),void 0,[],(o,s)=>n.combineInners(o,s),(o,s)=>n.combineAll(o,s),o=>n.onPull(o),o=>n.onEmit(o)),this._closeLastSubstream=void 0,this._currentChannel=void 0;break}case eT:{this._emitted=this._currentChannel.out,this._currentChannel=this._activeSubexecutor!==void 0?void 0:re,t=hT();break}case tT:{this.runEnsuring(this._currentChannel);break}case rT:{t=this.doneHalt(this._currentChannel.error());break}case Nx:{this._doneStack.push(this._currentChannel.k),this._currentChannel=this._currentChannel.channel;break}case nT:{let r=this._providedEnv===void 0?this._currentChannel.effect():p(this._currentChannel.effect(),wx(this._providedEnv));t=Lx(jn(r,{onFailure:n=>{let o=this.doneHalt(n);return o!==void 0&&CS(o)?o.effect:be},onSuccess:n=>{let o=this.doneSucceed(n);return o!==void 0&&CS(o)?o.effect:be}}));break}case oT:{let r=this._input,n=new e(this._currentChannel.left(),this._providedEnv,o=>this._executeCloseLastSubstream(o));n._input=r,this._input=n,this.addFinalizer(o=>{let s=this.restorePipe(o,r);return s!==void 0?s:be}),this._currentChannel=this._currentChannel.right();break}case sT:{let r=this._providedEnv;this._providedEnv=this._currentChannel.context(),this._currentChannel=this._currentChannel.inner,this.addFinalizer(()=>Ze(()=>{this._providedEnv=r}));break}case iT:{let r=this._currentChannel;t=mT(this._input,R,n=>{try{this._currentChannel=r.more(n)}catch(o){this._currentChannel=r.done.onExit(zc(o))}},n=>{let o=s=>r.done.onExit(s);this._currentChannel=o(n)});break}case aT:{t=this.doneSucceed(this._currentChannel.evaluate());break}case cT:{t=this.doneSucceed(this._currentChannel.terminal);break}case uT:{this._currentChannel=this._currentChannel.channel();break}}}catch(r){this._currentChannel=se(zn(r))}return t}getDone(){return this._done}getEmit(){return this._emitted}cancelWith(t){this._cancelled=t}clearInProgressFinalizer(){this._inProgressFinalizer=void 0}storeInProgressFinalizer(t){this._inProgressFinalizer=t}popAllFinalizers(t){let r=[],n=this._doneStack.pop();for(;n;)n._tag==="ContinuationFinalizer"&&r.push(n.finalizer),n=this._doneStack.pop();let o=r.length===0?be:lL(r,t);return this.storeInProgressFinalizer(o),o}popNextFinalizers(){let t=[];for(;this._doneStack.length!==0;){let r=this._doneStack[this._doneStack.length-1];if(r._tag===Fx)return t;t.push(r),this._doneStack.pop()}return t}restorePipe(t,r){let n=this._input;return this._input=r,n!==void 0?n.close(t):be}close(t){let r,n=this._inProgressFinalizer;n!==void 0&&(r=p(n,la(Ze(()=>this.clearInProgressFinalizer()))));let o,s=this.popAllFinalizers(t);s!==void 0&&(o=p(s,la(Ze(()=>this.clearInProgressFinalizer()))));let i=this._activeSubexecutor===void 0?void 0:this._activeSubexecutor.close(t);if(!(i===void 0&&r===void 0&&o===void 0))return p(Ir(pL(i)),fo(Ir(pL(r))),fo(Ir(pL(o))),w(([[a,c],l])=>p(a,zp(c),zp(l))),au,P(a=>Je(()=>a)))}doneSucceed(t){if(this._doneStack.length===0)return this._done=xe(t),this._currentChannel=void 0,Pd();let r=this._doneStack[this._doneStack.length-1];if(r._tag===Fx){this._doneStack.pop(),this._currentChannel=r.onSuccess(t);return}let n=this.popNextFinalizers();if(this._doneStack.length===0)return this._doneStack=n.reverse(),this._done=xe(t),this._currentChannel=void 0,Pd();let o=lL(n.map(i=>i.finalizer),xe(t));this.storeInProgressFinalizer(o);let s=p(o,la(Ze(()=>this.clearInProgressFinalizer())),au,P(()=>Ze(()=>this.doneSucceed(t))));return Lx(s)}doneHalt(t){if(this._doneStack.length===0)return this._done=st(t),this._currentChannel=void 0,Pd();let r=this._doneStack[this._doneStack.length-1];if(r._tag===Fx){this._doneStack.pop();try{this._currentChannel=r.onHalt(t)}catch(i){this._currentChannel=se(zn(i))}return}let n=this.popNextFinalizers();if(this._doneStack.length===0)return this._doneStack=n.reverse(),this._done=st(t),this._currentChannel=void 0,Pd();let o=lL(n.map(i=>i.finalizer),st(t));this.storeInProgressFinalizer(o);let s=p(o,la(Ze(()=>this.clearInProgressFinalizer())),au,P(()=>Ze(()=>this.doneHalt(t))));return Lx(s)}processCancellation(){return this._currentChannel=void 0,this._done=this._cancelled,this._cancelled=void 0,Pd()}runBracketOut(t){let r=au(jn(this.provide(t.acquire()),{onFailure:n=>Ze(()=>{this._currentChannel=se(n)}),onSuccess:n=>Ze(()=>{this.addFinalizer(o=>this.provide(t.finalizer(n,o))),this._currentChannel=A(n)})}));return Lx(r)}provide(t){return this._providedEnv===void 0?t:p(t,wx(this._providedEnv))}runEnsuring(t){this.addFinalizer(t.finalizer),this._currentChannel=t.channel}addFinalizer(t){this._doneStack.push(new Jk(t))}runSubexecutor(){let t=this._activeSubexecutor;switch(t._tag){case aL:return this.pullFromChild(t.childExecutor,t.parentSubexecutor,t.onEmit,t);case xT:return this.pullFromUpstream(t);case gT:return this.drainChildExecutors(t);case cL:return this._emitted=t.value,this._activeSubexecutor=t.next,hT()}}replaceSubexecutor(t){this._currentChannel=void 0,this._activeSubexecutor=t}finishWithExit(t){let r=qt(t,{onFailure:n=>this.doneHalt(n),onSuccess:n=>this.doneSucceed(n)});return this._activeSubexecutor=void 0,r===void 0?be:pee(r)}finishSubexecutorWithCloseEffect(t,...r){this.addFinalizer(()=>p(r,zr(o=>p(Ze(()=>o(t)),P(s=>s!==void 0?s:be)),{discard:!0})));let n=p(t,qt({onFailure:o=>this.doneHalt(o),onSuccess:o=>this.doneSucceed(o)}));return this._activeSubexecutor=void 0,n}applyUpstreamPullStrategy(t,r,n){switch(n._tag){case Zk:{let o=!t||r.some(s=>s!==void 0);return[n.emitSeparator,o?[void 0,...r]:r]}case rL:{let o=!t||r.some(s=>s!==void 0);return[n.emitSeparator,o?[...r,void 0]:r]}}}pullFromChild(t,r,n,o){return mT(t,R,s=>{let i=n(s);switch(i._tag){case Qk:break;case XD:{this.finishWithDoneValue(t,r,i.value);break}case eL:{let a=r.enqueuePullFromChild(o);this.replaceSubexecutor(a);break}}this._activeSubexecutor=new Ux(s,this._activeSubexecutor)},qt({onFailure:s=>{let i=this.handleSubexecutorFailure(t,r,s);return i===void 0?void 0:iL(i)},onSuccess:s=>{this.finishWithDoneValue(t,r,s)}}))}finishWithDoneValue(t,r,n){let o=r;switch(o._tag){case xT:{let s=new bl(o.upstreamExecutor,o.createChild,o.lastDone!==void 0?o.combineChildResults(o.lastDone,n):n,o.activeChildExecutors,o.combineChildResults,o.combineWithChildResult,o.onPull,o.onEmit);this._closeLastSubstream=t.close(xe(n)),this.replaceSubexecutor(s);break}case gT:{let s=new Nd(o.upstreamExecutor,o.lastDone!==void 0?o.combineChildResults(o.lastDone,n):n,o.activeChildExecutors,o.upstreamDone,o.combineChildResults,o.combineWithChildResult,o.onPull);this._closeLastSubstream=t.close(xe(n)),this.replaceSubexecutor(s);break}default:break}}handleSubexecutorFailure(t,r,n){return this.finishSubexecutorWithCloseEffect(st(n),o=>r.close(o),o=>t.close(o))}pullFromUpstream(t){if(t.activeChildExecutors.length===0)return this.performPullFromUpstream(t);let r=t.activeChildExecutors[0],n=new bl(t.upstreamExecutor,t.createChild,t.lastDone,t.activeChildExecutors.slice(1),t.combineChildResults,t.combineWithChildResult,t.onPull,t.onEmit);if(r===void 0)return this.performPullFromUpstream(n);this.replaceSubexecutor(new Fd(r.childExecutor,n,r.onEmit))}performPullFromUpstream(t){return mT(t.upstreamExecutor,r=>{let n=this._closeLastSubstream===void 0?be:this._closeLastSubstream;return this._closeLastSubstream=void 0,p(this._executeCloseLastSubstream(n),ue(r))},r=>{if(this._closeLastSubstream!==void 0){let i=this._closeLastSubstream;return this._closeLastSubstream=void 0,p(this._executeCloseLastSubstream(i),w(()=>{let a=new e(t.createChild(r),this._providedEnv,this._executeCloseLastSubstream);a._input=this._input;let[c,l]=this.applyUpstreamPullStrategy(!1,t.activeChildExecutors,t.onPull(uL(r)));this._activeSubexecutor=new Fd(a,new bl(t.upstreamExecutor,t.createChild,t.lastDone,l,t.combineChildResults,t.combineWithChildResult,t.onPull,t.onEmit),t.onEmit),X(c)&&(this._activeSubexecutor=new Ux(c.value,this._activeSubexecutor))}))}let n=new e(t.createChild(r),this._providedEnv,this._executeCloseLastSubstream);n._input=this._input;let[o,s]=this.applyUpstreamPullStrategy(!1,t.activeChildExecutors,t.onPull(uL(r)));this._activeSubexecutor=new Fd(n,new bl(t.upstreamExecutor,t.createChild,t.lastDone,s,t.combineChildResults,t.combineWithChildResult,t.onPull,t.onEmit),t.onEmit),X(o)&&(this._activeSubexecutor=new Ux(o.value,this._activeSubexecutor))},r=>{if(t.activeChildExecutors.some(s=>s!==void 0)){let s=new Nd(t.upstreamExecutor,t.lastDone,[void 0,...t.activeChildExecutors],t.upstreamExecutor.getDone(),t.combineChildResults,t.combineWithChildResult,t.onPull);if(this._closeLastSubstream!==void 0){let i=this._closeLastSubstream;return this._closeLastSubstream=void 0,p(this._executeCloseLastSubstream(i),w(()=>this.replaceSubexecutor(s)))}this.replaceSubexecutor(s);return}let n=this._closeLastSubstream,o=this.finishSubexecutorWithCloseEffect(p(r,Sm(s=>t.combineWithChildResult(t.lastDone,s))),()=>n,s=>t.upstreamExecutor.close(s));return o===void 0?void 0:iL(o)})}drainChildExecutors(t){if(t.activeChildExecutors.length===0){let s=this._closeLastSubstream;return s!==void 0&&this.addFinalizer(()=>B(s)),this.finishSubexecutorWithCloseEffect(t.upstreamDone,()=>s,i=>t.upstreamExecutor.close(i))}let r=t.activeChildExecutors[0],n=t.activeChildExecutors.slice(1);if(r===void 0){let[s,i]=this.applyUpstreamPullStrategy(!0,n,t.onPull(hee(n.reduce((a,c)=>c!==void 0?a+1:a,0))));return this.replaceSubexecutor(new Nd(t.upstreamExecutor,t.lastDone,i,t.upstreamDone,t.combineChildResults,t.combineWithChildResult,t.onPull)),X(s)?(this._emitted=s.value,hT()):void 0}let o=new Nd(t.upstreamExecutor,t.lastDone,n,t.upstreamDone,t.combineChildResults,t.combineWithChildResult,t.onPull);this.replaceSubexecutor(new Fd(r.childExecutor,o,r.onEmit))}},pL=e=>e!==void 0?e:be,lL=(e,t)=>p(zr(e,r=>Ir(r(t))),w(r=>p(Lv(r),_e(()=>Bp))),P(r=>Je(()=>r))),yT=(e,t,r)=>{let n=[e],o=()=>{let s=n.pop();if(s===void 0||s.upstream===void 0)return il("Unexpected end of input for channel execution");let i=s.upstream.run();switch(i._tag){case xl:{let a=s.onEmit(s.upstream.getEmit());return n.length===0?a===void 0?Je(t):p(a,jn({onFailure:r,onSuccess:t})):a===void 0?Je(()=>o()):p(a,jn({onFailure:r,onSuccess:()=>o()}))}case ml:{let a=s.onDone(s.upstream.getDone());return n.length===0?a===void 0?Je(t):p(a,jn({onFailure:r,onSuccess:t})):a===void 0?Je(()=>o()):p(a,jn({onFailure:r,onSuccess:()=>o()}))}case hu:return n.push(s),p(s.onEffect(i.effect),hi(a=>Je(()=>{let c=s.onDone(st(a));return c===void 0?be:c})),jn({onFailure:r,onSuccess:()=>o()}));case gl:return n.push(s),n.push(i),Je(()=>o())}};return o()},ss=u(2,(e,t)=>{let r=(n,o,s)=>pD(Ze(()=>new wS(e,void 0,R)),i=>Je(()=>bT(i.run(),i).pipe(pS(n),ue(We(n)),dl(We(o)))),(i,a)=>{let c=i.close(a);return c===void 0?be:_x(c,l=>su(s,Ht(l)))});return cl(n=>Po([Ly(t,vm),wt(),wt()]).pipe(P(([o,s,i])=>n(r(s,i,o)).pipe(yt(t),P(a=>t.addFinalizer(c=>{let l=Bc(c)?PQ(c.cause):void 0;return Qb(s).pipe(P(f=>f?Cr(i,void 0).pipe(ue(B_(a)),ue(aN(a))):Cr(i,void 0).pipe(ue(l&&Ac(l)>0?z_(a,s5(l)):kn(a)),ue(aN(a)))))}).pipe(ue(n(We(s)))))))))}),bT=(e,t)=>{let r=e;switch(r._tag){case hu:return p(r.effect,P(()=>bT(t.run(),t)));case xl:return bT(t.run(),t);case ml:return Je(()=>t.getDone());case gl:return yT(r,()=>bT(t.run(),t),Ht)}};var ST="Done",mee="Await";var Uke="effect/ChannelMergeDecision",gee=Symbol.for(Uke),bee={[gee]:{_R:e=>e,_E0:e=>e,_Z0:e=>e,_E:e=>e,_Z:e=>e}},mu=e=>{let t=Object.create(bee);return t._tag=ST,t.effect=e,t},xu=e=>{let t=Object.create(bee);return t._tag=mee,t.f=e,t};var ET="BothRunning",CT="LeftDone",wT="RightDone";var qke="effect/ChannelMergeState",See=Symbol.for(qke),hL={[See]:See},OT=(e,t)=>{let r=Object.create(hL);return r._tag=ET,r.left=e,r.right=t,r},mL=e=>{let t=Object.create(hL);return t._tag=CT,t.f=e,t},xL=e=>{let t=Object.create(hL);return t._tag=wT,t.f=e,t};var gL="BackPressure",bL="BufferSliding";var Bke="effect/ChannelMergeStrategy",Eee=Symbol.for(Bke),Cee={[Eee]:Eee},wee=e=>{let t=Object.create(Cee);return t._tag=gL,t},Oee=e=>{let t=Object.create(Cee);return t._tag=bL,t};var _ee=u(2,(e,{onBackPressure:t,onBufferSliding:r})=>{switch(e._tag){case gL:return t();case bL:return r()}});var qx="Empty",OS="Emit",_S="Error",kS="Done",Tee=e=>({_tag:qx,notifyProducer:e}),yL=e=>({_tag:OS,notifyConsumers:e}),zke=e=>({_tag:_S,cause:e}),jke=e=>({_tag:kS,done:e}),SL=class{ref;constructor(t){this.ref=t}awaitRead(){return lo(Yo(this.ref,t=>t._tag===qx?[We(t.notifyProducer),t]:[be,t]))}get close(){return hD(t=>this.error(yd(t)))}done(t){return lo(Yo(this.ref,r=>{switch(r._tag){case qx:return[We(r.notifyProducer),r];case OS:return[zr(r.notifyConsumers,n=>Cr(n,V(t)),{discard:!0}),jke(t)];case _S:return[al,r];case kS:return[al,r]}}))}emit(t){return P(wt(),r=>lo(Yo(this.ref,n=>{switch(n._tag){case qx:return[We(n.notifyProducer),n];case OS:{let o=n.notifyConsumers[0],s=n.notifyConsumers.slice(1);if(o!==void 0)return[Cr(o,Y(t)),s.length===0?Tee(r):yL(s)];throw new Error("Bug: Channel.SingleProducerAsyncInput.emit - Queue was empty! please report an issue at https://github.com/Effect-TS/effect/issues")}case _S:return[al,n];case kS:return[al,n]}})))}error(t){return lo(Yo(this.ref,r=>{switch(r._tag){case qx:return[We(r.notifyProducer),r];case OS:return[zr(r.notifyConsumers,n=>Zf(n,t),{discard:!0}),zke(t)];case _S:return[al,r];case kS:return[al,r]}}))}get take(){return this.takeWith(t=>st(Is(t,V)),t=>xe(t),t=>At(Y(t)))}takeWith(t,r,n){return P(wt(),o=>lo(Yo(this.ref,s=>{switch(s._tag){case qx:return[ue(Cr(s.notifyProducer,void 0),uu(We(o),{onFailure:t,onSuccess:Xe({onLeft:n,onRight:r})})),yL([o])];case OS:return[uu(We(o),{onFailure:t,onSuccess:Xe({onLeft:n,onRight:r})}),yL([...s.notifyConsumers,o])];case _S:return[B(t(s.cause)),s];case kS:return[B(n(s.done)),s]}})))}},_T=()=>p(wt(),P(e=>tr(Tee(e))),w(e=>new SL(e)));var Iee=(e,t,r)=>T(Z(tr(()=>be)),n=>p(Z(au(ln(e,o=>Lr(n,s=>r(o,s))))),T(t),Md(o=>P(_t(n),s=>s(o))))),TS=u(2,(e,t)=>Ud(e,()=>t));var Ld=u(2,(e,t)=>SS(e,r=>Xe(Xa(r),{onLeft:t,onRight:se}))),ma=u(2,(e,t)=>uee(e,t,()=>{},()=>{}));var xa=e=>{let t=Ae({onInput:()=>t,onFailure:se,onDone:dr});return pe(e,t)};var IS=u(2,(e,t)=>Md(e,()=>t));var Vke=e=>T(e,R),Ree=u(2,(e,t)=>Dx(e,{onFailure:r=>{let n=Xa(r);switch(n._tag){case"Left":return t.onFailure(n.left);case"Right":return se(n.right)}},onSuccess:t.onSuccess}));var kT=e=>Ce(e.takeWith(se,t=>T(A(t),()=>kT(e)),dr));var wL=e=>nr(()=>Aee(e)),Aee=e=>p(Z(Vn(e)),T(Xe({onLeft:qt({onFailure:se,onSuccess:rr}),onRight:t=>T(A(t),()=>Aee(e))}))),As=()=>lt({onInput:e=>T(A(e),()=>As()),onFailure:Ne,onDone:rr}),OL=u(2,(e,t)=>Hd(e,{other:Z(t),onSelfDone:r=>mu(Je(()=>r)),onOtherDone:r=>mu(Je(()=>r))})),Mee=u(2,(e,t)=>OL(e,We(t))),Ud=u(2,(e,t)=>T(e,r=>du(()=>t(r))));var _L=u(2,(e,t)=>kL(e,Is(t))),kL=u(2,(e,t)=>SS(e,r=>se(t(r)))),qd=u(2,(e,t)=>{let r=lt({onInput:n=>T(A(t(n)),()=>r),onFailure:Ne,onDone:rr});return pe(e,r)}),TT=u(2,(e,t)=>{let r=Ae({onInput:n=>p(Z(t(n)),T(A),T(()=>r)),onFailure:se,onDone:rr});return pe(e,r)}),TL=u(3,(e,t,r)=>ga(n=>co(function*(){let o=yield*_T(),s=kT(o),i=yield*os(r);yield*su(n,Pt(i));let a=yield*wt(),c=r===Number.POSITIVE_INFINITY?d=>R:(yield*fl(r)).withPermits;yield*(yield*s.pipe(pe(e),Dd(n))).pipe(jn({onFailure:d=>Ve(i,Ht(d)),onSuccess:Xe({onLeft:d=>ue(uo(c(r)(be)),po(Ve(i,B(V(d))))),onRight:d=>co(function*(){let h=yield*wt(),m=yield*wt();yield*Ve(i,w(We(h),Y)),yield*Cr(m,void 0).pipe(ue(cl(y=>Ir(y(We(a))).pipe(yD(Ir(y(t(d)))),P(R))).pipe(_x(y=>Zf(a,y)),pS(h))),c(1),yt(n)),yield*We(m)})})}),SD,uo,yt(n));let f=Ce(uu(lo(Vn(i)),{onFailure:se,onSuccess:Xe({onLeft:rr,onRight:d=>T(A(d),()=>f)})}));return lT(f,o)}))),Gke=e=>t=>Kke(e)(t,Mr);var Kke=({bufferSize:e=16,concurrency:t,mergeStrategy:r=wee()})=>(n,o)=>ga(s=>co(function*(){let i=t==="unbounded"?Number.MAX_SAFE_INTEGER:t,a=yield*_T(),c=kT(a),l=yield*os(e);yield*su(s,Pt(l));let f=yield*hl();yield*su(s,Pt(f));let d=yield*tr(g()),h=yield*wt(),m=(yield*fl(i)).withPermits,y=yield*Dd(pe(c,n),s);function _(O){return O.pipe(P(Xe({onLeft:U=>B(x(U)),onRight:U=>Kt(Ve(l,B(Y(U))),g())})),Ik({until:U=>X(U)}),P(U=>Os(d,$({onNone:()=>x(U.value),onSome:I=>x(o(I,U.value))}))),hi(U=>ca(U)?Ht(U):Ve(l,Ht(U)).pipe(ue(Cr(h,void 0)),po)))}yield*y.pipe(jn({onFailure:O=>Ve(l,Ht(O)).pipe(ue(B(!1))),onSuccess:Xe({onLeft:O=>ll(uo(We(h)),uo(m(i)(be)),{onSelfDone:(U,I)=>Kt(kn(I),!1),onOtherDone:(U,I)=>ue(kn(I),_t(d).pipe(P($({onNone:()=>Ve(l,B(V(O))),onSome:Q=>Ve(l,B(V(o(Q,O))))})),Kt(!1)))}),onRight:O=>_ee(r,{onBackPressure:()=>co(function*(){let U=yield*wt(),I=uS(J=>Dd(pe(c,O),J).pipe(P(z=>lS(Ir(_(z)),Ir(uo(We(h))))),P(R)));return yield*Cr(U,void 0).pipe(ue(I),m(1),yt(s)),yield*We(U),!(yield*Qb(h))}),onBufferSliding:()=>co(function*(){let U=yield*wt(),I=yield*wt(),Q=yield*Gk(f);yield*Vn(f).pipe(P(te=>Cr(te,void 0)),Ox(()=>Q>=i)),yield*Ve(f,U);let J=uS(te=>Dd(pe(c,O),te).pipe(P(ce=>Ir(_(ce)).pipe(lS(Ir(uo(We(h)))),lS(Ir(uo(We(U)))))),P(R)));return yield*Cr(I,void 0).pipe(ue(J),m(1),yt(s)),yield*We(I),!(yield*Qb(h))})})})}),Ik({while:O=>O}),yt(s));let C=p(Vn(l),lo,uu({onFailure:se,onSuccess:Xe({onLeft:rr,onRight:O=>T(A(O),()=>C)})}),Ce);return lT(C,a)})),IL=u(3,(e,t,r)=>Gke(r)(qd(e,t)));var Hd=u(2,(e,t)=>{function r(n){return co(function*(){let o=yield*_T(),s=kT(o),i=yield*Dd(pe(s,e),n),a=yield*Dd(pe(s,t.other),n);function c(f,d,h){return(m,y,_)=>{function C(O){let U=O;return U._tag===ST?B(Z(ue(kn(d),U.effect))):w(B_(d),qt({onFailure:I=>Z(U.f(st(I))),onSuccess:Xe({onLeft:I=>Z(U.f(xe(I))),onRight:I=>Fe(A(I),l(_(U.f)))})}))}return qt(f,{onFailure:O=>C(m(st(O))),onSuccess:Xe({onLeft:O=>C(m(xe(O))),onRight:O=>B(T(A(O),()=>T(Z(yt(uo(h),n)),U=>l(y(U,d)))))})})}}function l(f){switch(f._tag){case ET:{let d=uo(vo(f.left)),h=uo(vo(f.right));return Ce(ll(d,h,{onSelfDone:(m,y)=>ue(kn(y),c(m,f.right,i)(t.onSelfDone,OT,_=>mL(_))),onOtherDone:(m,y)=>ue(kn(y),c(m,f.left,a)(t.onOtherDone,(_,C)=>OT(C,_),_=>xL(_)))}))}case CT:return Ce(w(Ir(a),qt({onFailure:d=>Z(f.f(st(d))),onSuccess:Xe({onLeft:d=>Z(f.f(xe(d))),onRight:d=>T(A(d),()=>l(mL(f.f)))})})));case wT:return Ce(w(Ir(i),qt({onFailure:d=>Z(f.f(st(d))),onSuccess:Xe({onLeft:d=>Z(f.f(xe(d))),onRight:d=>T(A(d),()=>l(xL(f.f)))})})))}}return Z(_k(f=>{let d=_k(y=>(y.transferChildren(f.scope()),be)),h=uo(i).pipe(la(d),yt(n)),m=uo(a).pipe(la(d),yt(n));return da(h,m,(y,_)=>OT(y,_))})).pipe(T(l),lT(o))})}return ga(r)});var vee=u(2,(e,t)=>Ld(e,r=>fT(()=>zn(t(r))))),RL=u(2,(e,t)=>Ld(e,t)),or=u(2,(e,t)=>nr(()=>{let r,n=lt({onInput:s=>T(A(s),()=>n),onFailure:s=>(r=Jke(s),se(zn(r))),onDone:rr}),o=Ae({onInput:s=>p(A(s),T(()=>o)),onFailure:s=>A_(s)&&Zke(s.defect)&&N(s.defect,r)?Ne(s.defect.error):se(s),onDone:rr});return pe(pe(pe(e,n),t),o)}));var IT=e=>T(e,()=>IT(e)),RS=e=>uS(t=>ss(e,t));var Pee=e=>RS(xa(e)),AS=e=>fD(t=>ss(e,t)),AL=e=>Ce(cl(t=>w(G2(),r=>aee(_x(t(ix(e,r)),n=>sx(r,st(n))),(n,o)=>sx(r,o))))),ML=e=>gu(w(Tk,t=>T(Z(e(t)),A)));var Fee=()=>nr(()=>{let e="",t=!1,r=o=>{let s=[];return bt(o,i=>{if(i.length!==0){let a=0,c=i.indexOf("\r"),l=i.indexOf(`
`);for(t&&(l===0?(s.push(e),e="",a=1,l=i.indexOf(`
`,a)):e=e+"\r",t=!1);c!==-1||l!==-1;)c===-1||l!==-1&&l<c?(e.length===0?s.push(i.substring(a,l)):(s.push(e+i.substring(a,l)),e=""),a=l+1,l=i.indexOf(`
`,a)):i.length===c+1?(t=!0,c=-1):l===c+1?(e.length===0?s.push(i.substring(a,c)):(e=e+i.substring(a,c),s.push(e),e=""),a=c+2,c=i.indexOf("\r",a),l=i.indexOf(`
`,a)):c=i.indexOf("\r",c+1);t?e=e+i.substring(a,i.length-1):e=e+i.substring(a,i.length)}}),Le(s)},n=Ae({onInput:o=>{let s=r(o);return le(s)?n:T(A(s),()=>n)},onFailure:o=>e.length===0?se(o):T(A(G(e)),()=>se(o)),onDone:o=>e.length===0?dr(o):T(A(G(e)),()=>dr(o))});return n}),Nee=e=>Qke(e),Dee=e=>P(Tk,t=>Dd(e,t)),Dd=u(2,(e,t)=>fo(Ze(()=>new wS(e,void 0,R)),pu()).pipe(ln(([r,n])=>V2(t,o=>{let s=r.close(o);return s!==void 0?wx(s,n):be})),au,w(([r])=>Je(()=>EL(r.run(),r))))),EL=(e,t)=>{let r=e;switch(r._tag){case ml:return qt(t.getDone(),{onFailure:Ht,onSuccess:n=>B(V(n))});case xl:return B(Y(t.getEmit()));case hu:return p(r.effect,P(()=>EL(t.run(),t)));case gl:return yT(r,()=>EL(t.run(),t),n=>Ht(n))}},Qke=e=>nr(()=>Lee(e)),Lee=e=>Ae({onInput:t=>T(Z(Ve(e,Y(t))),()=>Lee(e)),onFailure:t=>Z(Ve(e,V(st(t)))),onDone:t=>Z(Ve(e,V(xe(t))))}),Ce=e=>Vke(Z(e)),gu=e=>oL(AL(e),(t,r)=>t,(t,r)=>t),ga=e=>oL(ML(e),(t,r)=>t,(t,r)=>t);var vL=function(){let e=typeof arguments[0]!="string",t=e?arguments[1]:arguments[0],r=qn(e?arguments[2]:arguments[1]),n=Po([CD(t,r),Cx(),mD,GY(ZY)]);if(e){let o=arguments[0];return Iee(n,([s,i])=>vd(o,qe(i,cn,s)),([s,,i,a],c)=>Mm(s,c,i,a))}return o=>Iee(n,([s,i])=>vd(o,qe(i,cn,s)),([s,,i,a],c)=>Mm(s,c,i,a))},Uee=(...e)=>Kn(pt(e)),Kn=e=>qee(0,e.length,e),qee=(e,t,r)=>e===t?re:p(A(p(r,dt(e))),T(()=>qee(e+1,t,r))),Hee=u(e=>pT(e[1]),(e,t,r)=>r?.concurrent?Hd(e,{other:t,onSelfDone:n=>xu(o=>Je(()=>Nw(n,o))),onOtherDone:n=>xu(o=>Je(()=>Nw(o,n)))}):T(e,n=>Ud(t,o=>[n,o]))),PL=u(e=>pT(e[1]),(e,t,r)=>r?.concurrent?Ud(Hee(e,t,{concurrent:!0}),n=>n[0]):T(e,n=>TS(t,n))),Fe=u(e=>pT(e[1]),(e,t,r)=>r?.concurrent?Ud(Hee(e,t,{concurrent:!0}),n=>n[1]):T(e,()=>t)),CL=Symbol.for("effect/Channel/ChannelException"),Jke=e=>({_tag:"ChannelException",[CL]:CL,error:e}),Zke=e=>F(e,CL);var MS=Symbol.for("effect/Sink"),Yke={_A:e=>e,_In:e=>e,_L:e=>e,_E:e=>e,_R:e=>e},fn=class{channel;[MS]=Yke;constructor(t){this.channel=t}pipe(){return v(this,arguments)}},Wee=e=>F(e,MS),vS=e=>new fn(nr(()=>Qn(e())));var Bee=()=>new fn(zee(ee())),zee=e=>Ae({onInput:t=>zee(p(e,He(t))),onFailure:se,onDone:()=>dr(e)}),jee=e=>vS(()=>WL($ee(e,ee()))),$ee=(e,t)=>Ae({onInput:r=>{let[n,o]=mf(r,e);return n.length<e?$ee(e-n.length,He(t,n)):le(o)?dr(He(t,n)):T(A(o),()=>dr(He(t,n)))},onFailure:se,onDone:()=>dr(t)});var Vee=e=>new fn(p(fu(Qn(e)),Ud(([t,r])=>[r,yC(t)])));var Gee=new fn(xa(As()));var NL=e=>new fn(Ne(e));var RT=(e,t,r)=>vS(()=>new fn(Kee(e,t,r))),Kee=(e,t,r)=>t(e)?lt({onInput:n=>{let[o,s]=Qee(e,n,t,r,0,n.length);return Vt(s)?p(A(s),TS(o)):Kee(o,t,r)},onFailure:Ne,onDone:()=>rr(e)}):rr(e),Qee=(e,t,r,n,o,s)=>{if(o===s)return[e,ee()];let i=n(e,p(t,dt(o)));return r(i)?Qee(i,t,r,n,o+1,s):[i,p(t,$t(o+1))]},DL=u(2,(e,t)=>{let r=p(Qn(e),fu,Ree({onFailure:n=>Qn(t.onFailure(n)),onSuccess:([n,o])=>nr(()=>{let s={ref:p(n,zi(Vt))},i=p(du(()=>{let l=s.ref;return s.ref=ee(),l}),T(l=>Kn(l))),a=As(),c=p(i,Fe(a),pe(Qn(t.onSuccess(o))));return T(fu(c),([l,f])=>p(dr(s.ref),T(Kn),Fe(Kn(l)),TS(f)))})}));return new fn(r)}),Xke=(e,t,r)=>vS(()=>new fn(Jee(e,t,r))),Jee=(e,t,r)=>t(e)?lt({onInput:n=>Jee(r(e,n),t,r),onFailure:Ne,onDone:()=>rr(e)}):rr(e);var LL=(e,t,r)=>vS(()=>new fn(Zee(e,t,r))),Zee=(e,t,r)=>t(e)?lt({onInput:n=>p(Z(eTe(e,n,t,r)),T(([o,s])=>p(s,$({onNone:()=>Zee(o,t,r),onSome:i=>p(A(i),TS(o))})))),onFailure:Ne,onDone:()=>rr(e)}):rr(e),eTe=(e,t,r,n)=>Yee(e,t,0,t.length,r,n),Yee=(e,t,r,n,o,s)=>r===n?B([e,g()]):p(s(e,p(t,dt(r))),P(i=>o(i)?Yee(i,t,r+1,n,o,s):B([i,x(p(t,$t(r+1)))])));var AT=(e,t)=>Xke(e,jr,t);var tTe=u(2,(e,t)=>DL(e,{onFailure:NL,onSuccess:t})),UL=e=>{let t=Ae({onInput:r=>p(Z(zr(r,n=>e(n),{discard:!0})),T(()=>t)),onFailure:se,onDone:()=>re});return new fn(t)},qL=e=>{let t=Ae({onInput:r=>p(Z(e(r)),T(()=>t)),onFailure:se,onDone:()=>re});return new fn(t)},HL=e=>{let t=Ae({onInput:r=>Xee(e,r,0,r.length,t),onFailure:se,onDone:()=>re});return new fn(t)},Xee=(e,t,r,n,o)=>r===n?o:p(Z(e(p(t,dt(r)))),T(s=>s?Xee(e,t,r+1,n,o):A(p(t,$t(r)))),Ld(s=>p(A(p(t,$t(r))),Fe(Ne(s)))));var WL=e=>new fn(e),BL=e=>new fn(Z(e));var ete=()=>RT(g(),ge,(e,t)=>$(e,{onNone:()=>x(t),onSome:()=>e}));var tte=()=>AT(g(),(e,t)=>yo(SC(t),()=>e));var rte=u(2,(e,t)=>new fn(p(Qn(e),Ud(t))));var rTe=u(2,(e,t)=>{function r(n){return co(function*(){let o=yield*mS(t?.capacity??16),s=yield*ix(rc(o),n),i=yield*ix(rc(o),n),a=Nee(o),c=wL(s).pipe(pe(Qn(e)),PL(Z(Pt(s))),Hd({other:wL(i).pipe(pe(Qn(t.other)),PL(Z(Pt(i)))),onSelfDone:t.onSelfDone,onOtherDone:t.onOtherDone})),l=Hd(a,{other:c,onSelfDone:()=>xu(R),onOtherDone:f=>mu(f)});return new fn(l)})}return nTe(r)});var nte=AT(0,(e,t)=>e+xf(t,0,(r,n)=>r+n));var Qn=e=>di(e)?Qn(BL(e)):e.channel;var nTe=e=>new fn(ga(t=>e(t).pipe(w(r=>Qn(r)))));var ote=u(e=>Wee(e[1]),(e,t,r)=>oTe(e,t,(n,o)=>o,r)),oTe=u(e=>Wee(e[1]),(e,t,r,n)=>n?.concurrent?rTe(e,{other:t,onSelfDone:qt({onFailure:o=>mu(Ht(o)),onSuccess:o=>xu(qt({onFailure:Ht,onSuccess:s=>B(r(o,s))}))}),onOtherDone:qt({onFailure:o=>mu(Ht(o)),onSuccess:o=>xu(qt({onFailure:Ht,onSuccess:s=>B(r(s,o))}))})}):tTe(e,o=>rte(t,s=>r(o,s))));var ste=AT(0,(e,t)=>e+t.length),ite=vS(()=>{let e=[];return p(AT(void 0,(t,r)=>bt(r,n=>{e.push(String(n))})),rte(()=>e.join("")))});var ate=mu,cte=xu;var pte=Symbol.for("effect/RcRef"),zL={_tag:"Empty"},iTe={_tag:"Closed"},aTe={_A:R,_E:R},jL=class extends un{acquire;context;scope;idleTimeToLive;[pte]=aTe;[Hn]=Hn;state=zL;semaphore=ax(1);constructor(t,r,n,o){super(),this.acquire=t,this.context=r,this.scope=n,this.idleTimeToLive=o,this.get=$L(this)}get;commit(){return this.get}},lte=e=>de(t=>{let r=t.getFiberRef(Xr),n=jt(r,ts),o=new jL(e.acquire,r,n,e.idleTimeToLive?Qe(e.idleTimeToLive):void 0);return tt(n.addFinalizer(()=>o.semaphore.withPermits(1)(q(()=>{let s=o.state._tag==="Acquired"?Zi(o.state.scope,en):ae;return o.state=iTe,s}))),o)}),$L=e=>{let t=e;return er(r=>q(()=>{switch(t.state._tag){case"Closed":return Xt;case"Acquired":return t.state.refCount++,t.state.fiber?tt(Hc(t.state.fiber),t.state):S(t.state);case"Empty":return aa().pipe(uy("scope"),cy("value",({scope:n})=>r(Lt(t.acquire,Xr,qe(t.context,ts,n)))),k(({scope:n,value:o})=>{let s={_tag:"Acquired",value:o,scope:n,fiber:void 0,refCount:1};return t.state=s,s}))}})).pipe(t.semaphore.withPermits(1),uy("state"),cy("scope",()=>ts),Dr(({scope:r,state:n})=>r.addFinalizer(()=>q(()=>(n.refCount--,n.refCount>0?ae:t.idleTimeToLive===void 0?(t.state=zL,Zi(n.scope,en)):Qa(t.idleTimeToLive).pipe(Ki,we(q(()=>t.state._tag==="Acquired"&&t.state.refCount===0?(t.state=zL,Zi(n.scope,en)):ae)),rs(E(()=>{n.fiber=void 0})),Uy(t.scope),Dr(o=>{n.fiber=o}),t.semaphore.withPermits(1)))))),k(({state:r})=>r.value))};var fte=lte,dte=$L;var Wd={};Xn(Wd,{FiberFailureCauseId:()=>xTe,FiberFailureId:()=>mTe,defaultRuntime:()=>vT,defaultRuntimeFlags:()=>dTe,deleteFiberRef:()=>TTe,disableRuntimeFlag:()=>CTe,enableRuntimeFlag:()=>ETe,isAsyncFiberException:()=>gTe,isFiberFailure:()=>bTe,make:()=>hTe,makeFiberFailure:()=>yTe,provideService:()=>OTe,runCallback:()=>lTe,runFork:()=>MT,runPromise:()=>fTe,runPromiseExit:()=>PS,runSync:()=>pTe,runSyncExit:()=>uTe,setFiberRef:()=>kTe,updateContext:()=>wTe,updateFiberRefs:()=>_Te,updateRuntimeFlags:()=>STe});var MT=px,uTe=G_,pTe=pN,lTe=zy,fTe=lN,PS=K_,vT=pa,dTe=fN,hTe=lx,mTe=Symbol.for("effect/Runtime/FiberFailure"),xTe=cx,gTe=PJ,bTe=FJ,yTe=V_,STe=Q_,ETe=LJ,CTe=DJ,wTe=dN,OTe=UJ,_Te=J_,kTe=qJ,TTe=HJ;var yl=eS;var mte=bx;var VL=EY;var PT=wd;var gte="Left",bte="Right",yte="Both",Ste="Either";var Ete={_tag:gte},Cte={_tag:bte},GL={_tag:yte},wte={_tag:Ste},KL=e=>{switch(e){case"left":return Ete;case"right":return Cte;case"both":return GL;case"either":return wte;default:return e}};var _te=GL;var Hx=class{value;constructor(t){this.value=t}};var QL=(e,t)=>({ref:e,isNew:t,isChanged:!1,expected:e.versioned,newValue:e.versioned.value}),JL=e=>e.newValue,ZL=(e,t)=>{e.isChanged=!0,e.newValue=t},Ite=e=>{e.ref.versioned=new Hx(e.newValue)};var Rte=e=>e.ref.versioned!==e.expected,Ate=e=>e.isChanged;var FS="Invalid",FT="ReadWrite",RTe="ReadOnly",YL=e=>{for(let t of e)Ite(t[1])},XL=e=>{let t=RTe;for(let[,r]of e)if(t=Rte(r)?FS:Ate(r)?FT:t,t===FS)return t;return t};var vte=e=>{let t=new Map;for(let[,r]of e){for(let n of r.ref.todos)t.set(n[0],n[1]);r.ref.todos=new Map}return t},Pte=e=>{let t=Array.from(e.entries()).sort((r,n)=>r[0]-n[0]);for(let[r,n]of t)n()},Fte=(e,t,r)=>{let n=!1;for(let[,o]of t)o.ref.todos.has(e)||(o.ref.todos.set(e,r),n=!0);return n};var eU="WithSTMRuntime",NT="OnFailure",tU="OnRetry",DT="OnSuccess",Nte="Provide",rU="Sync",nU="Succeed",oU="Retry",sU="Fail";var iU="Interrupt";var bu="Fail";var yu="Interrupt",nc="Succeed",Su="Retry";var NS="Done",DS="Suspend";var LS="Done",LT="Interrupted",US="Running";var qT="effect/STM/State",Bd=Symbol.for(qT),cU=e=>F(e,Bd),uU=e=>e._tag===US,Lte=e=>e._tag===LS;var UT=e=>({[Bd]:Bd,_tag:LS,exit:e,[W](){return p(M(qT),K(M(LS)),K(M(e)),ie(this))},[H](t){return cU(t)&&t._tag===LS&&N(e,t.exit)}}),PTe=p(M(qT),K(M(LT)),K(M("interrupted"))),Ute={[Bd]:Bd,_tag:LT,[W](){return PTe},[H](e){return cU(e)&&e._tag===LT}},FTe=p(M(qT),K(M(US)),K(M("running"))),qte={[Bd]:Bd,_tag:US,[W](){return FTe},[H](e){return cU(e)&&e._tag===US}},qS=e=>{switch(e._tag){case bu:return UT(At(e.error));case"Die":return UT(zc(e.defect));case yu:return UT(qv(e.fiberId));case nc:return UT(xe(e.value));case Su:throw new Error("BUG: STM.STMState.fromTExit - please report an issue at https://github.com/Effect-TS/effect/issues")}};var Wx="effect/TExit",Bx=Symbol.for(Wx),HS={_A:e=>e,_E:e=>e},WS=e=>F(e,Bx);var Hte=e=>e._tag===nc,DTe=e=>e._tag===Su,Wte=e=>({[Bx]:HS,_tag:bu,error:e,[W](){return p(M(Wx),K(M(bu)),K(M(e)),ie(this))},[H](t){return WS(t)&&t._tag===bu&&N(e,t.error)}}),Bte=e=>({[Bx]:HS,_tag:"Die",defect:e,[W](){return p(M(Wx),K(M("Die")),K(M(e)),ie(this))},[H](t){return WS(t)&&t._tag==="Die"&&N(e,t.defect)}}),zte=e=>({[Bx]:HS,_tag:yu,fiberId:e,[W](){return p(M(Wx),K(M(yu)),K(M(e)),ie(this))},[H](t){return WS(t)&&t._tag===yu&&N(e,t.fiberId)}}),pU=e=>({[Bx]:HS,_tag:nc,value:e,[W](){return p(M(Wx),K(M(nc)),K(M(e)),ie(this))},[H](t){return WS(t)&&t._tag===nc&&N(e,t.value)}}),LTe=p(M(Wx),K(M(Su)),K(M("retry"))),jte={[Bx]:HS,_tag:Su,[W](){return LTe},[H](e){return WS(e)&&DTe(e)}};var $te=e=>({_tag:NS,exit:e}),lU=e=>({_tag:DS,journal:e});var Vte={ref:0},Gte=()=>{let e=Vte.ref+1;return Vte.ref=e,e};var WTe="effect/STM",BTe=Symbol.for(WTe),HT={_R:e=>e,_E:e=>e,_A:e=>e},ba=class{effect_instruction_i0;_op=uc;effect_instruction_i1=void 0;effect_instruction_i2=void 0;[Ck];[kg];[MS];[yS];get[BTe](){return HT}constructor(t){this.effect_instruction_i0=t,this[Ck]=Ta,this[kg]=HT,this[MS]=HT,this[yS]=HT}[H](t){return this===t}[W](){return ie(this,zu(this))}[Symbol.iterator](){return new kp(new qs(this))}commit(){return Qte(this,Mr,Mr)}pipe(){return v(this,arguments)}};var Qte=(e,t,r)=>de(n=>{let o=n.id(),s=n.getFiberRef(QY),i=n.getFiberRef(Mk),a=n.getFiberRef(JY),c=jTe(o,e,s,i,a);switch(c._tag){case NS:return t(c.exit),c.exit;case DS:{let l=Gte(),f={value:qte},d=sD(h=>Jte(o,e,l,f,s,i,a,h));return cl(h=>p(h(d),hi(m=>{let y=f.value;return uU(y)&&(f.value=Ute),y=f.value,Lte(y)?(t(y.exit),y.exit):(r(),Ht(m))})))}}}),zTe=(e,t,r,n,o,s)=>{let i=new Map,a=new WT(t,i,e,n).run(),c=XL(i);if(c===FT)YL(i);else if(c===FS)throw new Error("BUG: STM.TryCommit.tryCommit - please report an issue at https://github.com/Effect-TS/effect/issues");switch(a._tag){case nc:return r.value=qS(a),El(xe(a.value),i,o,s);case bu:{r.value=qS(a);let l=Ya(a.error);return El(st(l),i,o,s)}case"Die":{r.value=qS(a);let l=zn(a.defect);return El(st(l),i,o,s)}case yu:{r.value=qS(a);let l=yd(e);return El(st(l),i,o,s)}case Su:return lU(i)}},jTe=(e,t,r,n,o)=>{let s=new Map,i=new WT(t,s,e,r).run(),a=XL(s);if(a===FT&&Hte(i))YL(s);else if(a===FS)throw new Error("BUG: STM.TryCommit.tryCommitSync - please report an issue at https://github.com/Effect-TS/effect/issues");switch(i._tag){case nc:return El(xe(i.value),s,n,o);case bu:{let c=Ya(i.error);return El(st(c),s,n,o)}case"Die":{let c=zn(i.defect);return El(st(c),s,n,o)}case yu:{let c=yd(e);return El(st(c),s,n,o)}case Su:return lU(s)}},Jte=(e,t,r,n,o,s,i,a)=>{if(uU(n.value)){let c=zTe(e,t,n,o,s,i);switch(c._tag){case NS:{$Te(c.exit,a);break}case DS:{Fte(r,c.journal,()=>Jte(e,t,r,n,o,s,i,a));break}}}},El=(e,t,r,n)=>{let o=vte(t);return o.size>0&&r.scheduleTask(()=>Pte(o),n),$te(e)},$Te=(e,t)=>{t(e)};var WT=class{self;journal;fiberId;contStack=[];env;constructor(t,r,n,o){this.self=t,this.journal=r,this.fiberId=n,this.env=o}getEnv(){return this.env}pushStack(t){this.contStack.push(t)}popStack(){return this.contStack.pop()}nextSuccess(){let t=this.popStack();for(;t!==void 0&&t.effect_instruction_i0!==DT;)t=this.popStack();return t}nextFailure(){let t=this.popStack();for(;t!==void 0&&t.effect_instruction_i0!==NT;)t=this.popStack();return t}nextRetry(){let t=this.popStack();for(;t!==void 0&&t.effect_instruction_i0!==tU;)t=this.popStack();return t}run(){let t=this.self,r;for(;r===void 0&&t!==void 0;)try{let n=t;if(n)switch(n._op){case"Tag":{t=gi((o,s,i)=>Pn(i,n));break}case"Left":{t=BT(n.left);break}case"None":{t=BT(new FQ);break}case"Right":{t=ft(n.right);break}case"Some":{t=ft(n.value);break}case"Commit":{switch(n.effect_instruction_i0){case"Die":{r=Bte(rt(()=>n.effect_instruction_i1()));break}case sU:{let o=this.nextFailure();o===void 0?r=Wte(rt(()=>n.effect_instruction_i1())):t=rt(()=>o.effect_instruction_i2(rt(()=>n.effect_instruction_i1())));break}case oU:{let o=this.nextRetry();o===void 0?r=jte:t=rt(()=>o.effect_instruction_i2());break}case iU:{r=zte(this.fiberId);break}case eU:{t=rt(()=>n.effect_instruction_i1(this));break}case DT:case NT:case tU:{this.pushStack(n),t=n.effect_instruction_i1;break}case Nte:{let o=this.env;this.env=rt(()=>n.effect_instruction_i2(o)),t=p(n.effect_instruction_i1,VTe(BS(()=>this.env=o)));break}case nU:{let o=n.effect_instruction_i1,s=this.nextSuccess();s===void 0?r=pU(o):t=rt(()=>s.effect_instruction_i2(o));break}case rU:{let o=rt(()=>n.effect_instruction_i1()),s=this.nextSuccess();s===void 0?r=pU(o):t=rt(()=>s.effect_instruction_i2(o));break}}break}}}catch(n){t=Yte(n)}return r}},Zte=u(2,(e,t)=>{let r=new ba(NT);return r.effect_instruction_i1=e,r.effect_instruction_i2=t,r});var Yte=e=>Xte(()=>e);var Xte=e=>{let t=new ba("Die");return t.effect_instruction_i1=e,t},gi=e=>dn(t=>ft(e(t.journal,t.fiberId,t.getEnv()))),VTe=u(2,(e,t)=>tre(e,{onFailure:r=>fU(t,BT(r)),onSuccess:r=>fU(t,ft(r))})),BT=e=>ere(()=>e),ere=e=>{let t=new ba(sU);return t.effect_instruction_i1=e,t},No=u(2,(e,t)=>{let r=new ba(DT);return r.effect_instruction_i1=e,r.effect_instruction_i2=t,r}),tre=u(2,(e,{onFailure:t,onSuccess:r})=>p(e,Jn(Y),Zte(n=>p(t(n),Jn(V))),No(n=>{switch(n._tag){case"Left":return ft(n.left);case"Right":return r(n.right)}}))),dn=e=>{let t=new ba(eU);return t.effect_instruction_i1=e,t};var Zn=e=>{let t=new ba(iU);return t.effect_instruction_i1=e,t},Jn=u(2,(e,t)=>p(e,No(r=>BS(()=>t(r)))));var is=new ba(oU),ft=e=>{let t=new ba(nU);return t.effect_instruction_i1=e,t},BS=e=>{let t=new ba(rU);return t.effect_instruction_i1=e,t};var fU=u(2,(e,t)=>p(e,No(()=>t))),rre=u(3,(e,t,r)=>p(e,No(n=>p(t,Jn(o=>r(n,o))))));var zS="BackPressure",jS="Dropping",$S="Sliding";var GTe=u(2,(e,t)=>p(e,Jn(()=>t)));var KTe=e=>No(e,R);var VS=u(e=>Lo(e[0]),(e,t,r)=>r?.discard?p(BS(()=>e[Symbol.iterator]()),No(n=>{let o=dU(()=>{let s=n.next();return s.done?zd:p(t(s.value),No(()=>o))});return o})):dU(()=>Ee(e).reduce((n,o)=>rre(n,t(o),(s,i)=>(s.push(i),s)),ft([]))));var ore=(e,t)=>Symbol.iterator in e?VS(e,R,t):t?.discard?VS(Object.values(e),R,t):Jn(VS(Object.entries(e),([r,n])=>Jn(n,o=>[r,o])),r=>{let n={};for(let[o,s]of r)n[o]=s;return n});var dU=e=>KTe(BS(e)),hU=u(2,(e,t)=>No(e,r=>GTe(t(r),r)));var zd=ft(void 0);var QTe="effect/TRef",JTe=Symbol.for(QTe),ZTe={_A:e=>e},zx=class{[JTe]=ZTe;todos;versioned;constructor(t){this.versioned=new Hx(t),this.todos=new Map}modify(t){return gi(r=>{let n=gU(this,r),[o,s]=t(JL(n));return ZL(n,s),o})}pipe(){return v(this,arguments)}},mU=e=>gi(t=>{let r=new zx(e);return t.set(r,QL(r,!0)),r}),jT=e=>e.modify(t=>[t,t]),xU=u(2,(e,t)=>e.modify(()=>[void 0,t]));var gU=(e,t)=>{if(t.has(e))return t.get(e);let r=QL(e,!1);return t.set(e,r),r},je=u(2,(e,t)=>JL(gU(e,t))),Ge=u(3,(e,t,r)=>{let n=gU(e,r);ZL(n,t)});var YTe="effect/TQueue/TEnqueue",$T=Symbol.for(YTe),XTe="effect/TQueue/TDequeue",VT=Symbol.for(XTe);var bU={_Out:e=>e},yU={_In:e=>e},are=class{ref;requestedCapacity;strategy;[VT]=bU;[$T]=yU;constructor(t,r,n){this.ref=t,this.requestedCapacity=r,this.strategy=n}capacity(){return this.requestedCapacity}size=dn(t=>{let r=je(this.ref,t.journal);return r===void 0?Zn(t.fiberId):ft(r.length)});isFull=Jn(this.size,t=>t===this.requestedCapacity);isEmpty=Jn(this.size,t=>t===0);shutdown=dn(t=>(Ge(this.ref,void 0,t.journal),zd));isShutdown=gi(t=>je(this.ref,t)===void 0);awaitShutdown=No(this.isShutdown,t=>t?zd:is);offer(t){return dn(r=>{let n=p(this.ref,je(r.journal));if(n===void 0)return Zn(r.fiberId);if(n.length<this.requestedCapacity)return n.push(t),Ge(this.ref,n,r.journal),ft(!0);switch(this.strategy._tag){case zS:return is;case jS:return ft(!1);case $S:return n.length===0?ft(!0):(n.shift(),n.push(t),Ge(this.ref,n,r.journal),ft(!0))}})}offerAll(t){return dn(r=>{let n=Array.from(t),o=je(this.ref,r.journal);if(o===void 0)return Zn(r.fiberId);if(o.length+n.length<=this.requestedCapacity)return Ge(this.ref,[...o,...n],r.journal),ft(!0);switch(this.strategy._tag){case zS:return is;case jS:{let s=n.slice(0,this.requestedCapacity-o.length);return Ge(this.ref,[...o,...s],r.journal),ft(!1)}case $S:{let s=n.slice(0,this.requestedCapacity-o.length),i=o.length+s.length-this.requestedCapacity,a=o.slice(i);return Ge(this.ref,[...a,...s],r.journal),ft(!0)}}})}peek=dn(t=>{let r=je(this.ref,t.journal);return r===void 0?Zn(t.fiberId):r.length===0?is:ft(r[0])});peekOption=dn(t=>{let r=je(this.ref,t.journal);return r===void 0?Zn(t.fiberId):ft(br(r[0]))});take=dn(t=>{let r=je(this.ref,t.journal);if(r===void 0)return Zn(t.fiberId);if(r.length===0)return is;let n=r.shift();return Ge(this.ref,r,t.journal),ft(n)});takeAll=dn(t=>{let r=je(this.ref,t.journal);return r===void 0?Zn(t.fiberId):(Ge(this.ref,[],t.journal),ft(r))});takeUpTo(t){return dn(r=>{let n=je(this.ref,r.journal);if(n===void 0)return Zn(r.fiberId);let[o,s]=mf(Le(n),t);return Ge(this.ref,Array.from(s),r.journal),ft(Array.from(o))})}};var cre=e=>e.isShutdown;var SU=e=>e.shutdown;var ure=e=>e.take;var eIe="effect/TPubSub",GT=Symbol.for(eIe),Ms=Symbol.for("effect/TPubSub/AbsentValue"),Eu=(e,t,r)=>({head:e,subscribers:t,tail:r}),lre=class{pubsubSize;publisherHead;publisherTail;requestedCapacity;strategy;subscriberCount;subscribers;[GT]={_A:t=>t};[$T]=yU;constructor(t,r,n,o,s,i,a){this.pubsubSize=t,this.publisherHead=r,this.publisherTail=n,this.requestedCapacity=o,this.strategy=s,this.subscriberCount=i,this.subscribers=a}isShutdown=gi(t=>je(this.publisherTail,t)===void 0);awaitShutdown=No(this.isShutdown,t=>t?zd:is);capacity(){return this.requestedCapacity}size=dn(t=>je(this.publisherTail,t.journal)===void 0?Zn(t.fiberId):ft(je(this.pubsubSize,t.journal)));isEmpty=Jn(this.size,t=>t===0);isFull=Jn(this.size,t=>t===this.capacity());offer(t){return dn(r=>{let n=je(this.publisherTail,r.journal);if(n===void 0)return Zn(r.fiberId);let o=je(this.subscriberCount,r.journal);if(o===0)return ft(!0);let s=je(this.pubsubSize,r.journal);if(s<this.requestedCapacity){let i=new zx(void 0),a=Eu(t,o,i);return Ge(n,a,r.journal),Ge(this.publisherTail,i,r.journal),Ge(this.pubsubSize,s+1,r.journal),ft(!0)}switch(this.strategy._tag){case zS:return is;case jS:return ft(!1);case $S:{if(this.requestedCapacity>0){let c=je(this.publisherHead,r.journal),l=!0;for(;l;){let f=je(c,r.journal);if(f===void 0)return is;let d=f.head,h=f.tail;if(d!==Ms){let m=Eu(Ms,f.subscribers,f.tail);Ge(c,m,r.journal),Ge(this.publisherHead,h,r.journal),l=!1}else c=h}}let i=new zx(void 0),a=Eu(t,o,i);return Ge(n,a,r.journal),Ge(this.publisherTail,i,r.journal),ft(!0)}}})}offerAll(t){return Jn(VS(t,r=>this.offer(r)),Lz(R))}shutdown=gi(t=>{if(je(this.publisherTail,t)!==void 0){Ge(this.publisherTail,void 0,t);let n=je(this.subscribers,t);Q4(n,o=>{Ge(o,void 0,t)}),Ge(this.subscribers,Zs(),t)}})},EU=class{pubsubSize;publisherHead;requestedCapacity;subscriberHead;subscriberCount;subscribers;[GT]=GT;[VT]=bU;constructor(t,r,n,o,s,i){this.pubsubSize=t,this.publisherHead=r,this.requestedCapacity=n,this.subscriberHead=o,this.subscriberCount=s,this.subscribers=i}isShutdown=gi(t=>je(this.subscriberHead,t)===void 0);awaitShutdown=No(this.isShutdown,t=>t?zd:is);capacity(){return this.requestedCapacity}size=dn(t=>{let r=je(this.subscriberHead,t.journal);if(r===void 0)return Zn(t.fiberId);let n=!0,o=0;for(;n;){let s=je(r,t.journal);if(s===void 0)n=!1;else{let i=s.head,a=s.tail;i!==Ms&&(o=o+1,o>=Number.MAX_SAFE_INTEGER&&(n=!1)),r=a}}return ft(o)});isEmpty=Jn(this.size,t=>t===0);isFull=Jn(this.size,t=>t===this.capacity());peek=dn(t=>{let r=je(this.subscriberHead,t.journal);if(r===void 0)return Zn(t.fiberId);let n=Ms,o=!0;for(;o;){let s=je(r,t.journal);if(s===void 0)return is;let i=s.head,a=s.tail;i!==Ms?(n=i,o=!1):r=a}return ft(n)});peekOption=dn(t=>{let r=je(this.subscriberHead,t.journal);if(r===void 0)return Zn(t.fiberId);let n=g(),o=!0;for(;o;){let s=je(r,t.journal);if(s===void 0)n=g(),o=!1;else{let i=s.head,a=s.tail;i!==Ms?(n=x(i),o=!1):r=a}}return ft(n)});shutdown=gi(t=>{let r=je(this.subscriberHead,t);if(r!==void 0){Ge(this.subscriberHead,void 0,t);let n=!0;for(;n;){let s=je(r,t);if(s===void 0)n=!1;else{let i=s.head,a=s.tail;if(i!==Ms){let c=s.subscribers;if(c===1){let l=je(this.pubsubSize,t),f=Eu(Ms,0,a);Ge(r,f,t),Ge(this.publisherHead,a,t),Ge(this.pubsubSize,l-1,t)}else{let l=Eu(i,c-1,a);Ge(r,l,t)}}r=a}}let o=je(this.subscriberCount,t);Ge(this.subscriberCount,o-1,t),Ge(this.subscribers,Ef(je(this.subscribers,t),this.subscriberHead),t)}});take=dn(t=>{let r=je(this.subscriberHead,t.journal);if(r===void 0)return Zn(t.fiberId);let n=Ms,o=!0;for(;o;){let s=je(r,t.journal);if(s===void 0)return is;let i=s.head,a=s.tail;if(i!==Ms){let c=s.subscribers;if(c===1){let l=je(this.pubsubSize,t.journal),f=Eu(Ms,0,a);Ge(r,f,t.journal),Ge(this.publisherHead,a,t.journal),Ge(this.pubsubSize,l-1,t.journal)}else{let l=Eu(i,c-1,a);Ge(r,l,t.journal)}Ge(this.subscriberHead,a,t.journal),n=i,o=!1}else r=a}return ft(n)});takeAll=this.takeUpTo(Number.POSITIVE_INFINITY);takeUpTo(t){return dn(r=>{let n=je(this.subscriberHead,r.journal);if(n===void 0)return Zn(r.fiberId);let o=[],s=0;for(;s!==t;){let i=je(n,r.journal);if(i===void 0)s=t;else{let a=i.head,c=i.tail;if(a!==Ms){let l=i.subscribers;if(l===1){let f=je(this.pubsubSize,r.journal),d=Eu(Ms,0,c);Ge(n,d,r.journal),Ge(this.publisherHead,c,r.journal),Ge(this.pubsubSize,f-1,r.journal)}else{let f=Eu(a,l-1,c);Ge(n,f,r.journal)}o.push(a),s=s+1}n=c}}return Ge(this.subscriberHead,n,r.journal),ft(o)})}};var tIe=(e,t,r,n,o,s)=>p(jT(r),No(i=>p(ore([mU(i),jT(o),jT(s)]),hU(([a,c])=>p(o,xU(c+1))),hU(([a,c,l])=>p(s,xU(p(l,ji(a))))),Jn(([a])=>new EU(e,t,n,a,o,s)))));var fre=e=>tIe(e.pubsubSize,e.publisherHead,e.publisherTail,e.requestedCapacity,e.subscriberCount,e.subscribers),dre=e=>wr(fre(e),t=>SU(t));var hre=dre;var xre=cre;var gre=ure;var jx=class{capacity;array;size=0;current=0;constructor(t){this.capacity=t,this.array=Array.from({length:t},ph)}head(){return br(this.array[this.current])}lastOrNull(){if(this.size===0)return;let t=this.current===0?this.array.length-1:this.current-1;return this.array[t]??void 0}put(t){this.array[this.current]=t,this.increment()}dropLast(){this.size>0&&(this.decrement(),this.array[this.current]=void 0)}toChunk(){let t=this.current-this.size,r=t<0?[...this.array.slice(this.capacity+t,this.capacity),...this.array.slice(0,this.current)]:this.array.slice(t,this.current);return pt(r)}increment(){this.size<this.capacity&&(this.size+=1),this.current=(this.current+1)%this.capacity}decrement(){this.size-=1,this.current>0?this.current-=1:this.current=this.capacity-1}};var CU="NotStarted",wU="Previous",OU="Current",yre={_tag:CU},Sre=e=>({_tag:wU,fiber:e}),Ere=e=>({_tag:OU,fiber:e});var KT=e=>Object.assign(e,{chunk(r){return this(B(r))},die(r){return this(_d(r))},dieMessage(r){return this(il(r))},done(r){return this(Je(()=>Fw(r,{onFailure:x,onSuccess:G})))},end(){return this(Fo(g()))},fail(r){return this(Fo(x(r)))},fromEffect(r){return this(cS(r,{onFailure:x,onSuccess:G}))},fromEffectChunk(r){return this(p(r,mi(x)))},halt(r){return this(Ht(p(r,Is(x))))},single(r){return this(B(G(r)))}}),Cre=(e,t)=>{let r=!1,n=[],o=!1;function s(c){if(r)return!1;if(c.length<=5e4)n.push.apply(n,c);else for(let l=0;l<c.length;l++)n.push(c[0]);return o||(o=!0,t.scheduleTask(i,0)),!0}function i(){o=!1,n.length>0&&(e.unsafeOffer(n),n=[])}function a(c){r||(r=!0,c._tag==="Success"&&n.push(c.value),i(),e.unsafeOffer(c._tag==="Success"?Bp:c))}return{single(c){return r?!1:(n.push(c),o||(o=!0,t.scheduleTask(i,0)),!0)},array:s,chunk(c){return s(Zt(c))},done:a,end(){r||(r=!0,i(),e.unsafeOffer(Bp))},halt(c){return a(st(c))},fail(c){return a(At(c))},die(c){return a(zc(c))},dieMessage(c){return a(zc(new Error(c)))}}};var sIe=Symbol.for("effect/Stream/Handoff"),wre="Empty",Ore="Full",_re=e=>({_tag:wre,notifyConsumer:e}),iIe=(e,t)=>({_tag:Ore,value:e,notifyProducer:t}),kre=(e,t)=>r=>{switch(r._tag){case wre:return e(r.notifyConsumer);case Ore:return t(r.value,r.notifyProducer)}},aIe={_A:e=>e},as=()=>p(wt(),P(e=>tr(_re(e))),w(e=>({[sIe]:aIe,ref:e}))),Wt=u(2,(e,t)=>P(wt(),r=>lo(Yo(e.ref,n=>p(n,kre(o=>[ue(Cr(o,void 0),We(r)),iIe(t,r)],(o,s)=>[P(We(s),()=>p(e,Wt(t))),n])))))),cs=e=>P(wt(),t=>lo(Yo(e.ref,r=>p(r,kre(n=>[P(We(n),()=>cs(e)),r],(n,o)=>[Kt(Cr(o,void 0),n),_re(t)])))));var $x="Emit",Vx="Halt";var _U=e=>({_tag:$x,elements:e}),QT=e=>({_tag:Vx,cause:e}),GS=e=>({_tag:"End",reason:e});var pIe="effect/Take",lIe=Symbol.for(pIe),fIe={_A:e=>e,_E:e=>e},Cl=class{exit;[lIe]=fIe;constructor(t){this.exit=t}pipe(){return v(this,arguments)}},Cu=e=>new Cl(xe(e));var Gx=e=>Je(()=>e.exit),ya=new Cl(At(g()));var wu=e=>new Cl(st(p(e,Is(x))));var JT=e=>uu(e,{onFailure:t=>$(tx(t),{onNone:()=>ya,onSome:wu}),onSuccess:Cu});var Kx=u(2,(e,{onEnd:t,onFailure:r,onSuccess:n})=>qt(e.exit,{onFailure:o=>$(tx(o),{onNone:t,onSome:r}),onSuccess:n}));var ZT=e=>new Cl(xe(G(e)));var KS=()=>Fo(g());var YT=e=>mi(Ht(e),x);var XT="ScheduleEnd",kU="UpstreamEnd",Qx={_tag:XT},TU={_tag:kU};var eI="DrainLeft",tI="DrainRight",rI="PullBoth",nI="PullLeft",oI="PullRight",wl={_tag:eI},Ol={_tag:tI},_l={_tag:rI},Ou=e=>({_tag:nI,rightChunk:e}),_u=e=>({_tag:oI,leftChunk:e});var IU="PullBoth",RU="PullLet",AU="PullRight",QS={_tag:IU},JS=e=>({_tag:RU,rightChunk:e}),ZS=e=>({_tag:AU,leftChunk:e});var gIe="effect/Stream",uI=Symbol.for(gIe),bIe={_R:e=>e,_E:e=>e,_A:e=>e},L=class{channel;[uI]=bIe;constructor(t){this.channel=t}pipe(){return v(this,arguments)}},us=e=>F(e,uI)||di(e),Jx=4096,vre=e=>XS(vU(e)),vU=e=>{let t=r=>lt({onInput:n=>{let o=He(r,n);return T(A(o),()=>t(o))},onFailure:Ne,onDone:()=>re});return new L(pe(D(e),t(ee())))},PU=(e,t)=>Kd(wr(e,t)),Pre=u(2,(e,t)=>pI(e,t,mte)),pI=u(3,(e,t,r)=>Tl(FU(e,t,r),n=>Xe(n,{onLeft:g,onRight:x}))),FU=u(3,(e,t,r)=>{let n=Po([as(),tr(Qx),tr(ee()),yl(r),tr(!1),tr(!1)]);return sr(n).pipe(hr(([o,s,i,a,c,l])=>{let f=Ae({onInput:y=>T(Z(p(o,Wt(_U(y)),Ox(()=>Vt(y)))),()=>f),onFailure:y=>Z(Wt(o,QT(y))),onDone:()=>Z(Wt(o,GS(TU)))}),d=p(sd(i,ee()),P(y=>Vt(y)?p(Lr(c,!0),ue(B(p(A(y),T(()=>d))))):p(cs(o),w(_=>{switch(_._tag){case $x:return p(Z(Lr(c,!0)),Fe(A(_.elements)),Fe(Z(_t(l))),T(C=>C?re:d));case Vx:return se(_.cause);case"End":return _.reason._tag===XT?p(_t(c),w(C=>C?Z(p(Lr(s,Qx),ue(Lr(l,!0)))):p(Z(p(Lr(s,Qx),ue(Lr(l,!0)))),T(()=>d))),Ce):p(Lr(s,_.reason),ue(Lr(l,!0)),Z)}}))),Ce),h=y=>a.next(y),m=(y,_,C)=>{let O=p(Lr(c,!1),ue(Lr(l,!1)),ue(p(d,or(Qn(t)),fu,RS,yt(C)))),U=(I,Q,J)=>p(Lr(i,yC(I)),ue(w(_t(s),z=>{switch(z._tag){case XT:return p(Po([_t(c),O,p(h(x(Q)),yt(C))]),w(([te,ce,Ye])=>{let at=p(J,$({onNone:()=>G(Y(Q)),onSome:Ue=>fp(Y(Q),V(Ue))}));return te?p(A(at),T(()=>m(ce,Ye,C))):m(ce,Ye,C)}),Ce);case kU:return p(_t(c),w(te=>te?A(G(Y(Q))):re),Ce)}})),Ce);return Ce(ll(vo(y),vo(_),{onSelfDone:(I,Q)=>p(kn(_),ue(p(Je(()=>I),w(([J,z])=>U(J,z,g()))))),onOtherDone:(I,Q)=>jn(Je(()=>I),{onFailure:J=>Xe(Xa(J),{onLeft:()=>p(o,Wt(GS(Qx)),ul,ue(p(vo(y),w(([z,te])=>U(z,te,g()))))),onRight:z=>p(o,Wt(QT(z)),ul,ue(p(vo(y),w(([te,ce])=>U(te,ce,g())))))}),onSuccess:J=>p(o,Wt(GS(Qx)),ul,ue(p(vo(y),w(([z,te])=>U(z,te,x(J))))))})}))};return ng(y=>pe(D(e),f).pipe(RS,yt(y),ue(or(d,Qn(t)).pipe(fu,RS,yt(y),P(_=>h(g()).pipe(yt(y),w(C=>new L(m(_,C,y)))))))))}))}),Fre=u(2,(e,t)=>Or(e,()=>t)),NU=e=>{if(e==="unbounded")return hl();if(typeof e=="number"||e===void 0)return os(e??16);switch(e.strategy){case"dropping":return vx(e.bufferSize??16);case"sliding":return Px(e.bufferSize??16);default:return os(e.bufferSize??16)}},Nre=(e,t)=>wr(NU(t),r=>Pt(r)).pipe(P(r=>pu().pipe(P(n=>Ze(()=>{let o=PS(n);return e(KT(i=>JT(i).pipe(P(a=>Ve(r,a)),po,o).then(a=>{if(Bc(a)&&!ca(a.cause))throw rx(a.cause)})))})),w(n=>{let o=Vn(r).pipe(P(s=>Gx(s)),fa({onFailure:s=>Z(Pt(r)).pipe(Fe($(s,{onNone:()=>re,onSome:i=>Ne(i)}))),onSuccess:s=>A(s).pipe(T(()=>o))}),Ce);return eg(o).pipe(Tu(n??be))}))),vs),Dre=(e,t)=>p(wr(NU(t),r=>Pt(r)),P(r=>p(pu(),P(n=>p(e(KT(o=>p(JT(o),P(s=>Ve(r,s)),po,PS(n)).then(s=>{if(Bc(s)&&!ca(s.cause))throw rx(s.cause)}))),w(()=>{let o=p(Vn(r),P(Gx),fa({onFailure:s=>p(Z(Pt(r)),Fe($(s,{onNone:()=>re,onSome:Ne}))),onSuccess:s=>p(A(s),T(()=>o))}),Ce);return o}))))),gu,eg),yIe=e=>{if(e?.bufferSize==="unbounded"||e?.bufferSize===void 0&&e?.strategy===void 0)return hl();switch(e?.strategy){case"sliding":return Px(e.bufferSize??16);default:return vx(e?.bufferSize??16)}},DU=(e,t)=>wr(yIe(t),Pt).pipe(ln(r=>KY(Mk,n=>e(Cre(r,n)))),w(r=>{let n=T(Vn(r),o=>Jb(o)?Xi(o)?re:se(o.cause):Fe(A(Le(o)),n));return n}),gu,eg),Lre=(e,t)=>p(wr(NU(t),r=>Pt(r)),P(r=>p(pu(),P(n=>p(e(KT(o=>p(JT(o),P(s=>Ve(r,s)),po,PS(n)).then(s=>{if(Bc(s)&&!ca(s.cause))throw rx(s.cause)}))),ue(tr(!1)),P(o=>p(_t(o),w(s=>s?KS():p(Vn(r),P(Gx),lD(()=>p(Lr(o,!0),ue(Pt(r)))))))))))),Kd,hr(Au)),Ure=u(3,(e,t,r)=>Tn(()=>{let n=s=>lt({onInput:i=>{if(s.length+i.length>=t){let[c,l]=p(i,mf(t-s.length));return o(p(s,He(c)),l)}return n(p(s,He(i)))},onFailure:Ne,onDone:()=>o(s,ee())}),o=(s,i)=>pe(Fe(A(i),As()),D(r(s)));return new L(p(D(e),or(n(ee()))))})),qre=u(3,(e,t,r)=>p(e,UU(t,r),w(n=>n.map(o=>Ml(bi(o,{shutdown:!0})))))),LU=u(2,(e,t)=>w(TI(e,t),r=>Ml(o0(r)))),Hre=u(2,(e,t)=>w(fte({acquire:LU(e,t),idleTimeToLive:t.idleTimeToLive}),r=>vs(dte(r)))),UU=u(3,(e,t,r)=>P(rse(r),n=>p(Po(Array.from({length:t},()=>rc(n))),ln(()=>cu(kI(e,n)))))),Wre=u(2,(e,t)=>w(TI(e,t),rc)),Bre=u(2,(e,t)=>{if(t.capacity==="unbounded")return OIe(e);if(t.strategy==="dropping")return CIe(e,t.capacity);if(t.strategy==="sliding")return wIe(e,t.capacity);let r=Bq(e,t);return new L(gu(w(r,n=>{let o=p(Z(Vn(n)),T(qt({onFailure:s=>p(tx(s),$({onNone:()=>re,onSome:se})),onSuccess:s=>T(A(G(s)),()=>o)})));return o})))}),zre=u(2,(e,t)=>{if(t.strategy==="dropping")return SIe(e,t.capacity);if(t.strategy==="sliding")return EIe(e,t.capacity);let r=II(e,t);return new L(gu(w(r,n=>{let o=p(Z(Vn(n)),T(Kx({onEnd:()=>re,onFailure:se,onSuccess:s=>p(A(s),T(()=>o))})));return o})))}),SIe=u(2,(e,t)=>{let r=wr(vx(t),n=>Pt(n));return new L(lI(r,D(e)))}),EIe=u(2,(e,t)=>{let r=wr(Px(t),n=>Pt(n));return new L(lI(r,D(e)))}),CIe=u(2,(e,t)=>{let r=wr(vx(t),n=>Pt(n));return new L(lI(r,D(p0(1)(e))))}),wIe=u(2,(e,t)=>{let r=wr(Px(t),n=>Pt(n));return new L(lI(r,D(p(e,p0(1)))))}),OIe=e=>{let t=II(e,{strategy:"unbounded"});return new L(gu(w(t,r=>{let n=p(Z(Vn(r)),T(Kx({onEnd:()=>re,onFailure:se,onSuccess:o=>T(A(o),()=>n)})));return n})))},lI=(e,t)=>{let r=(o,s)=>{let i=a=>p(_t(s),ln(We),ue(wt()),P(c=>p(Ve(o,[a,c]),ue(Lr(s,c)),ue(We(c)))),po,Z);return Ae({onInput:a=>p(wt(),P(c=>p(Ve(o,[Cu(a),c]),P(l=>p(Lr(s,c),Ox(()=>l))))),po,Z,T(()=>r(o,s))),onFailure:a=>i(wu(a)),onDone:()=>i(ya)})},n=o=>{let s=p(Z(Vn(o)),T(([i,a])=>Fe(Z(Cr(a,void 0)),Kx(i,{onEnd:()=>re,onFailure:se,onSuccess:c=>p(A(c),T(()=>s))}))));return s};return gu(p(e,P(o=>p(wt(),ln(s=>Cr(s,void 0)),P(s=>p(tr(s),P(i=>p(t,pe(r(o,i)),AS,cu)),Kt(n(o))))))))},Iu=u(2,(e,t)=>Zx(e,r=>Xe(Xa(r),{onLeft:t,onRight:r0}))),Zx=u(2,(e,t)=>new L(p(D(e),SS(r=>D(t(r)))))),jre=u(2,(e,t)=>p(e,Iu(r=>p(t(r),_e(()=>ku(r)))))),qU=u(2,(e,t)=>p(e,Zx(r=>p(t(r),_e(()=>r0(r)))))),$re=u(3,(e,t,r)=>Iu(e,n=>"_tag"in n&&n._tag===t?r(n):ku(n))),Vre=u(2,(e,t)=>Iu(e,r=>{let n=Object.keys(t);return"_tag"in r&&n.includes(r._tag)?t[r._tag](r):ku(r)})),Gre=e=>p(e,HU((t,r)=>N(r)(t))),HU=u(2,(e,t)=>{let r=n=>Ae({onInput:o=>{let[s,i]=xf(o,[n,ee()],([a,c],l)=>X(a)&&t(a.value,l)?[x(l),c]:[x(l),p(c,Fn(l))]);return T(A(i),()=>r(s))},onFailure:se,onDone:()=>re});return new L(p(D(e),pe(r(g()))))}),Kre=u(2,(e,t)=>{let r=n=>Ae({onInput:o=>p(o,oS([n,ee()],([s,i],a)=>X(s)?p(t(s.value,a),w(c=>c?[x(a),i]:[x(a),p(i,Fn(a))])):B([x(a),p(i,Fn(a))])),Z,T(([s,i])=>p(A(i),T(()=>r(s))))),onFailure:se,onDone:()=>re});return new L(p(D(e),pe(r(g()))))}),XS=e=>p(e,Vd(G)),Qre=u(2,(e,t)=>n0(t(XS(e)))),kl=e=>Ex(uD(e),t=>t._tag==="None"?iS:Fo(t.value)),Jre=u(4,(e,t,r,n)=>{function o(s,i){return Z(cs(i)).pipe(Fe(Ae({onInput:a=>T(Z(Wt(s,xe(a))),()=>o(s,i)),onFailure:a=>Z(Wt(s,st(p(a,Is(x))))),onDone:()=>T(Z(Wt(s,At(g()))),()=>o(s,i))})))}return new L(ga(s=>Po([as(),as(),as(),as()]).pipe(ln(([i,a,c])=>D(e).pipe(ma(Kn),pe(o(i,c)),ss(s),yt(s))),ln(([,i,a,c])=>D(t).pipe(ma(Kn),pe(o(i,c)),ss(s),yt(s))),w(([i,a,c,l])=>{let f=Wt(c,void 0).pipe(ue(cs(i).pipe(P(R)))),d=Wt(l,void 0).pipe(ue(cs(a).pipe(P(R))));return D(MI(r,h=>P(n(h,f,d),kl)))}))))}),e0=u(4,(e,t,r,n)=>{let o=(s,i)=>Fe(Z(cs(i)),Ae({onInput:a=>T(Z(p(s,Wt(Cu(a)))),()=>o(s,i)),onFailure:a=>Z(Wt(s,wu(a))),onDone:()=>Z(Wt(s,ya))}));return new L(ga(s=>Po([as(),as(),as(),as()]).pipe(ln(([i,a,c])=>pe(D(e),o(i,c)).pipe(ss(s),yt(s))),ln(([i,a,c,l])=>pe(D(t),o(a,l)).pipe(ss(s),yt(s))),w(([i,a,c,l])=>{let f=Wt(c,void 0).pipe(ue(cs(i).pipe(P(Gx)))),d=Wt(l,void 0).pipe(ue(cs(a).pipe(P(Gx))));return D(h0(r,h=>P(n(h,f,d),kl)))}))))}),oc=u(2,(e,t)=>new L(p(D(e),Fe(D(t))))),Zre=e=>Tn(()=>p(e,xf(Ru,(t,r)=>oc(r)(t)))),Yre=u(2,(e,t)=>p(e,dI(t,(r,n)=>[r,n]))),Xre=u(2,(e,t)=>p(e,dI(t,(r,n)=>r))),fI=u(2,(e,t)=>hr(e,()=>t)),dI=u(3,(e,t,r)=>p(e,hr(n=>p(t,Or(o=>r(n,o)))))),ene=u(2,(e,t)=>ng(r=>co(function*(){let n=yield*as();function o(a){return $a(t).pipe(Kt(a),yt(r),w(c=>i(Sre(c))))}let s=Ae({onInput:a=>$(SC(a),{onNone:()=>s,onSome:c=>Z(Wt(n,_U(G(c)))).pipe(T(()=>s))}),onFailure:a=>Z(Wt(n,QT(a))),onDone:()=>Z(Wt(n,GS(TU)))});function i(a){switch(a._tag){case CU:return Ce(cs(n).pipe(w(c=>{switch(c._tag){case $x:return Ce(o(c.elements));case Vx:return se(c.cause);case"End":return re}})));case wU:return Ce(cs(n).pipe(yt(r),P(c=>ll(vo(a.fiber),vo(c),{onSelfDone:(l,f)=>qt(l,{onFailure:d=>kn(f).pipe(Kt(se(d))),onSuccess:d=>kn(f).pipe(ue(B(A(d).pipe(T(()=>i(Ere(c)))))))}),onOtherDone:(l,f)=>qt(l,{onFailure:d=>kn(f).pipe(Kt(se(d))),onSuccess:d=>{switch(d._tag){case $x:return kn(f).pipe(ue(o(d.elements)));case Vx:return kn(f).pipe(Kt(se(d.cause)));case"End":return vo(f).pipe(w(h=>A(h).pipe(Fe(re))))}}})}))));case OU:return Ce(vo(a.fiber).pipe(w(c=>{switch(c._tag){case $x:return Ce(o(c.elements));case Vx:return se(c.cause);case"End":return re}})))}}return f0(a=>pe(D(e),s).pipe(ss(a),yt(a))).pipe(fI(new L(i(yre))))}))),hI=e=>sr(_d(e)),tne=e=>sr(aD(e)),rne=e=>sr(il(e)),WU=u(2,(e,t)=>p(wt(),P(r=>p(e,BU({maximumLag:t.maximumLag,decide:n=>P(We(r),o=>o(n))}),P(n=>p(Po(bt(EC(0,t.size-1),o=>w(n,([s,i])=>[[s,o],i]))),w(Le),P(o=>{let[s,i]=l4(o,[new Map,ee()],([a,c],[l,f])=>[a.set(l[0],l[1]),p(c,Et(f))]);return p(Cr(r,a=>w(t.decide(a),c=>l=>c(s.get(l)))),Kt(Array.from(i)))}))))))),Ire={ref:0},Rre=()=>{let e=Ire.ref;return Ire.ref=e+1,e},BU=u(2,(e,t)=>zU(e,t.maximumLag,t.decide,()=>be)),zU=u(4,(e,t,r,n)=>p(wr(tr(new Map),(o,s)=>p(_t(o),P(i=>p(i.values(),zr(Pt))))),P(o=>co(function*(){let s=l=>p(r(l),P(f=>p(_t(o),P(d=>p(d.entries(),oS(ee(),(h,[m,y])=>f(m)?p(Ve(y,xe(l)),jn({onFailure:_=>ca(_)?B(p(h,Et(m))):Ht(_),onSuccess:()=>B(h)})):B(h)),P(h=>Vt(h)?Os(o,m=>{for(let y of h)m.delete(y);return m}):be))))),po),i=yield*fl(1),a=yield*tr(p(os(t),P(l=>{let f=Rre();return p(Os(o,d=>d.set(f,l)),Kt([f,l]))}))),c=l=>i.withPermits(1)(p(Lr(a,p(os(1),ln(f=>Ve(f,l)),P(f=>{let d=Rre();return p(Os(o,h=>h.set(d,f)),Kt(wE(d,f)))}))),ue(p(_t(o),P(f=>p(pt(f.values()),zr(d=>p(Ve(d,l),kd(h=>ca(h)?x(be):g()))))))),ue(n(l)),po));return yield*p(e,kq(s),jn({onFailure:l=>c(st(p(l,Is(x)))),onSuccess:()=>c(At(g()))}),cu),i.withPermits(1)(lo(_t(a)))})))),Yx=e=>new L(xa(D(e))),nne=u(2,(e,t)=>sr(wt()).pipe(hr(r=>f0(n=>D(t).pipe(xa,ss(n),hi(o=>Zf(r,o)),yt(n))).pipe(fI(eq(e,r)))))),jU=u(2,(e,t)=>{let r=n=>lt({onInput:o=>{let s=p(o,$t(n)),i=Math.max(0,n-o.length);return le(o)||i>0?r(i):p(A(s),Fe(As()))},onFailure:Ne,onDone:()=>re});return new L(p(D(e),or(r(t))))}),one=u(2,(e,t)=>t<=0?ZU():Tn(()=>{let r=new jx(t),n=lt({onInput:o=>{let s=p(o,Kh(i=>{let a=r.head();return r.put(i),a}));return p(A(s),T(()=>n))},onFailure:Ne,onDone:()=>re});return new L(p(D(e),or(n)))})),sne=u(2,(e,t)=>jU($U(e,r=>!t(r)),1)),ine=u(2,(e,t)=>{let r=lt({onInput:n=>p(wk(n,t),w(Le),w(o=>le(o)?nr(()=>r):p(A(o),Fe(As()))),Ce),onFailure:Ne,onDone:()=>re});return new L(p(D(e),or(r)))}),$U=u(2,(e,t)=>{let r=lt({onInput:n=>{let o=tM(n,t);return le(o)?nr(()=>r):Fe(A(o),As())},onFailure:Ne,onDone:rr});return new L(or(D(e),r))}),ane=u(2,(e,t)=>{let r=lt({onInput:n=>p(Ok(n,t),w(Le),w(o=>le(o)?nr(()=>r):Fe(A(o),As())),Ce),onFailure:Ne,onDone:()=>re});return new L(or(D(e),r))}),cne=e=>p(e,Or(Y),Iu(t=>Rl(V(t)))),Ru=new L(re),Tu=u(2,(e,t)=>new L(p(D(e),IS(t)))),une=u(2,(e,t)=>new L(Md(D(e),t))),t0=()=>sr(Cx()),pne=e=>p(t0(),Or(e)),lne=e=>p(t0(),yi(e)),mI=e=>p(t0(),hr(e)),VU=e=>Yx(sr(e)),ku=e=>tg(Fo(x(e))),xI=e=>tg(kk(()=>x(e()))),r0=e=>sr(Ht(e)),fne=e=>sr(iD(e)),dne=u(2,(e,t)=>Vd(e,zi(t))),GU=u(2,(e,t)=>{let r=n=>{let o=n.next();return o.done?Ae({onInput:s=>r(s[Symbol.iterator]()),onFailure:se,onDone:dr}):p(t(o.value),w(s=>s?p(A(G(o.value)),T(()=>r(n))):r(n)),Ce)};return new L(nr(()=>p(D(e),pe(r(ee()[Symbol.iterator]())))))}),Tl=u(2,(e,t)=>Vd(e,Kh(t))),hne=u(2,(e,t)=>Tn(()=>{let r=n=>{let o=n.next();return o.done?Ae({onInput:s=>r(s[Symbol.iterator]()),onFailure:se,onDone:dr}):p(t(o.value),$({onNone:()=>Ze(()=>r(n)),onSome:w(s=>T(A(G(s)),()=>r(n)))}),Ce)};return new L(p(D(e),pe(r(ee()[Symbol.iterator]()))))})),mne=u(2,(e,t)=>{let r=lt({onInput:n=>{let o=u4(n,t);return o.length===n.length?p(A(o),T(()=>r)):A(o)},onFailure:Ne,onDone:dr});return new L(p(D(e),or(r)))}),xne=u(2,(e,t)=>Tn(()=>{let r=n=>{let o=n.next();return o.done?Ae({onInput:s=>r(s[Symbol.iterator]()),onFailure:se,onDone:dr}):Ce($(t(o.value),{onNone:()=>B(re),onSome:w(s=>T(A(G(s)),()=>r(n)))}))};return new L(p(D(e),or(r(ee()[Symbol.iterator]()))))})),gne=e=>PU(be,()=>e),bne=u(2,(e,t)=>{let r=lt({onInput:n=>$(aM(n,t),{onNone:()=>r,onSome:o=>A(G(o))}),onFailure:Ne,onDone:()=>re});return new L(p(D(e),pe(r)))}),yne=u(2,(e,t)=>{let r=lt({onInput:n=>p(oD(n,t),w($({onNone:()=>r,onSome:o=>A(G(o))})),Ce),onFailure:Ne,onDone:()=>re});return new L(p(D(e),pe(r)))}),hr=u(e=>us(e[0]),(e,t,r)=>{let n=r?.bufferSize??16;return r?.switch?YS(r?.concurrency,()=>Are(e,1,n,t),o=>Are(e,o,n,t)):YS(r?.concurrency,()=>new L(ma(D(e),o=>p(o,bt(s=>D(t(s))),xf(re,(s,i)=>p(s,Fe(i)))))),o=>new L(p(D(e),ma(Kn),IL(s=>D(t(s)),r))))}),YS=(e,t,r)=>{switch(e){case void 0:return t();case"unbounded":return r(Number.MAX_SAFE_INTEGER);default:return e>1?r(e):t()}},Are=u(4,(e,t,r,n)=>new L(p(D(e),ma(Kn),IL(o=>D(n(o)),{concurrency:t,mergeStrategy:Oee(),bufferSize:r})))),Xx=u(e=>us(e[0]),(e,t)=>hr(e,R,t)),n0=e=>{let t=Ae({onInput:r=>T(Kn(r),()=>t),onFailure:se,onDone:()=>re});return new L(p(D(e),pe(t)))},Sne=u(e=>us(e[0]),(e,t)=>t?.unordered?hr(e,r=>sr(r),{concurrency:t.concurrency}):YS(t?.concurrency,()=>yi(e,R),r=>new L(p(D(e),ma(Kn),TL(R,r),qd(G))))),$d=e=>{let t=(n,o)=>{let[s,i]=p(n,oM(c=>!Xi(c))),a=p(va(i),$({onNone:()=>o,onSome:qt({onFailure:c=>$(tx(c),{onNone:()=>re,onSome:se}),onSuccess:()=>re})}));return p(A(p(s,Kh(c=>Xi(c)?x(c.value):g()))),T(()=>a))},r=Ae({onInput:n=>t(n,r),onFailure:n=>se(n),onDone:()=>re});return new L(p(D(e),pe(r)))},Ene=e=>p(e,Or(pt),n0),Ml=e=>n0($d(p(e,Or(t=>t.exit)))),gI=e=>new L(IT(D(e))),Cne=(e,t)=>p(wr(Ze(()=>e[Symbol.asyncIterator]()),r=>r.return?sS(async()=>r.return()):be),w(r=>Al(p(aS({try:async()=>r.next(),catch:n=>x(t(n))}),P(n=>n.done?Fo(g()):B(n.value))))),vs),eg=e=>new L(e),D=e=>{if("channel"in e)return e.channel;if(di(e))return D(sr(e));throw new TypeError("Expected a Stream.")},Il=e=>new L(le(e)?re:A(e)),wne=(e,t)=>{if(t?.scoped){let n=w(rc(e),aI);return t.shutdown?w(n,Tu(Mx(e))):n}let r=hr(Kd(rc(e)),aI);return t?.shutdown?Tu(r,Mx(e)):r},aI=(e,t)=>p(Vn(e),hi(r=>p(xS(e),P(n=>n&&ca(r)?KS():YT(r)))),Au,t?.shutdown?Tu(Pt(e)):R),One=(...e)=>p(rg(e),hr(Il)),sr=e=>p(e,mi(x),tg),tg=e=>new L(Ce(fa(e,{onFailure:$({onNone:()=>re,onSome:Ne}),onSuccess:t=>A(G(t))}))),o0=(e,t)=>{let r=t?.maxChunkSize??Jx;if(t?.scoped){let o=w(rc(e),s=>bi(s,{maxChunkSize:r,shutdown:!0}));return t.shutdown?w(o,Tu(Mx(e))):o}let n=hr(Kd(rc(e)),o=>bi(o,{maxChunkSize:r}));return t?.shutdown?Tu(n,Mx(e)):n},_ne=e=>vs(w(hre(e),t=>QU(t))),rg=e=>Tn(()=>df(e)?Il(e):KU(e[Symbol.iterator]())),kne=e=>p(e,w(rg),vl),KU=(e,t=Jx)=>p(Ze(()=>{let r=[],n=o=>p(Ze(()=>{let s=o.next();if(t===1)return s.done?re:p(A(G(s.value)),T(()=>n(o)));r=[];let i=0;for(;s.done===!1&&(r.push(s.value),i=i+1,!(i>=t));)s=o.next();return i>0?p(A(Le(r)),T(()=>n(o))):re}),Ce);return new L(n(e))}),vl),s0=e=>p(e,w(Au),vs),bi=(e,t)=>p(Kk(e,1,t?.maxChunkSize??Jx),hi(r=>p(xS(e),P(n=>n&&ca(r)?KS():YT(r)))),Au,t?.shutdown?Tu(Pt(e)):R),QU=e=>p(gre(e),w(G),hi(t=>p(xre(e),P(r=>r&&ca(t)?KS():YT(t)))),Au),Tne=e=>p(yl(e),w(t=>Al(t.next(void 0))),vl),Ine=(...e)=>{let t=e.length===1?e[0].evaluate:e[0],r=e.length===1?e[0].onError:e[1],n=e.length===1?e[0].releaseLockOnEnd===!0:!1;return vs(w(wr(Ze(()=>t().getReader()),o=>n?Ze(()=>o.releaseLock()):sS(()=>o.cancel())),o=>Al(P(aS({try:()=>o.read(),catch:s=>x(r(s))}),({done:s,value:i})=>s?Fo(g()):B(i)))))},Rne=(...e)=>{let t=e.length===1?e[0].evaluate:e[0],r=e.length===1?e[0].onError:e[1],n=(e.length===1?e[0].bufferSize:e[2])??4096,o=e.length===1?e[0].releaseLockOnEnd===!0:!1;return vs(w(wr(Ze(()=>t().getReader({mode:"byob"})),s=>o?Ze(()=>s.releaseLock()):sS(()=>s.cancel())),s=>Iu(gI(_Ie(s,r,n)),i=>i===Ane?Ru:ku(i))))},Ane=Symbol.for("effect/Stream/EOF"),_Ie=(e,t,r)=>{let n=new ArrayBuffer(r);return aq(0,o=>P(aS({try:()=>e.read(new Uint8Array(n,o,n.byteLength-o)),catch:s=>t(s)}),({done:s,value:i})=>{if(s)return Fo(Ane);let a=o+i.byteLength;return B([i,a>=n.byteLength?g():x(a)])}))},Mne=u(2,(e,t)=>{let r=(o,s)=>{if(le(s))return[o,ee()];let i=[],a=0,c=0,l,f=ee();switch(o._tag){case"Some":{let m=o.value;l=m[0];let y=!0;for(;y&&c<s.length;){let _=dt(s,c),C=t(_);if(!N(l,C)){let O=m[1],U=Le(Array.from(s).slice(a,c)),I=He(O,U);i.push([l,I]),l=C,a=c,y=!1}c=c+1}y&&(f=m[1]);break}case"None":{l=t(dt(s,c)),c=c+1;break}}for(;c<s.length;){let m=dt(s,c),y=t(m);N(l,y)||(i.push([l,Le(Array.from(s).slice(a,c))]),l=y,a=c),c=c+1}let d=He(f,Le(Array.from(s).slice(a,c))),h=Le(i);return[x([l,d]),h]},n=o=>Ae({onInput:s=>{let[i,a]=r(o,s);return le(a)?n(i):T(A(a),()=>n(i))},onFailure:s=>$(o,{onNone:()=>se(s),onSome:i=>T(A(G(i)),()=>se(s))}),onDone:s=>$(o,{onNone:()=>rr(s),onSome:i=>T(A(G(i)),()=>rr(s))})});return new L(or(D(e),n(g())))}),vne=u(2,(e,t)=>p(e,p0(t),XS)),Pne=u(3,(e,t,r)=>pI(e,jee(t),VL(r))),JU=u(2,(e,t)=>{let r=n=>p(vJ(n),w($({onNone:()=>lt({onInput:o=>T(A(o),()=>r(n)),onFailure:Ne,onDone:()=>re}),onSome:qt({onFailure:se,onSuccess:()=>re})})),Ce);return new L(ga(n=>t.pipe(yt(n),w(o=>D(e).pipe(pe(r(o)))))))}),Fne=u(2,(e,t)=>p(e,JU($a(t)))),Nne=u(2,(e,t)=>{let r=p(e8(t),w($({onNone:()=>lt({onInput:n=>p(A(n),T(()=>r)),onFailure:Ne,onDone:()=>re}),onSome:n=>Ce(fa(n,{onFailure:Ne,onSuccess:()=>re}))})),Ce);return new L(p(D(e),pe(r)))}),ZU=()=>new L(As()),Dne=u(2,(e,t)=>p(e,YU(t,gI(Rl(!0,!1))))),YU=u(3,(e,t,r)=>{let n=o=>Ae({onInput:s=>T(Z(Wt(o,ZT(s))),()=>n(o)),onFailure:s=>Z(Wt(o,wu(s))),onDone:()=>Z(Wt(o,ya))});return new L(ga(o=>p(as(),fo(as()),ln(([s])=>D(e).pipe(ma(Kn),pe(n(s)),ss(o),yt(o))),ln(([s,i])=>D(t).pipe(ma(Kn),pe(n(i)),ss(o),yt(o))),w(([s,i])=>{let a=(c,l)=>Ae({onInput:f=>f&&!c?p(Z(cs(s)),T(Kx({onEnd:()=>l?re:a(!0,l),onFailure:se,onSuccess:d=>p(A(d),T(()=>a(c,l)))}))):!f&&!l?p(Z(cs(i)),T(Kx({onEnd:()=>c?re:a(c,!0),onFailure:se,onSuccess:d=>p(A(d),T(()=>a(c,l)))}))):a(c,l),onFailure:se,onDone:()=>re});return p(D(r),ma(Kn),pe(a(!1,!1)))}))))}),XU=u(2,(e,t)=>new L(p(D(e),or(nr(()=>{let r=n=>Ae({onInput:o=>{let s=[],i=n;for(let a of o)i?(i=!1,s.push(a)):(s.push(t),s.push(a));return p(A(Le(s)),T(()=>r(i)))},onFailure:se,onDone:()=>re});return r(!0)}))))),Lne=u(2,(e,{end:t,middle:r,start:n})=>p(Rl(n),oc(p(e,XU(r))),oc(Rl(t)))),Une=u(2,(e,t)=>p(e,bI($a(t)))),bI=u(2,(e,t)=>new L(p(D(e),OL(t)))),eq=u(2,(e,t)=>new L(p(D(e),Mee(t)))),qne=(e,t)=>zq(e,r=>x([r,t(r)])),Rl=(...e)=>rg(e),Or=u(2,(e,t)=>new L(p(D(e),qd(bt(t))))),yI=u(3,(e,t,r)=>{let n=o=>lt({onInput:s=>{let[i,a]=nM(s,o,r);return T(A(a),()=>n(i))},onFailure:Ne,onDone:()=>re});return new L(p(D(e),pe(n(t))))}),SI=u(3,(e,t,r)=>Tn(()=>{let n=o=>lt({onInput:s=>p(Je(()=>{let i=[],a=c=>Ze(()=>{i.push(c)});return p(s,oS(o,(c,l)=>p(r(c,l),P(([f,d])=>p(a(d),Kt(f))))),fa({onFailure:c=>i.length!==0?Fe(A(Le(i)),Ne(c)):Ne(c),onSuccess:c=>T(A(Le(i)),()=>n(c))}))}),Ce),onFailure:Ne,onDone:()=>re});return new L(p(D(e),or(n(t))))})),Hne=u(2,(e,t)=>p(e,EI(t.onFailure),Or(t.onSuccess))),Vd=u(2,(e,t)=>new L(p(D(e),qd(t)))),Wne=u(2,(e,t)=>new L(p(D(e),TT(t)))),Bne=u(2,(e,t)=>p(e,i0(r=>pt(t(r))))),i0=u(2,(e,t)=>p(e,Vd(rM(t)))),zne=u(2,(e,t)=>p(e,yi(t),i0(R))),jne=u(2,(e,t)=>p(e,yi(r=>p(t(r),w(pt))),i0(R))),yi=u(2,(e,t)=>{let r=n=>{let o=n.next();if(o.done)return Ae({onInput:s=>r(s[Symbol.iterator]()),onFailure:se,onDone:dr});{let s=o.value;return Ce(w(t(s),i=>T(A(G(i)),()=>r(n))))}};return new L(p(D(e),pe(nr(()=>r(ee()[Symbol.iterator]())))))}),$ne=u(3,(e,t,r)=>new L(p(D(e),ma(Kn),TL(r,t),qd(G)))),EI=u(2,(e,t)=>new L(p(D(e),_L(t)))),Vne=u(2,(e,t)=>new L(p(D(e),kL(t)))),a0=u(e=>us(e[1]),(e,t,r)=>wI(e,t,{onSelf:R,onOther:R,haltStrategy:r?.haltStrategy})),CI=u(e=>Symbol.iterator in e[0],(e,t)=>Xx(rg(e),t)),Gne=u(2,(e,t)=>{let n=Object.keys(e).map(o=>e[o].pipe(Or(s=>({_tag:o,value:s}))));return CI(n,t)}),tq=u(2,(e,t)=>wI(e,t,{onSelf:V,onOther:Y})),Kne=u(2,(e,t)=>p(e,a0(Yx(t)))),Qne=u(2,(e,t)=>p(Yx(e),a0(t))),wI=u(3,(e,t,r)=>{let n=r.haltStrategy?KL(r.haltStrategy):_te,o=s=>i=>s||!Xi(i)?ate(Je(()=>i)):cte(a=>Je(()=>a));return new L(Hd(D(Or(e,r.onSelf)),{other:D(Or(t,r.onOther)),onSelfDone:o(n._tag==="Either"||n._tag==="Left"),onOtherDone:o(n._tag==="Either"||n._tag==="Right")}))}),Jne=e=>ho(e,ite),Zne=sr(Sx),Yne=u(2,(e,t)=>oc(e,Yx(sr(t)))),Xne=u(2,(e,t)=>p(e,Zx(r=>sr(p(t(r),ue(Ht(r))))))),eoe=u(2,(e,t)=>new L(p(D(e),Md(r=>Xi(r)?t():be)))),toe=u(2,(e,t)=>vl(Kt(t,e))),roe=e=>p(e,rq(R)),rq=u(2,(e,t)=>new L(p(D(e),vee(t)))),c0=u(2,(e,t)=>new L(p(D(e),RL(()=>D(t()))))),noe=u(2,(e,t)=>p(e,Or(V),c0(()=>p(t(),Or(Y))))),ooe=u(2,(e,t)=>p(e,c0(()=>xI(t)))),soe=u(2,(e,t)=>p(e,nq(()=>G(t())))),nq=u(2,(e,t)=>p(e,oq(()=>new L(A(t()))))),oq=u(2,(e,t)=>{let r=lt({onInput:n=>le(n)?nr(()=>r):p(A(n),Fe(As())),onFailure:Ne,onDone:()=>nr(()=>D(t()))});return new L(p(D(e),pe(r)))}),ioe=u(2,(e,t)=>p(e,c0(()=>Fq(t)))),aoe=(e,t)=>sq(e,r=>{let n=t(r);return[G(n[0]),n[1]]}),sq=(e,t)=>{let r=n=>{let o=t(n);return $(o[1],{onNone:()=>Fe(A(o[0]),re),onSome:s=>T(A(o[0]),()=>r(s))})};return new L(nr(()=>r(e)))},iq=(e,t)=>{let r=n=>Ce(w(t(n),([o,s])=>$(s,{onNone:()=>Fe(A(o),re),onSome:i=>T(A(o),()=>r(i))})));return new L(nr(()=>r(e)))},aq=(e,t)=>iq(e,r=>p(t(r),w(([n,o])=>[G(n),o]))),coe=u(2,(e,t)=>{let r="Emit",n="Halt";return p(wt(),P(s=>p(as(),w(i=>{let a=DL(Vee(t),{onFailure:l=>ote(BL(Y$(s,l)),NL(l)),onSuccess:([l,f])=>{let d=Ae({onInput:h=>T(Z(Wt(i,{_tag:r,elements:h})),()=>d),onFailure:h=>Fe(Z(Wt(i,{_tag:n,cause:h})),se(h)),onDone:h=>Fe(Z(Wt(i,{_tag:"End"})),re)});return WL(p(Z(Cr(s,l)),Fe(Z(p(i,Wt({_tag:r,elements:f})))),Fe(d)))}}),c=p(cs(i),w(l=>{switch(l._tag){case r:return p(A(l.elements),T(()=>c));case n:return se(l.cause);case"End":return re}}),Ce);return p(e,Uq(l=>Zf(s,l)),ho(a),cu,ue(We(s)),w(l=>[l,new L(c)]))}))),lo)}),uoe=u(e=>typeof e[1]=="function",(e,t,r)=>cq(e,n=>B(t(n)?Y(n):V(n)),r)),cq=u(e=>typeof e[1]=="function",(e,t,r)=>p(yi(e,t),WU({size:2,maximumLag:r?.bufferSize??16,decide:Xe({onLeft:()=>B(n=>n===0),onRight:()=>B(n=>n===1)})}),P(([n,o])=>B([Tl($d(bi(n,{shutdown:!0})),s=>Xe(s,{onLeft:x,onRight:g})),Tl($d(bi(o,{shutdown:!0})),s=>Xe(s,{onLeft:g,onRight:x}))])))),poe=u(2,(e,t)=>new L(p(D(e),or(Qn(t))))),uq=u(2,(e,t)=>new L(pe(D(e),t))),loe=u(2,(e,t)=>new L(p(D(e),or(t)))),foe=u(2,(e,t)=>new L(Fe(A(t),D(e)))),OI=u(2,(e,t)=>new L(p(D(e),vd(t)))),pq=u(2,(e,t)=>_I(e,_o(t))),lq=u(2,(e,t)=>new L(ga(r=>_D(t,r).pipe(w(n=>p(D(e),vd(n))))))),doe=u(3,(e,t,r)=>u0(e,t,B(r))),u0=u(3,(e,t,r)=>fq(e,t,sr(r))),fq=u(3,(e,t,r)=>mI(n=>hr(r,o=>p(e,OI(qe(n,t,o)))))),_I=u(2,(e,t)=>mI(r=>p(e,OI(t(r))))),dq=u(2,(e,t)=>p(e,lq(p(Pk(),kD(t))))),hoe=(e,t,r=Jx)=>Tn(()=>{if(e>t)return Ru;let n=(o,s,i)=>{let a=s-o+1;return a>i?p(A(EC(o,o+i-1)),T(()=>n(o+i,s,i))):A(EC(o,o+a-1))};return new L(n(e,t,r))}),moe=u(2,(e,t)=>hq(e,t)),hq=(...e)=>wt().pipe(w(t=>{let r=null;return CI(e.map((n,o)=>n.pipe(Nq(()=>r===null?(r=o,t8(t,Bp),!0):r===o),bI(We(t).pipe(P(()=>r===o?Sx:be))))),{concurrency:e.length})}),vl),p0=u(2,(e,t)=>Tn(()=>{let r=Math.max(t,1),n=iI(new MU(r),r);return new L(p(D(e),pe(n)))})),iI=(e,t)=>Ae({onInput:r=>{if(r.length===t&&e.isEmpty())return T(A(r),()=>iI(e,t));if(r.length>0){let n=[],o,s=0;for(;s<r.length;){for(;s<r.length&&o===void 0;)o=e.write(p(r,dt(s))),s=s+1;o!==void 0&&(n.push(o),o=void 0)}return T(Uee(...n),()=>iI(e,t))}return nr(()=>iI(e,t))},onFailure:r=>Fe(e.emitIfNotEmpty(),se(r)),onDone:()=>e.emitIfNotEmpty()}),MU=class{n;builder=[];pos=0;constructor(t){this.n=t}isEmpty(){return this.pos===0}write(t){if(this.builder.push(t),this.pos+=1,this.pos===this.n){let r=Le(this.builder);return this.builder=[],this.pos=0,r}}emitIfNotEmpty(){return this.pos!==0?A(Le(this.builder)):re}},xoe=u(2,(e,t)=>p(e,mq(t,R))),mq=u(3,(e,t,r)=>new L(Ld(D(e),n=>$(t(n),{onNone:()=>se(zn(r(n))),onSome:Ne})))),goe=u(2,(e,t)=>Tl(xq(e,t),r=>Xe(r,{onLeft:g,onRight:x}))),boe=e=>Al(p(e,mi(x))),yoe=e=>Au(p(e,mi(x))),Au=e=>h0(e,t=>p(w(t,r=>x([r,t])),Ex($({onNone:()=>B(g()),onSome:Fo})))),Al=e=>Au(p(e,w(G))),xq=u(2,(e,t)=>bq(e,t,{onElement:r=>Y(r),onSchedule:V})),Soe=u(2,(e,t)=>Tl(gq(e,t,{onElement:r=>x(r),onSchedule:g}),R)),gq=u(3,(e,t,r)=>{let n=p(yl(t),w(o=>{let s=c=>$(va(c),{onNone:()=>a,onSome:l=>Fe(A(G(r.onElement(l))),i(p(c,$t(1)),l))}),i=(c,l)=>{let f=p(o.next(l),Kt(p(A(G(r.onElement(l))),T(()=>i(c,l))))),d=p(o.last,Rk,P(h=>p(o.reset,w(()=>p(A(G(r.onSchedule(h))),Fe(s(c)))))));return p(f,ED(()=>d),Ce)},a=lt({onInput:s,onFailure:Ne,onDone:()=>re});return a}),Ce);return new L(p(D(e),pe(n)))}),Eoe=e=>new L(IT(A(G(e)))),bq=u(3,(e,t,r)=>p(yl(t),w(n=>{let o=u0(PT,_t(n.iterationMeta)),s=p(e,o,Or(r.onElement),D),i=Ce(fa(n.next(void 0),{onFailure:()=>re,onSuccess:a=>T(s,()=>Fe(A(G(r.onSchedule(a))),i))}));return new L(Fe(s,i))}),vl)),kIe=(e,t)=>yq(B(e),t),yq=(e,t)=>hr(sr(fo(e,yl(t))),([r,n])=>{let o=bD(PT,_t(n.iterationMeta));return oc(d0(r),MI(r,s=>$n(n.next(s),{onFailure:B,onSuccess:()=>w(o(e),i=>x([i,i]))})))}),cI=u(2,(e,t)=>yl(t).pipe(w(r=>{let n=u0(PT,_t(r.iterationMeta)),o=D(n(e)).pipe(TT(s=>Kt(r.reset,s)),Ld(s=>r.next(s).pipe(fa({onFailure:()=>Ne(s),onSuccess:()=>o}),Ce)));return o}),Ce,eg)),Coe=u(e=>us(e[0]),(e,t,r)=>Tn(()=>{let n=r?.preventFallbackOnPartialStream??!1,o=0,s=g(),i=Tn(()=>{let a=t.steps[o++];if(!a)return ku(vg(s));let c=ob(a.provide)?pq(e,a.provide):dq(e,a.provide),l=!1;if(X(s)){let f=s.value,d=!1,h=c;c=Tn(()=>d?h:(d=!0,ku(f))),c=Mre(cI(c,rS(a,!1)))}else{let f=rS(a,!0);c=f?Mre(cI(c,f)):c}return Iu(n?Vd(c,f=>(l=!0,f)):c,f=>n&&l?ku(f):(s=x(f),i))});return i})),Mre=e=>Zx(e,t=>r0(ZN(t))),ho=u(2,(e,t)=>D(e).pipe(or(Qn(t)),Pee)),woe=e=>ho(e,Bee()),Ooe=e=>ho(e,ste),_oe=e=>ho(e,Gee),koe=u(3,(e,t,r)=>Sq(e,t,jr,r)),Toe=u(3,(e,t,r)=>Eq(e,t,jr,r)),Ioe=u(3,(e,t,r)=>p(e,Cq(t,jr,r))),Roe=u(3,(e,t,r)=>p(e,wq(t,jr,r))),Sq=u(4,(e,t,r,n)=>ho(e,RT(t,r,n))),Eq=u(4,(e,t,r,n)=>ho(e,LL(t,r,n))),Cq=u(4,(e,t,r,n)=>p(e,Gd(RT(t,r,n)))),wq=u(4,(e,t,r,n)=>p(e,Gd(LL(t,r,n)))),Oq=u(2,(e,t)=>ho(e,UL(t))),_q=u(2,(e,t)=>ho(e,qL(t))),Aoe=u(2,(e,t)=>p(e,Gd(qL(t)))),kq=u(2,(e,t)=>p(e,Gd(UL(t)))),Moe=u(2,(e,t)=>ho(e,HL(t))),voe=u(2,(e,t)=>p(e,Gd(HL(t)))),Poe=e=>ho(e,ete()),Foe=u(2,(e,t)=>p(e,Tq(t))),kI=u(2,(e,t)=>p(e,l0(t))),Tq=u(2,(e,t)=>p(e,l0(t),dD)),Iq=u(2,(e,t)=>{let r=Ae({onInput:n=>T(Z(YD(t,bt(n,xe))),()=>r),onFailure:n=>Z(Ve(t,st(Is(n,x)))),onDone:()=>Z(Ve(t,At(g())))});return p(pe(D(e),r),xa,AS,po)}),l0=u(2,(e,t)=>{let r=Ae({onInput:n=>T(A(Cu(n)),()=>r),onFailure:n=>A(wu(n)),onDone:()=>A(ya)});return p(pe(D(e),r),TT(n=>Ve(t,n)),xa,AS,po)}),Noe=e=>ho(e,tte()),Gd=u(2,(e,t)=>p(D(e),or(Qn(t)),xa,AS)),Doe=e=>ho(e,nte),Loe=u(3,(e,t,r)=>p(e,Mq(t,(n,o)=>B(r(n,o))))),Uoe=u(2,(e,t)=>p(e,Rq((r,n)=>B(t(r,n))))),Rq=u(2,(e,t)=>p(e,SI(g(),(r,n)=>{switch(r._tag){case"None":return B([x(n),n]);case"Some":return p(t(r.value,n),w(o=>[x(o),o]))}}))),qoe=u(2,(e,t)=>Tl(Aq(e,t,{onElement:x,onSchedule:g}),R)),Aq=u(3,(e,t,r)=>{let n=(o,s)=>{let i=s.next();return i.done?Ae({onInput:a=>n(o,a[Symbol.iterator]()),onFailure:se,onDone:rr}):Ce($n(o.next(i.value),{onFailure:()=>p(o.last,Rk,w(a=>p(A(fp(r.onElement(i.value),r.onSchedule(a))),T(()=>n(o,s)))),dl(o.reset)),onSuccess:()=>B(p(A(G(r.onElement(i.value))),T(()=>n(o,s))))}))};return new L(p(Z(yl(t)),T(o=>p(D(e),pe(n(o,ee()[Symbol.iterator]()))))))}),Mq=u(3,(e,t,r)=>new L(p(A(G(t)),T(()=>D(p(e,SI(t,(n,o)=>p(r(n,o),w(s=>[s,s]))))))))),Kd=e=>new L(IS(AL(p(e,w(G))),be)),f0=e=>new L(ML(t=>e(t).pipe(w(G)))),Hoe=e=>p(e,EI(x),vq(()=>g())),Woe=u(2,(e,t)=>p(e,Or(_e(t)))),vq=u(2,(e,t)=>yi(e,$({onNone:()=>kk(t),onSome:B}))),Boe=u(2,(e,t)=>Pq(e,t,1)),Pq=u(3,(e,t,r)=>t<=0||r<=0?hI(new Sd("Invalid bounds - `chunkSize` and `stepSize` must be greater than zero")):new L(nr(()=>{let n=new jx(t),o=(i,a)=>{if(i<t){let h=n.toChunk(),m=le(h)?ee():G(h);return p(A(m),T(()=>a))}let c=i-(i-t)%r;if(c===i)return a;let l=i-(c-t+r),f=p(n.toChunk(),p4(l)),d=le(f)?ee():G(f);return p(A(d),T(()=>a))},s=i=>Ae({onInput:a=>T(A(Kh(a,(c,l)=>{n.put(c);let f=i+l+1;return f<t||(f-t)%r>0?g():x(n.toChunk())})),()=>s(i+a.length)),onFailure:a=>o(i,se(a)),onDone:()=>o(i,re)});return p(D(e),pe(s(0)))}))),zoe=u(2,(e,t)=>{let r=(o,s)=>{let[i,a]=p(o,He(s),oM(t));return le(i)||le(a)?n(p(i,He(p(a,$t(1))))):p(A(G(i)),T(()=>r(ee(),p(a,$t(1)))))},n=o=>lt({onInput:s=>r(o,s),onFailure:Ne,onDone:()=>le(o)?re:ge(p(o,aM(t)))?Fe(A(G(o)),re):Fe(r(ee(),o),re)});return new L(p(D(e),pe(n(ee()))))}),joe=u(2,(e,t)=>{let r=(n,o)=>Ae({onInput:s=>{let i,[a,c]=p(s,xf([p(n,_e(()=>ee())),o],([f,d],h)=>{let m=p(f,Fn(h));return d<t.length&&N(h,p(t,dt(d)))?d+1===t.length?(i===void 0&&(i=[]),i.push(p(m,bs(m.length-t.length))),[ee(),0]):[m,d+1]:[m,N(h,p(t,dt(0)))?1:0]})),l=i===void 0?ee():Le(i);return T(A(l),()=>r(Vt(a)?x(a):g(),c))},onFailure:s=>$(n,{onNone:()=>se(s),onSome:i=>Fe(A(G(i)),se(s))}),onDone:s=>$(n,{onNone:()=>dr(s),onSome:i=>Fe(A(G(i)),dr(s))})});return new L(p(D(e),pe(r(g(),0))))}),$oe=e=>uq(e,Fee()),d0=e=>Il(G(e)),Fq=e=>Tn(()=>Il(G(e()))),Tn=e=>new L(nr(()=>D(e()))),Voe=u(2,(e,t)=>{if(!Number.isInteger(t))return hI(new Sd(`${t} must be an integer`));let r=n=>lt({onInput:o=>{let s=p(o,bs(Math.min(n,Number.POSITIVE_INFINITY))),i=Math.max(0,n-s.length);return i>0?p(A(s),T(()=>r(i))):A(s)},onFailure:Ne,onDone:dr});return new L(p(D(e),or(0<t?r(t):re)))}),Goe=u(2,(e,t)=>t<=0?Ru:new L(p(B(new jx(t)),w(r=>{let n=lt({onInput:o=>{for(let s of o)r.put(s);return n},onFailure:Ne,onDone:()=>p(A(r.toChunk()),Fe(re))});return p(D(e),pe(n))}),Ce))),Koe=u(2,(e,t)=>{let r=lt({onInput:n=>{let o=p(n,sM(i=>!t(i))),s=p(n,$t(o.length),bs(1));return le(s)?p(A(o),T(()=>r)):A(p(o,He(s)))},onFailure:Ne,onDone:dr});return new L(p(D(e),or(r)))}),Qoe=u(2,(e,t)=>{let r=n=>{let o=n.next();return o.done?Ae({onInput:s=>r(s[Symbol.iterator]()),onFailure:se,onDone:dr}):p(t(o.value),w(s=>s?A(G(o.value)):p(A(G(o.value)),T(()=>r(n)))),Ce)};return new L(p(D(e),pe(r(ee()[Symbol.iterator]()))))}),Nq=u(2,(e,t)=>{let r=lt({onInput:n=>{let o=p(n,sM(t));return o.length===n.length?p(A(o),T(()=>r)):A(o)},onFailure:Ne,onDone:dr});return new L(p(D(e),or(r)))}),Dq=u(2,(e,t)=>yi(e,r=>Kt(t(r),r))),Joe=u(2,(e,t)=>p(e,Lq(t.onFailure),Dq(t.onSuccess))),Lq=u(2,(e,t)=>Iu(e,r=>sr(ue(t(r),Fo(r))))),Uq=u(2,(e,t)=>{let r=Ae({onInput:n=>T(A(n),()=>r),onFailure:n=>Z(ue(t(n),Ht(n))),onDone:rr});return new L(p(D(e),pe(r)))}),Zoe=u(2,(e,t)=>p(sr(Po([os(1),wt()])),hr(([r,n])=>{let o=Ml(bi(r,{maxChunkSize:1})),s=Ae({onInput:i=>p(Z(Ve(r,Cu(i))),Dx({onFailure:()=>T(A(i),()=>As()),onSuccess:()=>T(A(i),()=>s)})),onFailure:i=>p(Z(Ve(r,wu(i))),Dx({onFailure:()=>se(i),onSuccess:()=>se(i)})),onDone:()=>p(Z(Ve(r,ya)),Dx({onFailure:()=>re,onSuccess:()=>re}))});return p(new L(p(pe(D(e),s),IS(ue(ul(Ve(r,ya)),We(n))))),a0(VU(p(ho(o,t),la(ue(Pt(r),Cr(n,void 0)))))))}))),Yoe=u(2,(e,t)=>qq(e,{...t,cost:r=>B(t.cost(r))})),qq=u(2,(e,t)=>t.strategy==="enforce"?TIe(e,t.cost,t.units,t.duration,t.burst??0):IIe(e,t.cost,t.units,t.duration,t.burst??0)),TIe=(e,t,r,n,o)=>{let s=(a,c)=>Ae({onInput:l=>p(t(l),fo(ta),w(([f,d])=>{let m=(d-c)/Qr(n),y=a+m*r,_=r+o<0?Number.POSITIVE_INFINITY:r+o,C=y<0?_:Math.min(y,_);return f<=C?p(A(l),T(()=>s(C-f,d))):s(a,c)}),Ce),onFailure:se,onDone:()=>re}),i=p(ta,w(a=>s(r,a)),Ce);return new L(p(D(e),or(i)))},IIe=(e,t,r,n,o)=>{let s=(a,c)=>Ae({onInput:l=>p(t(l),fo(ta),w(([f,d])=>{let m=(d-c)/Qr(n),y=a+m*r,_=r+o<0?Number.POSITIVE_INFINITY:r+o,O=(y<0?_:Math.min(y,_))-f,U=O>=0?0:-O/r,I=On(Math.max(0,U*Qr(n)));return _C(I,Pa)?p(Z($a(I)),Fe(A(l)),T(()=>s(O,d))):T(A(l),()=>s(O,d))}),Ce),onFailure:se,onDone:()=>re}),i=p(ta,w(a=>s(r,a)),Ce);return new L(p(D(e),or(i)))},Xoe=e=>kIe(void 0,VL(e)),ese=u(2,(e,t)=>p(jd(e),w(xD({onTimeout:()=>g(),duration:t})),s0)),tse=u(3,(e,t,r)=>p(e,Wq(r,xI(t)))),Hq=u(3,(e,t,r)=>p(jd(e),w(gD({onTimeout:()=>Is(t(),x),duration:r})),s0)),Wq=u(3,(e,t,r)=>{let n=new v_("Stream Timeout");return p(e,Hq(()=>zn(n),t),qU(o=>A_(o)&&NQ(o.defect)&&o.defect.message!==void 0&&o.defect.message==="Stream Timeout"?x(r):g()))}),rse=e=>{if(typeof e=="number")return mS(e);if(e.capacity==="unbounded")return $k({replay:e.replay});switch(e.strategy){case"dropping":return BX(e);case"sliding":return zX(e);default:return mS(e)}},TI=u(2,(e,t)=>p(wr(rse(t),r=>Mx(r)),ln(r=>p(e,kI(r),cu)))),jd=e=>w(Dee(D(e)),t=>p(t,mi(x),P(Xe({onLeft:()=>Fo(g()),onRight:B})))),II=u(e=>us(e[0]),(e,t)=>ln(wr(t?.strategy==="unbounded"?hl():t?.strategy==="dropping"?vx(t.capacity??2):t?.strategy==="sliding"?Px(t.capacity??2):os(t?.capacity??2),r=>Pt(r)),r=>cu(l0(e,r)))),Bq=u(e=>us(e[0]),(e,t)=>ln(wr(os(t?.capacity??2),r=>Pt(r)),r=>cu(Iq(e,r)))),nse=u(e=>us(e[0]),(e,t)=>RI(e,vT,t)),ose=u(e=>us(e[0]),(e,t)=>w(pu(),r=>RI(e,r,t))),RI=u(e=>us(e[0]),(e,t,r)=>{let n=MT(t),o,s,i=Ak(!1);return new ReadableStream({start(a){s=n(_q(e,c=>c.length===0?be:i.whenOpen(Ze(()=>{i.unsafeClose();for(let l of c)a.enqueue(l);o(),o=void 0})))),s.addObserver(c=>{try{c._tag==="Failure"?a.error(rx(c.cause)):a.close()}catch{}})},pull(){return new Promise(a=>{o=a,kx(i.open)})},cancel(){if(s)return lu(po(kn(s)))}},r?.strategy)}),sse=u(2,(e,t)=>{let r=nr(()=>{let n={ref:ee()},o={ref:!1},s=nr(()=>{let l=n.ref;return le(l)?lt({onInput:f=>p(A(f),T(()=>s)),onFailure:Ne,onDone:rr}):(n.ref=ee(),p(Kn(l),T(()=>s)))}),i=l=>{let f=n.ref,d=He(f,zi(l,h=>h.length!==0));return n.ref=d,d},a=lt({onInput:l=>T(A(l),()=>a),onFailure:Ne,onDone:l=>Fe(du(()=>{o.ref=!0}),rr(l))}),c=p(t,Qn,fu,T(([l,f])=>p(dr([o.ref,i(l)]),T(([d,h])=>{let m=d&&le(h)?re:c;return p(A(G(f)),T(()=>m))}))));return p(D(e),pe(a),pe(s),or(c))});return new L(r)}),AI=u(e=>us(e[0]),(e,t)=>{let r=MT(t);return{[Symbol.asyncIterator](){let n,o,s,i=Ak(!1),a=!1;return{next(){return s||(s=r(Oq(e,c=>i.whenOpen(Ze(()=>{i.unsafeClose(),n({done:!1,value:c}),n=o=void 0})))),s.addObserver(c=>{a||(s=Td(i.whenOpen(Ze(()=>{c._tag==="Failure"?o(rx(c.cause)):n({done:!0,value:void 0}),n=o=void 0}))))})),new Promise((c,l)=>{n=c,o=l,i.unsafeOpen()})},return(){return a=!0,s?lu(Kt(kn(s),{done:!0,value:void 0})):Promise.resolve({done:!0,value:void 0})}}}}}),ise=e=>AI(e,vT),ase=e=>w(pu(),t=>AI(e,t)),zq=(e,t)=>jq(e,r=>p(t(r),ct(([n,o])=>[G(n),o]))),jq=(e,t)=>{let r=n=>$(t(n),{onNone:()=>re,onSome:([o,s])=>T(A(o),()=>r(s))});return new L(nr(()=>r(e)))},h0=(e,t)=>Tn(()=>{let r=n=>Ce(w(t(n),$({onNone:()=>re,onSome:([o,s])=>T(A(o),()=>r(s))})));return new L(r(e))}),MI=(e,t)=>h0(e,r=>p(t(r),w(ct(([n,o])=>[G(n),o])))),cse=d0(void 0);var vl=e=>Xx(sr(e)),vs=e=>Xx(Kd(e)),ng=e=>Xx(f0(t=>e(t))),use=u(3,(e,t,r)=>p(e,_I(n=>p(n,qe(t,r(p(n,Pn(t)))))))),pse=u(2,(e,t)=>p(e,Vq(Ze(t)))),lse=(e,t)=>$q(t)(Ze(e)),$q=u(2,(e,t)=>p(sr(e),hr(r=>p(t(r),_e(()=>Ru))))),Vq=u(2,(e,t)=>p(sr(t),hr(r=>r?e:Ru))),fse=function(){let e=typeof arguments[0]!="string",t=e?arguments[1]:arguments[0],r=qn(e?arguments[2]:arguments[1]);if(e){let n=arguments[0];return new L(vL(D(n),t,r))}return n=>new L(vL(D(n),t,r))},dse=u(2,(e,t)=>p(e,PI(t,(r,n)=>[r,n]))),hse=u(2,(e,t)=>p(e,PI(t,(r,n)=>[...r,n]))),mse=u(2,(e,t)=>x0(e,{other:t.other,onSelf:r=>[r,t.defaultOther],onOther:r=>[t.defaultSelf,r],onBoth:(r,n)=>[r,n]})),xse=u(3,(e,t,r)=>x0(e,{other:t,onSelf:R,onOther:()=>r,onBoth:n=>n})),gse=u(3,(e,t,r)=>x0(e,{other:t,onSelf:()=>r,onOther:R,onBoth:(n,o)=>o})),bse=u(2,(e,t)=>m0(e,{other:t.other,onSelf:r=>[r,t.defaultOther],onOther:r=>[t.defaultSelf,r],onBoth:(r,n)=>[r,n],order:t.order})),yse=u(2,(e,t)=>m0(e,{other:t.other,onSelf:R,onOther:()=>t.defaultSelf,onBoth:r=>r,order:t.order})),Sse=u(2,(e,t)=>m0(e,{other:t.other,onSelf:()=>t.defaultOther,onOther:R,onBoth:(r,n)=>n,order:t.order})),m0=u(2,(e,t)=>{let r=(o,s,i)=>{switch(o._tag){case eI:return p(s,fa({onFailure:At,onSuccess:a=>xe([bt(a,([c,l])=>[c,t.onSelf(l)]),wl])}));case tI:return p(i,fa({onFailure:At,onSuccess:a=>xe([bt(a,([c,l])=>[c,t.onOther(l)]),Ol])}));case rI:return p(kl(s),fo(kl(i),{concurrent:!0}),$n({onFailure:a=>B(At(x(a))),onSuccess:([a,c])=>X(a)&&X(c)?le(a.value)&&le(c.value)?r(_l,s,i):le(a.value)?r(Ou(c.value),s,i):le(c.value)?r(_u(a.value),s,i):B(xe(n(a.value,c.value))):X(a)&&ge(c)?le(a.value)?r(wl,s,i):B(xe([p(a.value,bt(([l,f])=>[l,t.onSelf(f)])),wl])):ge(a)&&X(c)?le(c.value)?r(Ol,s,i):B(xe([p(c.value,bt(([l,f])=>[l,t.onOther(f)])),Ol])):B(At(g()))}));case nI:return $n(s,{onFailure:$({onNone:()=>B(xe([p(o.rightChunk,bt(([a,c])=>[a,t.onOther(c)])),Ol])),onSome:a=>B(At(x(a)))}),onSuccess:a=>le(a)?r(Ou(o.rightChunk),s,i):B(xe(n(a,o.rightChunk)))});case oI:return $n(i,{onFailure:$({onNone:()=>B(xe([bt(o.leftChunk,([a,c])=>[a,t.onSelf(c)]),wl])),onSome:a=>B(At(x(a)))}),onSuccess:a=>le(a)?r(_u(o.leftChunk),s,i):B(xe(n(o.leftChunk,a)))})}},n=(o,s)=>{let i=(U,I)=>I<U.length-1,a=[],c,l=0,f=0,d=p(o,dt(l)),h=p(s,dt(f)),m=d[0],y=d[1],_=h[0],C=h[1],O=!0;for(;O;){let U=t.order(m,_);if(U===0)a.push([m,t.onBoth(y,C)]),i(o,l)&&i(s,f)?(l=l+1,f=f+1,d=p(o,dt(l)),h=p(s,dt(f)),m=d[0],y=d[1],_=h[0],C=h[1]):i(o,l)?(c=_u(p(o,$t(l+1))),O=!1):i(s,f)?(c=Ou(p(s,$t(f+1))),O=!1):(c=_l,O=!1);else if(U<0)if(a.push([m,t.onSelf(y)]),i(o,l))l=l+1,d=p(o,dt(l)),m=d[0],y=d[1];else{let I=[];for(I.push(h);i(s,f);)f=f+1,h=p(s,dt(f)),I.push(h);c=Ou(Le(I)),O=!1}else if(a.push([_,t.onOther(C)]),i(s,f))f=f+1,h=p(s,dt(f)),_=h[0],C=h[1];else{let I=[];for(I.push(d);i(o,l);)l=l+1,d=p(o,dt(l)),I.push(d);c=_u(Le(I)),O=!1}}return[Le(a),c]};return e0(e,t.other,_l,r)}),x0=u(2,(e,t)=>{let r=(o,s,i)=>{switch(o._tag){case eI:return $n(s,{onFailure:a=>B(At(a)),onSuccess:a=>B(xe([bt(a,t.onSelf),wl]))});case tI:return $n(i,{onFailure:a=>B(At(a)),onSuccess:a=>B(xe([bt(a,t.onOther),Ol]))});case rI:return p(kl(s),fo(kl(i),{concurrent:!0}),$n({onFailure:a=>B(At(x(a))),onSuccess:([a,c])=>X(a)&&X(c)?le(a.value)&&le(c.value)?r(_l,s,i):le(a.value)?r(Ou(c.value),s,i):le(c.value)?r(_u(a.value),s,i):B(xe(n(a.value,c.value,t.onBoth))):X(a)&&ge(c)?B(xe([bt(a.value,t.onSelf),wl])):ge(a)&&X(c)?B(xe([bt(c.value,t.onOther),Ol])):B(At(g()))}));case nI:return $n(s,{onFailure:$({onNone:()=>B(xe([bt(o.rightChunk,t.onOther),Ol])),onSome:a=>B(At(x(a)))}),onSuccess:a=>le(a)?r(Ou(o.rightChunk),s,i):le(o.rightChunk)?r(_u(a),s,i):B(xe(n(a,o.rightChunk,t.onBoth)))});case oI:return $n(i,{onFailure:$({onNone:()=>B(xe([bt(o.leftChunk,t.onSelf),wl])),onSome:a=>B(At(x(a)))}),onSuccess:a=>le(a)?r(_u(o.leftChunk),s,i):le(o.leftChunk)?r(Ou(a),s,i):B(xe(n(o.leftChunk,a,t.onBoth)))})}},n=(o,s,i)=>{let[a,c]=_se(o,s,i);switch(c._tag){case"Left":return le(c.left)?[a,_l]:[a,_u(c.left)];case"Right":return le(c.right)?[a,_l]:[a,Ou(c.right)]}};return e0(e,t.other,_l,r)}),Ese=u(2,(e,t)=>p(e,vI(t,(r,n)=>[r,n]))),Gq=(...e)=>{if(e.length===0)return Ru;if(e.length===1)return Or(e[0],n=>[n]);let[t,...r]=e;return vI(t,Gq(...r),(n,o)=>[n,...o])},vI=u(3,(e,t,r)=>{let n=o=>p(o,P(s=>le(s)?n(o):B(s)));return p(jd(e),w(n),fo(p(jd(t),w(n))),P(([o,s])=>p(tg(ll(o,s,{onSelfDone:(i,a)=>p(Je(()=>i),da(vo(a),(c,l)=>[c,l,!0])),onOtherDone:(i,a)=>p(Je(()=>i),da(vo(a),(c,l)=>[l,c,!1]))})),hr(([i,a,c])=>p(sr(tr([hf(i),hf(a)])),hr(l=>p(Il(c?p(a,bt(f=>r(hf(i),f))):p(i,bt(f=>r(f,hf(a))))),oc(p(Al(o),tq(Al(s)),yi(Xe({onLeft:f=>Yo(l,([d,h])=>[p(f,bt(m=>r(m,h))),[hf(f),h]]),onRight:f=>Yo(l,([d,h])=>[p(f,bt(m=>r(d,m))),[d,hf(f)]])})),hr(Il))))))),jd)),s0)}),Cse=u(2,(e,t)=>p(e,g0(t,(r,n)=>r.length>n.length?[p(r,bs(n.length)),V(p(r,bs(n.length)))]:[r,Y(p(n,$t(r.length)))]))),wse=u(2,(e,t)=>p(e,g0(t,(r,n)=>r.length>n.length?[n,V(p(r,bs(n.length)))]:[p(n,bs(r.length)),Y(p(n,$t(r.length)))]))),PI=u(3,(e,t,r)=>p(e,g0(t,(n,o)=>_se(n,o,r)))),g0=u(3,(e,t,r)=>{let n=(s,i,a)=>{switch(s._tag){case IU:return p(kl(i),fo(kl(a),{concurrent:!0}),$n({onFailure:c=>B(At(x(c))),onSuccess:([c,l])=>X(c)&&X(l)?le(c.value)&&le(l.value)?n(QS,i,a):le(c.value)?n(JS(l.value),i,a):le(l.value)?n(ZS(c.value),i,a):B(xe(o(c.value,l.value))):B(At(g()))}));case RU:return $n(i,{onFailure:c=>B(At(c)),onSuccess:c=>le(c)?n(JS(s.rightChunk),i,a):le(s.rightChunk)?n(ZS(c),i,a):B(xe(o(c,s.rightChunk)))});case AU:return $n(a,{onFailure:c=>B(At(c)),onSuccess:c=>le(c)?n(ZS(s.leftChunk),i,a):le(s.leftChunk)?n(JS(c),i,a):B(xe(o(s.leftChunk,c)))})}},o=(s,i)=>{let[a,c]=r(s,i);switch(c._tag){case"Left":return le(c.left)?[a,QS]:[a,ZS(c.left)];case"Right":return le(c.right)?[a,QS]:[a,JS(c.right)]}};return p(e,e0(t,QS,n))}),Kq=e=>p(e,yI(0,(t,r)=>[t+1,[r,t]])),Qq=e=>{let t=r=>Ae({onInput:n=>{let[o,s]=nM(n,r,(a,c)=>[x(c),p(a,ct(l=>[l,c]))]),i=Kh(s,a=>X(a)?x([a.value[0],x(a.value[1])]):g());return T(A(i),()=>t(o))},onFailure:se,onDone:()=>$(r,{onNone:()=>re,onSome:n=>Fe(A(G([n,g()])),re)})});return new L(p(D(e),or(t(g()))))},Jq=e=>p(e,yI(g(),(t,r)=>[x(r),[t,r]])),Ose=e=>p(Qq(Jq(e)),Or(([[t,r],n])=>[t,r,p(n,ct(o=>o[1]))])),_se=(e,t,r)=>e.length>t.length?[p(e,bs(t.length),iM(t,r)),V(p(e,$t(t.length)))]:[p(e,iM(p(t,bs(e.length)),r)),Y(p(t,$t(e.length)))],kse=d0({}),Tse=u(e=>typeof e[0]!="string",(e,t,r,n)=>hr(e,o=>Or(r(o),s=>({...o,[t]:s})),n)),Ise=fh(Or),Rse=lh(Or);var Ase=u(e=>us(e[0]),(e,t="utf-8")=>Tn(()=>{let r=new TextDecoder(t);return Or(e,n=>r.decode(n))})),Mse=e=>Tn(()=>{let t=new TextEncoder;return Or(e,r=>t.encode(r))}),vse=(e,t,r)=>DU(n=>wr(Ze(()=>e.addEventListener(t,n.single,r)),()=>Ze(()=>e.removeEventListener(t,n.single,r))),{bufferSize:typeof r=="object"?r.bufferSize:void 0});var Pse=Yv;var Nse="effect/Redacted",og=ne("effect/Redacted/redactedRegistry",()=>new WeakMap),Yq=Symbol.for(Nse),RIe={[Yq]:{_A:e=>e},pipe(){return v(this,arguments)},toString(){return"<redacted>"},toJSON(){return"<redacted>"},[he](){return"<redacted>"},[W](){return p(M(Nse),K(M(og.get(this))),ie(this))},[H](e){return Xq(e)&&N(og.get(this),og.get(e))}},Xq=e=>F(e,Yq),Dse=e=>{let t=Object.create(RIe);return og.set(t,e),t},Lse=e=>{if(og.has(e))return og.get(e);throw new Error("Unable to get redacted value")};var MIe="effect/Config",Use=Symbol.for(MIe),vIe={_A:e=>e},eH={...Ti,[Use]:vIe,commit(){return q8(this)}};var qse=u(2,(e,t)=>{let r=Object.create(eH);return r._tag=$w,r.original=e,r.mapOrFail=t,r}),Hse=u(2,(e,t)=>{let r=Object.create(eH);return r._tag=Vw,r.name=t,r.config=e,r});var Wse=(e,t)=>{let r=Object.create(eH);return r._tag=Gw,r.description=e,r.parse=t,r};var Bse=e=>{let t=Wse("a text property",Y);return e===void 0?t:Hse(t,e)};var zse=qse;var jse=Bse;var tH=xx;var Vse=QZ,Gse=JZ,Kse=ZZ,Qse=AN,rH=YZ;var Jse=mx,Zse=MN,Yse=vN;var Xse=XZ;var nH=PN,oH=Zy;var eie=FN,tie=tY;var rie=Yy;var nie=LN;var oie=nY;var sie=qN;var sH=Symbol.for("effect/Encoding/errors/Decode"),Si=(e,t)=>{let r={_tag:"DecodeException",[sH]:sH,input:e};return cr(t)&&(r.message=t),r};var iH=Symbol.for("effect/Encoding/errors/Encode"),aie=(e,t)=>{let r={_tag:"EncodeException",[iH]:iH,input:e};return cr(t)&&(r.message=t),r};var FI=new TextEncoder,NI=new TextDecoder;var b0=e=>{let t=e.length,r="",n;for(n=2;n<t;n+=3)r+=Mu[e[n-2]>>2],r+=Mu[(e[n-2]&3)<<4|e[n-1]>>4],r+=Mu[(e[n-1]&15)<<2|e[n]>>6],r+=Mu[e[n]&63];return n===t+1&&(r+=Mu[e[n-2]>>2],r+=Mu[(e[n-2]&3)<<4],r+="=="),n===t&&(r+=Mu[e[n-2]>>2],r+=Mu[(e[n-2]&3)<<4|e[n-1]>>4],r+=Mu[(e[n-1]&15)<<2],r+="="),r},LI=e=>{let t=aH(e),r=t.length;if(r%4!==0)return V(Si(t,`Length must be a multiple of 4, but is ${r}`));let n=t.indexOf("=");if(n!==-1&&(n<r-2||n===r-2&&t[r-1]!=="="))return V(Si(t,"Found a '=' character, but it is not at the end"));try{let o=t.endsWith("==")?2:t.endsWith("=")?1:0,s=new Uint8Array(3*(r/4)-o);for(let i=0,a=0;i<r;i+=4,a+=3){let c=DI(t.charCodeAt(i))<<18|DI(t.charCodeAt(i+1))<<12|DI(t.charCodeAt(i+2))<<6|DI(t.charCodeAt(i+3));s[a]=c>>16,s[a+1]=c>>8&255,s[a+2]=c&255}return Y(s)}catch(o){return V(Si(t,o instanceof Error?o.message:"Invalid input"))}},aH=e=>e.replace(/[\n\r]/g,"");function DI(e){if(e>=cie.length)throw new TypeError(`Invalid character ${String.fromCharCode(e)}`);let t=cie[e];if(t===255)throw new TypeError(`Invalid character ${String.fromCharCode(e)}`);return t}var Mu=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],cie=[255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,62,255,255,255,63,52,53,54,55,56,57,58,59,60,61,255,255,255,0,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];var cH=e=>b0(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),pie=e=>{let t=aH(e),r=t.length;if(r%4===1)return V(Si(t,`Length should be a multiple of 4, but is ${r}`));if(!/^[-_A-Z0-9]*?={0,2}$/i.test(t))return V(Si(t,"Invalid input"));let n=r%4===2?`${t}==`:r%4===3?`${t}=`:t;return n=n.replace(/-/g,"+").replace(/_/g,"/"),LI(n)};var uH=e=>{let t="";for(let r=0;r<e.length;++r)t+=DIe[e[r]];return t},fie=e=>{let t=new TextEncoder().encode(e);if(t.length%2!==0)return V(Si(e,`Length must be a multiple of 2, but is ${t.length}`));try{let r=t.length/2,n=new Uint8Array(r);for(let o=0;o<r;o++){let s=lie(t[o*2]),i=lie(t[o*2+1]);n[o]=s<<4|i}return Y(n)}catch(r){return V(Si(e,r instanceof Error?r.message:"Invalid input"))}},DIe=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],lie=e=>{if(48<=e&&e<=57)return e-48;if(97<=e&&e<=102)return e-97+10;if(65<=e&&e<=70)return e-65+10;throw new TypeError("Invalid input")};var pH=e=>typeof e=="string"?b0(FI.encode(e)):b0(e),lH=e=>LI(e),die=e=>wh(lH(e),t=>NI.decode(t)),fH=e=>typeof e=="string"?cH(FI.encode(e)):cH(e),dH=e=>pie(e),hie=e=>wh(dH(e),t=>NI.decode(t)),hH=e=>typeof e=="string"?uH(FI.encode(e)):uH(e),mH=e=>fie(e),mie=e=>wh(mH(e),t=>NI.decode(t)),xie=e=>Ch({try:()=>encodeURIComponent(e),catch:t=>qIe(e,t instanceof Error?t.message:"Invalid input")}),gie=e=>Ch({try:()=>decodeURIComponent(e),catch:t=>UIe(e,t instanceof Error?t.message:"Invalid input")});var UIe=Si;var qIe=aie;var HIe="effect/GroupBy",yie=Symbol.for(HIe),WIe={_R:e=>e,_E:e=>e,_K:e=>e,_V:e=>e},BIe=e=>F(e,yie),zIe=u(e=>BIe(e[0]),(e,t,r)=>hr(e.grouped,([n,o])=>t(n,Ml(bi(o,{shutdown:!0}))),{concurrency:"unbounded",bufferSize:r?.bufferSize??16}));var Sie=e=>({[yie]:WIe,pipe(){return v(this,arguments)},grouped:e}),Eie=u(e=>us(e[0]),(e,t,r)=>Sie(vs(co(function*(){let n=yield*wt(),o=yield*wr(os(r?.bufferSize??16),a=>Pt(a)),s=yield*tr(new Map),i=yield*p(yi(e,t),zU(r?.bufferSize??16,([a,c])=>P(We(n),l=>l(a,c)),a=>Ve(o,a)));return yield*Cr(n,(a,c)=>p(_t(s),w(l=>br(l.get(a))),P($({onNone:()=>P(i,([l,f])=>ue(Os(s,d=>d.set(a,l)),p(Ve(o,xe([a,jIe(f,d=>new Cl(p(d,Sm(h=>G(h[1])))))])),Kt(d=>d===l)))),onSome:l=>B(f=>f===l)})))),$d(bi(o,{shutdown:!0}))})))),gH=u(e=>typeof e[0]!="function",(e,t,r)=>r?.key?zIe(bH(e,r.key,{bufferSize:r.bufferSize}),(n,o)=>yi(o,t)):YS(r?.concurrency,()=>yi(e,t),n=>r?.unordered?hr(e,o=>sr(t(o)),{concurrency:n}):$ne(e,n,t))),Cie=u(e=>typeof e[0]!="string",(e,t,r,n)=>gH(e,o=>w(r(o),s=>({...o,[t]:s})),n)),jIe=(e,t)=>new xH(e,t),xH=class extends un{dequeue;f;[jX]={_Out:t=>t};constructor(t,r){super(),this.dequeue=t,this.f=r}capacity(){return $X(this.dequeue)}get size(){return Gk(this.dequeue)}unsafeSize(){return this.dequeue.unsafeSize()}get awaitShutdown(){return KX(this.dequeue)}isActive(){return this.dequeue.isActive()}get isShutdown(){return xS(this.dequeue)}get shutdown(){return Pt(this.dequeue)}get isFull(){return GX(this.dequeue)}get isEmpty(){return VX(this.dequeue)}get take(){return p(Vn(this.dequeue),w(t=>this.f(t)))}get takeAll(){return p(JX(this.dequeue),w(bt(t=>this.f(t))))}takeUpTo(t){return p(ZX(this.dequeue,t),w(bt(r=>this.f(r))))}takeBetween(t,r){return p(Kk(this.dequeue,t,r),w(bt(n=>this.f(n))))}takeN(t){return p(YX(this.dequeue,t),w(bt(r=>this.f(r))))}poll(){return p(QX(this.dequeue),w(ct(t=>this.f(t))))}pipe(){return v(this,arguments)}commit(){return this.take}},bH=u(e=>typeof e[0]!="function",(e,t,r)=>{let n=(o,s)=>Ae({onInput:i=>T(Z(zr($Ie(i,t),([a,c])=>{let l=o.get(a);return l===void 0?p(os(r?.bufferSize??16),P(f=>p(Ze(()=>{o.set(a,f)}),ue(Ve(s,ZT([a,f]))),ue(p(Ve(f,Cu(c)),kd(d=>M_(d)?x(be):g())))))):kd(Ve(l,Cu(c)),f=>M_(f)?x(be):g())},{discard:!0})),()=>n(o,s)),onFailure:i=>Z(Ve(s,wu(i))),onDone:()=>Z(p(zr(o.entries(),([i,a])=>p(Ve(a,ya),kd(c=>M_(c)?x(be):g())),{discard:!0}),ue(Ve(s,ya))))});return Sie(ng(o=>co(function*(){let s=new Map,i=yield*hl();return yield*su(o,Pt(i)),yield*D(e).pipe(pe(n(s,i)),xa,ss(o),yt(o),Kt(Ml(bi(i,{shutdown:!0}))))})))}),$Ie=u(2,(e,t)=>{let r=[],n=e[Symbol.iterator](),o=new Map,s;for(;(s=n.next())&&!s.done;){let i=s.value,a=t(i);if(o.has(a))o.get(a).push(i);else{let c=[i];r.push([a,c]),o.set(a,c)}}return Le(r.map(i=>[i[0],Le(i[1])]))});var rn=class{path;actual;issue;_tag="Pointer";constructor(t,r,n){this.path=t,this.actual=r,this.issue=n}},qI=class{actual;message;_tag="Unexpected";constructor(t,r){this.actual=t,this.message=r}},Jd=class{ast;message;_tag="Missing";actual=void 0;constructor(t,r){this.ast=t,this.message=r}},mr=class{ast;actual;issues;output;_tag="Composite";constructor(t,r,n,o){this.ast=t,this.actual=r,this.issues=n,this.output=o}},E0=class{ast;actual;kind;issue;_tag="Refinement";constructor(t,r,n,o){this.ast=t,this.actual=r,this.kind=n,this.issue=o}},C0=class{ast;actual;kind;issue;_tag="Transformation";constructor(t,r,n,o){this.ast=t,this.actual=r,this.kind=n,this.issue=o}},Oe=class{ast;actual;message;_tag="Type";constructor(t,r,n){this.ast=t,this.actual=r,this.message=n}},HI=class{ast;actual;message;_tag="Forbidden";constructor(t,r,n){this.ast=t,this.actual=r,this.message=n}},wie=Symbol.for("effect/Schema/ParseErrorTypeId");var EH=class extends jZ("ParseError"){[wie]=wie;get message(){return this.toString()}toString(){return ag.formatIssueSync(this.issue)}toJSON(){return{_id:"ParseError",message:this.toString()}}[he](){return this.toJSON()}},vu=e=>new EH({issue:e}),it=Y,xr=V,cg=Ch;var O0=W1,mo=gE,Fs=u(2,(e,t)=>mo(e)?Xe(e,{onLeft:V,onRight:t}):P(e,t)),In=u(2,(e,t)=>mo(e)?wh(e,t):w(e,t)),Zd=u(2,(e,t)=>mo(e)?Hs(e,t):mi(e,t));var kie=u(2,(e,t)=>mo(e)?xz(e,{onLeft:t.onFailure,onRight:t.onSuccess}):cS(e,t)),Tie=u(2,(e,t)=>mo(e)?Xe(e,{onLeft:t,onRight:Y}):Ex(e,t)),_0=(e,t)=>t===void 0||go(t)?e:e===void 0?t:{...e,...t},k0=(e,t,r)=>{let n=hn(e,t);return(o,s)=>n(o,_0(r,s))},wH=(e,t,r)=>{let n=k0(e,t,r);return(o,s)=>B1(n(o,s),vu)},OH=(e,t,r)=>{let n=k0(e,t,r);return(o,s)=>$1(n(o,s))},_H=(e,t,r)=>{let n=hn(e,t);return(o,s)=>n(o,{..._0(r,s),isEffectAllowed:!0})},kH=(e,t)=>wH(e.ast,!0,t),TH=(e,t)=>OH(e.ast,!0,t),IH=(e,t)=>k0(e.ast,!0,t);var mn=(e,t)=>_H(e.ast,!0,t),RH=(e,t)=>wH(e.ast,!1,t),AH=(e,t)=>OH(e.ast,!1,t),Iie=(e,t)=>k0(e.ast,!1,t);var xn=(e,t)=>_H(e.ast,!1,t),Rie=kH,Aie=TH;var Yd=(e,t)=>wH(gt(e.ast),!0,t),Mie=(e,t)=>OH(gt(e.ast),!0,t),vie=(e,t)=>k0(gt(e.ast),!0,t);var Pie=(e,t)=>_H(gt(e.ast),!0,t),T0=(e,t)=>{let r=hn(gt(e.ast),!0);return(n,o)=>Wo(r(n,{exact:!0,..._0(t,o)}))},Fie=(e,t)=>{let r=hn(gt(e.ast),!0);return(n,o)=>{let s=r(n,{exact:!0,..._0(t,o)});if(kt(s))throw vu(s.left)}},Nie=RH,Die=AH;var GIe=ne(Symbol.for("effect/ParseResult/decodeMemoMap"),()=>new WeakMap),KIe=ne(Symbol.for("effect/ParseResult/encodeMemoMap"),()=>new WeakMap),hn=(e,t)=>{let r=t?GIe:KIe,n=r.get(e);if(n)return n;let o=QIe(e,t),s=tj(e),i=X(s)?(l,f)=>o(l,_0(f,s.value)):o,a=rj(e),c=t&&X(a)?(l,f)=>S0(Tie(i(l,f),a.value),e,l,f):i;return r.set(e,c),c},yH=e=>yr(Y6(e)),SH=e=>yr(X6(e)),QIe=(e,t)=>{switch(e._tag){case"Refinement":if(t){let r=hn(e.from,!0);return(n,o)=>{o=o??fC;let s=o?.errors==="all",i=Fs(Tie(r(n,o),a=>{let c=new E0(e,n,"From",a);return s&&IA(e)&&Hie(a)?$(e.filter(n,o,e),{onNone:()=>V(c),onSome:l=>V(new mr(e,n,[c,new E0(e,n,"Predicate",l)]))}):V(c)}),a=>$(e.filter(a,o,e),{onNone:()=>Y(a),onSome:c=>V(new E0(e,n,"Predicate",c))}));return S0(i,e,n,o)}}else{let r=hn(gt(e),!0),n=hn(Lie(e.from),!1);return(o,s)=>S0(Fs(r(o,s),i=>n(i,s)),e,o,s)}case"Transformation":{let r=ZIe(e.transformation,t),n=t?hn(e.from,!0):hn(e.to,!1),o=t?hn(e.to,!0):hn(e.from,!1);return(s,i)=>S0(Fs(Zd(n(s,i),a=>new C0(e,s,t?"Encoded":"Type",a)),a=>Fs(Zd(r(a,i??fC,e,s),c=>new C0(e,s,"Transformation",c)),c=>Zd(o(c,i),l=>new C0(e,s,t?"Type":"Encoded",l)))),e,s,i)}case"Declaration":{let r=t?e.decodeUnknown(...e.typeParameters):e.encodeUnknown(...e.typeParameters);return(n,o)=>S0(r(n,o??fC,e),e,n,o)}case"Literal":return Ps(e,r=>r===e.literal);case"UniqueSymbol":return Ps(e,r=>r===e.symbol);case"UndefinedKeyword":return Ps(e,VB);case"NeverKeyword":return Ps(e,KB);case"UnknownKeyword":case"AnyKeyword":case"VoidKeyword":return Y;case"StringKeyword":return Ps(e,cr);case"NumberKeyword":return Ps(e,go);case"BooleanKeyword":return Ps(e,_i);case"BigIntKeyword":return Ps(e,Bu);case"SymbolKeyword":return Ps(e,Oa);case"ObjectKeyword":return Ps(e,$r);case"Enums":return Ps(e,r=>e.enums.some(([n,o])=>o===r));case"TemplateLiteral":{let r=NA(e);return Ps(e,n=>cr(n)&&r.test(n))}case"TupleType":{let r=e.elements.map(l=>hn(l.type,t)),n=e.rest.map(l=>hn(l.type,t)),o=e.elements.filter(l=>!l.isOptional);e.rest.length>0&&(o=o.concat(e.rest.slice(1)));let s=o.length,i=e.elements.length>0?e.elements.map((l,f)=>f).join(" | "):"never",a=yH(e),c=SH(e);return(l,f)=>{if(!tR(l))return V(new Oe(e,l));let d=f?.errors==="all",h=[],m=0,y=[],_=l.length;for(let I=_;I<=s-1;I++){let Q=new rn(I,l,new Jd(o[I-_]));if(d){h.push([m++,Q]);continue}else return V(new mr(e,l,Q,y))}if(e.rest.length===0)for(let I=e.elements.length;I<=_-1;I++){let Q=new rn(I,l,new qI(l[I],`is unexpected, expected: ${i}`));if(d){h.push([m++,Q]);continue}else return V(new mr(e,l,Q,y))}let C=0,O;for(;C<r.length;C++)if(_<C+1){if(e.elements[C].isOptional)continue}else{let I=r[C],Q=I(l[C],f);if(mo(Q)){if(kt(Q)){let J=new rn(C,l,Q.left);if(d){h.push([m++,J]);continue}else return V(new mr(e,l,J,Sa(y)))}y.push([m++,Q.right])}else{let J=m++,z=C;O||(O=[]),O.push(({es:te,output:ce})=>P(pl(Q),Ye=>{if(kt(Ye)){let at=new rn(z,l,Ye.left);return d?(te.push([J,at]),be):V(new mr(e,l,at,Sa(ce)))}return ce.push([J,Ye.right]),be}))}}if(ut(n)){let[I,...Q]=n;for(;C<_-Q.length;C++){let J=I(l[C],f);if(mo(J))if(kt(J)){let z=new rn(C,l,J.left);if(d){h.push([m++,z]);continue}else return V(new mr(e,l,z,Sa(y)))}else y.push([m++,J.right]);else{let z=m++,te=C;O||(O=[]),O.push(({es:ce,output:Ye})=>P(pl(J),at=>{if(kt(at)){let Ue=new rn(te,l,at.left);return d?(ce.push([z,Ue]),be):V(new mr(e,l,Ue,Sa(Ye)))}else return Ye.push([z,at.right]),be}))}}for(let J=0;J<Q.length;J++)if(C+=J,!(_<C+1)){let z=Q[J](l[C],f);if(mo(z)){if(kt(z)){let te=new rn(C,l,z.left);if(d){h.push([m++,te]);continue}else return V(new mr(e,l,te,Sa(y)))}y.push([m++,z.right])}else{let te=m++,ce=C;O||(O=[]),O.push(({es:Ye,output:at})=>P(pl(z),Ue=>{if(kt(Ue)){let _r=new rn(ce,l,Ue.left);return d?(Ye.push([te,_r]),be):V(new mr(e,l,_r,Sa(at)))}return at.push([te,Ue.right]),be}))}}}let U=({es:I,output:Q})=>Ri(I)?V(new mr(e,l,Sa(I),Sa(Q))):Y(Sa(Q));if(O&&O.length>0){let I=O;return Je(()=>{let Q={es:Ah(h),output:Ah(y)};return P(zr(I,J=>J(Q),{concurrency:a,batching:c,discard:!0}),()=>U(Q))})}return U({output:y,es:h})}}case"TypeLiteral":{if(e.propertySignatures.length===0&&e.indexSignatures.length===0)return Ps(e,QB);let r=[],n={},o=[];for(let f of e.propertySignatures)r.push([hn(f.type,t),f]),n[f.name]=null,o.push(f.name);let s=e.indexSignatures.map(f=>[hn(f.parameter,t),hn(f.type,t),f.parameter]),i=Qt.make(e.indexSignatures.map(f=>f.parameter).concat(o.map(f=>Oa(f)?new pf(f):new Ui(f)))),a=hn(i,t),c=yH(e),l=SH(e);return(f,d)=>{if(!yg(f))return V(new Oe(e,f));let h=d?.errors==="all",m=[],y=0,_=d?.onExcessProperty==="error",C=d?.onExcessProperty==="preserve",O={},U;if(_||C){U=Reflect.ownKeys(f);for(let z of U){let te=a(z,d);if(mo(te)&&kt(te))if(_){let ce=new rn(z,f,new qI(f[z],`is unexpected, expected: ${String(i)}`));if(h){m.push([y++,ce]);continue}else return V(new mr(e,f,ce,O))}else O[z]=f[z]}}let I,Q=d?.exact===!0;for(let z=0;z<r.length;z++){let te=r[z][1],ce=te.name,Ye=Object.prototype.hasOwnProperty.call(f,ce);if(!Ye){if(te.isOptional)continue;if(Q){let _r=new rn(ce,f,new Jd(te));if(h){m.push([y++,_r]);continue}else return V(new mr(e,f,_r,O))}}let at=r[z][0],Ue=at(f[ce],d);if(mo(Ue)){if(kt(Ue)){let _r=new rn(ce,f,Ye?Ue.left:new Jd(te));if(h){m.push([y++,_r]);continue}else return V(new mr(e,f,_r,O))}O[ce]=Ue.right}else{let _r=y++,Ns=ce;I||(I=[]),I.push(({es:Ds,output:Oi})=>P(pl(Ue),Yn=>{if(kt(Yn)){let Rn=new rn(Ns,f,Ye?Yn.left:new Jd(te));return h?(Ds.push([_r,Rn]),be):V(new mr(e,f,Rn,Oi))}return Oi[Ns]=Yn.right,be}))}}for(let z=0;z<s.length;z++){let te=s[z],ce=te[0],Ye=te[1],at=VR(f,te[2]);for(let Ue of at){let _r=ce(Ue,d);if(mo(_r)&&Wo(_r)){let Ns=Ye(f[Ue],d);if(mo(Ns))if(kt(Ns)){let Ds=new rn(Ue,f,Ns.left);if(h){m.push([y++,Ds]);continue}else return V(new mr(e,f,Ds,O))}else Object.prototype.hasOwnProperty.call(n,Ue)||(O[Ue]=Ns.right);else{let Ds=y++,Oi=Ue;I||(I=[]),I.push(({es:Yn,output:Rn})=>P(pl(Ns),Ls=>{if(kt(Ls)){let ch=new rn(Oi,f,Ls.left);return h?(Yn.push([Ds,ch]),be):V(new mr(e,f,ch,Rn))}else return Object.prototype.hasOwnProperty.call(n,Ue)||(Rn[Ue]=Ls.right),be}))}}}}let J=({es:z,output:te})=>{if(Ri(z))return V(new mr(e,f,Sa(z),te));if(d?.propertyOrder==="original"){let ce=U||Reflect.ownKeys(f);for(let at of o)ce.indexOf(at)===-1&&ce.push(at);let Ye={};for(let at of ce)Object.prototype.hasOwnProperty.call(te,at)&&(Ye[at]=te[at]);return Y(Ye)}return Y(te)};if(I&&I.length>0){let z=I;return Je(()=>{let te={es:Ah(m),output:Object.assign({},O)};return P(zr(z,ce=>ce(te),{concurrency:c,batching:l,discard:!0}),()=>J(te))})}return J({es:m,output:O})}}case"Union":{let r=MH(e.types,t),n=Reflect.ownKeys(r.keys),o=n.length,s=e.types.length,i=new Map;for(let l=0;l<s;l++)i.set(e.types[l],hn(e.types[l],t));let a=yH(e)??1,c=SH(e);return(l,f)=>{let d=[],h=0,m=[];if(o>0)if(dh(l))for(let C=0;C<o;C++){let O=n[C],U=r.keys[O].buckets;if(Object.prototype.hasOwnProperty.call(l,O)){let I=String(l[O]);if(Object.prototype.hasOwnProperty.call(U,I))m=m.concat(U[I]);else{let{candidates:Q,literals:J}=r.keys[O],z=Qt.make(J),te=Q.length===s?new nn([new It(O,z,!1,!0)],[]):Qt.make(Q);d.push([h++,new mr(te,l,new rn(O,l,new Oe(z,l[O])))])}}else{let{candidates:I,literals:Q}=r.keys[O],J=new It(O,Qt.make(Q),!1,!0),z=I.length===s?new nn([J],[]):Qt.make(I);d.push([h++,new mr(z,l,new rn(O,l,new Jd(J)))])}}else{let C=r.candidates.length===s?e:Qt.make(r.candidates);d.push([h++,new Oe(C,l)])}r.otherwise.length>0&&(m=m.concat(r.otherwise));let y;for(let C=0;C<m.length;C++){let O=m[C],U=i.get(O)(l,f);if(mo(U)&&(!y||y.length===0)){if(Wo(U))return U;d.push([h++,U.left])}else{let I=h++;y||(y=[]),y.push(Q=>Je(()=>"finalResult"in Q?be:P(pl(U),J=>(Wo(J)?Q.finalResult=J:Q.es.push([I,J.left]),be))))}}let _=C=>Ri(C)?C.length===1&&C[0][1]._tag==="Type"?V(C[0][1]):V(new mr(e,l,Sa(C))):V(new Oe(e,l));if(y&&y.length>0){let C=y;return Je(()=>{let O={es:Ah(d)};return P(zr(C,U=>U(O),{concurrency:a,batching:c,discard:!0}),()=>"finalResult"in O?O.finalResult:_(O.es))})}return _(d)}}case"Suspend":{let r=Uh(()=>hn(e.f(),t));return(n,o)=>r()(n,o)}}},Ps=(e,t)=>r=>t(r)?Y(r):V(new Oe(e,r)),y0=(e,t)=>{switch(e._tag){case"Declaration":{let r=up(e);if(X(r))return y0(r.value,t);break}case"TypeLiteral":{let r=[];for(let n=0;n<e.propertySignatures.length;n++){let o=e.propertySignatures[n],s=t?rb(o.type):gt(o.type);Ma(s)&&!o.isOptional&&r.push([o.name,s])}return r}case"TupleType":{let r=[];for(let n=0;n<e.elements.length;n++){let o=e.elements[n],s=t?rb(o.type):gt(o.type);Ma(s)&&!o.isOptional&&r.push([n,s])}return r}case"Refinement":return y0(e.from,t);case"Suspend":return y0(e.f(),t);case"Transformation":return y0(t?e.from:e.to,t)}return[]},MH=(e,t)=>{let r={},n=[],o=[];for(let s=0;s<e.length;s++){let i=e[s],a=y0(i,t);if(a.length>0){o.push(i);for(let c=0;c<a.length;c++){let[l,f]=a[c],d=String(f.literal);r[l]=r[l]||{buckets:{},literals:[],candidates:[]};let h=r[l].buckets;if(Object.prototype.hasOwnProperty.call(h,d)){if(c<a.length-1)continue;h[d].push(i),r[l].literals.push(f),r[l].candidates.push(i)}else{h[d]=[i],r[l].literals.push(f),r[l].candidates.push(i);break}}}else n.push(i)}return{keys:r,otherwise:n,candidates:o}},Lie=e=>pp(e)?Lie(e.from):e,S0=(e,t,r,n)=>{if(n?.isEffectAllowed===!0||mo(e))return e;let o=new Zp,s=Td(e,{scheduler:o});o.flush();let i=s.unsafePoll();if(i){if(Xi(i))return Y(i.value);let a=i.cause;return vQ(a)?V(a.error):V(new HI(t,r,Ny(a)))}return V(new HI(t,r,"cannot be be resolved synchronously, this is caused by using runSync on an effect that performs async work"))},JIe=([e],[t])=>e>t?1:e<t?-1:0;function Sa(e){return e.sort(JIe).map(t=>t[1])}var ZIe=(e,t)=>{switch(e._tag){case"FinalTransformation":return t?e.decode:e.encode;case"ComposeTransformation":return Y;case"TypeLiteralTransformation":return r=>{let n=Y(r);for(let o of e.propertySignatureTransformations){let[s,i]=t?[o.from,o.to]:[o.to,o.from],a=t?o.decode:o.encode;n=In(n,l=>{let f=a(Object.prototype.hasOwnProperty.call(l,s)?x(l[s]):g());return delete l[s],X(f)&&(l[i]=f.value),l})}return n}}},Do=(e,t=[])=>({value:e,forest:t}),ag={formatIssue:e=>In(sg(e),YIe),formatIssueSync:e=>{let t=ag.formatIssue(e);return mo(t)?z1(t):kx(t)},formatError:e=>ag.formatIssue(e.issue),formatErrorSync:e=>ag.formatIssueSync(e.issue)},YIe=e=>e.value+Uie(`
`,e.forest),Uie=(e,t)=>{let r="",n=t.length,o;for(let s=0;s<n;s++){o=t[s];let i=s===n-1;r+=e+(i?"\u2514":"\u251C")+"\u2500 "+o.value,r+=Uie(e+(n>1&&!i?"\u2502  ":"   "),o.forest)}return r},XIe=e=>{switch(e){case"Encoded":return"Encoded side transformation failure";case"Transformation":return"Transformation process failure";case"Type":return"Type side transformation failure"}},e1e=e=>{switch(e){case"From":return"From side refinement failure";case"Predicate":return"Predicate refinement failure"}},qie=e=>"ast"in e?x(e.ast):g(),CH=Y(void 0),t1e=e=>qie(e).pipe(kr(J6),$({onNone:()=>CH,onSome:t=>{let r=t(e);return cr(r)?Y({message:r,override:!1}):di(r)?w(r,n=>({message:n,override:!1})):cr(r.message)?Y({message:r.message,override:r.override}):w(r.message,n=>({message:n,override:r.override}))}})),vH=e=>t=>t._tag===e,Hie=vH("Composite"),Oie=vH("Refinement"),_ie=vH("Transformation"),Pl=e=>Fs(t1e(e),t=>t!==void 0?!t.override&&(Hie(e)||Oie(e)&&e.kind==="From"||_ie(e)&&e.kind!=="Transformation")?_ie(e)||Oie(e)?Pl(e.issue):CH:Y(t.message):CH),Wie=e=>qie(e).pipe(kr(ej),G1(t=>t(e)),yr);function r1e(e){return TA(e).pipe(yo(()=>_A(e)),yo(()=>kA(e)),yo(()=>Jg(e)),_e(()=>`{ ${e.from} | filter }`))}function n1e(e){return e.message!==void 0?e.message:`Expected ${pp(e.ast)?r1e(e.ast):String(e.ast)}, actual ${Ho(e.actual)}`}var Bie=e=>In(Pl(e),t=>t??Wie(e)??n1e(e)),UI=e=>Wie(e)??String(e.ast),zie=e=>e.message??"is forbidden",jie=e=>e.message??"is unexpected",$ie=e=>{let t=Z6(e.ast);if(X(t)){let r=t.value();return cr(r)?Y(r):r}return Y(e.message??"is missing")},sg=e=>{switch(e._tag){case"Type":return In(Bie(e),Do);case"Forbidden":return Y(Do(UI(e),[Do(zie(e))]));case"Unexpected":return Y(Do(jie(e)));case"Missing":return In($ie(e),Do);case"Transformation":return Fs(Pl(e),t=>t!==void 0?Y(Do(t)):In(sg(e.issue),r=>Do(UI(e),[Do(XIe(e.kind),[r])])));case"Refinement":return Fs(Pl(e),t=>t!==void 0?Y(Do(t)):In(sg(e.issue),r=>Do(UI(e),[Do(e1e(e.kind),[r])])));case"Pointer":return In(sg(e.issue),t=>Do(ZE(e.path),[t]));case"Composite":return Fs(Pl(e),t=>{if(t!==void 0)return Y(Do(t));let r=UI(e);return JE(e.issues)?In(zr(e.issues,sg),n=>Do(r,n)):In(sg(e.issues),n=>Do(r,[n]))})}},Qd=(e,t,r)=>({_tag:e,path:t,message:r}),w0={formatIssue:e=>ig(e,void 0,[]),formatIssueSync:e=>{let t=w0.formatIssue(e);return mo(t)?z1(t):kx(t)},formatError:e=>w0.formatIssue(e.issue),formatErrorSync:e=>w0.formatIssueSync(e.issue)},ig=(e,t,r)=>{let n=e._tag;switch(n){case"Type":return In(Bie(e),o=>[Qd(t??n,r,o)]);case"Forbidden":return Y([Qd(n,r,zie(e))]);case"Unexpected":return Y([Qd(n,r,jie(e))]);case"Missing":return In($ie(e),o=>[Qd(n,r,o)]);case"Pointer":return ig(e.issue,void 0,r.concat(e.path));case"Composite":return Fs(Pl(e),o=>o!==void 0?Y([Qd(n,r,o)]):JE(e.issues)?In(zr(e.issues,s=>ig(s,void 0,r)),Mh):ig(e.issues,void 0,r));case"Refinement":return Fs(Pl(e),o=>o!==void 0?Y([Qd(n,r,o)]):ig(e.issue,e.kind==="Predicate"?n:void 0,r));case"Transformation":return Fs(Pl(e),o=>o!==void 0?Y([Qd(n,r,o)]):ig(e.issue,e.kind==="Transformation"?n:void 0,r))}};var Pu={};Xn(Pu,{LoggerTypeId:()=>s1e,add:()=>a1e,addEffect:()=>c1e,addScoped:()=>u1e,batched:()=>h1e,defaultLogger:()=>M1e,filterLogLevel:()=>f1e,isLogger:()=>j1e,json:()=>q1e,jsonLogger:()=>v1e,logFmt:()=>H1e,logfmtLogger:()=>P1e,make:()=>i1e,map:()=>d1e,mapInput:()=>p1e,mapInputOptions:()=>l1e,minimumLogLevel:()=>z1e,none:()=>b1e,pretty:()=>W1e,prettyLogger:()=>N1e,prettyLoggerDefault:()=>D1e,remove:()=>y1e,replace:()=>I0,replaceEffect:()=>S1e,replaceScoped:()=>E1e,simple:()=>C1e,stringLogger:()=>F1e,structured:()=>B1e,structuredLogger:()=>L1e,succeed:()=>w1e,sync:()=>O1e,test:()=>_1e,tracerLogger:()=>U1e,withConsoleError:()=>g1e,withConsoleLog:()=>m1e,withLeveledConsole:()=>x1e,withMinimumLogLevel:()=>k1e,withSpanAnnotations:()=>T1e,zip:()=>I1e,zipLeft:()=>R1e,zipRight:()=>A1e});var Gie=u(2,(e,t)=>e.log({fiberId:Cf,logLevel:lm,message:t,cause:R_,context:Xw(),spans:Ys(),annotations:Pc(),date:new Date}));var s1e=Hm,i1e=_n,a1e=fS,c1e=wD,u1e=OD,p1e=GG,l1e=t_,f1e=KG,d1e=Sy,h1e=JK,m1e=Ym,x1e=zK,g1e=jK,b1e=QG,y1e=dS,I0=eX,S1e=tX,E1e=rX,C1e=r_,w1e=JG,O1e=ZG,_1e=Gie,k1e=XY,T1e=QK,I1e=n_,R1e=YG,A1e=XG,M1e=bd,v1e=i_,P1e=s_,F1e=o_,N1e=hF,D1e=a_,L1e=Ey,U1e=E2,q1e=I0(bd,$K),H1e=I0(bd,VK),W1e=I0(bd,GK),B1e=I0(bd,KK),z1e=YY,j1e=t7;var R0={};Xn(R0,{MetricTypeId:()=>$1e,counter:()=>Q1e,fiberActive:()=>NRe,fiberFailures:()=>PRe,fiberLifetimes:()=>FRe,fiberStarted:()=>MRe,fiberSuccesses:()=>vRe,frequency:()=>J1e,fromMetricKey:()=>Y1e,gauge:()=>X1e,globalMetricRegistry:()=>V1e,histogram:()=>eRe,increment:()=>tRe,incrementBy:()=>rRe,make:()=>G1e,map:()=>nRe,mapInput:()=>K1e,mapType:()=>oRe,modify:()=>sRe,set:()=>iRe,snapshot:()=>aRe,succeed:()=>cRe,summary:()=>pRe,summaryTimestamp:()=>lRe,sync:()=>uRe,tagged:()=>fRe,taggedWithLabels:()=>hRe,taggedWithLabelsInput:()=>dRe,timer:()=>mRe,timerWithBoundaries:()=>xRe,trackAll:()=>gRe,trackDefect:()=>bRe,trackDefectWith:()=>yRe,trackDuration:()=>SRe,trackDurationWith:()=>ERe,trackError:()=>CRe,trackErrorWith:()=>wRe,trackSuccess:()=>ORe,trackSuccessWith:()=>_Re,unsafeSnapshot:()=>ARe,update:()=>kRe,value:()=>TRe,withConstantInput:()=>Z1e,withNow:()=>IRe,zip:()=>RRe});var $1e=jF,V1e=Ty,G1e=oa,K1e=Bm,Q1e=hd,J1e=z7,Z1e=j7,Y1e=md,X1e=$7,eRe=zm,tRe=V7,rRe=G7,nRe=$F,oRe=K7,sRe=u_,iRe=Q7,aRe=uK,cRe=J7,uRe=Z7,pRe=Y7,lRe=VF,fRe=jm,dRe=X7,hRe=GF,mRe=eK,xRe=tK,gRe=rK,bRe=nK,yRe=KF,SRe=oK,ERe=QF,CRe=sK,wRe=JF,ORe=iK,_Re=ZF,kRe=ui,TRe=aK,IRe=YF,RRe=cK,ARe=XF,MRe=g2,vRe=b2,PRe=y2,FRe=S2,NRe=g_;var Kie=Xq,WI=Dse,A0=Lse;var Qie=e=>ar((t,r)=>e(A0(t),A0(r)));var wi={};Xn(wi,{Any:()=>LH,Array:()=>Nt,ArrayEnsure:()=>iAe,ArrayFormatterIssue:()=>iB,BetweenBigDecimalSchemaId:()=>YW,BetweenBigIntSchemaId:()=>xW,BetweenDateSchemaId:()=>AW,BetweenDurationSchemaId:()=>wW,BetweenSchemaId:()=>yce,BigDecimal:()=>VW,BigDecimalFromNumber:()=>GW,BigDecimalFromSelf:()=>qu,BigInt:()=>Ll,BigIntFromNumber:()=>gW,BigIntFromSelf:()=>Du,Boolean:()=>nh,BooleanFromString:()=>nB,BooleanFromUnknown:()=>rB,BrandSchemaId:()=>FH,Capitalize:()=>JH,Capitalized:()=>JI,CapitalizedSchemaId:()=>tce,Cause:()=>Pve,CauseFromSelf:()=>p1,Char:()=>GH,Chunk:()=>dve,ChunkFromSelf:()=>cue,Class:()=>Eve,Config:()=>ePe,Data:()=>yve,DataFromSelf:()=>pue,Date:()=>PW,DateFromNumber:()=>FW,DateFromSelf:()=>oh,DateFromSelfSchemaId:()=>MW,DateFromString:()=>n1,DateTimeUtc:()=>LW,DateTimeUtcFromDate:()=>DW,DateTimeUtcFromNumber:()=>NW,DateTimeUtcFromSelf:()=>hg,DateTimeZoned:()=>WW,DateTimeZonedFromSelf:()=>s1,Defect:()=>Q0,Duration:()=>SW,DurationFromMillis:()=>yW,DurationFromNanos:()=>bW,DurationFromSelf:()=>dg,Either:()=>HMe,EitherFromSelf:()=>RB,EitherFromUnion:()=>WMe,EndsWithSchemaId:()=>$H,Enums:()=>ZRe,Exit:()=>tB,ExitFromSelf:()=>xue,FiberId:()=>eB,FiberIdFromSelf:()=>c1,Finite:()=>oW,FiniteSchemaId:()=>cce,FromPropertySignature:()=>Uu,GreaterThanBigDecimalSchemaId:()=>KW,GreaterThanBigIntSchemaId:()=>fW,GreaterThanDateSchemaId:()=>IW,GreaterThanDurationSchemaId:()=>EW,GreaterThanOrEqualToBigDecimalSchemaId:()=>QW,GreaterThanOrEqualToBigIntSchemaId:()=>dW,GreaterThanOrEqualToDateSchemaId:()=>RW,GreaterThanOrEqualToDurationSchemaId:()=>CW,GreaterThanOrEqualToSchemaId:()=>lce,GreaterThanSchemaId:()=>uce,HashMap:()=>Vve,HashMapFromSelf:()=>bue,HashSet:()=>Bve,HashSetFromSelf:()=>gue,IncludesSchemaId:()=>VH,InstanceOfSchemaId:()=>NH,Int:()=>B0,IntSchemaId:()=>hce,ItemsCountSchemaId:()=>Bce,JsonNumber:()=>uW,JsonNumberSchemaId:()=>Tce,LengthSchemaId:()=>BH,LessThanBigDecimalSchemaId:()=>JW,LessThanBigIntSchemaId:()=>hW,LessThanDateSchemaId:()=>kW,LessThanDurationSchemaId:()=>j0,LessThanOrEqualToBigDecimalSchemaId:()=>ZW,LessThanOrEqualToBigIntSchemaId:()=>mW,LessThanOrEqualToDateSchemaId:()=>TW,LessThanOrEqualToDurationSchemaId:()=>nMe,LessThanOrEqualToSchemaId:()=>gce,LessThanSchemaId:()=>mce,List:()=>Jve,ListFromSelf:()=>yue,Literal:()=>Bt,Lowercase:()=>KH,Lowercased:()=>KI,LowercasedSchemaId:()=>Zae,Map:()=>VMe,MapFromRecord:()=>KMe,MapFromSelf:()=>MB,MaxItemsSchemaId:()=>Wce,MaxLengthSchemaId:()=>Gae,MinItemsSchemaId:()=>Hce,MinLengthSchemaId:()=>Kae,MultipleOfSchemaId:()=>dce,Negative:()=>aW,NegativeBigDecimalFromSelf:()=>cve,NegativeBigDecimalSchemaId:()=>nue,NegativeBigInt:()=>zAe,NegativeBigIntFromSelf:()=>BAe,Never:()=>L0,NonEmptyArray:()=>fg,NonEmptyArrayEnsure:()=>aAe,NonEmptyChunk:()=>xve,NonEmptyChunkFromSelf:()=>uue,NonEmptyString:()=>eW,NonEmptyTrimmedString:()=>YI,NonNaN:()=>sW,NonNaNSchemaId:()=>Sce,NonNegative:()=>z0,NonNegativeBigDecimalFromSelf:()=>ave,NonNegativeBigDecimalSchemaId:()=>tue,NonNegativeBigInt:()=>VAe,NonNegativeBigIntFromSelf:()=>Fce,NonNegativeInt:()=>t1,NonPositive:()=>cW,NonPositiveBigDecimalFromSelf:()=>uve,NonPositiveBigDecimalSchemaId:()=>sue,NonPositiveBigInt:()=>$Ae,NonPositiveBigIntFromSelf:()=>jAe,Not:()=>pW,Null:()=>D0,NullOr:()=>P0,NullishOr:()=>F0,Number:()=>bn,NumberFromString:()=>e1,Object:()=>UH,Option:()=>PMe,OptionFromNonEmptyTrimmedString:()=>zW,OptionFromNullOr:()=>FMe,OptionFromNullishOr:()=>NMe,OptionFromSelf:()=>ih,OptionFromUndefinedOr:()=>DMe,PatternSchemaId:()=>zH,Positive:()=>iW,PositiveBigDecimalFromSelf:()=>ive,PositiveBigDecimalSchemaId:()=>Xce,PositiveBigInt:()=>WAe,PositiveBigIntFromSelf:()=>HAe,PropertyKey:()=>l1,PropertySignatureDeclaration:()=>Lu,PropertySignatureTransformation:()=>Ci,PropertySignatureTypeId:()=>uB,ReadonlyMap:()=>$Me,ReadonlyMapFromRecord:()=>GMe,ReadonlyMapFromSelf:()=>AB,ReadonlySet:()=>YMe,ReadonlySetFromSelf:()=>Zce,Record:()=>lB,Redacted:()=>KAe,RedactedFromSelf:()=>Nce,RefineSchemaId:()=>dB,Set:()=>XMe,SetFromSelf:()=>Yce,SortedSet:()=>Xve,SortedSetFromSelf:()=>Sue,StartsWithSchemaId:()=>jH,String:()=>$e,StringFromBase64:()=>pMe,StringFromBase64Url:()=>lMe,StringFromHex:()=>fMe,StringFromUriComponent:()=>dMe,Struct:()=>zt,Symbol:()=>lW,SymbolFromSelf:()=>U0,TaggedClass:()=>Cve,TaggedError:()=>wve,TaggedRequest:()=>dPe,TaggedStruct:()=>J0,TemplateLiteral:()=>Aae,TemplateLiteralParser:()=>YRe,TimeZone:()=>HW,TimeZoneFromSelf:()=>o1,TimeZoneNamed:()=>qW,TimeZoneNamedFromSelf:()=>G0,TimeZoneOffset:()=>UW,TimeZoneOffsetFromSelf:()=>V0,ToPropertySignature:()=>Ca,Trim:()=>YH,Trimmed:()=>W0,TrimmedSchemaId:()=>$ae,Tuple:()=>Ei,TypeId:()=>Dl,ULID:()=>rW,ULIDSchemaId:()=>ace,URL:()=>nW,URLFromSelf:()=>XI,UUID:()=>tW,UUIDSchemaId:()=>ice,Uint8:()=>r1,Uint8Array:()=>OW,Uint8ArrayFromBase64:()=>aMe,Uint8ArrayFromBase64Url:()=>cMe,Uint8ArrayFromHex:()=>uMe,Uint8ArrayFromSelf:()=>$0,Uncapitalize:()=>ZH,Uncapitalized:()=>ZI,UncapitalizedSchemaId:()=>nce,Undefined:()=>N0,UndefinedOr:()=>eh,Union:()=>yn,UniqueSymbolFromSelf:()=>Iae,Unknown:()=>rh,Uppercase:()=>QH,Uppercased:()=>QI,UppercasedSchemaId:()=>Xae,ValidDateFromSelf:()=>vW,ValidDateSchemaId:()=>_W,Void:()=>DH,annotations:()=>IAe,asSchema:()=>HRe,asSerializable:()=>tPe,asSerializableWithResult:()=>fPe,asWithResult:()=>sPe,asserts:()=>Fie,attachPropertySignature:()=>TAe,between:()=>yB,betweenBigDecimal:()=>aue,betweenBigInt:()=>SB,betweenDate:()=>OMe,betweenDuration:()=>qce,brand:()=>yAe,capitalized:()=>rce,clamp:()=>UAe,clampBigDecimal:()=>pve,clampBigInt:()=>qAe,clampDuration:()=>tMe,compose:()=>VI,declare:()=>ir,decode:()=>zRe,decodeEither:()=>jRe,decodeOption:()=>Aie,decodePromise:()=>$Re,decodeSync:()=>Rie,decodeUnknown:()=>sh,decodeUnknownEither:()=>Oae,decodeUnknownOption:()=>TH,decodeUnknownPromise:()=>_ae,decodeUnknownSync:()=>kH,deserialize:()=>oPe,deserializeExit:()=>lPe,deserializeFailure:()=>aPe,deserializeSuccess:()=>uPe,element:()=>qH,encode:()=>h1,encodeEither:()=>WRe,encodeOption:()=>Die,encodePromise:()=>BRe,encodeSync:()=>Nie,encodeUnknown:()=>d1,encodeUnknownEither:()=>Cae,encodeUnknownOption:()=>AH,encodeUnknownPromise:()=>wae,encodeUnknownSync:()=>RH,encodedBoundSchema:()=>aB,encodedSchema:()=>f1,endsWith:()=>vAe,equivalence:()=>hPe,exitSchema:()=>FB,extend:()=>Z0,failureSchema:()=>oB,filter:()=>Se,filterEffect:()=>_Ae,finite:()=>gB,format:()=>Ft,fromBrand:()=>tAe,fromKey:()=>pAe,getClassTag:()=>y1,getNumberIndexedAccess:()=>x1,greaterThan:()=>pce,greaterThanBigDecimal:()=>rve,greaterThanBigInt:()=>Ace,greaterThanDate:()=>CMe,greaterThanDuration:()=>sMe,greaterThanOrEqualTo:()=>fce,greaterThanOrEqualToBigDecimal:()=>nve,greaterThanOrEqualToBigInt:()=>Mce,greaterThanOrEqualToDate:()=>wMe,greaterThanOrEqualToDuration:()=>iMe,head:()=>gMe,headNonEmpty:()=>bMe,headOrElse:()=>yMe,includes:()=>PAe,instanceOf:()=>vae,int:()=>bB,is:()=>T0,isPropertySignature:()=>m1,isSchema:()=>gn,itemsCount:()=>xMe,keyof:()=>nAe,length:()=>Jae,lessThan:()=>xce,lessThanBigDecimal:()=>ove,lessThanBigInt:()=>vce,lessThanDate:()=>SMe,lessThanDuration:()=>rMe,lessThanOrEqualTo:()=>bce,lessThanOrEqualToBigDecimal:()=>sve,lessThanOrEqualToBigInt:()=>Pce,lessThanOrEqualToDate:()=>EMe,lessThanOrEqualToDuration:()=>oMe,lowercased:()=>Yae,make:()=>Te,makePropertySignature:()=>sc,maxItems:()=>mMe,maxLength:()=>AAe,minItems:()=>hMe,minLength:()=>Qae,multipleOf:()=>LAe,mutable:()=>wAe,negative:()=>wce,negativeBigDecimal:()=>oue,negativeBigInt:()=>CB,nonEmptyString:()=>xB,nonNaN:()=>Ece,nonNegative:()=>_ce,nonNegativeBigDecimal:()=>rue,nonNegativeBigInt:()=>wB,nonPositive:()=>Oce,nonPositiveBigDecimal:()=>iue,nonPositiveBigInt:()=>OB,omit:()=>gAe,optional:()=>dAe,optionalElement:()=>oAe,optionalToOptional:()=>WH,optionalToRequired:()=>Fu,optionalWith:()=>hAe,parseJson:()=>sce,parseNumber:()=>kce,partial:()=>SAe,partialWith:()=>EAe,pattern:()=>mB,pick:()=>Wae,pickLiteral:()=>QRe,pluck:()=>bAe,positive:()=>Cce,positiveBigDecimal:()=>eue,positiveBigInt:()=>EB,propertySignature:()=>pg,rename:()=>RAe,required:()=>CAe,requiredToOptional:()=>lAe,serializableSchema:()=>rPe,serialize:()=>nPe,serializeExit:()=>pPe,serializeFailure:()=>iPe,serializeSuccess:()=>cPe,split:()=>FAe,standardSchemaV1:()=>qRe,startsWith:()=>MAe,successSchema:()=>sB,suspend:()=>GI,symbolSerializable:()=>Y0,symbolWithResult:()=>Wu,tag:()=>qae,transform:()=>me,transformLiteral:()=>jae,transformLiterals:()=>kAe,transformOrFail:()=>gr,trimmed:()=>Vae,typeSchema:()=>ye,uncapitalized:()=>oce,uppercased:()=>ece,validDate:()=>TB,validate:()=>kae,validateEither:()=>VRe,validateOption:()=>Mie,validatePromise:()=>GRe,validateSync:()=>Yd,withConstructorDefault:()=>Fl,withDecodingDefault:()=>Lae,withDefaults:()=>uAe});var Zie=u(e=>$r(e[0]),(e,...t)=>{let r={};for(let n of t)n in e&&(r[n]=e[n]);return r}),Yie=u(e=>$r(e[0]),(e,...t)=>{let r={...e};for(let n of t)delete r[n];return r});var Dl=Symbol.for("effect/Schema");function Te(e){return class{[Dl]=PH;static ast=e;static annotations(r){return Te(ps(this.ast,r))}static pipe(){return v(this,arguments)}static toString(){return String(e)}static Type;static Encoded;static Context;static[Dl]=PH}}var PH={_A:e=>e,_I:e=>e,_R:e=>e},eae=e=>Xi(e)?e.value:LRe(Ny(e.cause)),LRe=e=>({issues:[{message:e}]}),URe=e=>w(w0.formatIssue(e),t=>({issues:t.map(r=>({path:r.path,message:r.message}))})),qRe=(e,t)=>{let r=mn(e,{errors:"all"});return class extends Te(e.ast){static"~standard"={version:1,vendor:"effect",validate(o){let s=new Zp,i=Td($n(r(o,t),{onFailure:URe,onSuccess:c=>B({value:c})}),{scheduler:s});s.flush();let a=i.unsafePoll();return a?eae(a):new Promise(c=>{i.addObserver(l=>{c(eae(l))})})}}}},tae={schemaId:K6,message:dA,missingMessage:nC,identifier:Gg,title:Bo,description:Ic,examples:hA,default:mA,documentation:Q6,jsonSchema:xA,arbitrary:gA,pretty:bA,equivalence:oC,concurrency:yA,batching:SA,parseIssueTitle:EA,parseOptions:CA,decodingFallback:wA},Hu=e=>{if(!e)return{};let t={...e};for(let r in tae)if(r in e){let n=tae[r];t[n]=e[r],delete t[r]}return t},ps=(e,t)=>tb(e,Hu(t));function HRe(e){return e}var Ft=e=>String(e.ast),f1=e=>Te(rb(e.ast)),aB=e=>Te(wj(e.ast)),ye=e=>Te(gt(e.ast)),d1=(e,t)=>{let r=xn(e,t);return(n,o)=>Zd(r(n,o),vu)},Cae=(e,t)=>{let r=Iie(e,t);return(n,o)=>Hs(r(n,o),vu)},wae=(e,t)=>{let r=d1(e,t);return(n,o)=>lu(r(n,o))},h1=d1,WRe=Cae,BRe=wae,sh=(e,t)=>{let r=mn(e,t);return(n,o)=>Zd(r(n,o),vu)},Oae=(e,t)=>{let r=IH(e,t);return(n,o)=>Hs(r(n,o),vu)},_ae=(e,t)=>{let r=sh(e,t);return(n,o)=>lu(r(n,o))},zRe=sh,jRe=Oae,$Re=_ae,kae=(e,t)=>{let r=Pie(e,t);return(n,o)=>Zd(r(n,o),vu)},VRe=(e,t)=>{let r=vie(e,t);return(n,o)=>Hs(r(n,o),vu)},GRe=(e,t)=>{let r=kae(e,t);return(n,o)=>lu(r(n,o))},gn=e=>F(e,Dl)&&$r(e[Dl]);function KRe(e){return lC(e)?Qt.make(hj(e,t=>new Ui(t))):new Ui(e[0])}function Tae(e,t=KRe(e)){return class extends Te(t){static annotations(n){return Tae(this.literals,ps(this.ast,n))}static literals=[...e]}}function Bt(...e){return ut(e)?Tae(e):L0}var QRe=(...e)=>t=>Bt(...e),Iae=e=>Te(new pf(e)),JRe=e=>new rC(Object.keys(e).filter(t=>typeof e[e[t]]!="number").map(t=>[t,e[t]])),Rae=(e,t=JRe(e))=>class extends Te(t){static annotations(n){return Rae(this.enums,ps(this.ast,n))}static enums={...e}},ZRe=e=>Rae(e),Aae=(...[e,...t])=>{let r=[],n="",o=t;gn(e)?Ma(e.ast)?n=String(e.ast.literal):o=[e,...o]:n=String(e);for(let s=0;s<o.length;s++){let i=o[s];if(gn(i)){if(s<o.length-1){let a=o[s+1];if(gn(a)){if(Ma(a.ast)){r.push(new ip(i.ast,String(a.ast.literal))),s++;continue}}else{r.push(new ip(i.ast,String(a))),s++;continue}}r.push(new ip(i.ast,""))}else r.push(new ip(new Ui(i),""))}return Ri(r)?Te(new $g(n,r)):Te(new $g("",[new ip(new Ui(n),"")]))};function Mae(e,t){let r=e.ast;switch(r._tag){case"Literal":{let n=r.literal;if(!cr(n)){let o=String(n);return me(Bt(o),t,{strict:!0,decode:()=>n,encode:()=>o})}break}case"NumberKeyword":return VI(e1,t);case"Union":{let n=[],o=!1;for(let s of r.types){let i=Te(s),a=f1(i),c=Mae(a,i);c&&(o=!0),n.push(c??i)}return o?VI(yn(...n),t):t}}}var YRe=(...e)=>{let t=[],r=[],n=[],o=!1;for(let c=0;c<e.length;c++){let l=e[c],f=gn(l)?l:Bt(l);n.push(f);let d=f1(f);t.push(d);let h=Mae(d,f);h?(r.push(h),o=!0):r.push(f)}let s=Aae(...t),i=yj(s.ast),a=Ei(...r);return o&&(a=a.annotations({[cp]:Ft(Ei(...n))})),class extends gr(s,a,{strict:!1,decode:(l,f,d)=>{let h=i.exec(l);return h?it(h.slice(1,e.length+1)):xr(new Oe(d,l,`${i.source}: no match for ${JSON.stringify(l)}`))},encode:l=>it(l.join(""))}){static params=e.slice()}},XRe=(e,t,r)=>cB(e,new uf(e.map(n=>n.ast),(...n)=>t.decode(...n.map(Te)),(...n)=>t.encode(...n.map(Te)),Hu(r))),eAe=(e,t)=>{let r=()=>(o,s,i)=>e(o)?it(o):xr(new Oe(i,o)),n=r;return cB([],new uf([],r,n,Hu(t)))};function cB(e,t){return class extends Te(t){static annotations(n){return cB(this.typeParameters,ps(this.ast,n))}static typeParameters=[...e]}}var ir=function(){if(Array.isArray(arguments[0])){let r=arguments[0],n=arguments[1],o=arguments[2];return XRe(r,n,o)}let e=arguments[0],t=arguments[1];return eAe(e,t)},FH=Symbol.for("effect/SchemaId/Brand"),tAe=(e,t)=>r=>fB(r,new _c(r.ast,function(s,i,a){let c=e.either(s);return kt(c)?x(new Oe(a,s,c.left.map(l=>l.message).join(", "))):g()},Hu({schemaId:FH,[FH]:{constructor:e},...t}))),NH=Symbol.for("effect/SchemaId/InstanceOf"),vae=(e,t)=>ir(r=>r instanceof e,{title:e.name,description:`an instance of ${e.name}`,pretty:()=>String,schemaId:NH,[NH]:{constructor:e},...t}),N0=class extends Te(lf){},DH=class extends Te(sj){},D0=class extends Te(oj){},L0=class extends Te(Zg){},rh=class extends Te(RA){},LH=class extends Te(AA){},Du=class extends Te(ij){},U0=class extends Te(aj){},$e=class extends Te(iC){},bn=class extends Te(aC){},nh=class extends Te(cC){},UH=class extends Te(cj){};var rAe=e=>Qt.make(e.map(t=>t.ast));function Pae(e,t=rAe(e)){return class extends Te(t){static annotations(n){return Pae(this.members,ps(this.ast,n))}static members=[...e]}}function yn(...e){return lC(e)?Pae(e):ut(e)?e[0]:L0}var P0=e=>yn(e,D0),eh=e=>yn(e,N0),F0=e=>yn(e,D0,N0),nAe=e=>Te(gj(e.ast)),qH=e=>new BI(new wo(e.ast,!1),e),oAe=e=>new BI(new wo(e.ast,!0),e),BI=class e{ast;from;[Dl];_Token;constructor(t,r){this.ast=t,this.from=r}annotations(t){return new e(new wo(this.ast.type,this.ast.isOptional,{...this.ast.annotations,...Hu(t)}),this.from)}toString(){return`${this.ast.type}${this.ast.isOptional?"?":""}`}},sAe=(e,t)=>new wc(e.map(r=>gn(r)?new wo(r.ast,!1):r.ast),t.map(r=>gn(r)?new ap(r.ast):r.ast),!0);function q0(e,t,r=sAe(e,t)){return class extends Te(r){static annotations(o){return q0(this.elements,this.rest,ps(this.ast,o))}static elements=[...e];static rest=[...t]}}function Ei(...e){return Array.isArray(e[0])?q0(e[0],e.slice(1)):q0(e,[])}function Fae(e,t){return class extends q0([],[e],t){static annotations(n){return Fae(this.value,ps(this.ast,n))}static value=e}}var Nt=e=>Fae(e);function Nae(e,t){return class extends q0([e],[e],t){static annotations(n){return Nae(this.value,ps(this.ast,n))}static value=e}}var fg=e=>Nae(e);function iAe(e){return me(yn(e,Nt(e)),Nt(ye(e)),{strict:!0,decode:t=>Kl(t),encode:t=>t.length===1?t[0]:t})}function aAe(e){return me(yn(e,fg(e)),fg(ye(e)),{strict:!0,decode:t=>ut(t)?t:Gr(t),encode:t=>t.length===1?t[0]:t})}var HH=e=>e?'"?:"':'":"',Lu=class extends wo{isReadonly;defaultValue;_tag="PropertySignatureDeclaration";constructor(t,r,n,o,s){super(t,r,o),this.isReadonly=n,this.defaultValue=s}toString(){let t=HH(this.isOptional),r=String(this.type);return`PropertySignature<${t}, ${r}, never, ${t}, ${r}>`}},Uu=class extends wo{isReadonly;fromKey;constructor(t,r,n,o,s){super(t,r,o),this.isReadonly=n,this.fromKey=s}},Ca=class extends wo{isReadonly;defaultValue;constructor(t,r,n,o,s){super(t,r,o),this.isReadonly=n,this.defaultValue=s}},cAe=e=>e===void 0?"never":cr(e)?JSON.stringify(e):String(e),Ci=class{from;to;decode;encode;_tag="PropertySignatureTransformation";constructor(t,r,n,o){this.from=t,this.to=r,this.decode=n,this.encode=o}toString(){return`PropertySignature<${HH(this.to.isOptional)}, ${this.to.type}, ${cAe(this.from.fromKey)}, ${HH(this.from.isOptional)}, ${this.from.type}>`}},Dae=(e,t)=>{switch(e._tag){case"PropertySignatureDeclaration":return new Lu(e.type,e.isOptional,e.isReadonly,{...e.annotations,...t},e.defaultValue);case"PropertySignatureTransformation":return new Ci(e.from,new Ca(e.to.type,e.to.isOptional,e.to.isReadonly,{...e.to.annotations,...t},e.to.defaultValue),e.decode,e.encode)}},uB=Symbol.for("effect/PropertySignature"),m1=e=>F(e,uB),zI=class e{ast;[Dl];[uB]=null;_TypeToken;_Key;_EncodedToken;_HasDefault;constructor(t){this.ast=t}pipe(){return v(this,arguments)}annotations(t){return new e(Dae(this.ast,Hu(t)))}toString(){return String(this.ast)}},sc=e=>new zI(e),H0=class e extends zI{from;constructor(t,r){super(t),this.from=r}annotations(t){return new e(Dae(this.ast,Hu(t)),this.from)}},pg=e=>new H0(new Lu(e.ast,!1,!0,{},void 0),e),Fl=u(2,(e,t)=>{let r=e.ast;switch(r._tag){case"PropertySignatureDeclaration":return sc(new Lu(r.type,r.isOptional,r.isReadonly,r.annotations,t));case"PropertySignatureTransformation":return sc(new Ci(r.from,new Ca(r.to.type,r.to.isOptional,r.to.isReadonly,r.to.annotations,t),r.decode,r.encode))}}),rae=(e,t)=>$(e,{onNone:()=>x(t()),onSome:r=>x(r===void 0?t():r)}),jI=e=>_j(e,jI,t=>{let r=jI(t.to);if(r)return new En(t.from,r,t.transformation)}),Lae=u(2,(e,t)=>{let r=e.ast;switch(r._tag){case"PropertySignatureDeclaration":{let n=gt(r.type);return sc(new Ci(new Uu(r.type,r.isOptional,r.isReadonly,r.annotations),new Ca(jI(n)??n,!1,!0,{},r.defaultValue),o=>rae(o,t),R))}case"PropertySignatureTransformation":{let n=r.to.type;return sc(new Ci(r.from,new Ca(jI(n)??n,!1,r.to.isReadonly,r.to.annotations,r.to.defaultValue),o=>rae(r.decode(o),t),r.encode))}}}),uAe=u(2,(e,t)=>e.pipe(Lae(t.decoding),Fl(t.constructor))),pAe=u(2,(e,t)=>{let r=e.ast;switch(r._tag){case"PropertySignatureDeclaration":return sc(new Ci(new Uu(r.type,r.isOptional,r.isReadonly,r.annotations,t),new Ca(gt(r.type),r.isOptional,r.isReadonly,{},r.defaultValue),R,R));case"PropertySignatureTransformation":return sc(new Ci(new Uu(r.from.type,r.from.isOptional,r.from.isReadonly,r.from.annotations,t),r.to,r.decode,r.encode))}}),Fu=(e,t,r)=>sc(new Ci(new Uu(e.ast,!0,!0,{},void 0),new Ca(t.ast,!1,!0,{},void 0),n=>x(r.decode(n)),kr(r.encode))),lAe=(e,t,r)=>sc(new Ci(new Uu(e.ast,!1,!0,{},void 0),new Ca(t.ast,!0,!0,{},void 0),kr(r.decode),n=>x(r.encode(n)))),WH=(e,t,r)=>sc(new Ci(new Uu(e.ast,!0,!0,{},void 0),new Ca(t.ast,!0,!0,{},void 0),r.decode,r.encode)),fAe=(e,t)=>{let r=t?.exact,n=t?.default,o=t?.nullable,s=t?.as=="Option",i=t?.onNoneEncoding?yo(t.onNoneEncoding):R;if(r){if(n)return o?Fl(Fu(P0(e),ye(e),{decode:$({onNone:n,onSome:a=>a===null?n():a}),encode:x}),n).ast:Fl(Fu(e,ye(e),{decode:$({onNone:n,onSome:R}),encode:x}),n).ast;if(s){let a=BW(ye(e));return o?Fu(P0(e),a,{decode:Qu(iE),encode:i}).ast:Fu(e,a,{decode:R,encode:R}).ast}else return o?WH(P0(e),ye(e),{decode:Qu(iE),encode:R}).ast:new Lu(e.ast,!0,!0,{},void 0)}else{if(n)return o?Fl(Fu(F0(e),ye(e),{decode:$({onNone:n,onSome:a=>a??n()}),encode:x}),n).ast:Fl(Fu(eh(e),ye(e),{decode:$({onNone:n,onSome:a=>a===void 0?n():a}),encode:x}),n).ast;if(s){let a=BW(ye(e));return o?Fu(F0(e),a,{decode:Qu(c=>c!=null),encode:i}).ast:Fu(eh(e),a,{decode:Qu(GB),encode:i}).ast}else return o?WH(F0(e),eh(ye(e)),{decode:Qu(iE),encode:R}).ast:new Lu(eh(e).ast,!0,!0,{},void 0)}},dAe=e=>{let t=e.ast===lf||e.ast===Zg?lf:eh(e).ast;return new H0(new Lu(t,!0,!0,{},void 0),e)},hAe=u(e=>gn(e[0]),(e,t)=>new H0(fAe(e,t),e)),mAe=LA([nC]),xAe=(e,t)=>{let r=Reflect.ownKeys(e),n=[];if(r.length>0){let s=[],i=[],a=[];for(let c=0;c<r.length;c++){let l=r[c],f=e[l];if(m1(f)){let d=f.ast;switch(d._tag){case"PropertySignatureDeclaration":{let h=d.type,m=d.isOptional,y=d.annotations;s.push(new It(l,h,m,!0,mAe(d))),i.push(new It(l,gt(h),m,!0,y)),n.push(new It(l,h,m,!0,y));break}case"PropertySignatureTransformation":{let h=d.from.fromKey??l;s.push(new It(h,d.from.type,d.from.isOptional,!0,d.from.annotations)),i.push(new It(l,d.to.type,d.to.isOptional,!0,d.to.annotations)),a.push(new zh(h,l,d.decode,d.encode));break}}}else s.push(new It(l,f.ast,!1,!0)),i.push(new It(l,gt(f.ast),!1,!0)),n.push(new It(l,f.ast,!1,!0))}if(ut(a)){let c=[],l=[];for(let f of t){let{indexSignatures:d,propertySignatures:h}=DA(f.key.ast,f.value.ast);h.forEach(m=>{s.push(m),i.push(new It(m.name,gt(m.type),m.isOptional,m.isReadonly,m.annotations))}),d.forEach(m=>{c.push(m),l.push(new Oc(m.parameter,gt(m.type),m.isReadonly))})}return new En(new nn(s,c,{[cp]:"Struct (Encoded side)"}),new nn(i,l,{[cp]:"Struct (Type side)"}),new kc(a))}}let o=[];for(let s of t){let{indexSignatures:i,propertySignatures:a}=DA(s.key.ast,s.value.ast);a.forEach(c=>n.push(c)),i.forEach(c=>o.push(c))}return new nn(n,o)},Uae=(e,t)=>{let r=Reflect.ownKeys(e);for(let n of r){let o=e[n];if(t[n]===void 0&&m1(o)){let s=o.ast,i=s._tag==="PropertySignatureDeclaration"?s.defaultValue:s.to.defaultValue;i!==void 0&&(t[n]=i())}}return t};function pB(e,t,r=xAe(e,t)){return class extends Te(r){static annotations(o){return pB(this.fields,this.records,ps(this.ast,o))}static fields={...e};static records=[...t];static make=(o,s)=>{let i=Uae(e,{...o});return S1(s)?i:Yd(this)(i)};static pick(...o){return zt(Zie(e,...o))}static omit(...o){return zt(Yie(e,...o))}}}function zt(e,...t){return pB(e,t)}var qae=e=>Bt(e).pipe(pg,Fl(()=>e)),J0=(e,t)=>zt({_tag:qae(e),...t});function Hae(e,t,r){return class extends pB({},[{key:e,value:t}],r){static annotations(o){return Hae(e,t,ps(this.ast,o))}static key=e;static value=t}}var lB=e=>Hae(e.key,e.value),Wae=(...e)=>t=>Te(Li(t.ast,e)),gAe=(...e)=>t=>Te(Ej(t.ast,e)),bAe=u(2,(e,t)=>{let r=af(gt(e.ast),t),n=Te(r.isOptional?zg(r.type):r.type);return me(e.pipe(Wae(t)),n,{strict:!0,decode:s=>s[t],encode:s=>r.isOptional&&s===void 0?{}:{[t]:s}})});function fB(e,t){return class extends Te(t){static annotations(n){return fB(this.from,ps(this.ast,n))}static make=(n,o)=>S1(o)?n:Yd(this)(n);static from=e}}var yAe=(e,t)=>r=>{let n=$(OA(r.ast),{onNone:()=>[e],onSome:s=>[...s,e]}),o=tb(r.ast,Hu({[fA]:n,...t}));return fB(r,o)},SAe=e=>Te(cf(e.ast)),EAe=u(e=>gn(e[0]),(e,t)=>Te(cf(e.ast,t))),CAe=e=>Te(Bh(e.ast)),wAe=e=>Te(sf(e.ast)),M0=(e,t,r)=>{if(PA(e)&&PA(t)){let n=[...e.propertySignatures];for(let o of t.propertySignatures){let s=o.name,i=n.findIndex(a=>a.name===s);if(i===-1)n.push(o);else{let{isOptional:a,type:c}=n[i];n[i]=new It(s,$I(c,o.type,r.concat(s)),a,!0)}}return new nn(n,e.indexSignatures.concat(t.indexSignatures))}throw new Error(KR(e,t,r))},OAe=Cj([Gg]),v0=(e,t)=>t.map(r=>new _c(r,e.filter,OAe(e))),$I=(e,t,r)=>Qt.make(Nu([e],[t],r)),Xd=e=>Xg(e)?e.types:[e],Nu=(e,t,r)=>Ql(e,n=>Ql(t,o=>{switch(o._tag){case"Literal":{if(cr(o.literal)&&Yg(n)||go(o.literal)&&MA(n)||_i(o.literal)&&vA(n))return[o];break}case"StringKeyword":{if(o===iC){if(Yg(n)||Ma(n)&&cr(n.literal))return[n];if(pp(n))return v0(n,Nu(Xd(n.from),[o],r))}else if(n===iC)return[o];break}case"NumberKeyword":{if(o===aC){if(MA(n)||Ma(n)&&go(n.literal))return[n];if(pp(n))return v0(n,Nu(Xd(n.from),[o],r))}else if(n===aC)return[o];break}case"BooleanKeyword":{if(o===cC){if(vA(n)||Ma(n)&&_i(n.literal))return[n];if(pp(n))return v0(n,Nu(Xd(n.from),[o],r))}else if(n===cC)return[o];break}case"Union":return Nu(Xd(n),o.types,r);case"Suspend":return[new js(()=>$I(n,o.f(),r))];case"Refinement":return v0(o,Nu(Xd(n),Xd(o.from),r));case"TypeLiteral":{switch(n._tag){case"Union":return Nu(n.types,[o],r);case"Suspend":return[new js(()=>$I(n.f(),o,r))];case"Refinement":return v0(n,Nu(Xd(n.from),[o],r));case"TypeLiteral":return[M0(n,o,r)];case"Transformation":{let s=n.transformation,i=M0(n.from,o,r),a=M0(n.to,gt(o),r);switch(s._tag){case"TypeLiteralTransformation":return[new En(i,a,new kc(s.propertySignatureTransformations))];case"ComposeTransformation":return[new En(i,a,dC)];case"FinalTransformation":return[new En(i,a,new Vg((c,l,f,d)=>In(s.decode(c,l,f,d),h=>({...c,...h})),(c,l,f,d)=>In(s.encode(c,l,f,d),h=>({...c,...h}))))]}}}break}case"Transformation":{if(mj(n)){if(eb(o.transformation)&&eb(n.transformation))return[new En(M0(n.from,o.from,r),M0(n.to,o.to,r),new kc(o.transformation.propertySignatureTransformations.concat(n.transformation.propertySignatureTransformations)))]}else return Nu([o],[n],r);break}}throw new Error(KR(n,o,r))})),Z0=u(2,(e,t)=>Te($I(e.ast,t.ast,[]))),VI=u(e=>gn(e[1]),(e,t)=>hB(e,t,qA(e.ast,t.ast))),GI=e=>Te(new js(()=>e().ast)),dB=Symbol.for("effect/SchemaId/Refine");function Bae(e,t,r){return class extends Te(r){static annotations(o){return Bae(this.from,this.filter,ps(this.ast,o))}static[dB]=e;static from=e;static filter=t;static make=(o,s)=>S1(s)?o:Yd(this)(o)}}var nae=(e,t,r)=>{if(_i(e))return e?g():x(new Oe(t,r));if(cr(e))return x(new Oe(t,r,e));if(e!==void 0){if("_tag"in e)return x(e);let n=new Oe(t,r,e.message);return x(ut(e.path)?new rn(e.path,r,n):n)}return g()},zae=(e,t,r)=>{if(d6(e))return nae(e,t,r);if(ut(e)){let n=hc(e,o=>nae(o,t,r));if(ut(n))return x(n.length===1?n[0]:new mr(t,r,n))}return g()};function Se(e,t){return r=>{function n(s,i,a){return zae(e(s,i,a),a,s)}let o=new _c(r.ast,n,Hu(t));return Bae(r,n,o)}}var _Ae=u(2,(e,t)=>gr(e,ye(e),{strict:!0,decode:(r,n,o)=>Fs(t(r,n,o),s=>$(zae(s,o,r),{onNone:()=>it(r),onSome:xr})),encode:r=>it(r)}));function hB(e,t,r){return class extends Te(r){static annotations(o){return hB(this.from,this.to,ps(this.ast,o))}static from=e;static to=t}}var gr=u(e=>gn(e[0])&&gn(e[1]),(e,t,r)=>hB(e,t,new En(e.ast,t.ast,new Vg(r.decode,r.encode)))),me=u(e=>gn(e[0])&&gn(e[1]),(e,t,r)=>gr(e,t,{strict:!0,decode:(n,o,s,i)=>it(r.decode(n,i)),encode:(n,o,s,i)=>it(r.encode(n,i))}));function jae(e,t){return me(Bt(e),Bt(t),{strict:!0,decode:()=>t,encode:()=>e})}function kAe(...e){return yn(...e.map(([t,r])=>jae(t,r)))}var TAe=u(e=>gn(e[0]),(e,t,r,n)=>{let o=Z0(ye(e),zt({[t]:Oa(r)?Iae(r):Bt(r)})).ast;return Te(new En(e.ast,n?ps(o,n):o,new kc([new zh(t,t,()=>x(r),()=>g())])))}),IAe=u(2,(e,t)=>e.annotations(t)),RAe=u(2,(e,t)=>Te(jg(e.ast,t))),$ae=Symbol.for("effect/SchemaId/Trimmed"),Vae=e=>t=>t.pipe(Se(r=>r===r.trim(),{schemaId:$ae,title:"trimmed",description:"a string with no leading or trailing whitespace",jsonSchema:{pattern:"^\\S[\\s\\S]*\\S$|^\\S$|^$"},...e})),Gae=U6,AAe=(e,t)=>r=>r.pipe(Se(n=>n.length<=e,{schemaId:Gae,title:`maxLength(${e})`,description:`a string at most ${e} character(s) long`,jsonSchema:{maxLength:e},...t})),Kae=L6,Qae=(e,t)=>r=>r.pipe(Se(n=>n.length>=e,{schemaId:Kae,title:`minLength(${e})`,description:`a string at least ${e} character(s) long`,jsonSchema:{minLength:e},...t})),BH=q6,Jae=(e,t)=>r=>{let n=$r(e)?Math.max(0,Math.floor(e.min)):Math.max(0,Math.floor(e)),o=$r(e)?Math.max(n,Math.floor(e.max)):n;return n!==o?r.pipe(Se(s=>s.length>=n&&s.length<=o,{schemaId:BH,title:`length({ min: ${n}, max: ${o})`,description:`a string at least ${n} character(s) and at most ${o} character(s) long`,jsonSchema:{minLength:n,maxLength:o},...t})):r.pipe(Se(s=>s.length===n,{schemaId:BH,title:`length(${n})`,description:n===1?"a single character":`a string ${n} character(s) long`,jsonSchema:{minLength:n,maxLength:n},...t}))},zH=Symbol.for("effect/SchemaId/Pattern"),mB=(e,t)=>r=>{let n=e.source;return r.pipe(Se(o=>(e.lastIndex=0,e.test(o)),{schemaId:zH,[zH]:{regex:e},description:`a string matching the pattern ${n}`,jsonSchema:{pattern:n},...t}))},jH=Symbol.for("effect/SchemaId/StartsWith"),MAe=(e,t)=>r=>{let n=JSON.stringify(e);return r.pipe(Se(o=>o.startsWith(e),{schemaId:jH,[jH]:{startsWith:e},title:`startsWith(${n})`,description:`a string starting with ${n}`,jsonSchema:{pattern:`^${e}`},...t}))},$H=Symbol.for("effect/SchemaId/EndsWith"),vAe=(e,t)=>r=>{let n=JSON.stringify(e);return r.pipe(Se(o=>o.endsWith(e),{schemaId:$H,[$H]:{endsWith:e},title:`endsWith(${n})`,description:`a string ending with ${n}`,jsonSchema:{pattern:`^.*${e}$`},...t}))},VH=Symbol.for("effect/SchemaId/Includes"),PAe=(e,t)=>r=>{let n=JSON.stringify(e);return r.pipe(Se(o=>o.includes(e),{schemaId:VH,[VH]:{includes:e},title:`includes(${n})`,description:`a string including ${n}`,jsonSchema:{pattern:`.*${e}.*`},...t}))},Zae=Symbol.for("effect/SchemaId/Lowercased"),Yae=e=>t=>t.pipe(Se(r=>r===r.toLowerCase(),{schemaId:Zae,title:"lowercased",description:"a lowercase string",jsonSchema:{pattern:"^[^A-Z]*$"},...e})),KI=class extends $e.pipe(Yae({identifier:"Lowercased"})){},Xae=Symbol.for("effect/SchemaId/Uppercased"),ece=e=>t=>t.pipe(Se(r=>r===r.toUpperCase(),{schemaId:Xae,title:"uppercased",description:"an uppercase string",jsonSchema:{pattern:"^[^a-z]*$"},...e})),QI=class extends $e.pipe(ece({identifier:"Uppercased"})){},tce=Symbol.for("effect/SchemaId/Capitalized"),rce=e=>t=>t.pipe(Se(r=>r[0]?.toUpperCase()===r[0],{schemaId:tce,title:"capitalized",description:"a capitalized string",jsonSchema:{pattern:"^[^a-z]?.*$"},...e})),JI=class extends $e.pipe(rce({identifier:"Capitalized"})){},nce=Symbol.for("effect/SchemaId/Uncapitalized"),oce=e=>t=>t.pipe(Se(r=>r[0]?.toLowerCase()===r[0],{schemaId:nce,title:"uncapitalized",description:"a uncapitalized string",jsonSchema:{pattern:"^[^A-Z]?.*$"},...e})),ZI=class extends $e.pipe(oce({identifier:"Uncapitalized"})){},GH=class extends $e.pipe(Jae(1,{identifier:"Char"})){},xB=e=>Qae(1,{title:"nonEmptyString",description:"a non empty string",...e}),KH=class extends me($e.annotations({description:"a string that will be converted to lowercase"}),KI,{strict:!0,decode:t=>t.toLowerCase(),encode:R}).annotations({identifier:"Lowercase"}){},QH=class extends me($e.annotations({description:"a string that will be converted to uppercase"}),QI,{strict:!0,decode:t=>t.toUpperCase(),encode:R}).annotations({identifier:"Uppercase"}){},JH=class extends me($e.annotations({description:"a string that will be converted to a capitalized format"}),JI,{strict:!0,decode:t=>oY(t),encode:R}).annotations({identifier:"Capitalize"}){},ZH=class extends me($e.annotations({description:"a string that will be converted to an uncapitalized format"}),ZI,{strict:!0,decode:t=>sY(t),encode:R}).annotations({identifier:"Uncapitalize"}){},W0=class extends $e.pipe(Vae({identifier:"Trimmed"})){},YI=class extends W0.pipe(xB({identifier:"NonEmptyTrimmedString"})){},YH=class extends me($e.annotations({description:"a string that will be trimmed"}),W0,{strict:!0,decode:t=>t.trim(),encode:R}).annotations({identifier:"Trim"}){},FAe=e=>me($e.annotations({description:"a string that will be split"}),Nt($e),{strict:!0,decode:t=>t.split(e),encode:t=>t.join(e)}),XH=e=>e instanceof Error?e.message:String(e),NAe=e=>gr($e.annotations({description:"a string to be decoded into JSON"}),rh,{strict:!0,decode:(t,r,n)=>cg({try:()=>JSON.parse(t,e?.reviver),catch:o=>new Oe(n,t,XH(o))}),encode:(t,r,n)=>cg({try:()=>JSON.stringify(t,e?.replacer,e?.space),catch:o=>new Oe(n,t,XH(o))})}).annotations({title:"parseJson",schemaId:nj}),sce=(e,t)=>gn(e)?VI(sce(t),e):NAe(e),eW=class extends $e.pipe(xB({identifier:"NonEmptyString"})){},ice=Symbol.for("effect/SchemaId/UUID"),oae=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i,tW=class extends $e.pipe(mB(oae,{schemaId:ice,identifier:"UUID",jsonSchema:{format:"uuid",pattern:oae.source},description:"a Universally Unique Identifier",arbitrary:()=>t=>t.uuid()})){},ace=Symbol.for("effect/SchemaId/ULID"),DAe=/^[0-7][0-9A-HJKMNP-TV-Z]{25}$/i,rW=class extends $e.pipe(mB(DAe,{schemaId:ace,identifier:"ULID",description:"a Universally Unique Lexicographically Sortable Identifier",arbitrary:()=>t=>t.ulid()})){},XI=class extends vae(URL,{identifier:"URLFromSelf",arbitrary:()=>t=>t.webUrl().map(r=>new URL(r)),pretty:()=>t=>t.toString()}){},nW=class extends gr($e.annotations({description:"a string to be decoded into a URL"}),XI,{strict:!0,decode:(t,r,n)=>cg({try:()=>new URL(t),catch:o=>new Oe(n,t,`Unable to decode ${JSON.stringify(t)} into a URL. ${XH(o)}`)}),encode:t=>it(t.toString())}).annotations({identifier:"URL",pretty:()=>t=>t.toString()}){};var cce=R6,gB=e=>t=>t.pipe(Se(Number.isFinite,{schemaId:cce,title:"finite",description:"a finite number",jsonSchema:{},...e})),uce=w6,pce=(e,t)=>r=>r.pipe(Se(n=>n>e,{schemaId:uce,title:`greaterThan(${e})`,description:e===0?"a positive number":`a number greater than ${e}`,jsonSchema:{exclusiveMinimum:e},...t})),lce=O6,fce=(e,t)=>r=>r.pipe(Se(n=>n>=e,{schemaId:lce,title:`greaterThanOrEqualTo(${e})`,description:e===0?"a non-negative number":`a number greater than or equal to ${e}`,jsonSchema:{minimum:e},...t})),dce=Symbol.for("effect/SchemaId/MultipleOf"),LAe=(e,t)=>r=>{let n=Math.abs(e);return r.pipe(Se(o=>j6(o,e)===0,{schemaId:dce,title:`multipleOf(${n})`,description:`a number divisible by ${n}`,jsonSchema:{multipleOf:n},...t}))},hce=T6,bB=e=>t=>t.pipe(Se(r=>Number.isSafeInteger(r),{schemaId:hce,title:"int",description:"an integer",jsonSchema:{type:"integer"},...e})),mce=_6,xce=(e,t)=>r=>r.pipe(Se(n=>n<e,{schemaId:mce,title:`lessThan(${e})`,description:e===0?"a negative number":`a number less than ${e}`,jsonSchema:{exclusiveMaximum:e},...t})),gce=k6,bce=(e,t)=>r=>r.pipe(Se(n=>n<=e,{schemaId:gce,title:`lessThanOrEqualTo(${e})`,description:e===0?"a non-positive number":`a number less than or equal to ${e}`,jsonSchema:{maximum:e},...t})),yce=M6,yB=(e,t,r)=>n=>n.pipe(Se(o=>o>=e&&o<=t,{schemaId:yce,title:`between(${e}, ${t})`,description:`a number between ${e} and ${t}`,jsonSchema:{minimum:e,maximum:t},...r})),Sce=I6,Ece=e=>t=>t.pipe(Se(r=>!Number.isNaN(r),{schemaId:Sce,title:"nonNaN",description:"a number excluding NaN",...e})),Cce=e=>pce(0,{title:"positive",...e}),wce=e=>xce(0,{title:"negative",...e}),Oce=e=>bce(0,{title:"nonPositive",...e}),_ce=e=>fce(0,{title:"nonNegative",...e}),UAe=(e,t)=>r=>me(r,ye(r).pipe(yB(e,t)),{strict:!1,decode:n=>z6(n,{minimum:e,maximum:t}),encode:R});function kce(e){return gr(e,bn,{strict:!1,decode:(t,r,n)=>O0(V6(t),()=>new Oe(n,t,`Unable to decode ${JSON.stringify(t)} into a number`)),encode:t=>it(String(t))})}var e1=class extends kce($e.annotations({description:"a string to be decoded into a number"})).annotations({identifier:"NumberFromString"}){},oW=class extends bn.pipe(gB({identifier:"Finite"})){},B0=class extends bn.pipe(bB({identifier:"Int"})){},sW=class extends bn.pipe(Ece({identifier:"NonNaN"})){},iW=class extends bn.pipe(Cce({identifier:"Positive"})){},aW=class extends bn.pipe(wce({identifier:"Negative"})){},cW=class extends bn.pipe(Oce({identifier:"NonPositive"})){},z0=class extends bn.pipe(_ce({identifier:"NonNegative"})){},Tce=A6,uW=class extends bn.pipe(gB({schemaId:Tce,identifier:"JsonNumber"})){},pW=class extends me(nh.annotations({description:"a boolean that will be negated"}),nh,{strict:!0,decode:t=>nb(t),encode:t=>nb(t)}){},Ice=(e,t)=>{let r=Symbol.keyFor(e);return r===void 0?xr(new Oe(t,e,`Unable to encode a unique symbol ${String(e)} into a string`)):it(r)},Rce=e=>it(Symbol.for(e)),lW=class extends gr($e.annotations({description:"a string to be decoded into a globally shared symbol"}),U0,{strict:!1,decode:t=>Rce(t),encode:(t,r,n)=>Ice(t,n)}).annotations({identifier:"Symbol"}){};var fW=v6,Ace=(e,t)=>r=>r.pipe(Se(n=>n>e,{schemaId:fW,[fW]:{min:e},title:`greaterThanBigInt(${e})`,description:e===0n?"a positive bigint":`a bigint greater than ${e}n`,...t})),dW=P6,Mce=(e,t)=>r=>r.pipe(Se(n=>n>=e,{schemaId:dW,[dW]:{min:e},title:`greaterThanOrEqualToBigInt(${e})`,description:e===0n?"a non-negative bigint":`a bigint greater than or equal to ${e}n`,...t})),hW=F6,vce=(e,t)=>r=>r.pipe(Se(n=>n<e,{schemaId:hW,[hW]:{max:e},title:`lessThanBigInt(${e})`,description:e===0n?"a negative bigint":`a bigint less than ${e}n`,...t})),mW=N6,Pce=(e,t)=>r=>r.pipe(Se(n=>n<=e,{schemaId:mW,[mW]:{max:e},title:`lessThanOrEqualToBigInt(${e})`,description:e===0n?"a non-positive bigint":`a bigint less than or equal to ${e}n`,...t})),xW=D6,SB=(e,t,r)=>n=>n.pipe(Se(o=>o>=e&&o<=t,{schemaId:xW,[xW]:{min:e,max:t},title:`betweenBigInt(${e}, ${t})`,description:`a bigint between ${e}n and ${t}n`,...r})),EB=e=>Ace(0n,{title:"positiveBigInt",...e}),CB=e=>vce(0n,{title:"negativeBigInt",...e}),wB=e=>Mce(0n,{title:"nonNegativeBigInt",...e}),OB=e=>Pce(0n,{title:"nonPositiveBigInt",...e}),qAe=(e,t)=>r=>me(r,r.pipe(ye,SB(e,t)),{strict:!1,decode:n=>Hj(n,{minimum:e,maximum:t}),encode:R}),Ll=class extends gr($e.annotations({description:"a string to be decoded into a bigint"}),Du,{strict:!0,decode:(t,r,n)=>O0(Bj(t),()=>new Oe(n,t,`Unable to decode ${JSON.stringify(t)} into a bigint`)),encode:t=>it(String(t))}).annotations({identifier:"BigInt"}){};var HAe=Du.pipe(EB({identifier:"PositiveBigintFromSelf"})),WAe=Ll.pipe(EB({identifier:"PositiveBigint"})),BAe=Du.pipe(CB({identifier:"NegativeBigintFromSelf"})),zAe=Ll.pipe(CB({identifier:"NegativeBigint"})),jAe=Du.pipe(OB({identifier:"NonPositiveBigintFromSelf"})),$Ae=Ll.pipe(OB({identifier:"NonPositiveBigint"})),Fce=Du.pipe(wB({identifier:"NonNegativeBigintFromSelf"})),VAe=Ll.pipe(wB({identifier:"NonNegativeBigint"})),gW=class extends gr(bn.annotations({description:"a number to be decoded into a bigint"}),Du.pipe(SB(BigInt(Number.MIN_SAFE_INTEGER),BigInt(Number.MAX_SAFE_INTEGER))),{strict:!0,decode:(t,r,n)=>O0(zj(t),()=>new Oe(n,t,`Unable to decode ${t} into a bigint`)),encode:(t,r,n)=>O0(Wj(t),()=>new Oe(n,t,`Unable to encode ${t}n into a number`))}).annotations({identifier:"BigIntFromNumber"}){},GAe=e=>t=>e(t).map(WI),xo=(e,t,r,n)=>kie(e,{onFailure:o=>new mr(r,n,o),onSuccess:t}),sae=e=>(t,r,n)=>Kie(t)?xo(e(A0(t),r),WI,n,t):xr(new Oe(n,t)),Nce=e=>ir([e],{decode:t=>sae(mn(t)),encode:t=>sae(xn(t))},{description:"Redacted(<redacted>)",pretty:()=>()=>"Redacted(<redacted>)",arbitrary:GAe,equivalence:Qie});function KAe(e){return me(e,Nce(ye(e)),{strict:!0,decode:t=>WI(t),encode:t=>A0(t)})}var dg=class extends ir(wC,{identifier:"DurationFromSelf",pretty:()=>String,arbitrary:()=>t=>t.oneof(t.constant(ab),t.bigInt({min:0n}).map(r=>Ks(r)),t.maxSafeNat().map(r=>On(r))),equivalence:()=>lM}){},bW=class extends gr(Fce.annotations({description:"a bigint to be decoded into a Duration"}),dg.pipe(Se(t=>g4(t),{description:"a finite duration"})),{strict:!0,decode:t=>it(Ks(t)),encode:(t,r,n)=>$(b4(t),{onNone:()=>xr(new Oe(n,t,`Unable to encode ${t} into a bigint`)),onSome:o=>it(o)})}).annotations({identifier:"DurationFromNanos"}){},t1=z0.pipe(bB()).annotations({identifier:"NonNegativeInt"}),yW=class extends me(z0.annotations({description:"a non-negative number to be decoded into a Duration"}),dg,{strict:!0,decode:t=>On(t),encode:t=>Qr(t)}).annotations({identifier:"DurationFromMillis"}){},Dce=J0("Millis",{millis:t1}),Lce=J0("Nanos",{nanos:Ll}),Uce=J0("Infinity",{}),QAe=Uce.make({}),JAe=yn(Dce,Lce,Uce).annotations({identifier:"DurationValue",description:"an JSON-compatible tagged union to be decoded into a Duration"}),ZAe=Ei(qH(t1).annotations({title:"seconds"}),qH(t1).annotations({title:"nanos"})).annotations({identifier:"FiniteHRTime"}),YAe=Ei(Bt(-1),Bt(0)).annotations({identifier:"InfiniteHRTime"}),XAe=yn(ZAe,YAe).annotations({identifier:"HRTime",description:"a tuple of seconds and nanos to be decoded into a Duration"}),eMe=e=>typeof e=="object",SW=class extends me(yn(JAe,XAe),dg,{strict:!0,decode:t=>{if(eMe(t))switch(t._tag){case"Millis":return On(t.millis);case"Nanos":return Ks(t.nanos);case"Infinity":return ab}let[r,n]=t;return r===-1?ab:Ks(BigInt(r)*BigInt(1e9)+BigInt(n))},encode:t=>{switch(t.value._tag){case"Millis":return Dce.make({millis:t.value.millis});case"Nanos":return Lce.make({nanos:t.value.nanos});case"Infinity":return QAe}}}).annotations({identifier:"Duration"}){},tMe=(e,t)=>r=>me(r,r.pipe(ye,qce(e,t)),{strict:!1,decode:n=>E4(n,{minimum:e,maximum:t}),encode:R}),j0=Symbol.for("effect/SchemaId/LessThanDuration"),rMe=(e,t)=>r=>r.pipe(Se(n=>fM(n,e),{schemaId:j0,[j0]:{max:e},title:`lessThanDuration(${e})`,description:`a Duration less than ${Qe(e)}`,...t})),nMe=Symbol.for("effect/schema/LessThanOrEqualToDuration"),oMe=(e,t)=>r=>r.pipe(Se(n=>OC(n,e),{schemaId:j0,[j0]:{max:e},title:`lessThanOrEqualToDuration(${e})`,description:`a Duration less than or equal to ${Qe(e)}`,...t})),EW=Symbol.for("effect/SchemaId/GreaterThanDuration"),sMe=(e,t)=>r=>r.pipe(Se(n=>_C(n,e),{schemaId:EW,[EW]:{min:e},title:`greaterThanDuration(${e})`,description:`a Duration greater than ${Qe(e)}`,...t})),CW=Symbol.for("effect/schema/GreaterThanOrEqualToDuration"),iMe=(e,t)=>r=>r.pipe(Se(n=>cb(n,e),{schemaId:CW,[CW]:{min:e},title:`greaterThanOrEqualToDuration(${e})`,description:`a Duration greater than or equal to ${Qe(e)}`,...t})),wW=Symbol.for("effect/SchemaId/BetweenDuration"),qce=(e,t,r)=>n=>n.pipe(Se(o=>S4(o,{minimum:e,maximum:t}),{schemaId:wW,[wW]:{maximum:t,minimum:e},title:`betweenDuration(${e}, ${t})`,description:`a Duration between ${Qe(e)} and ${Qe(t)}`,...r})),$0=class extends ir(JB,{identifier:"Uint8ArrayFromSelf",pretty:()=>t=>`new Uint8Array(${JSON.stringify(Array.from(t))})`,arbitrary:()=>t=>t.uint8Array(),equivalence:()=>Mn(N)}){},r1=class extends bn.pipe(yB(0,255,{identifier:"Uint8",description:"a 8-bit unsigned integer"})){},OW=class extends me(Nt(r1).annotations({description:"an array of 8-bit unsigned integers to be decoded into a Uint8Array"}),$0,{strict:!0,decode:t=>Uint8Array.from(t),encode:t=>Array.from(t)}).annotations({identifier:"Uint8Array"}){};var _B=(e,t,r)=>gr($e.annotations({description:"a string to be decoded into a Uint8Array"}),$0,{strict:!0,decode:(n,o,s)=>Hs(t(n),i=>new Oe(s,n,i.message)),encode:n=>it(r(n))}).annotations({identifier:e}),aMe=_B("Uint8ArrayFromBase64",lH,pH),cMe=_B("Uint8ArrayFromBase64Url",dH,fH),uMe=_B("Uint8ArrayFromHex",mH,hH),kB=(e,t,r)=>gr($e.annotations({description:`A string that is interpreted as being ${e}-encoded and will be decoded into a UTF-8 string`}),$e,{strict:!0,decode:(n,o,s)=>Hs(t(n),i=>new Oe(s,n,i.message)),encode:n=>it(r(n))}).annotations({identifier:`StringFrom${e}`}),pMe=kB("Base64",die,pH),lMe=kB("Base64Url",hie,fH),fMe=kB("Hex",mie,hH),dMe=gr($e.annotations({description:"A string that is interpreted as being UriComponent-encoded and will be decoded into a UTF-8 string"}),$e,{strict:!0,decode:(e,t,r)=>Hs(gie(e),n=>new Oe(r,e,n.message)),encode:(e,t,r)=>Hs(xie(e),n=>new Oe(r,e,n.message))}).annotations({identifier:"StringFromUriComponent"}),Hce=H6,hMe=(e,t)=>r=>{let n=Math.floor(e);if(n<1)throw new Error(XE(`Expected an integer greater than or equal to 1, actual ${e}`));return r.pipe(Se(o=>o.length>=n,{schemaId:Hce,title:`minItems(${n})`,description:`an array of at least ${n} item(s)`,jsonSchema:{minItems:n},[Qg]:!0,...t}))},Wce=W6,mMe=(e,t)=>r=>{let n=Math.floor(e);if(n<1)throw new Error(XE(`Expected an integer greater than or equal to 1, actual ${e}`));return r.pipe(Se(o=>o.length<=n,{schemaId:Wce,title:`maxItems(${n})`,description:`an array of at most ${n} item(s)`,jsonSchema:{maxItems:n},[Qg]:!0,...t}))},Bce=B6,xMe=(e,t)=>r=>{let n=Math.floor(e);if(n<0)throw new Error(XE(`Expected an integer greater than or equal to 0, actual ${e}`));return r.pipe(Se(o=>o.length===n,{schemaId:Bce,title:`itemsCount(${n})`,description:`an array of exactly ${n} item(s)`,jsonSchema:{minItems:n,maxItems:n},[Qg]:!0,...t}))},x1=e=>Te(Bg(e.ast));function gMe(e){return me(e,ih(x1(ye(e))),{strict:!1,decode:t=>Ia(t),encode:t=>$(t,{onNone:()=>[],onSome:Gr})})}function bMe(e){return me(e,x1(ye(e)),{strict:!1,decode:t=>Ur(t),encode:t=>Gr(t)})}var yMe=u(e=>gn(e[0]),(e,t)=>gr(e,x1(ye(e)),{strict:!0,decode:(r,n,o)=>r.length>0?it(r[0]):t?it(t()):xr(new Oe(o,r,"Unable to retrieve the first element of an empty array")),encode:r=>it(Gr(r))})),_W=Symbol.for("effect/SchemaId/ValidDate"),TB=e=>t=>t.pipe(Se(r=>!Number.isNaN(r.getTime()),{schemaId:_W,[_W]:{noInvalidDate:!0},title:"validDate",description:"a valid Date",...e})),kW=Symbol.for("effect/SchemaId/LessThanDate"),SMe=(e,t)=>r=>r.pipe(Se(n=>n<e,{schemaId:kW,[kW]:{max:e},title:`lessThanDate(${bo(e)})`,description:`a date before ${bo(e)}`,...t})),TW=Symbol.for("effect/schema/LessThanOrEqualToDate"),EMe=(e,t)=>r=>r.pipe(Se(n=>n<=e,{schemaId:TW,[TW]:{max:e},title:`lessThanOrEqualToDate(${bo(e)})`,description:`a date before or equal to ${bo(e)}`,...t})),IW=Symbol.for("effect/SchemaId/GreaterThanDate"),CMe=(e,t)=>r=>r.pipe(Se(n=>n>e,{schemaId:IW,[IW]:{min:e},title:`greaterThanDate(${bo(e)})`,description:`a date after ${bo(e)}`,...t})),RW=Symbol.for("effect/schema/GreaterThanOrEqualToDate"),wMe=(e,t)=>r=>r.pipe(Se(n=>n>=e,{schemaId:RW,[RW]:{min:e},title:`greaterThanOrEqualToDate(${bo(e)})`,description:`a date after or equal to ${bo(e)}`,...t})),AW=Symbol.for("effect/SchemaId/BetweenDate"),OMe=(e,t,r)=>n=>n.pipe(Se(o=>o<=t&&o>=e,{schemaId:AW,[AW]:{max:t,min:e},title:`betweenDate(${bo(e)}, ${bo(t)})`,description:`a date between ${bo(e)} and ${bo(t)}`,...r})),MW=C6,oh=class extends ir(aE,{identifier:"DateFromSelf",schemaId:MW,[MW]:{noInvalidDate:!1},description:"a potentially invalid Date instance",pretty:()=>t=>`new Date(${JSON.stringify(t)})`,arbitrary:()=>t=>t.date({noInvalidDate:!1}),equivalence:()=>HB}){},vW=class extends oh.pipe(TB({identifier:"ValidDateFromSelf",description:"a valid Date instance"})){},n1=class extends me($e.annotations({description:"a string to be decoded into a Date"}),oh,{strict:!0,decode:t=>new Date(t),encode:t=>bo(t)}).annotations({identifier:"DateFromString"}){},PW=class extends n1.pipe(TB({identifier:"Date"})){};var FW=class extends me(bn.annotations({description:"a number to be decoded into a Date"}),oh,{strict:!0,decode:t=>new Date(t),encode:t=>t.getTime()}).annotations({identifier:"DateFromNumber"}){},hg=class extends ir(t=>tH(t)&&Kse(t),{identifier:"DateTimeUtcFromSelf",description:"a DateTime.Utc instance",pretty:()=>t=>t.toString(),arbitrary:()=>t=>t.date({noInvalidDate:!0}).map(r=>Jse(r)),equivalence:()=>rH}){},IB=(e,t)=>cg({try:()=>Zse(e),catch:()=>new Oe(t,e,`Unable to decode ${Ho(e)} into a DateTime.Utc`)}),NW=class extends gr(bn.annotations({description:"a number to be decoded into a DateTime.Utc"}),hg,{strict:!0,decode:(t,r,n)=>IB(t,n),encode:t=>it(nie(t))}).annotations({identifier:"DateTimeUtcFromNumber"}){},DW=class extends gr(oh.annotations({description:"a Date to be decoded into a DateTime.Utc"}),hg,{strict:!0,decode:(t,r,n)=>IB(t,n),encode:t=>it(rie(t))}).annotations({identifier:"DateTimeUtcFromDate"}){},LW=class extends gr($e.annotations({description:"a string to be decoded into a DateTime.Utc"}),hg,{strict:!0,decode:(t,r,n)=>IB(t,n),encode:t=>it(oie(t))}).annotations({identifier:"DateTimeUtc"}){},zce=()=>e=>e.integer({min:-720*60*1e3,max:840*60*1e3}).map(oH),V0=class extends ir(Vse,{identifier:"TimeZoneOffsetFromSelf",description:"a TimeZone.Offset instance",pretty:()=>t=>t.toString(),arbitrary:zce}){},UW=class extends me(bn.annotations({description:"a number to be decoded into a TimeZone.Offset"}),V0,{strict:!0,decode:t=>oH(t),encode:t=>t.offset}).annotations({identifier:"TimeZoneOffset"}){},jce=()=>e=>e.constantFrom(...Intl.supportedValuesOf("timeZone")).map(nH),G0=class extends ir(Gse,{identifier:"TimeZoneNamedFromSelf",description:"a TimeZone.Named instance",pretty:()=>t=>t.toString(),arbitrary:jce}){},qW=class extends gr($e.annotations({description:"a string to be decoded into a TimeZone.Named"}),G0,{strict:!0,decode:(t,r,n)=>cg({try:()=>nH(t),catch:()=>new Oe(n,t,`Unable to decode ${JSON.stringify(t)} into a TimeZone.Named`)}),encode:t=>it(t.id)}).annotations({identifier:"TimeZoneNamed"}){},o1=class extends yn(V0,G0){},HW=class extends gr($e.annotations({description:"a string to be decoded into a TimeZone"}),o1,{strict:!0,decode:(t,r,n)=>$(eie(t),{onNone:()=>xr(new Oe(n,t,`Unable to decode ${JSON.stringify(t)} into a TimeZone`)),onSome:it}),encode:t=>it(tie(t))}).annotations({identifier:"TimeZone"}){},_Me=e=>e.oneof(zce()(e),jce()(e)),s1=class extends ir(t=>tH(t)&&Qse(t),{identifier:"DateTimeZonedFromSelf",description:"a DateTime.Zoned instance",pretty:()=>t=>t.toString(),arbitrary:()=>t=>t.tuple(t.integer({min:-31536e9,max:31536e9}),_Me(t)).map(([r,n])=>Yse(r,{timeZone:n})),equivalence:()=>rH}){},WW=class extends gr($e.annotations({description:"a string to be decoded into a DateTime.Zoned"}),s1,{strict:!0,decode:(t,r,n)=>$(Xse(t),{onNone:()=>xr(new Oe(n,t,`Unable to decode ${JSON.stringify(t)} into a DateTime.Zoned`)),onSome:it}),encode:t=>it(sie(t))}).annotations({identifier:"DateTimeZoned"}){},kMe=zt({_tag:Bt("None")}).annotations({description:"NoneEncoded"}),TMe=e=>zt({_tag:Bt("Some"),value:e}).annotations({description:`SomeEncoded<${Ft(e)}>`}),IMe=e=>yn(kMe,TMe(e)).annotations({description:`OptionEncoded<${Ft(e)}>`}),$ce=e=>e._tag==="None"?g():x(e.value),RMe=(e,t)=>r=>r.oneof(t,r.record({_tag:r.constant("None")}),r.record({_tag:r.constant("Some"),value:e(r)})).map($ce),AMe=e=>$({onNone:()=>"none()",onSome:t=>`some(${e(t)})`}),iae=e=>(t,r,n)=>SE(t)?ge(t)?it(g()):xo(e(t.value,r),x,n,t):xr(new Oe(n,t)),BW=e=>ir([e],{decode:t=>iae(mn(t)),encode:t=>iae(xn(t))},{pretty:AMe,arbitrary:RMe,equivalence:Q1}),ih=e=>BW(e).annotations({description:`Option<${Ft(e)}>`}),MMe={_tag:"None"},vMe=e=>({_tag:"Some",value:e});function PMe(e){let t=e;return me(IMe(t),ih(ye(t)),{strict:!0,decode:n=>$ce(n),encode:n=>$(n,{onNone:()=>MMe,onSome:vMe})})}function FMe(e){return me(P0(e),ih(ye(e)),{strict:!0,decode:t=>br(t),encode:t=>EE(t)})}function NMe(e,t){return me(F0(e),ih(ye(e)),{strict:!0,decode:r=>br(r),encode:t===null?r=>EE(r):r=>yr(r)})}function DMe(e){return me(eh(e),ih(ye(e)),{strict:!0,decode:t=>br(t),encode:t=>yr(t)})}var zW=class extends me($e,ih(YI),{strict:!0,decode:t=>Qu(x(t.trim()),iY),encode:t=>_e(t,()=>"")}){},Vce=e=>zt({_tag:Bt("Right"),right:e}).annotations({description:`RightEncoded<${Ft(e)}>`}),Gce=e=>zt({_tag:Bt("Left"),left:e}).annotations({description:`LeftEncoded<${Ft(e)}>`}),LMe=(e,t)=>yn(Vce(e),Gce(t)).annotations({description:`EitherEncoded<${Ft(t)}, ${Ft(e)}>`}),Kce=e=>e._tag==="Left"?V(e.left):Y(e.right),UMe=(e,t)=>r=>r.oneof(r.record({_tag:r.constant("Left"),left:t(r)}),r.record({_tag:r.constant("Right"),right:e(r)})).map(Kce),qMe=(e,t)=>Xe({onLeft:r=>`left(${t(r)})`,onRight:r=>`right(${e(r)})`}),aae=(e,t)=>(r,n,o)=>gE(r)?Xe(r,{onLeft:s=>xo(t(s,n),V,o,r),onRight:s=>xo(e(s,n),Y,o,r)}):xr(new Oe(o,r)),RB=({left:e,right:t})=>ir([t,e],{decode:(r,n)=>aae(mn(r),mn(n)),encode:(r,n)=>aae(xn(r),xn(n))},{description:`Either<${Ft(t)}, ${Ft(e)}>`,pretty:qMe,arbitrary:UMe,equivalence:(r,n)=>mz({left:n,right:r})}),jW=e=>({_tag:"Left",left:e}),$W=e=>({_tag:"Right",right:e}),HMe=({left:e,right:t})=>{let r=t,n=e;return me(LMe(r,n),RB({left:ye(n),right:ye(r)}),{strict:!0,decode:s=>Kce(s),encode:s=>Xe(s,{onLeft:jW,onRight:$W})})},WMe=({left:e,right:t})=>{let r=t,n=e,o=ye(r),s=ye(n),i=me(r,Vce(o),{strict:!0,decode:l=>$W(l),encode:l=>l.right}),a=me(n,Gce(s),{strict:!0,decode:l=>jW(l),encode:l=>l.left});return me(yn(i,a),RB({left:s,right:o}),{strict:!0,decode:l=>l._tag==="Left"?V(l.left):Y(l.right),encode:l=>Xe(l,{onLeft:jW,onRight:$W})})},BMe=(e,t,r)=>n=>{let o=n.array(n.tuple(e(n),t(n)));return(r.depthIdentifier!==void 0?n.oneof(r,n.constant([]),o):o).map(s=>new Map(s))},zMe=(e,t)=>r=>`new Map([${Array.from(r.entries()).map(([n,o])=>`[${e(n)}, ${t(o)}]`).join(", ")}])`,jMe=(e,t)=>{let r=Mn(ar(([n,o],[s,i])=>e(n,s)&&t(o,i)));return ar((n,o)=>r(Array.from(n.entries()),Array.from(o.entries())))},cae=e=>(t,r,n)=>$B(t)?xo(e(Array.from(t.entries()),r),o=>new Map(o),n,t):xr(new Oe(n,t)),Qce=(e,t,r)=>ir([e,t],{decode:(n,o)=>cae(mn(Nt(Ei(n,o)))),encode:(n,o)=>cae(xn(Nt(Ei(n,o))))},{description:r,pretty:zMe,arbitrary:BMe,equivalence:jMe}),AB=({key:e,value:t})=>Qce(e,t,`ReadonlyMap<${Ft(e)}, ${Ft(t)}>`),MB=({key:e,value:t})=>Qce(e,t,`Map<${Ft(e)}, ${Ft(t)}>`);function $Me({key:e,value:t}){return me(Nt(Ei(e,t)),AB({key:ye(e),value:ye(t)}),{strict:!0,decode:r=>new Map(r),encode:r=>Array.from(r.entries())})}function VMe({key:e,value:t}){return me(Nt(Ei(e,t)),MB({key:ye(e),value:ye(t)}),{strict:!0,decode:r=>new Map(r),encode:r=>Array.from(r.entries())})}var GMe=({key:e,value:t})=>me(lB({key:aB(e),value:t}).annotations({description:"a record to be decoded into a ReadonlyMap"}),AB({key:e,value:ye(t)}),{strict:!0,decode:r=>new Map(Object.entries(r)),encode:r=>Object.fromEntries(r)}),KMe=({key:e,value:t})=>me(lB({key:aB(e),value:t}).annotations({description:"a record to be decoded into a Map"}),MB({key:e,value:ye(t)}),{strict:!0,decode:r=>new Map(Object.entries(r)),encode:r=>Object.fromEntries(r)}),QMe=(e,t)=>r=>{let n=r.array(e(r));return(t.depthIdentifier!==void 0?r.oneof(t,r.constant([]),n):n).map(o=>new Set(o))},JMe=e=>t=>`new Set([${Array.from(t.values()).map(r=>e(r)).join(", ")}])`,ZMe=e=>{let t=Mn(e);return ar((r,n)=>t(Array.from(r.values()),Array.from(n.values())))},uae=e=>(t,r,n)=>jB(t)?xo(e(Array.from(t.values()),r),o=>new Set(o),n,t):xr(new Oe(n,t)),Jce=(e,t)=>ir([e],{decode:r=>uae(mn(Nt(r))),encode:r=>uae(xn(Nt(r)))},{description:t,pretty:JMe,arbitrary:QMe,equivalence:ZMe}),Zce=e=>Jce(e,`ReadonlySet<${Ft(e)}>`),Yce=e=>Jce(e,`Set<${Ft(e)}>`);function YMe(e){return me(Nt(e),Zce(ye(e)),{strict:!0,decode:t=>new Set(t),encode:t=>Array.from(t)})}function XMe(e){return me(Nt(e),Yce(ye(e)),{strict:!0,decode:t=>new Set(t),encode:t=>Array.from(t)})}var eve=()=>e=>`BigDecimal(${Wi(ff(e))})`,tve=()=>e=>e.tuple(e.bigInt(),e.integer({min:0,max:18})).map(([t,r])=>lp(t,r)),qu=class extends ir(zA,{identifier:"BigDecimalFromSelf",pretty:eve,arbitrary:tve,equivalence:()=>jA}){},VW=class extends gr($e.annotations({description:"a string to be decoded into a BigDecimal"}),qu,{strict:!0,decode:(t,r,n)=>$A(t).pipe($({onNone:()=>xr(new Oe(n,t,`Unable to decode ${JSON.stringify(t)} into a BigDecimal`)),onSome:o=>it(ff(o))})),encode:t=>it(Wi(ff(t)))}).annotations({identifier:"BigDecimal"}){},GW=class extends me(bn.annotations({description:"a number to be decoded into a BigDecimal"}),qu,{strict:!0,decode:t=>Dj(t),encode:t=>Lj(t)}).annotations({identifier:"BigDecimalFromNumber"}){},KW=Symbol.for("effect/SchemaId/GreaterThanBigDecimal"),rve=(e,t)=>r=>{let n=Wi(e);return r.pipe(Se(o=>vj(o,e),{schemaId:KW,[KW]:{min:e},title:`greaterThanBigDecimal(${n})`,description:`a BigDecimal greater than ${n}`,...t}))},QW=Symbol.for("effect/schema/GreaterThanOrEqualToBigDecimal"),nve=(e,t)=>r=>{let n=Wi(e);return r.pipe(Se(o=>Pj(o,e),{schemaId:QW,[QW]:{min:e},title:`greaterThanOrEqualToBigDecimal(${n})`,description:`a BigDecimal greater than or equal to ${n}`,...t}))},JW=Symbol.for("effect/SchemaId/LessThanBigDecimal"),ove=(e,t)=>r=>{let n=Wi(e);return r.pipe(Se(o=>Aj(o,e),{schemaId:JW,[JW]:{max:e},title:`lessThanBigDecimal(${n})`,description:`a BigDecimal less than ${n}`,...t}))},ZW=Symbol.for("effect/schema/LessThanOrEqualToBigDecimal"),sve=(e,t)=>r=>{let n=Wi(e);return r.pipe(Se(o=>Mj(o,e),{schemaId:ZW,[ZW]:{max:e},title:`lessThanOrEqualToBigDecimal(${n})`,description:`a BigDecimal less than or equal to ${n}`,...t}))},Xce=Symbol.for("effect/schema/PositiveBigDecimal"),eue=e=>t=>t.pipe(Se(r=>Uj(r),{schemaId:Xce,title:"positiveBigDecimal",description:"a positive BigDecimal",...e})),ive=qu.pipe(eue({identifier:"PositiveBigDecimalFromSelf"})),tue=Symbol.for("effect/schema/NonNegativeBigDecimal"),rue=e=>t=>t.pipe(Se(r=>r.value>=0n,{schemaId:tue,title:"nonNegativeBigDecimal",description:"a non-negative BigDecimal",...e})),ave=qu.pipe(rue({identifier:"NonNegativeBigDecimalFromSelf"})),nue=Symbol.for("effect/schema/NegativeBigDecimal"),oue=e=>t=>t.pipe(Se(r=>VA(r),{schemaId:nue,title:"negativeBigDecimal",description:"a negative BigDecimal",...e})),cve=qu.pipe(oue({identifier:"NegativeBigDecimalFromSelf"})),sue=Symbol.for("effect/schema/NonPositiveBigDecimal"),iue=e=>t=>t.pipe(Se(r=>r.value<=0n,{schemaId:sue,title:"nonPositiveBigDecimal",description:"a non-positive BigDecimal",...e})),uve=qu.pipe(iue({identifier:"NonPositiveBigDecimalFromSelf"})),YW=Symbol.for("effect/SchemaId/BetweenBigDecimal"),aue=(e,t,r)=>n=>{let o=Wi(e),s=Wi(t);return n.pipe(Se(i=>Fj(i,{minimum:e,maximum:t}),{schemaId:YW,[YW]:{maximum:t,minimum:e},title:`betweenBigDecimal(${o}, ${s})`,description:`a BigDecimal between ${o} and ${s}`,...r}))},pve=(e,t)=>r=>me(r,r.pipe(ye,aue(e,t)),{strict:!1,decode:n=>Nj(n,{minimum:e,maximum:t}),encode:R}),lve=(e,t)=>r=>{let n=r.array(e(r));return(t.depthIdentifier!==void 0?r.oneof(t,r.constant([]),n):n).map(pt)},fve=e=>t=>`Chunk(${Zt(t).map(e).join(", ")})`,pae=e=>(t,r,n)=>df(t)?le(t)?it(ee()):xo(e(Zt(t),r),pt,n,t):xr(new Oe(n,t)),cue=e=>ir([e],{decode:t=>pae(mn(Nt(t))),encode:t=>pae(xn(Nt(t)))},{description:`Chunk<${Ft(e)}>`,pretty:fve,arbitrary:lve,equivalence:bC});function dve(e){return me(Nt(e),cue(ye(e)),{strict:!0,decode:t=>t.length===0?ee():pt(t),encode:t=>Zt(t)})}var hve=e=>t=>qr(e(t),{minLength:1}).map(r=>sb(r)),mve=e=>t=>`NonEmptyChunk(${Zt(t).map(e).join(", ")})`,lae=e=>(t,r,n)=>df(t)&&Vt(t)?xo(e(Zt(t),r),sb,n,t):xr(new Oe(n,t)),uue=e=>ir([e],{decode:t=>lae(mn(fg(t))),encode:t=>lae(xn(fg(t)))},{description:`NonEmptyChunk<${Ft(e)}>`,pretty:mve,arbitrary:hve,equivalence:bC});function xve(e){return me(fg(e),uue(ye(e)),{strict:!0,decode:t=>sb(t),encode:t=>Zt(t)})}var vB=e=>Array.isArray(e)?zZ(e):BZ(e),gve=e=>t=>e(t).map(vB),bve=e=>t=>`Data(${e(t)})`,fae=e=>(t,r,n)=>ju(t)?xo(e(t,r),vB,n,t):xr(new Oe(n,t)),pue=e=>ir([e],{decode:t=>fae(mn(t)),encode:t=>fae(xn(t))},{description:`Data<${Ft(e)}>`,pretty:bve,arbitrary:gve}),yve=e=>me(e,pue(ye(e)),{strict:!1,decode:t=>vB(t),encode:t=>Array.isArray(t)?Array.from(t):Object.assign({},t)}),Sve=e=>gn(e)||m1(e),lue=e=>Reflect.ownKeys(e).every(t=>Sve(e[t])),PB=e=>"fields"in e?e.fields:PB(e[dB]),g1=e=>lue(e)?zt(e):gn(e)?e:zt(PB(e)),b1=e=>lue(e)?e:PB(e),Eve=e=>(t,r)=>th({kind:"Class",identifier:e,schema:g1(t),fields:b1(t),Base:kN,annotations:r}),y1=e=>Fl(pg(Bt(e)),()=>e),Cve=e=>(t,r,n)=>{let o=b1(r),s=g1(r),i={_tag:y1(t)},a=lg(i,o);return class extends th({kind:"TaggedClass",identifier:e??t,schema:Z0(s,zt(i)),fields:a,Base:kN,annotations:n}){static _tag=t}},wve=e=>(t,r,n)=>{class o extends TN{}o.prototype.name=t;let s=b1(r),i=g1(r),a={_tag:y1(t)},c=lg(a,s),l="message"in c;class f extends th({kind:"TaggedError",identifier:e??t,schema:Z0(i,zt(a)),fields:c,Base:o,annotations:n,disableToString:!0}){static _tag=t}return l||Object.defineProperty(f.prototype,"message",{get(){return`{ ${Reflect.ownKeys(s).map(d=>`${$u(d)}: ${Ho(this[d])}`).join(", ")} }`},enumerable:!1,configurable:!0}),f},lg=(e,t)=>{let r={...e};for(let n of Reflect.ownKeys(t)){if(n in e)throw new Error(eC(n));r[n]=t[n]}return r};function S1(e){return _i(e)?e:e?.disableValidation??!1}var dae=ne("effect/Schema/astCache",()=>new WeakMap),Ove=e=>e===void 0?[]:Array.isArray(e)?e:[e],th=({Base:e,annotations:t,disableToString:r,fields:n,identifier:o,kind:s,schema:i})=>{let a=Symbol.for(`effect/Schema/${s}/${o}`),[c,l,f]=Ove(t),d=ye(i),h=d.annotations({identifier:o,...c}),m=d.annotations({[cp]:`${o} (Type side)`,...c}),y=i.annotations({[cp]:`${o} (Constructor)`,...c}),_=i.annotations({[cp]:`${o} (Encoded side)`,...f}),C=i.annotations({...f,...c,...l}),O=I=>F(I,a)&&T0(m)(I),U=class extends e{constructor(I={},Q=!1){I={...I},s!=="Class"&&delete I._tag,I=Uae(n,I),S1(Q)||(I=Yd(y)(I)),super(I,!0)}static[Dl]=PH;static get ast(){let I=dae.get(this);if(I)return I;let Q=ir([i],{decode:()=>(J,z,te)=>J instanceof this||O(J)?it(J):xr(new Oe(te,J)),encode:()=>(J,z)=>J instanceof this?it(J):In(xn(m)(J,z),te=>new this(te,!0))},{identifier:o,pretty:J=>z=>`${o}(${J(z)})`,arbitrary:J=>z=>J(z).map(te=>new this(te)),equivalence:R,[Kg]:h.ast,...c});return I=me(_,Q,{strict:!0,decode:J=>new this(J,!0),encode:R}).annotations({[Kg]:C.ast,...l}).ast,dae.set(this,I),I}static pipe(){return v(this,arguments)}static annotations(I){return Te(this.ast).annotations(I)}static toString(){return`(${String(_)} <-> ${o})`}static make(...I){return new this(...I)}static fields={...n};static identifier=o;static extend(I){return(Q,J)=>{let z=b1(Q),te=g1(Q),ce=lg(n,z);return th({kind:s,identifier:I,schema:Z0(i,te),fields:ce,Base:this,annotations:J})}}static transformOrFail(I){return(Q,J,z)=>{let te=lg(n,Q);return th({kind:s,identifier:I,schema:gr(i,ye(zt(te)),J),fields:te,Base:this,annotations:z})}}static transformOrFailFrom(I){return(Q,J,z)=>{let te=lg(n,Q);return th({kind:s,identifier:I,schema:gr(f1(i),zt(te),J),fields:te,Base:this,annotations:z})}}get[a](){return a}};return r!==!0&&Object.defineProperty(U.prototype,"toString",{value(){return`${o}({ ${Reflect.ownKeys(n).map(I=>`${$u(I)}: ${Ho(this[I])}`).join(", ")} })`},configurable:!0,writable:!0}),U},_ve=zt({_tag:Bt("None")}).annotations({identifier:"FiberIdNoneEncoded"}),kve=zt({_tag:Bt("Runtime"),id:B0,startTimeMillis:B0}).annotations({identifier:"FiberIdRuntimeEncoded"}),Tve=zt({_tag:Bt("Composite"),left:GI(()=>i1),right:GI(()=>i1)}).annotations({identifier:"FiberIdCompositeEncoded"}),i1=yn(_ve,kve,Tve).annotations({identifier:"FiberIdEncoded"}),fue=e=>e.letrec(t=>({None:e.record({_tag:e.constant("None")}),Runtime:e.record({_tag:e.constant("Runtime"),id:e.integer(),startTimeMillis:e.integer()}),Composite:e.record({_tag:e.constant("Composite"),left:t("FiberId"),right:t("FiberId")}),FiberId:e.oneof(t("None"),t("Runtime"),t("Composite"))})).FiberId.map(K0),a1=e=>{switch(e._tag){case"None":return"FiberId.none";case"Runtime":return`FiberId.runtime(${e.id}, ${e.startTimeMillis})`;case"Composite":return`FiberId.composite(${a1(e.right)}, ${a1(e.left)})`}},c1=class extends ir(o5,{identifier:"FiberIdFromSelf",pretty:()=>a1,arbitrary:()=>fue}){},K0=e=>{switch(e._tag){case"None":return Dn;case"Runtime":return r5(e.id,e.startTimeMillis);case"Composite":return n5(K0(e.left),K0(e.right))}},XW=e=>{switch(e._tag){case"None":return{_tag:"None"};case"Runtime":return{_tag:"Runtime",id:e.id,startTimeMillis:e.startTimeMillis};case"Composite":return{_tag:"Composite",left:XW(e.left),right:XW(e.right)}}},eB=class extends me(i1,c1,{strict:!0,decode:t=>K0(t),encode:t=>XW(t)}).annotations({identifier:"FiberId"}){},Ive=e=>zt({_tag:Bt("Die"),defect:e}),Rve=zt({_tag:Bt("Empty")}),Ave=e=>zt({_tag:Bt("Fail"),error:e}),Mve=zt({_tag:Bt("Interrupt"),fiberId:i1}),vve=0,u1=(e,t)=>{let r=e,n=t,o=GI(()=>s),s=yn(Rve,Ave(r),Ive(n),Mve,zt({_tag:Bt("Sequential"),left:o,right:o}),zt({_tag:Bt("Parallel"),left:o,right:o})).annotations({title:`CauseEncoded<${Ft(e)}>`,[sC]:`CauseEncoded${vve++}`});return s},due=(e,t)=>r=>r.letrec(n=>({Empty:r.record({_tag:r.constant("Empty")}),Fail:r.record({_tag:r.constant("Fail"),error:e(r)}),Die:r.record({_tag:r.constant("Die"),defect:t(r)}),Interrupt:r.record({_tag:r.constant("Interrupt"),fiberId:fue(r)}),Sequential:r.record({_tag:r.constant("Sequential"),left:n("Cause"),right:n("Cause")}),Parallel:r.record({_tag:r.constant("Parallel"),left:n("Cause"),right:n("Cause")}),Cause:r.oneof(n("Empty"),n("Fail"),n("Die"),n("Interrupt"),n("Sequential"),n("Parallel"))})).Cause.map(Nl),hue=e=>t=>{let r=n=>{switch(n._tag){case"Empty":return"Cause.empty";case"Fail":return`Cause.fail(${e(n.error)})`;case"Die":return`Cause.die(${Ny(n)})`;case"Interrupt":return`Cause.interrupt(${a1(n.fiberId)})`;case"Sequential":return`Cause.sequential(${r(n.left)}, ${r(n.right)})`;case"Parallel":return`Cause.parallel(${r(n.left)}, ${r(n.right)})`}};return r(t)},hae=e=>(t,r,n)=>MQ(t)?xo(e(ug(t),r),Nl,n,t):xr(new Oe(n,t)),p1=({defect:e,error:t})=>ir([t,e],{decode:(r,n)=>hae(mn(u1(r,n))),encode:(r,n)=>hae(xn(u1(r,n)))},{title:`Cause<${t.ast}>`,pretty:hue,arbitrary:due});function Nl(e){switch(e._tag){case"Empty":return R_;case"Fail":return Ya(e.error);case"Die":return zn(e.defect);case"Interrupt":return yd(K0(e.fiberId));case"Sequential":return AQ(Nl(e.left),Nl(e.right));case"Parallel":return RQ(Nl(e.left),Nl(e.right))}}function ug(e){switch(e._tag){case"Empty":return{_tag:"Empty"};case"Fail":return{_tag:"Fail",error:e.error};case"Die":return{_tag:"Die",defect:e.defect};case"Interrupt":return{_tag:"Interrupt",fiberId:e.fiberId};case"Sequential":return{_tag:"Sequential",left:ug(e.left),right:ug(e.right)};case"Parallel":return{_tag:"Parallel",left:ug(e.left),right:ug(e.right)}}}var Pve=({defect:e,error:t})=>{let r=t,n=e;return me(u1(r,n),p1({error:ye(r),defect:ye(n)}),{strict:!1,decode:s=>Nl(s),encode:s=>ug(s)})},Q0=class extends me(rh,rh,{strict:!0,decode:t=>{if($r(t)&&"message"in t&&typeof t.message=="string"){let r=new Error(t.message,{cause:t});return"name"in t&&typeof t.name=="string"&&(r.name=t.name),r.stack="stack"in t&&typeof t.stack=="string"?t.stack:"",r}return lw(t)},encode:t=>t instanceof Error?{name:t.name,message:t.message}:lw(t)}).annotations({identifier:"Defect"}){},Fve=(e,t)=>zt({_tag:Bt("Failure"),cause:u1(e,t)}),Nve=e=>zt({_tag:Bt("Success"),value:e}),Dve=(e,t,r)=>yn(Fve(t,r),Nve(e)).annotations({title:`ExitEncoded<${Ft(e)}, ${Ft(t)}, ${Ft(r)}>`}),mue=e=>{switch(e._tag){case"Failure":return st(Nl(e.cause));case"Success":return xe(e.value)}},Lve=(e,t,r)=>n=>n.oneof(n.record({_tag:n.constant("Failure"),cause:due(t,r)(n)}),n.record({_tag:n.constant("Success"),value:e(n)})).map(mue),Uve=(e,t)=>r=>r._tag==="Failure"?`Exit.failCause(${hue(t)(r.cause)})`:`Exit.succeed(${e(r.value)})`,mae=(e,t)=>(r,n,o)=>Jb(r)?qt(r,{onFailure:s=>xo(t(s,n),st,o,r),onSuccess:s=>xo(e(s,n),xe,o,r)}):xr(new Oe(o,r)),xue=({defect:e,failure:t,success:r})=>ir([r,t,e],{decode:(n,o,s)=>mae(mn(n),mn(p1({error:o,defect:s}))),encode:(n,o,s)=>mae(xn(n),xn(p1({error:o,defect:s})))},{title:`Exit<${r.ast}, ${t.ast}>`,pretty:Uve,arbitrary:Lve}),tB=({defect:e,failure:t,success:r})=>{let n=r,o=t,s=e;return me(Dve(n,o,s),xue({failure:ye(o),success:ye(n),defect:ye(s)}),{strict:!1,decode:a=>mue(a),encode:a=>a._tag==="Failure"?{_tag:"Failure",cause:a.cause}:{_tag:"Success",value:a.value}})},qve=(e,t)=>r=>{let n=r.array(e(r));return(t.depthIdentifier!==void 0?r.oneof(t,r.constant([]),n):n).map(mp)},Hve=e=>t=>`HashSet(${Array.from(t).map(r=>e(r)).join(", ")})`,Wve=e=>{let t=Mn(e);return ar((r,n)=>t(Array.from(r),Array.from(n)))},xae=e=>(t,r,n)=>G4(t)?xo(e(Array.from(t),r),mp,n,t):xr(new Oe(n,t)),gue=e=>ir([e],{decode:t=>xae(mn(Nt(t))),encode:t=>xae(xn(Nt(t)))},{description:`HashSet<${Ft(e)}>`,pretty:Hve,arbitrary:qve,equivalence:Wve});function Bve(e){return me(Nt(e),gue(ye(e)),{strict:!0,decode:t=>mp(t),encode:t=>Array.from(t)})}var zve=(e,t,r)=>n=>{let o=n.array(n.tuple(e(n),t(n)));return(r.depthIdentifier!==void 0?n.oneof(r,n.constant([]),o):o).map(rm)},jve=(e,t)=>r=>`HashMap([${Array.from(r).map(([n,o])=>`[${e(n)}, ${t(o)}]`).join(", ")}])`,$ve=(e,t)=>{let r=Mn(ar(([n,o],[s,i])=>e(n,s)&&t(o,i)));return ar((n,o)=>r(Array.from(n),Array.from(o)))},gae=e=>(t,r,n)=>a5(t)?xo(e(Array.from(t),r),rm,n,t):xr(new Oe(n,t)),bue=({key:e,value:t})=>ir([e,t],{decode:(r,n)=>gae(mn(Nt(Ei(r,n)))),encode:(r,n)=>gae(xn(Nt(Ei(r,n))))},{description:`HashMap<${Ft(e)}, ${Ft(t)}>`,pretty:jve,arbitrary:zve,equivalence:$ve}),Vve=({key:e,value:t})=>me(Nt(Ei(e,t)),bue({key:ye(e),value:ye(t)}),{strict:!0,decode:r=>rm(r),encode:r=>Array.from(r)}),Gve=(e,t)=>r=>{let n=r.array(e(r));return(t.depthIdentifier!==void 0?r.oneof(t,r.constant([]),n):n).map(GC)},Kve=e=>t=>`List(${Array.from(t).map(r=>e(r)).join(", ")})`,Qve=e=>{let t=Mn(e);return ar((r,n)=>t(Array.from(r),Array.from(n)))},bae=e=>(t,r,n)=>VC(t)?xo(e(Array.from(t),r),GC,n,t):xr(new Oe(n,t)),yue=e=>ir([e],{decode:t=>bae(mn(Nt(t))),encode:t=>bae(xn(Nt(t)))},{description:`List<${Ft(e)}>`,pretty:Kve,arbitrary:Gve,equivalence:Qve});function Jve(e){return me(Nt(e),yue(ye(e)),{strict:!0,decode:t=>GC(t),encode:t=>Array.from(t)})}var Zve=(e,t,r)=>n=>{let o=n.array(e(n));return(r.depthIdentifier!==void 0?n.oneof(r,n.constant([]),o):o).map(s=>l_(s,t))},Yve=e=>t=>`new SortedSet([${Array.from(f_(t)).map(r=>e(r)).join(", ")}])`,yae=(e,t)=>(r,n,o)=>p2(r)?xo(e(Array.from(f_(r)),n),s=>l_(s,t),o,r):xr(new Oe(o,r)),Sue=(e,t,r)=>ir([e],{decode:n=>yae(mn(Nt(n)),t),encode:n=>yae(xn(Nt(n)),r)},{description:`SortedSet<${Ft(e)}>`,pretty:Yve,arbitrary:(n,o)=>Zve(n,t,o),equivalence:()=>IK()});function Xve(e,t){let r=ye(e);return me(Nt(e),Sue(r,t,t),{strict:!0,decode:n=>l_(n,t),encode:n=>Array.from(f_(n))})}var rB=class extends me(rh,nh,{strict:!0,decode:t=>zB(t),encode:R}).annotations({identifier:"BooleanFromUnknown"}){},nB=class extends me(Bt("true","false").annotations({description:"a string to be decoded into a boolean"}),nh,{strict:!0,decode:t=>t==="true",encode:t=>t?"true":"false"}).annotations({identifier:"BooleanFromString"}){},ePe=(e,t)=>{let r=IH(t);return jse(e).pipe(zse(n=>r(n).pipe(Hs(o=>Pse([],ag.formatIssueSync(o))))))},Y0=Symbol.for("effect/Schema/Serializable/symbol"),tPe=e=>e,rPe=e=>e[Y0],nPe=e=>d1(e[Y0])(e),oPe=u(2,(e,t)=>sh(e[Y0])(t)),Wu=Symbol.for("effect/Schema/Serializable/symbolResult"),sPe=e=>e,oB=e=>e[Wu].failure,sB=e=>e[Wu].success,Sae=ne("effect/Schema/Serializable/exitSchemaCache",()=>new WeakMap),FB=e=>{let t=Object.getPrototypeOf(e);if(!(Wu in t))return tB({failure:oB(e),success:sB(e),defect:Q0});let r=Sae.get(t);return r===void 0&&(r=tB({failure:oB(e),success:sB(e),defect:Q0}),Sae.set(t,r)),r},iPe=u(2,(e,t)=>h1(e[Wu].failure)(t)),aPe=u(2,(e,t)=>sh(e[Wu].failure)(t)),cPe=u(2,(e,t)=>h1(e[Wu].success)(t)),uPe=u(2,(e,t)=>sh(e[Wu].success)(t)),pPe=u(2,(e,t)=>h1(FB(e))(t)),lPe=u(2,(e,t)=>sh(FB(e))(t)),fPe=e=>e,dPe=e=>(t,r,n)=>{let o=lg({_tag:y1(t)},r.payload);return class extends th({kind:"TaggedRequest",identifier:e??t,schema:zt(o),fields:o,Base:UY,annotations:n}){static _tag=t;static success=r.success;static failure=r.failure;get[Y0](){return this.constructor}get[Wu](){return{failure:r.failure,success:r.success}}}},hPe=e=>Ea(e.ast,[]),mPe=vn(oC),Ea=(e,t)=>{let r=mPe(e);if(X(r))switch(e._tag){case"Declaration":return r.value(...e.typeParameters.map(n=>Ea(n,t)));case"Refinement":return r.value(Ea(e.from,t));default:return r.value()}switch(e._tag){case"NeverKeyword":throw new Error(h6(e,t));case"Transformation":return Ea(e.to,t);case"Declaration":case"Literal":case"StringKeyword":case"TemplateLiteral":case"UniqueSymbol":case"SymbolKeyword":case"UnknownKeyword":case"AnyKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"UndefinedKeyword":case"VoidKeyword":case"Enums":case"ObjectKeyword":return N;case"Refinement":return Ea(e.from,t);case"Suspend":{let n=Uh(()=>Ea(e.f(),t));return(o,s)=>n()(o,s)}case"TupleType":{let n=e.elements.map((s,i)=>Ea(s.type,t.concat(i))),o=e.rest.map(s=>Ea(s.type,t));return ar((s,i)=>{if(!Array.isArray(s)||!Array.isArray(i))return!1;let a=s.length;if(a!==i.length)return!1;let c=0;for(;c<Math.min(a,e.elements.length);c++)if(!n[c](s[c],i[c]))return!1;if(ut(o)){let[l,...f]=o;for(;c<a-f.length;c++)if(!l(s[c],i[c]))return!1;for(let d=0;d<f.length;d++)if(c+=d,!f[d](s[c],i[c]))return!1}return!0})}case"TypeLiteral":{if(e.propertySignatures.length===0&&e.indexSignatures.length===0)return N;let n=e.propertySignatures.map(s=>Ea(s.type,t.concat(s.name))),o=e.indexSignatures.map(s=>Ea(s.type,t));return ar((s,i)=>{if(!yg(s)||!yg(i))return!1;let a=Object.keys(s),c=Object.getOwnPropertySymbols(s);for(let d=0;d<n.length;d++){let h=e.propertySignatures[d],m=h.name,y=Object.prototype.hasOwnProperty.call(s,m),_=Object.prototype.hasOwnProperty.call(i,m);if(h.isOptional&&y!==_||y&&_&&!n[d](s[m],i[m]))return!1}let l,f;for(let d=0;d<o.length;d++){let h=e.indexSignatures[d],m=Tc(h.parameter),y=uC(m);if(y){if(l=l||Object.getOwnPropertySymbols(i),c.length!==l.length)return!1}else if(f=f||Object.keys(i),a.length!==f.length)return!1;let _=y?c:a;for(let C=0;C<_.length;C++){let O=_[C];if(!Object.prototype.hasOwnProperty.call(i,O)||!o[d](s[O],i[O]))return!1}}return!0})}case"Union":{let n=MH(e.types,!0),o=Reflect.ownKeys(n.keys),s=o.length;return ar((i,a)=>{let c=[];if(s>0&&dh(i))for(let f=0;f<s;f++){let d=o[f],h=n.keys[d].buckets;if(Object.prototype.hasOwnProperty.call(i,d)){let m=String(i[d]);Object.prototype.hasOwnProperty.call(h,m)&&(c=c.concat(h[m]))}}n.otherwise.length>0&&(c=c.concat(n.otherwise));let l=c.map(f=>[Ea(f,t),T0({ast:f})]);for(let f=0;f<l.length;f++){let[d,h]=l[f];if(h(i)&&h(a)&&d(i,a))return!0}return!1})}}},Eae=J0("symbol",{key:$e}).annotations({description:"an object to be decoded into a globally shared symbol"}),xPe=gr(Eae,U0,{strict:!0,decode:e=>Rce(e.key),encode:(e,t,r)=>In(Ice(e,r),n=>Eae.make({key:n}))}),l1=class extends yn($e,bn,xPe).annotations({identifier:"PropertyKey"}){};var iB=class extends zt({_tag:pg(Bt("Pointer","Unexpected","Missing","Composite","Refinement","Transformation","Type","Forbidden")).annotations({description:"The tag identifying the type of parse issue"}),path:pg(Nt(l1)).annotations({description:"The path to the property where the issue occurred"}),message:pg($e).annotations({description:"A descriptive message explaining the issue"})}).annotations({identifier:"ArrayFormatterIssue",description:"Represents an issue returned by the ArrayFormatter formatter"}){};var E1={};Xn(E1,{DefaultChunkSize:()=>bPe,Do:()=>ZLe,StreamTypeId:()=>gPe,accumulate:()=>yPe,accumulateChunks:()=>SPe,acquireRelease:()=>EPe,aggregate:()=>CPe,aggregateWithin:()=>wPe,aggregateWithinEither:()=>OPe,as:()=>_Pe,async:()=>kPe,asyncEffect:()=>TPe,asyncPush:()=>IPe,asyncScoped:()=>RPe,bind:()=>YLe,bindEffect:()=>XLe,bindTo:()=>eUe,branchAfter:()=>APe,broadcast:()=>MPe,broadcastDynamic:()=>PPe,broadcastedQueues:()=>FPe,broadcastedQueuesDynamic:()=>NPe,buffer:()=>DPe,bufferChunks:()=>LPe,catchAll:()=>UPe,catchAllCause:()=>qPe,catchSome:()=>HPe,catchSomeCause:()=>zPe,catchTag:()=>WPe,catchTags:()=>BPe,changes:()=>jPe,changesWith:()=>$Pe,changesWithEffect:()=>VPe,chunks:()=>GPe,chunksWith:()=>KPe,combine:()=>QPe,combineChunks:()=>JPe,concat:()=>ZPe,concatAll:()=>YPe,context:()=>EFe,contextWith:()=>CFe,contextWithEffect:()=>wFe,contextWithStream:()=>OFe,cross:()=>XPe,crossLeft:()=>eFe,crossRight:()=>tFe,crossWith:()=>rFe,debounce:()=>nFe,decodeText:()=>rUe,die:()=>oFe,dieMessage:()=>iFe,dieSync:()=>sFe,distributedWith:()=>aFe,distributedWithDynamic:()=>cFe,drain:()=>uFe,drainFork:()=>pFe,drop:()=>lFe,dropRight:()=>fFe,dropUntil:()=>dFe,dropUntilEffect:()=>hFe,dropWhile:()=>mFe,dropWhileEffect:()=>xFe,either:()=>gFe,empty:()=>bFe,encodeText:()=>nUe,ensuring:()=>yFe,ensuringWith:()=>SFe,execute:()=>_Fe,fail:()=>kFe,failCause:()=>IFe,failCauseSync:()=>RFe,failSync:()=>TFe,filter:()=>AFe,filterEffect:()=>MFe,filterMap:()=>vFe,filterMapEffect:()=>PFe,filterMapWhile:()=>FFe,filterMapWhileEffect:()=>NFe,finalizer:()=>DFe,find:()=>LFe,findEffect:()=>UFe,flatMap:()=>qFe,flatten:()=>HFe,flattenChunks:()=>WFe,flattenEffect:()=>BFe,flattenExitOption:()=>zFe,flattenIterables:()=>jFe,flattenTake:()=>$Fe,forever:()=>VFe,fromAsyncIterable:()=>GFe,fromChannel:()=>KFe,fromChunk:()=>JFe,fromChunkPubSub:()=>ZFe,fromChunkQueue:()=>YFe,fromChunks:()=>XFe,fromEffect:()=>e2e,fromEffectOption:()=>t2e,fromEventListener:()=>oUe,fromIterable:()=>o2e,fromIterableEffect:()=>s2e,fromIteratorSucceed:()=>i2e,fromPubSub:()=>r2e,fromPull:()=>a2e,fromQueue:()=>c2e,fromReadableStream:()=>p2e,fromReadableStreamByob:()=>l2e,fromSchedule:()=>f2e,fromTPubSub:()=>n2e,fromTQueue:()=>u2e,groupAdjacentBy:()=>d2e,groupBy:()=>h2e,groupByKey:()=>m2e,grouped:()=>x2e,groupedWithin:()=>g2e,haltAfter:()=>b2e,haltWhen:()=>y2e,haltWhenDeferred:()=>S2e,identity:()=>E2e,interleave:()=>C2e,interleaveWith:()=>w2e,interruptAfter:()=>k2e,interruptWhen:()=>T2e,interruptWhenDeferred:()=>I2e,intersperse:()=>O2e,intersperseAffixes:()=>_2e,iterate:()=>R2e,let:()=>tUe,make:()=>A2e,map:()=>M2e,mapAccum:()=>v2e,mapAccumEffect:()=>P2e,mapBoth:()=>F2e,mapChunks:()=>N2e,mapChunksEffect:()=>D2e,mapConcat:()=>L2e,mapConcatChunk:()=>U2e,mapConcatChunkEffect:()=>q2e,mapConcatEffect:()=>H2e,mapEffect:()=>W2e,mapError:()=>B2e,mapErrorCause:()=>z2e,mapInputContext:()=>RNe,merge:()=>j2e,mergeAll:()=>$2e,mergeEither:()=>K2e,mergeLeft:()=>Q2e,mergeRight:()=>J2e,mergeWith:()=>G2e,mergeWithTag:()=>V2e,mkString:()=>Z2e,never:()=>Y2e,onDone:()=>tNe,onEnd:()=>X2e,onError:()=>eNe,onStart:()=>rNe,orDie:()=>nNe,orDieWith:()=>oNe,orElse:()=>sNe,orElseEither:()=>iNe,orElseFail:()=>aNe,orElseIfEmpty:()=>cNe,orElseIfEmptyChunk:()=>uNe,orElseIfEmptyStream:()=>pNe,orElseSucceed:()=>lNe,paginate:()=>fNe,paginateChunk:()=>dNe,paginateChunkEffect:()=>hNe,paginateEffect:()=>mNe,partition:()=>xNe,partitionEither:()=>gNe,peel:()=>bNe,pipeThrough:()=>yNe,pipeThroughChannel:()=>SNe,pipeThroughChannelOrFail:()=>ENe,prepend:()=>CNe,provideContext:()=>wNe,provideLayer:()=>_Ne,provideService:()=>kNe,provideServiceEffect:()=>TNe,provideServiceStream:()=>INe,provideSomeContext:()=>ONe,provideSomeLayer:()=>ANe,race:()=>MNe,raceAll:()=>vNe,range:()=>PNe,rechunk:()=>FNe,refineOrDie:()=>NNe,refineOrDieWith:()=>DNe,repeat:()=>LNe,repeatEffect:()=>UNe,repeatEffectChunk:()=>qNe,repeatEffectChunkOption:()=>HNe,repeatEffectOption:()=>WNe,repeatEffectWithSchedule:()=>BNe,repeatEither:()=>zNe,repeatElements:()=>jNe,repeatElementsWith:()=>$Ne,repeatValue:()=>VNe,repeatWith:()=>GNe,retry:()=>KNe,run:()=>JNe,runCollect:()=>ZNe,runCount:()=>YNe,runDrain:()=>XNe,runFold:()=>eDe,runFoldEffect:()=>tDe,runFoldScoped:()=>rDe,runFoldScopedEffect:()=>nDe,runFoldWhile:()=>oDe,runFoldWhileEffect:()=>sDe,runFoldWhileScoped:()=>iDe,runFoldWhileScopedEffect:()=>aDe,runForEach:()=>cDe,runForEachChunk:()=>uDe,runForEachChunkScoped:()=>pDe,runForEachScoped:()=>lDe,runForEachWhile:()=>fDe,runForEachWhileScoped:()=>dDe,runHead:()=>hDe,runIntoPubSub:()=>mDe,runIntoPubSubScoped:()=>xDe,runIntoQueue:()=>gDe,runIntoQueueElementsScoped:()=>bDe,runIntoQueueScoped:()=>yDe,runLast:()=>SDe,runScoped:()=>EDe,runSum:()=>CDe,scan:()=>wDe,scanEffect:()=>ODe,scanReduce:()=>_De,scanReduceEffect:()=>kDe,schedule:()=>TDe,scheduleWith:()=>IDe,scoped:()=>RDe,scopedWith:()=>ADe,share:()=>vPe,sliding:()=>MDe,slidingSize:()=>vDe,some:()=>PDe,someOrElse:()=>FDe,someOrFail:()=>NDe,split:()=>DDe,splitLines:()=>UDe,splitOnChunk:()=>LDe,succeed:()=>qDe,suspend:()=>WDe,sync:()=>HDe,take:()=>BDe,takeRight:()=>zDe,takeUntil:()=>jDe,takeUntilEffect:()=>$De,takeWhile:()=>VDe,tap:()=>GDe,tapBoth:()=>KDe,tapError:()=>QDe,tapErrorCause:()=>JDe,tapSink:()=>ZDe,throttle:()=>YDe,throttleEffect:()=>XDe,tick:()=>eLe,timeout:()=>tLe,timeoutFail:()=>rLe,timeoutFailCause:()=>nLe,timeoutTo:()=>oLe,toAsyncIterable:()=>hLe,toAsyncIterableEffect:()=>dLe,toAsyncIterableRuntime:()=>fLe,toChannel:()=>QFe,toPubSub:()=>sLe,toPull:()=>iLe,toQueue:()=>aLe,toQueueOfElements:()=>cLe,toReadableStream:()=>uLe,toReadableStreamEffect:()=>pLe,toReadableStreamRuntime:()=>lLe,transduce:()=>mLe,unfold:()=>xLe,unfoldChunk:()=>gLe,unfoldChunkEffect:()=>bLe,unfoldEffect:()=>yLe,unwrap:()=>ELe,unwrapScoped:()=>CLe,unwrapScopedWith:()=>wLe,updateService:()=>OLe,void:()=>SLe,when:()=>_Le,whenCase:()=>kLe,whenCaseEffect:()=>TLe,whenEffect:()=>ILe,withExecutionPlan:()=>QNe,withSpan:()=>RLe,zip:()=>ALe,zipAll:()=>vLe,zipAllLeft:()=>PLe,zipAllRight:()=>FLe,zipAllSortedByKey:()=>NLe,zipAllSortedByKeyLeft:()=>DLe,zipAllSortedByKeyRight:()=>LLe,zipAllSortedByKeyWith:()=>ULe,zipAllWith:()=>qLe,zipFlatten:()=>MLe,zipLatest:()=>HLe,zipLatestAll:()=>WLe,zipLatestWith:()=>BLe,zipLeft:()=>zLe,zipRight:()=>jLe,zipWith:()=>$Le,zipWithChunks:()=>VLe,zipWithIndex:()=>JLe,zipWithNext:()=>GLe,zipWithPrevious:()=>KLe,zipWithPreviousAndNext:()=>QLe});var gPe=uI,bPe=Jx,yPe=vre,SPe=vU,EPe=PU,CPe=Pre,wPe=pI,OPe=FU,_Pe=Fre,kPe=Nre;var TPe=Dre,IPe=DU,RPe=Lre,APe=Ure,MPe=qre,vPe=Hre,PPe=LU,FPe=UU,NPe=Wre,DPe=Bre,LPe=zre,UPe=Iu,qPe=Zx,HPe=jre,WPe=$re,BPe=Vre,zPe=qU,jPe=Gre,$Pe=HU,VPe=Kre,GPe=XS,KPe=Qre,QPe=Jre,JPe=e0,ZPe=oc,YPe=Zre,XPe=Yre,eFe=Xre,tFe=fI,rFe=dI,nFe=ene,oFe=hI,sFe=tne,iFe=rne,aFe=WU,cFe=BU,uFe=Yx,pFe=nne,lFe=jU,fFe=one,dFe=sne,hFe=ine,mFe=$U,xFe=ane,gFe=cne,bFe=Ru,yFe=Tu,SFe=une,EFe=t0,CFe=pne,wFe=lne,OFe=mI,_Fe=VU,kFe=ku,TFe=xI,IFe=r0,RFe=fne,AFe=dne,MFe=GU,vFe=Tl,PFe=hne,FFe=mne,NFe=xne,DFe=gne,LFe=bne,UFe=yne,qFe=hr,HFe=Xx,WFe=n0,BFe=Sne,zFe=$d,jFe=Ene,$Fe=Ml,VFe=gI,GFe=Cne,KFe=eg,QFe=D,JFe=Il,ZFe=wne,YFe=aI,XFe=One,e2e=sr,t2e=tg,r2e=o0,n2e=_ne,o2e=rg,s2e=kne,i2e=KU,a2e=s0,c2e=bi,u2e=QU,p2e=Ine,l2e=Rne,f2e=Tne,d2e=Mne,h2e=Eie,m2e=bH,x2e=vne,g2e=Pne,b2e=Fne,y2e=JU,S2e=Nne,E2e=ZU,C2e=Dne,w2e=YU,O2e=XU,_2e=Lne,k2e=Une,T2e=bI,I2e=eq,R2e=qne,A2e=Rl,M2e=Or,v2e=yI,P2e=SI,F2e=Hne,N2e=Vd,D2e=Wne,L2e=Bne,U2e=i0,q2e=zne,H2e=jne,W2e=gH,B2e=EI,z2e=Vne,j2e=a0,$2e=CI,V2e=Gne,G2e=wI,K2e=tq,Q2e=Kne,J2e=Qne,Z2e=Jne,Y2e=Zne,X2e=Yne,eNe=Xne,tNe=eoe,rNe=toe,nNe=roe,oNe=rq,sNe=c0,iNe=noe,aNe=ooe,cNe=soe,uNe=nq,pNe=oq,lNe=ioe,fNe=aoe,dNe=sq,hNe=iq,mNe=aq,xNe=uoe,gNe=cq,bNe=coe,yNe=poe,SNe=uq,ENe=loe,CNe=foe,wNe=OI,ONe=pq,_Ne=lq,kNe=doe,TNe=u0,INe=fq,RNe=_I,ANe=dq,MNe=moe,vNe=hq,PNe=hoe,FNe=p0,NNe=xoe,DNe=mq,LNe=goe,UNe=boe,qNe=yoe,HNe=Au,WNe=Al,BNe=yq,zNe=xq,jNe=Soe,$Ne=gq,VNe=Eoe,GNe=bq,KNe=cI,QNe=Coe,JNe=ho,ZNe=woe,YNe=Ooe,XNe=_oe,eDe=koe,tDe=Toe,rDe=Ioe,nDe=Roe,oDe=Sq,sDe=Eq,iDe=Cq,aDe=wq,cDe=Oq,uDe=_q,pDe=Aoe,lDe=kq,fDe=Moe,dDe=voe,hDe=Poe,mDe=Foe,xDe=kI,gDe=Tq,bDe=Iq,yDe=l0,SDe=Noe,EDe=Gd,CDe=Doe,wDe=Loe,ODe=Mq,_De=Uoe,kDe=Rq,TDe=qoe,IDe=Aq,RDe=Kd,ADe=f0,MDe=Boe,vDe=Pq,PDe=Hoe,FDe=Woe,NDe=vq,DDe=zoe,LDe=joe,UDe=$oe,qDe=d0,HDe=Fq,WDe=Tn,BDe=Voe,zDe=Goe,jDe=Koe,$De=Qoe,VDe=Nq,GDe=Dq,KDe=Joe,QDe=Lq,JDe=Uq,ZDe=Zoe,YDe=Yoe,XDe=qq,eLe=Xoe,tLe=ese,rLe=tse,nLe=Hq,oLe=Wq,sLe=TI,iLe=jd,aLe=II,cLe=Bq,uLe=nse,pLe=ose,lLe=RI,fLe=AI,dLe=ase,hLe=ise,mLe=sse,xLe=zq,gLe=jq,bLe=h0,yLe=MI,SLe=cse;var ELe=vl,CLe=vs,wLe=ng,OLe=use,_Le=pse,kLe=lse,TLe=$q,ILe=Vq,RLe=fse,ALe=dse,MLe=hse,vLe=mse,PLe=xse,FLe=gse,NLe=bse,DLe=yse,LLe=Sse,ULe=m0,qLe=x0,HLe=Ese,WLe=Gq,BLe=vI,zLe=Cse,jLe=wse,$Le=PI,VLe=g0,GLe=Qq,KLe=Jq,QLe=Ose,JLe=Kq,ZLe=kse,YLe=Tse,XLe=Cie,eUe=Ise,tUe=Rse;var rUe=Ase,nUe=Mse,oUe=vse;var X0=Symbol.for("effect/Subscribable");var lht={[Hn]:Hn,[X0]:X0,pipe(){return v(this,arguments)}};var eE={};Xn(eE,{SubscriptionRefTypeId:()=>cUe,get:()=>uUe,getAndSet:()=>pUe,getAndUpdate:()=>lUe,getAndUpdateEffect:()=>fUe,getAndUpdateSome:()=>dUe,getAndUpdateSomeEffect:()=>hUe,make:()=>mUe,modify:()=>xUe,modifyEffect:()=>gUe,modifySome:()=>bUe,modifySomeEffect:()=>yUe,set:()=>SUe,setAndGet:()=>EUe,update:()=>CUe,updateAndGet:()=>OUe,updateAndGetEffect:()=>_Ue,updateEffect:()=>wUe,updateSome:()=>kUe,updateSomeAndGet:()=>IUe,updateSomeAndGetEffect:()=>RUe,updateSomeEffect:()=>TUe});var Cue=rN;var wue=KJ;var Oue=QJ;var _ue=JJ;var kue=ZJ;var Tue=YJ;var Iue=XJ;var Rue=oN;var sUe="effect/SubscriptionRef",LB=Symbol.for(sUe),iUe={_A:e=>e},DB=class extends un{ref;pubsub;semaphore;[Hn]=Hn;[X0]=X0;[SP]=sy;[Cue]=nN;[LB]=iUe;constructor(t,r,n){super(),this.ref=t,this.pubsub=r,this.semaphore=n,this.get=_t(this.ref)}commit(){return this.get}get;get changes(){return p(_t(this.ref),P(t=>w(o0(this.pubsub,{scoped:!0}),r=>oc(Rl(t),r))),this.semaphore.withPermits(1),vs)}modify(t){return this.modifyEffect(r=>B(t(r)))}modifyEffect(t){return p(_t(this.ref),P(t),P(([r,n])=>p(Lr(this.ref,n),Kt(r),dl(ZD(this.pubsub,n)))),this.semaphore.withPermits(1))}},Aue=e=>_t(e.ref),Mue=e=>p(Po([$k(),tr(e),fl(1)]),w(([t,r,n])=>new DB(r,t,n))),vue=u(2,(e,t)=>e.modify(t)),Pue=u(2,(e,t)=>e.modifyEffect(t)),Fue=u(2,(e,t)=>p(Lr(e.ref,t),dl(ZD(e.pubsub,t)),e.semaphore.withPermits(1)));var cUe=LB,uUe=Aue,pUe=sd,lUe=EP,fUe=wue,dUe=CP,hUe=Oue,mUe=Mue,xUe=vue,gUe=Pue,bUe=wP,yUe=_ue,SUe=Fue,EUe=OP,CUe=Os,wUe=kue,OUe=_P,_Ue=Tue,kUe=kP,TUe=Iue,IUe=TP,RUe=Rue;var Nue=gg(require("vscode")),AUe=(e,t,r)=>wi.decodeUnknown(e)(t).pipe(j.catchAll(n=>j.logWarning(n).pipe(j.andThen(j.succeed(r))))),MUe=e=>(t,r,n)=>j.gen(function*(){let o=e.get(t);return yield*AUe(r,o,n)}),tE=j.gen(function*(){let e=Nue.workspace.getConfiguration("effect-decorate.extension"),t=MUe(e),r=yield*t("areDecorationsActive",wi.Boolean,!0),n=yield*t("isDebugActive",wi.Boolean,!0),o=yield*t("isNamespaceDecorationActive",wi.Boolean,!0),s=yield*t("isYieldDecorationActive",wi.Boolean,!0),i=yield*t("yieldableColor",wi.Literal("none","default","custom"),"default"),a=yield*t("yieldableCustomColor",wi.String,"#ffffff"),c=yield*t("yieldableTextDecoration",wi.Literal("none","underline"),"underline"),l=yield*t("yieldStyling",wi.Literal("hide","thunder","none"),"hide");return{areDecorationsActive:r,isDebugActive:n,isNamespaceDecorationActive:o,isYieldDecorationActive:s,yieldableColor:i,yieldableCustomColor:a,yieldableTextDecoration:c,yieldStyling:l}});var Due=gg(require("vscode")),vUe=()=>j.runSync(tE),Lue=e=>Pu.replaceScoped(Pu.defaultLogger,j.gen(function*(){let t=yield*j.acquireRelease(j.sync(()=>Due.window.createOutputChannel(e)),r=>j.sync(()=>r.dispose()));return Pu.make(r=>{let n=vUe();if(!(r.logLevel===$p.Debug?n.isDebugActive:!0))return;let s=Pu.logfmtLogger.log(r);t.appendLine(s)})}));var C1=gg(require("vscode")),ah=class extends Jt.Tag("vscode/ExtensionContext")(){},Uue=e=>j.gen(function*(){let t=yield*ua.make();(yield*ah).subscriptions.push({dispose(){j.runFork(ua.close(t,tn.void))}}),yield*xi.buildWithScope(e,t)}).pipe(j.catchAllCause(j.logFatal)),que=(e,t)=>j.gen(function*(){let r=yield*ah,n=yield*j.runtime(),o=Wd.runFork(n);r.subscriptions.push(C1.commands.registerCommand(e,(...s)=>t(...s).pipe(j.scoped,j.catchAllCause(j.logWarning),j.annotateLogs({command:e}),o)))}),PUe=(e,t)=>j.flatMap(j.runtime(),r=>j.async(()=>{let n=Wd.runFork(r),o=e(s=>n(t(s).pipe(j.scoped,j.catchAllCause(i=>j.logWarning("unhandled defect in event listener: ",i)))));return j.sync(()=>{o.dispose()})})),UB=(e,t)=>j.forkScoped(PUe(e,t)),Hue=(e,t)=>j.gen(function*(){let r=yield*ah,n=yield*j.runtime(),o=Wd.runPromise(n),s=C1.languages.registerHoverProvider(e,{provideHover(i,a,c){return o(t(i,a,c).pipe(j.catchAllCause(l=>j.logWarning(l).pipe(j.as(null)))))}});r.subscriptions.push(s)});var Ar=gg(require("vscode"));var FUe=e=>t=>e?oe.some(t):oe.none(),NUe=()=>Ar.window.visibleTextEditors.filter(e=>e.document.uri.scheme==="file"&&e.document.languageId==="typescript"),Wue=e=>{let{document:t,text:r,regexp:n}=e,o=[];for(let s of r.matchAll(n)){if(!s[0])continue;let i=s.index,a=t.positionAt(i),c=t.positionAt(i+s[0].length);o.push(new Ar.Range(a,c))}return o},mg=(e,t)=>{for(let r of t)if(e.intersection(r))return!0;return!1},DUe=/\/\/.*/g,LUe=/\/\*[\s\S]*?\*\//g,UUe=/yield\*\s(\w+)/g,qUe=(e,t)=>{let r=Wue({document:e,text:t,regexp:DUe}),n=Wue({document:e,text:t,regexp:LUe});return[...r,...n]},HUe=e=>{let{document:t,text:r,commentRanges:n}=e,o=[],s=[],i;for(;(i=UUe.exec(r))!==null;){let a=t.positionAt(i.index),c=t.positionAt(i.index+i[0].length),l=new Ar.Range(a,c);if(mg(l,n))continue;let f=t.positionAt(i.index+i[0].length-i[1].length),d=new Ar.Range(a,f),h=f,m=new Ar.Range(h,c);o.push(d),s.push(m)}return{yieldables:s,yields:o}},WUe=e=>{let{document:t,text:r,commentRanges:n}=e,o=[],s=[],i=/\b([A-Z]\w*)\.([A-Z]\w*)\b/g,a;for(;(a=i.exec(r))!==null;){if(a[1]!==a[2])continue;let c=t.positionAt(a.index),l=t.positionAt(a.index+a[0].length),f=new Ar.Range(c,l);if(mg(f,n))continue;let d=t.positionAt(a.index+a[1].length+1),h=new Ar.Range(c,d),m=d,y=new Ar.Range(m,l);o.push(h),s.push(y)}return{namespaces:o,types:s}},rE=Ar.window.createTextEditorDecorationType,Bue={opacity:"0",letterSpacing:"-0.6em"},zue=e=>{let r=!e.isYieldDecorationActive||e.yieldStyling==="none"?oe.none():e.yieldStyling==="hide"?oe.some(rE(Bue)):oe.some(rE({before:{contentText:"\u26A1"},opacity:"0",letterSpacing:"-0.6em"})),o=(()=>{if(e.isYieldDecorationActive){let i=e.yieldableColor!=="none",a=e.yieldableColor==="default"?new Ar.ThemeColor("editorInfo.foreground"):e.yieldableCustomColor;return i?oe.some(rE({color:a,textDecoration:e.yieldableTextDecoration})):oe.some(rE({textDecoration:e.yieldableTextDecoration}))}else return oe.none()})(),s=FUe(e.isNamespaceDecorationActive)(rE(Bue));return{yieldableDecoration:o,yieldDecoration:r,namespaceDecoration:s}},jue=xi.scopedDiscard(j.gen(function*(){let e=yield*tE.pipe(j.andThen(eE.make));yield*UB(Ar.workspace.onDidChangeConfiguration,()=>tE.pipe(j.andThen(d=>eE.set(e,d))));let t=yield*p(e.get,j.andThen(zue),j.andThen(Br.make)),r=yield*Br.make(new Map),n=yield*Br.make(new Map),o=yield*Br.make(new Map),s=(d,h)=>j.gen(function*(){let m=yield*r,y=d.document.uri.path,_=d.document.version,C=m.get(y);if(C&&C.version===_)return C.ranges;let O=qUe(d.document,h);return yield*Br.update(r,U=>new Map(U).set(y,{version:_,ranges:O})),O}),i=(d,h,m)=>j.gen(function*(){let y=yield*o,_=d.document.uri.path,C=d.document.version,O=y.get(_),U=yield*s(d,h),I=O&&O.version===C?{yields:O.yields,yieldables:O.yieldables}:HUe({document:d.document,text:h,commentRanges:U});yield*Br.update(o,z=>new Map(z).set(_,{version:C,yields:I.yields,yieldables:I.yieldables}));let Q=[],J=[];for(let z=0;z<I.yields.length;z++){let te=I.yields[z],ce=I.yieldables[z];if(!te||!ce)continue;mg(ce,m)||mg(te,m)||(Q.push(te),J.push(ce))}return{yields:Q,yieldables:J}}),a=(d,h,m)=>j.gen(function*(){let y=yield*n,_=d.document.uri.path,C=d.document.version,O=y.get(_),U=yield*s(d,h),I=O&&O.version===C?{namespaces:O.namespaces,types:O.types}:WUe({document:d.document,text:h,commentRanges:U});yield*Br.update(n,z=>new Map(z).set(_,{version:C,namespaces:I.namespaces,types:I.types}));let Q=[],J=[];for(let z=0;z<I.namespaces.length;z++){let te=I.namespaces[z],ce=I.types[z];if(!te||!ce)continue;mg(te,m)||mg(ce,m)||(Q.push(te),J.push(ce))}return{namespaces:Q,types:J}}),c=d=>j.gen(function*(){let h=yield*t;oe.isSome(h.namespaceDecoration)&&d.setDecorations(h.namespaceDecoration.value,[]),oe.isSome(h.yieldableDecoration)&&d.setDecorations(h.yieldableDecoration.value,[]),oe.isSome(h.namespaceDecoration)&&d.setDecorations(h.namespaceDecoration.value,[])}),l=R0.counter("decorate_count",{description:"Counts how many times `decorate` has run",incremental:!0}),f=j.gen(function*(){if(!(yield*e).areDecorationsActive)return;let h=NUe();if(h.length===0)return;let m=yield*R0.value(l);yield*l(j.succeed(1));let{yieldDecoration:y,yieldableDecoration:_,namespaceDecoration:C}=yield*t;for(let O of h){yield*c(O);let U=O.selections,I=O.document.getText(),Q=yield*i(O,I,U),J=yield*a(O,I,U);oe.isSome(y)&&O.setDecorations(y.value,Q.yields),oe.isSome(_)&&O.setDecorations(_.value,Q.yieldables),oe.isSome(C)&&O.setDecorations(C.value,J.namespaces)}yield*j.logTrace(`count: ${m.count})`)}).pipe(j.withLogSpan("decorate"));yield*j.forkScoped(e.changes.pipe(E1.runForEach(d=>j.gen(function*(){let h=yield*Br.get(t);oe.isSome(h.yieldDecoration)&&h.yieldDecoration.value.dispose(),oe.isSome(h.yieldableDecoration)&&h.yieldableDecoration.value.dispose(),oe.isSome(h.namespaceDecoration)&&h.namespaceDecoration.value.dispose(),yield*Br.set(t,zue(d)),yield*f.pipe(j.annotateLogs({trigger:"configChange"}))})))),yield*UB(Ar.window.onDidChangeTextEditorSelection,d=>d.textEditor.document.languageId==="typescript"?f.pipe(j.annotateLogs({trigger:"selectionChange"})):j.void),yield*f,yield*j.logInfo("Finished initial decoration"),yield*j.logInfo("About to register hover provider"),yield*Hue(["typescript","typescriptreact"],(d,h)=>j.gen(function*(){yield*j.logInfo("Hover provider called");let m=yield*j.tryPromise(()=>Ar.commands.executeCommand("vscode.executeHoverProvider",d.uri,h));if(yield*j.logInfo(`Got ${m?.length??0} hovers`),!m||m.length===0)return null;let y=m[0];if(!y)return null;let _=y.contents.map(C=>typeof C=="string"?C.replace(/\b(\w+)\.(\1)\b/g,"$1"):C instanceof Ar.MarkdownString?new Ar.MarkdownString(C.value.replace(/\b(\w+)\.(\1)\b/g,"$1")):C);return new Ar.Hover(_,y.range)}).pipe(j.orElseSucceed(()=>null)))}));var $ue=gg(require("vscode"));var Vue=xi.scopedDiscard(que("effect-decorate.openSettings",()=>j.sync(()=>$ue.commands.executeCommand("workbench.action.openSettings","@ext:dearhumandev.effect-decorate"))));var BUe=xi.mergeAll(Lue("effect-decorate"),Pu.minimumLogLevel($p.Trace)),zUe=xi.mergeAll(jue,Vue,BUe),jUe=Uue(zUe).pipe(j.andThen(j.logInfo("\u{1F680} Initializing effect-decorate extension. ")));function $Ue(e){j.runFork(jUe.pipe(j.provideService(ah,e)))}0&&(module.exports={activate});
